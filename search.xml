<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å‰µç«™é¦–ç¯‡æ–‡ç« </title>
    <url>/posts/2051013919/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>è‡ª2018å¹´é–‹å§‹æ’°å¯«Bloggerç´€éŒ„å·¥ä½œä¸Šæœƒé‡åˆ°çš„å…§å®¹ï¼Œè—‰ç”±ç´€éŒ„çš„éç¨‹ä¹Ÿæœ‰åŠ©æ–¼åŠ æ·±å°æ–¼æŸé …æŠ€è¡“çš„å°è±¡ã€‚æƒ³ç•¶åˆæˆ‘é‡åˆ°å•é¡Œçš„æ™‚å€™ä¹Ÿæ˜¯ä¸æ–·Googleï¼Œå—æƒ æ–¼å¾ˆå¤šç¶²è·¯å¤§ç¥çš„æ–‡ç« æ‰è§£æ±ºäº†å•é¡Œï¼ŒæœŸè¨±æˆ‘ä¹Ÿèƒ½å¤ æˆç‚ºç¶²è·¯ä¸–ç•Œä¸­æœ‰ç”¨çš„äººï¼Œæ’°å¯«å‡ºä¸€äº›èƒ½å¤ å°é€™å€‹ä¸–ç•Œæœ‰æ‰€å¹«åŠ©çš„æ–‡ç« ã€‚</p>
<p>ç¤™æ–¼æˆ‘å°æ–¼Bloggerçš„èª¿æ•´ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¸¸å¸¸å½±ç‰‡ä¸Šå‚³å¤±æ•—æˆ–åˆ†é çš„éç¨‹æœƒç„¡æ³•å®Œæ•´å‘ˆç¾ï¼Œæœ‰ä¸€å¤©ç•¶æˆ‘é‡åˆ°Hexo-nexTçš„ä¸»é¡Œæ™‚ï¼Œé©šç‚ºå¤©äººï¼Œé€™å®Œå…¨å°±æ˜¯æˆ‘ç†æƒ³ä¸­çš„éƒ¨è½æ ¼å¤–è§€ï¼Œå› æ­¤å°±æ±ºå®šè—‰ç”±å­¸ç¿’ä¸€é …æ–°çš„æŠ€è¡“çš„åŒæ™‚ä¹Ÿä¾†é‡å»ºä¸€ä¸‹ä»¥å‰é†œé†œçš„Google
Blogger...</p>
<span id="more"></span>
<p>##ğŸŒŸ ç‚ºä»€éº¼æƒ³è¦é‡å»ºä¸€å€‹éƒ¨è½æ ¼?</p>
<h3 id="ä¸»è¦åŸå› ">ä¸»è¦åŸå› </h3>
<blockquote>
<p>Hexo-nexTç›¸ç•¶ç°¡æ½”æœ‰åŠ›</p>
</blockquote>
<p>æ–¼æˆ‘è€Œè¨€ï¼Œç†æƒ³ä¸­çš„éƒ¨è½æ ¼å°±æ˜¯åªè¦å¯ä»¥ä»‹ç´¹æˆ‘æ˜¯èª°ã€æ–¹ä¾¿è¨ªå®¢æŸ¥çœ‹æ–‡ç« ã€ç•™è¨€ï¼Œé€™å¹¾é …åŸºæœ¬åŠŸèƒ½å³å¯</p>
<p>å‰›å¥½Hexoçš„nexTä¸»é¡Œå¯ä»¥èªªæ˜¯å°ˆç‚ºé€™äº›å…§å®¹è€Œç”Ÿçš„éœæ…‹é é¢æ¸²æŸ“å™¨ï¼Œå…§å»ºçš„æ–‡ç« ç›®éŒ„ã€å¯ä»¥ç›´æ¥ä½¿ç”¨markdownèªæ³•é€²è¡Œæ¸²æŸ“çš„å…§å®¹ï¼Œé‚„æœ‰å„ç¨®ç•™è¨€å¤–æ›å¯ä¾›åˆ©ç”¨ï¼Œå®Œå…¨ç¬¦åˆæˆ‘çš„éœ€æ±‚ã€‚</p>
<h3 id="é¡å¤–å¥½è™•">é¡å¤–å¥½è™•</h3>
<blockquote>
<p>ç¶²ç«™è‡ªä¸»æ¬Šï¼Œéå¸¸çš„é‡è¦!</p>
</blockquote>
<p>Hexoå¯ä»¥åœ¨æœ¬åœ°ç«¯é€éhexo-cliå¥—ä»¶é€²è¡Œéœæ…‹ç¶²é æ¸²æŸ“ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å„²å­˜åŸå§‹æª”æ¡ˆï¼Œä¸æ€•æœ‰ä¸€å¤©æœå‹™æ”¶æ‰å»æ²’æœ‰åŸå§‹æª”å¯ä»¥å¾©åŸã€‚</p>
<p>æ¸²æŸ“å¾Œçš„å…§å®¹è¦çµ¦ç¶²è·¯çœ‹å¿…é ˆè¦æ‰¾å€‹ç©ºé–“é€²è¡Œéƒ¨ç½²ï¼Œå‰›å¥½<strong>GitHubPage</strong>æœ‰æä¾›é€™é …æœå‹™ï¼Œå¦‚æœ‰è³¼è²·ç¶²åŸŸï¼Œä¹Ÿå¯ä»¥é€²è¡ŒCNAMEè¨­å®šå³å¯æ“æœ‰è‡ªå·±çš„å®˜æ–¹ç¶²ç«™éƒ¨è½æ ¼äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆè®š!</p>
<hr />
<h2 id="æœªä¾†æ–‡ç« çµ„æˆæ–¹å‘">â¤´ï¸æœªä¾†æ–‡ç« çµ„æˆæ–¹å‘</h2>
<p>é€™å¹¾å¹´ä¾†åšäº†ä¸å°‘å€‹side
projectï¼Œå°ˆæ¡ˆåŸ·è¡Œéç¨‹ä¹Ÿèƒ½æœ‰å¹¸èˆ‡å„åœ°ç¶²å‹äº¤æµï¼Œå› ç‚ºæˆ‘æœ¬èº«æ˜¯åå·¥ç¨‹äººå“¡ï¼Œå°æ–¼è³‡è¨Šäººå“¡æ‰€èƒ½æ’°å¯«çš„ç´ æï¼Œæˆ‘å¯ä»¥å†å¤šèå…¥æœ‰é—œå·¥ç¨‹ä¸Šçš„æ‡‰ç”¨ï¼Œè€Œé€™äº›å…§å®¹ä¹Ÿæ˜¯çœ¾å¤šç¶²å‹æ‰€é—œæ³¨çš„å…§å®¹ï¼ŒåŒ…å«è¦åŠƒã€è¨­è¨ˆã€ç›£é€ ã€å·¥å‹™è¡Œæ”¿...ç­‰ã€‚</p>
<p>åœ¨æ­¤ï¼Œæˆ‘å¾ˆæ„Ÿè¬æ›¾ç¶“å¹«åŠ©éæˆ‘çš„æœ‹å‹ï¼Œå› ç‚ºæœ‰ä½ å€‘çš„æ”¯æŒï¼Œä¹Ÿæ‰èƒ½è®“æˆ‘æœ‰å‹•åŠ›ç¹¼çºŒç ”ç©¶é–‹ç™¼ã€‚</p>
<h3 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h3>
<p>ç•¶é‡åˆ°çš„å•é¡Œçš„æ™‚å€™å°±çŸ¥é“è¦å»æ‰¾ç­”æ¡ˆäº†ï¼Œé€™æ˜¯æˆ‘åœ¨è‡ªå­¸çš„éç¨‹ä¸­æ‰€é ˜æ‚Ÿåˆ°çš„ä¸€ä»¶äº‹ï¼Œçœ‹éç¨‹å¼ç¢¼å…¶å¯¦ä¸ä»£è¡¨ä½ å·²ç¶“æœƒäº†ï¼Œè€Œæ˜¯å¿…é ˆè¦æŠŠç­”æ¡ˆå¯«å‡ºä¾†ä¸¦è§£æ±ºäº†å•é¡Œæ‰æ˜¯çœŸçš„æœƒäº†!</p>
<blockquote>
<p>å¯«ç¨‹å¼æœ¬èº«å°±æ˜¯ä¸€å€‹ä¸æ–·é‡åˆ°éŒ¯èª¤ã€ä¿®æ­£éŒ¯èª¤çš„éç¨‹</p>
</blockquote>
<p>æˆ‘æœƒå°‡è§£æ±ºå•é¡Œçš„éç¨‹ä¸­ï¼Œé‚£äº›å€¼å¾—ç´€éŒ„çš„åŸºæœ¬æ¦‚å¿µå¯«åœ¨æˆ‘çš„éƒ¨è½æ ¼ä¸­ï¼Œæœ‰ä¸€å¤©ç¶²è·¯ä¸Šç›¸é‡æ™‚èƒ½å¹«åŠ©åˆ°ä½ æˆ‘æœƒå¾ˆé–‹å¿ƒã€‚</p>
<h3 id="å°ˆæ¡ˆé–‹ç™¼">å°ˆæ¡ˆé–‹ç™¼</h3>
<p>å¯«ç¨‹å¼çš„ç›®æ¨™ï¼Œå¾€å¾€æ˜¯é€éå®Œæˆå°å°ˆæ¡ˆåˆä½µæˆä¸€å€‹å¤§å°ˆæ¡ˆä¾†è§£æ±ºå¯¦å‹™ä¸Šçš„å•é¡Œï¼Œæ‡‚å¾—æ‹†åˆ†éœ€æ±‚ä¹Ÿæ˜¯ä¸€åå¥½çš„è³‡è¨Šäººå“¡æ‰€éœ€è¦çš„åŸºæœ¬æŠ€èƒ½ï¼Œé–‹ç™¼éç¨‹é›£å…æœƒé‡åˆ°ä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œä½†é€™äº›å•é¡Œåˆåé›¢åŸºæœ¬æ¦‚å¿µå¤ªé ï¼Œä¸»è¦è¨´æ±‚æ˜¯ç‚ºäº†è§£æ±ºå°ˆæ¡ˆå…§å®¹è€Œç”Ÿï¼Œå› æ­¤é€™éƒ¨åˆ†ç‚ºä»¥è§£æ±º<strong>å¯¦å‹™ä¸Šçš„å•é¡Œ</strong>ç‚ºå…§å®¹ï¼Œå°‡æˆ‘è¸©éçš„å‘åˆ†äº«çµ¦å„ä½åŒæ¨£é‡è¦‹è©²å•é¡Œçš„äººï¼Œè€Œä¸å†å¤šç¢ç£¨åŸºæœ¬æ¦‚å¿µã€‚</p>
<blockquote>
<p>å°ˆæ¡ˆé …ç›®å¦‚æœèƒ½é€²è¡Œè‰¯å¥½çš„æ‹†åˆ†ä¸¦é€²è¡Œ<strong>å–®å…ƒæ¸¬è©¦</strong>çœŸçš„å¾ˆæœ‰å¹«åŠ©</p>
</blockquote>
<h3 id="å°ˆæ¡ˆæˆæœ">å°ˆæ¡ˆæˆæœ</h3>
<blockquote>
<p>å°ˆæ¡ˆå®Œæˆä¸€å®šçš„ç¨‹åº¦å°±æœƒéœ€è¦é€²è¡Œæ¸¬è©¦ï¼Œé€éå¯¦éš›ä¸Šçš„æ¸¬è©¦ï¼Œäº†è§£å°ˆæ¡ˆçš„ç‘•ç–µåœ¨å“ªè£¡ã€‚</p>
</blockquote>
<p>æ—¢ç„¶æœƒæœ‰æ“ä½œï¼Œé‚£æŠŠå°ˆæ¡ˆçš„ç›¸é—œæ–‡ä»¶æ’°å¯«æ¸…æ¥šï¼Œæ‰å¯èƒ½æœƒæœ‰è¾¦æ³•å¥½å¥½æ“ä½œï¼Œå› æ­¤é€™éšæ®µçš„å…§å®¹æ˜¯å°‡é–‹ç™¼å®Œæˆçš„å°ˆæ¡ˆä½¿ç”¨æƒ…æ³ã€æ“ä½œæ­¥é©Ÿå¥½å¥½æè¿°ï¼Œåœ¨æ­¤ï¼Œå¾ˆæ„Ÿè¬é¡˜æ„é€²è¡Œæ¸¬è©¦çš„å¥½æœ‹å‹ï¼Œæœ‰ä½ å€‘æ‰èƒ½è®“å°ˆæ¡ˆè¶¨æ–¼å®Œæ•´ï¼Œç”±è¡·æ„Ÿè¬!!!</p>
<h3 id="éœ€æ±‚å›é¥‹">éœ€æ±‚å›é¥‹</h3>
<p>ä¸åŒçš„ä½¿ç”¨è€…æœ‰å„å¼å„æ¨£çš„éœ€æ±‚ï¼Œé€™éƒ¨åˆ†å°æˆ‘è€Œè¨€éƒ½æ˜¯å¾ˆå¥½çš„å›é¥‹ï¼Œå¦‚æœé€™äº›éœ€æ±‚èƒ½å¤ è®“ç¨‹å¼æ›´é©ç”¨æ–¼å¤§å¤šæ•¸äººçš„éœ€æ±‚ï¼Œé€™æ¨£å°æ–¼å°ˆæ¡ˆåŸ·è¡Œçš„ç™¼å±•æ–¹å‘å°±æœƒæ˜¯å¥åº·çš„ï¼Œç•¢ç«ŸåŠŸèƒ½å¥½å£å„æœ‰æ‰€ä¸»è§€æ„è­˜ï¼Œä½†è‹¥èƒ½å¤ å¤§éƒ¨åˆ†çš„äººéƒ½èªç‚ºé€™æ¨£å¾ˆæ£’ï¼Œé‚£æˆ‘ä¹Ÿå¾ˆæ¨‚æ„ç‚ºä¹‹ã€‚</p>
<blockquote>
<p>ç•¶å¯¦å‹™ä¸Šé‡åˆ°å•é¡Œçš„æ™‚å€™è«‹ç”¨åŠ›å‘Šè¨´æˆ‘ï¼Œè¯çµ¡LINEé‚„æ˜¯Mailéƒ½å¯ä»¥!(è©³è¦‹å·¦æ–¹å´é‚Šæ””)</p>
</blockquote>
]]></content>
      <tags>
        <tag>Blog</tag>
      </tags>
  </entry>
  <entry>
    <title>åœŸæ–¹è¨ˆç®—-æ–¹æ ¼æ³•(VBA)</title>
    <url>/posts/4262718496/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>æœ¬ç¯‡ä¸»è¦ä»‹ç´¹åˆ©ç”¨ <strong>AutoCAD VBA</strong> çš„ç‰©ä»¶æ“ä½œ+
<strong>Excel VBA</strong>
çš„å·¥ä½œè¡¨å‡½æ•¸ä¾†ç°¡åŒ–<strong>å¹³å¦åœ°è²Œ</strong>æ”¶æ–¹ä½œæ¥­çš„éç¨‹ã€‚</p>
<blockquote>
<p>åœŸæ–¹è¨ˆç®—æ˜¯å·¥ç¨‹æ–½ä½œæ™‚æœ‰é—œæ–¼ç”²ä¹™æ–¹é‡å°åœŸæ–¹æ•¸é‡æ™‚çš„é‡è¦ä¾æ“šï¼Œåˆ†ç‚ºå°å‹å·¥ç¨‹åŠå¤§å‹å·¥ç¨‹ä¾†è¨è«–ã€‚</p>
</blockquote>
<h3 id="å°å‹å·¥ç¨‹">å°å‹å·¥ç¨‹</h3>
<p>åœŸæ–¹é‡‘é¡ä½”æ¯”ä¸é«˜çš„æƒ…æ³ä¸‹ï¼Œé€šå¸¸å¥‘ç´„æ•¸é‡å¤šå°‘å°±å¤šå°‘ï¼Œç”²ä¹™é›™æ–¹ä¸å¤ªæœƒæœ‰æ„è¦‹ã€‚</p>
<h3 id="å¤§å‹å·¥ç¨‹">å¤§å‹å·¥ç¨‹</h3>
<p>åœŸæ–¹é‡‘é¡ä½”æ¯”é«˜çš„æƒ…æ³ä¸‹ï¼Œç”²ä¹™é›™æ–¹æœƒé‡å°è¨­è¨ˆåŸå§‹åœ°è²Œé€²è¡Œæ”¶æ–¹ä½œæ¥­ä¸¦ä½œæˆåœŸæ–¹å ±å‘Šï¼Œä¸¦ä»¥æ­¤ä½œç‚ºå¥‘ç´„æ•¸é‡ä¿®æ­£çš„ä¾æ“šï¼Œå†æ ¹æ“šçµæ§‹é«”çš„è¨­è¨ˆé«˜ç¨‹åŠåœ–èªªæŒ‡å®šçš„é–‹æŒ–æ–¹å¼é‡æ–°è¨ˆç®—æŒ–å¡«æ–¹æ•¸é‡ã€‚</p>
<h2 id="è¨ˆç®—æ–¹æ³•é¸å®š">è¨ˆç®—æ–¹æ³•é¸å®š</h2>
<p>åœ°å½¢æ¨¡å‹çš„å»ºç«‹æœƒæ ¹æ“šåœ°è²Œç‹€æ³è€Œå®š</p>
<ul>
<li>å…·æœ‰è¤‡é›œåœ°å½¢ç‰¹å¾µçš„åœ°å€ï¼Œä½¿ç”¨TIN(ä¸è¦å‰‡ä¸‰è§’ç¶²)</li>
<li>åœ°å½¢è®ŠåŒ–ç›¸å°å¹³ç·©çš„åœ°å€ï¼Œä½¿ç”¨DEM(æ•¸å­—é«˜ç¨‹æ¨¡å‹)</li>
</ul>
<p>æ–¹æ ¼æ³•ä¾¿æ˜¯ä½¿ç”¨DEMçš„æ¦‚å¿µï¼Œé€éæ¯å€‹æ–¹æ ¼é ‚é»è¨ˆç®—æ–¹æ ¼å¹³å‡é«˜ç¨‹å¾Œæ¨ç®—æ±‚å¾—åœŸæ–¹é«”ç©ï¼Œé«˜ç¨‹é ‚é»å‰‡åˆ©ç”¨IDW(åè·é›¢åŠ æ¬Šæ³•)ä¾†é€²è¡Œé«˜ç¨‹è³¦å€¼ï¼Œæ’å€¼éç¨‹æœƒéœ€è¦å¤§é‡çš„åŸºæœ¬é‹ç®—ã€‚</p>
<blockquote>
<p>æœ‰é—œä¸è¦å‰‡ä¸‰è§’ç¶²å¦è«‹åƒè€ƒç­†è€…å‰æ–‡ <a
href="https://hankvba.blogspot.com/2023/01/cad-vba.html">CAD
VBA@æ”¶æ–¹ä½œæ¥­(ä¸è¦å‰‡ä¸‰è§’ç¶²æ³•)</a></p>
</blockquote>
<span id="more"></span>
<h2 id="å½±ç‰‡æ“ä½œ">ğŸ¬å½±ç‰‡æ“ä½œ</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OJ6uFdUgUi4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<blockquote>
<p>æœ‰æ”¶æ–¹ä½œæ¥­çš„éœ€æ±‚æ­¡è¿é€éå·¦æ–¹å´é‚Šæ¬„å…§å®¹è¯ç¹«E-mailæˆ–LINEé€²è¡Œè«®è©¢ã€‚</p>
</blockquote>
<h2 id="å¯¦ç¾é‚è¼¯">ğŸ‘‰å¯¦ç¾é‚è¼¯</h2>
<h3 id="å»ºç«‹æ¸¬é‡é»å½±ç‰‡æœªå‡ºç¾">å»ºç«‹æ¸¬é‡é»(å½±ç‰‡æœªå‡ºç¾)</h3>
<ol type="1">
<li>å°‡è¨­è¨ˆåœ–é¢æ‰€è¨˜éŒ„çš„é«˜ç¨‹é»æ”¾å…¥å·¥ä½œè¡¨("DESIGN")</li>
</ol>
<figure>
<img src="H_List.JPG" alt="Fig1. è¨­è¨ˆåœ–é¢é«˜ç¨‹" />
<figcaption aria-hidden="true">Fig1. è¨­è¨ˆåœ–é¢é«˜ç¨‹</figcaption>
</figure>
<ol start="2" type="1">
<li>å°‡æ”¶æ–¹ä½œæ¥­æ‰€è¨˜éŒ„çš„é«˜ç¨‹é»æ”¾å…¥å·¥ä½œè¡¨("CHECK")</li>
</ol>
<figure>
<img src="H2_List.JPG" alt="Fig2.æ”¶æ–¹ä½œæ¥­é«˜ç¨‹" />
<figcaption aria-hidden="true">Fig2.æ”¶æ–¹ä½œæ¥­é«˜ç¨‹</figcaption>
</figure>
<table>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>ç”¨é€”èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Num</td>
<td>é»åç¨±</td>
</tr>
<tr class="even">
<td>X</td>
<td>TWD97-Eåº§æ¨™</td>
</tr>
<tr class="odd">
<td>Y</td>
<td>TWD97-Nåº§æ¨™</td>
</tr>
<tr class="even">
<td>Z</td>
<td>é«˜ç¨‹</td>
</tr>
<tr class="odd">
<td>Length</td>
<td>èˆ‡é ‚é»çš„è·é›¢</td>
</tr>
</tbody>
</table>
<p>æ­¤è™•çš„Lengthæœƒç”±æ¯ä¸€é»å»èˆ‡range("F1")ã€range("G1")é€²è¡Œè·é›¢æ›ç®—(IDWä½¿ç”¨)</p>
<h3 id="å»ºç«‹æ–¹æ ¼">å»ºç«‹æ–¹æ ¼</h3>
<ol type="1">
<li>å–å¾—è¨ˆç•«ç¯„åœä¹‹å¾Œï¼Œæ‰¾å‡ºå…¶é‚Šç•Œä½ç½®</li>
<li>æ–¹æ ¼æœƒåœ¨é‚Šç•Œå…§ä¾åºç¹ªè£½ä¸¦èˆ‡è¨ˆç•«ç¯„åœåˆ¤é‡‹å…©å¤šé‚Šå½¢ä½ç½®é—œä¿‚</li>
<li>ä½ç½®é—œä¿‚å¯åˆ†ç‚ºä¸‹åˆ—ä¸‰ç¨®
<ul>
<li>è¨ˆç•«ç¯„åœå¤–&gt;&gt;åˆªé™¤</li>
<li>è¨ˆç•«ç¯„åœå…§&gt;&gt;ä¿ç•™ä¸å‹•</li>
<li>è¨ˆç•«ç¯„åœèˆ‡ä¹‹ç›¸äº¤&gt;&gt;å¦å¤–å»ºç«‹è¨ˆç•«ç¯„åœå¤–éƒ¨é¢ç©ã€‚(é€™è£¡æœƒéœ€è¦æ‰‹å‹•èª¿æ•´ä¸‹)</li>
</ul></li>
</ol>
<h3 id="æ–¹æ ¼ç·¨è™ŸåŠé¢ç©">æ–¹æ ¼ç·¨è™ŸåŠé¢ç©</h3>
<ol type="1">
<li>æ¡†é¸æ‰€æœ‰æ–¹æ ¼åŠå¤–éƒ¨é¢ç©</li>
<li>æ–¹æ ¼ç”±å·¦ä¸Šåˆ°å³ä¸‹ä¾åºç·¨è™Ÿ</li>
<li>è¨ˆç®—å¤–éƒ¨é¢ç©å½¢å¿ƒåˆ°æ‰€æœ‰æ–¹æ ¼çš„ä½ç½®ä¸¦æŒ‡å®šå…¶æ­¸å±¬å“ªå€‹æ–¹æ ¼</li>
<li>ç”±æŒ‡å®šå…§å®¹é€²è¡Œé¢ç©æ‰£é™¤</li>
</ol>
<figure>
<img src="GRID_Num.JPG" alt="Fig3.æ–¹æ ¼è³‡æ–™ä¸»è¦é é¢" />
<figcaption aria-hidden="true">Fig3.æ–¹æ ¼è³‡æ–™ä¸»è¦é é¢</figcaption>
</figure>
<table>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>ç”¨é€”èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Num</td>
<td>æ–¹æ ¼ç·¨è™Ÿ</td>
</tr>
<tr class="even">
<td>Grid_Handle</td>
<td>æ–¹æ ¼åœ¨CADä¸­çš„é€£æ¥ç¢¼</td>
</tr>
<tr class="odd">
<td>Centroid_X</td>
<td>æ–¹æ ¼å½¢å¿ƒXåº§æ¨™</td>
</tr>
<tr class="even">
<td>Centroid_Y</td>
<td>æ–¹æ ¼å½¢å¿ƒYåº§æ¨™</td>
</tr>
<tr class="odd">
<td>DESIGN</td>
<td>å¹³å‡é ‚é»è¨­è¨ˆé«˜ç¨‹</td>
</tr>
<tr class="even">
<td>CHECK</td>
<td>å¹³å‡é ‚é»æ”¶æ–¹é«˜ç¨‹</td>
</tr>
<tr class="odd">
<td>Volume</td>
<td>åœŸæ–¹é«”ç©</td>
</tr>
</tbody>
</table>
<h3 id="æ–¹æ ¼é ‚é»è¨ˆç®—æ’å€¼">æ–¹æ ¼é ‚é»è¨ˆç®—æ’å€¼</h3>
<ol type="1">
<li>åŒ¯å‡ºæ‰€æœ‰æ–¹æ ¼ä¸é‡è¤‡é ‚é»</li>
<li>é‡å°æ¯å€‹é ‚é»é€²è¡ŒIDWæ’å€¼</li>
<li>æœå°‹åŠå¾‘é è¨­ç‚ºæ–¹æ ¼å¤§å°ï¼Œè¨ˆç®—é»æ•¸é è¨­ç‚º3é»</li>
<li>å¦‚é ‚é»å› ç‚ºé«˜ç¨‹é»çš„åˆ†å¸ƒé—œä¿‚ç„¡æ³•æ»¿è¶³ä¸Šè¿°æ¢ä»¶å‰‡æ’å€¼ç‚º0</li>
</ol>
<figure>
<img src="GRID_pts.JPG" alt="Fig4.æ–¹æ ¼é ‚é»è³‡æ–™" />
<figcaption aria-hidden="true">Fig4.æ–¹æ ¼é ‚é»è³‡æ–™</figcaption>
</figure>
<h3 id="æ–¹æ ¼åœŸæ–¹é«”ç©è¨ˆç®—">æ–¹æ ¼åœŸæ–¹é«”ç©è¨ˆç®—</h3>
<ol type="1">
<li>é€éGrid_Handleé€£æ¥è©²æ–¹æ ¼åœ¨CADä¸­çš„å„é ‚é»</li>
<li>å°‡å„é ‚é»èˆ‡è¨­è¨ˆé«˜ç¨‹åº§æ¨™æ¯”å°è¨ˆç®—è©²æ–¹æ ¼å¹³å‡é ‚é»è¨­è¨ˆé«˜ç¨‹</li>
<li>å°‡å„é ‚é»èˆ‡æ”¶æ–¹é«˜ç¨‹åº§æ¨™æ¯”å°è¨ˆç®—è©²æ–¹æ ¼å¹³å‡é ‚é»æ”¶æ–¹é«˜ç¨‹</li>
<li>ç”±å¹³å‡æ”¶æ–¹é«˜ç¨‹æ‰£é™¤å¹³å‡è¨­è¨ˆé«˜ç¨‹èˆ‡æ–¹æ ¼é¢ç©é€²è¡Œç›¸ä¹˜æ±‚å¾—æ–¹æ ¼åœŸæ–¹é«”ç©</li>
</ol>
<h3 id="åœŸæ–¹å ±å‘Š">åœŸæ–¹å ±å‘Š</h3>
<p>å°‡ä¸Šè¿°è¨ˆç®—æˆæœæ”¾å…¥å·¥ä½œè¡¨("REPORT")</p>
<figure>
<img src="REPORT.JPG" alt="Fig5.åœŸæ–¹è¨ˆç®—æ›¸" />
<figcaption aria-hidden="true">Fig5.åœŸæ–¹è¨ˆç®—æ›¸</figcaption>
</figure>
<h3 id="å¯è¦–åŒ–å‘ˆç¾">å¯è¦–åŒ–å‘ˆç¾</h3>
<p>æ–¹æ ¼å¯ä»¥é€éå»ºç«‹3D
BOXçš„æ–¹å¼é€²è¡Œå¯è¦–åŒ–å‘ˆç¾ï¼Œå› ç‚ºé«˜ç¨‹çš„å·®ç•°åªæœ‰ä¸€é»é»ï¼Œæ‰€ä»¥é‚„æ˜¯éœ€è¦å°‡é«˜ç¨‹å€æ•¸æ”¾å¤§è®“ä½¿ç”¨è€…å¯ä»¥æ›´æ¸…æ¥šæŒæ¡ç´°ç¯€ã€‚</p>
<figure>
<img src="5x5-elevationdiff-sharp.JPG"
alt="Fig6.åœŸæ–¹é«˜ç¨‹å·®å¯è¦–åŒ–å‘ˆç¾" />
<figcaption aria-hidden="true">Fig6.åœŸæ–¹é«˜ç¨‹å·®å¯è¦–åŒ–å‘ˆç¾</figcaption>
</figure>
<p>é™¤äº†ä»¥æŸ±ç‹€é«”æ–¹å¼å‘ˆç¾ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥é€éHatchçš„é¡è‰²å·®ç•°é€²è¡ŒæŒ–æ–¹å¡«æ–¹çš„åˆ¤é‡‹ï¼Œæ¯”å¦‚èªªæŒ–æ–¹å€åŸŸå°±çµ¦ç¶ è‰²ï¼Œå¡«æ–¹å€åŸŸå°±çµ¦ç´…è‰²ã€‚</p>
<h2 id="å¹¾ä½•åœ–å­¸åˆ¤é‡‹">ğŸ‘¨â€ğŸ«å¹¾ä½•åœ–å­¸åˆ¤é‡‹</h2>
<blockquote>
<p>æ•´é«”é‚„æœ‰å¾ˆå¤šå¯¦ç¾ç´°ç¯€å¯ä»¥é€²å»ç¨‹å¼ç¢¼è£¡é¢çœ‹!å®Œæ•´çš„ç¨‹å¼ç¢¼(åŒ…å«æ“ä½œè»Ÿé«”)å–å¾—è«‹æ´½ä½œè€…è«®è©¢ã€‚</p>
</blockquote>
<h3 id="åˆ¤æ–·é»è·Ÿå¤šé‚Šå½¢çš„é—œä¿‚">åˆ¤æ–·é»è·Ÿå¤šé‚Šå½¢çš„é—œä¿‚</h3>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> IsPointInPolygon(X, Y, poly() <span class="keyword">As</span> <span class="type">Double</span>) <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    <span class="comment">&#x27; Check if a point is inside a polygon.</span></span><br><span class="line">    <span class="comment">&#x27; Args:</span></span><br><span class="line">    <span class="comment">&#x27;   x: X coordinate of the point.</span></span><br><span class="line">    <span class="comment">&#x27;   y: Y coordinate of the point.</span></span><br><span class="line">    <span class="comment">&#x27;   poly: An array representing the vertices of the polygon.</span></span><br><span class="line">    <span class="comment">&#x27; Returns:</span></span><br><span class="line">    <span class="comment">&#x27;   True if the point is inside the polygon, False otherwise.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span>, j <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> numVertices <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> oddNodes <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line"></span><br><span class="line">    numVertices = UBound(poly) \ <span class="number">2</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; Check if the point is inside the polygon using the ray-casting algorithm</span></span><br><span class="line">    j = numVertices - <span class="number">1</span></span><br><span class="line">    oddNodes = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> numVertices - <span class="number">1</span></span><br><span class="line">        <span class="keyword">If</span> (poly(<span class="number">2</span> * i + <span class="number">1</span>) &gt; Y) &lt;&gt; (poly(<span class="number">2</span> * j + <span class="number">1</span>) &gt; Y) <span class="keyword">Then</span></span><br><span class="line">            <span class="keyword">If</span> (poly(<span class="number">2</span> * j + <span class="number">1</span>) - poly(<span class="number">2</span> * i + <span class="number">1</span>)) &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">                <span class="keyword">If</span> X &lt; (poly(<span class="number">2</span> * j) - poly(<span class="number">2</span> * i)) * (Y - poly(<span class="number">2</span> * i + <span class="number">1</span>)) / (poly(<span class="number">2</span> * j + <span class="number">1</span>) - poly(<span class="number">2</span> * i + <span class="number">1</span>)) + poly(<span class="number">2</span> * i) <span class="keyword">Then</span></span><br><span class="line">                    oddNodes = <span class="built_in">Not</span> oddNodes</span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        j = i</span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; Check if the point is exactly on a vertex or an edge</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> numVertices - <span class="number">1</span></span><br><span class="line">        j = (i + <span class="number">1</span>) <span class="built_in">Mod</span> numVertices</span><br><span class="line">        <span class="comment">&#x27; Check if the point is on a vertex</span></span><br><span class="line">        <span class="keyword">If</span> X = poly(<span class="number">2</span> * i) <span class="built_in">And</span> Y = poly(<span class="number">2</span> * i + <span class="number">1</span>) <span class="keyword">Then</span></span><br><span class="line">            IsPointInPolygon = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="comment">&#x27; Check if the point is on an edge</span></span><br><span class="line">        <span class="keyword">If</span> ((poly(<span class="number">2</span> * i + <span class="number">1</span>) &lt;= Y <span class="built_in">And</span> Y &lt;= poly(<span class="number">2</span> * j + <span class="number">1</span>)) <span class="built_in">Or</span> (poly(<span class="number">2</span> * j + <span class="number">1</span>) &lt;= Y <span class="built_in">And</span> Y &lt;= poly(<span class="number">2</span> * i + <span class="number">1</span>))) <span class="built_in">And</span> _</span><br><span class="line">           (X &lt;= myMax(poly(<span class="number">2</span> * i), poly(<span class="number">2</span> * j))) <span class="built_in">And</span> (poly(<span class="number">2</span> * j + <span class="number">1</span>) - poly(<span class="number">2</span> * i + <span class="number">1</span>) &lt;&gt; <span class="number">0</span>) <span class="keyword">Then</span></span><br><span class="line">            <span class="keyword">If</span> X = (poly(<span class="number">2</span> * j) - poly(<span class="number">2</span> * i)) * (Y - poly(<span class="number">2</span> * i + <span class="number">1</span>)) / (poly(<span class="number">2</span> * j + <span class="number">1</span>) - poly(<span class="number">2</span> * i + <span class="number">1</span>)) + poly(<span class="number">2</span> * i) <span class="keyword">Then</span></span><br><span class="line">                IsPointInPolygon = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line"></span><br><span class="line">    IsPointInPolygon = oddNodes</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="åˆ¤æ–·å¤šé‚Šå½¢çš„ä½ç½®é—œä¿‚">åˆ¤æ–·å¤šé‚Šå½¢çš„ä½ç½®é—œä¿‚</h3>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> PolygonsRelation(poly1() <span class="keyword">As</span> <span class="type">Double</span>, poly2() <span class="keyword">As</span> <span class="type">Double</span>) <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    <span class="comment">&#x27; Check relation between two closed polygons.</span></span><br><span class="line">    <span class="comment">&#x27; Args:</span></span><br><span class="line">    <span class="comment">&#x27;   poly1: An array representing the vertices of the first closed polygon.</span></span><br><span class="line">    <span class="comment">&#x27;   poly2: An array representing the vertices of the second closed polygon.</span></span><br><span class="line">    <span class="comment">&#x27; Returns:</span></span><br><span class="line">    <span class="comment">&#x27;   String indicating the relation between two polygons:</span></span><br><span class="line">    <span class="comment">&#x27;     - &quot;Disjoint&quot;: If polygons are disjoint.</span></span><br><span class="line">    <span class="comment">&#x27;     - &quot;Contains&quot;: If poly1 contains poly2.</span></span><br><span class="line">    <span class="comment">&#x27;     - &quot;Contained By&quot;: If poly2 contains poly1.</span></span><br><span class="line">    <span class="comment">&#x27;     - &quot;Overlap&quot;: If polygons overlap.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span>, j <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> numVertices1 <span class="keyword">As</span> <span class="type">Integer</span>, numVertices2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">    <span class="keyword">Dim</span> containsPoly1 <span class="keyword">As</span> <span class="type">Boolean</span>, containsPoly2 <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    <span class="keyword">Dim</span> intersects <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    <span class="keyword">Dim</span> X <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    <span class="keyword">Dim</span> Y <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    numVertices1 = UBound(poly1) \ <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">    numVertices2 = UBound(poly2) \ <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; Check if one polygon is completely contained in the other</span></span><br><span class="line">    containsPoly1 = <span class="literal">False</span></span><br><span class="line">    containsPoly2 = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> numVertices1 - <span class="number">1</span> <span class="comment">&#x27;æª¢æŸ¥é»è³‡æ–™æ˜¯å¦åœ¨poly2è£¡é¢</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">If</span> IsPointInPolygon(poly1(<span class="number">2</span> * i), poly1(<span class="number">2</span> * i + <span class="number">1</span>), poly2) <span class="keyword">Then</span></span><br><span class="line">            containsPoly1 = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span> i</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> numVertices2 - <span class="number">1</span> <span class="comment">&#x27;æª¢æŸ¥é»è³‡æ–™æ˜¯å¦åœ¨poly1è£¡é¢</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">If</span> IsPointInPolygon(poly2(<span class="number">2</span> * j), poly2(<span class="number">2</span> * j + <span class="number">1</span>), poly1) <span class="keyword">Then</span></span><br><span class="line">            containsPoly2 = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span> j</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; Check if polygons are disjoint</span></span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Not</span> containsPoly1 <span class="built_in">And</span> <span class="built_in">Not</span> containsPoly2 <span class="keyword">Then</span></span><br><span class="line">        intersects = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> numVertices1 - <span class="number">1</span></span><br><span class="line">            <span class="keyword">For</span> j = <span class="number">0</span> <span class="keyword">To</span> numVertices2 - <span class="number">1</span></span><br><span class="line">                <span class="keyword">If</span> DoIntersect(poly1(<span class="number">2</span> * i), poly1(<span class="number">2</span> * i + <span class="number">1</span>), poly1((<span class="number">2</span> * ((i + <span class="number">1</span>) <span class="built_in">Mod</span> numVertices1))), poly1((<span class="number">2</span> * ((i + <span class="number">1</span>) <span class="built_in">Mod</span> numVertices1)) + <span class="number">1</span>), _</span><br><span class="line">                               poly2(<span class="number">2</span> * j), poly2(<span class="number">2</span> * j + <span class="number">1</span>), poly2((<span class="number">2</span> * ((j + <span class="number">1</span>) <span class="built_in">Mod</span> numVertices2))), poly2((<span class="number">2</span> * ((j + <span class="number">1</span>) <span class="built_in">Mod</span> numVertices2)) + <span class="number">1</span>)) <span class="keyword">Then</span></span><br><span class="line">                    intersects = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            <span class="keyword">Next</span> j</span><br><span class="line">            <span class="keyword">If</span> intersects <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">        <span class="keyword">Next</span> i</span><br><span class="line">        <span class="keyword">If</span> <span class="built_in">Not</span> intersects <span class="keyword">Then</span></span><br><span class="line">            PolygonsRelation = <span class="string">&quot;Disjoint&quot;</span></span><br><span class="line">            <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; Check for containment</span></span><br><span class="line">    <span class="keyword">If</span> containsPoly1 <span class="built_in">And</span> containsPoly2 <span class="keyword">Then</span></span><br><span class="line">        PolygonsRelation = <span class="string">&quot;Overlap&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> containsPoly1 <span class="keyword">Then</span></span><br><span class="line">        PolygonsRelation = <span class="string">&quot;Contains&quot;</span></span><br><span class="line">    <span class="keyword">ElseIf</span> containsPoly2 <span class="keyword">Then</span></span><br><span class="line">        PolygonsRelation = <span class="string">&quot;Contained By&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        PolygonsRelation = <span class="string">&quot;Overlap&quot;</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h2 id="é–‹ç™¼å°çµ">ğŸ¯é–‹ç™¼å°çµ</h2>
<ul>
<li><p>é€²è¡ŒIDWæœƒéœ€è¦è¨ˆç®—è·é›¢ï¼Œå»ºè­°é€éå…§å»ºå‡½æ•¸å»åŸ·è¡Œï¼Œä¸è¦å¾VBAç®—å®ŒLengthä¹‹å¾Œå†<strong>å¡«å„²å­˜æ ¼</strong>ï¼Œæ•ˆèƒ½å·®å¾ˆå¤šã€‚</p></li>
<li><p>åˆ¤å®šå¤šé‚Šå½¢å¹¾ä½•é—œä¿‚æ™‚ï¼Œéœ€è¦é¡å¤–è€ƒé‡å››å€‹é ‚é»éƒ½åœ¨è¨ˆç•«ç¯„åœå¤–ä½†æ˜¯è¨ˆç•«ç¯„åœæœ‰å‡¸å¤šé‚Šå½¢æ’åœ¨æ–¹æ ¼ä¸­çš„æƒ…å½¢ã€‚</p></li>
<li><p>é›»è…¦è¨ˆç®—èƒ½åŠ›å¾ˆå¼·çš„å¯ä»¥å°‡è¨ˆç•«ç¯„åœåˆ‡æˆ5*5çš„æ–¹æ ¼ï¼Œä½†æ˜¯é‚„æ˜¯è¦è€ƒé‡é»è³‡æ–™çš„å¯†åº¦æ˜¯å¦è¶³å¤ ï¼Œå¯†åº¦ä¸è¶³æœƒå°è‡´å¾ˆå¤šé ‚é»éƒ½æ˜¯ä¸åˆç†çš„ï¼Œç¨‹å¼æœƒè‡ªå‹•åˆ¤é‡‹ç‚º0</p></li>
<li><p>IDWè¨ˆç®—æ™‚å¯ä»¥é€éCross
Validationçš„æ–¹å¼åˆ¤æ–·ç›®å‰æ¨¡å‹çš„åˆç†ç¨‹åº¦ï¼Œå½±éŸ¿IDWæœ‰æœå°‹åŠå¾‘ã€è¨ˆç®—æœ€å°‘é»æ•¸ã€è·é›¢å€’æ•¸çš„å¹•æ¬¡ã€‚</p></li>
</ul>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>AutoCAD VBA</tag>
        <tag>Excel VBA</tag>
        <tag>åœŸæ–¹è¨ˆç®—</tag>
      </tags>
  </entry>
  <entry>
    <title>Streamlitåšæ‰‹ç¹ªç°½å</title>
    <url>/posts/213685522/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>å·¥ç¨‹åŸ·è¡Œéç¨‹å…ä¸äº†æœƒæœ‰å¾ˆå¤šå“ç®¡æ–‡ä»¶éœ€è¦è£½ä½œï¼Œç´™æœ¬æ–‡ä»¶çš„åŠ å€¼æ‡‰ç”¨ç›¸ç•¶å›°é›£ï¼Œé€šå¸¸éƒ½æœƒæ”¾ç½®æ–¼ä¸€å †åˆä¸€å †çš„è³‡æ–™å¤¾ä¸­ï¼Œæœ‰éœ€è¦å†å»ç›¸äº’åƒç…§ï¼Œå¤§å¤šæµæ–¼å½¢å¼ï¼Œå€˜è‹¥å·¥ç¨‹æ–‡ä»¶èƒ½å¤ æ•¸ä½åŒ–ï¼Œå°æ–¼æ•´å€‹å·¥ç¨‹è³‡æ–™çš„ä¿å­˜ã€æŸ¥è©¢æœƒæœ‰å¾ˆå¤šå¥½è™•ï¼Œä½†ç¶“éå¹¾æ¬¡æŸ¥æ ¸å§”å“¡çš„å»ºè­°ï¼Œé—œæ–¼ç°½åé€™ä»¶äº‹æƒ…ä»–å€‘æœ‰æ„è¦‹ï¼Œæ—¢ç„¶æ˜¯éœ€è¦åœ¨ç¾å ´é€²è¡Œæª¢æŸ¥çš„æ–‡ä»¶ï¼Œé‚£<strong>ç•¶ç„¶</strong>æœƒæ˜¯æ‰‹å¯«çš„æ‰æœ€é¦™ï¼Œæ®Šä¸çŸ¥å¾ˆå¤šå§”å“¡é‚„æ˜¯èªç‚ºé›»è…¦ç›´æ¥å‡ºçš„æ–‡ä»¶ä¸èƒ½ç”¨ï¼Œè‡³å°‘ç°½åçš„éƒ¨åˆ†è¦æ‰‹å¯«æ‰æ˜¯çœŸçš„ã€‚</p>
<p>åŸºæ–¼é€™äº›ç†ç”±ï¼Œæˆ‘å¸Œæœ›èƒ½å¤ åšåˆ°ç”¨æ‰‹å¯«çš„è§¸æ„Ÿå»ç°½ç½²æ–‡ä»¶ï¼Œé€éStreamlitçš„å‰ç«¯åŠstreamlit-drawable-canvasä½œç‚ºç¹ªåœ–å™¨ï¼Œopencvä½œç‚ºèƒŒæ™¯å»èƒŒè™•ç†ï¼ŒåŠPyMuPDFä½œç‚ºè½‰æª”å·¥å…·ï¼Œä¾†é”æˆå§”å“¡çš„è¦æ±‚...</p>
<p>å…¶å¯¦æˆ‘ä¸€ç›´ä¸èƒ½ç†è§£ï¼Œä¸­è¯é›»ä¿¡éƒ½å¯ä»¥ç”¨æ‰‹å¯«çš„è§¸æ§æ¿ä¾†è·Ÿå®¢æˆ¶ç°½ç´„äº†ï¼Œç‚ºä»€éº¼å…¬å…±å·¥ç¨‹ä¸€å®šè¦ç”¨<strong>ç´™+ç­†</strong>ï¼Œç¾åœ¨å…¶å¯¦å¹³æ¿é›»è…¦éƒ½å¾ˆæ–¹ä¾¿ï¼ŒæŠŠè¦æŠ½æŸ¥çš„PDFéƒ½å…ˆæ”¾å¥½åœ¨é›²ç«¯ï¼Œå¸¶å»å·¥åœ°ç¾å ´é¸å–è¦æŠ½æŸ¥çš„å°æ‡‰PDFå¾Œå¯«ç´€éŒ„è¡¨ï¼Œå¯«å®Œå¾Œå¯ä»¥å³æ™‚ä¸Šå‚³åˆ°é›²ç«¯ï¼Œè³‡è¨Šæµå‹•æ‰æœƒè¿…é€Ÿï¼Œä¹Ÿä¸ç”¨é€™æ¨£æµªè²»ä¸€å †ç´™ä¾†è¨˜éŒ„é€™äº›å…§å®¹ï¼Œæœªä¾†è¦ç¿»é–±å¾é›²ç«¯å»æ’ˆå–å‡ºä¾†å³å¯ã€‚</p>
<span id="more"></span>
<h2 id="å½±ç‰‡æ“ä½œ">ğŸ¬å½±ç‰‡æ“ä½œ</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/V0we1mNC_ys?si=AJFYWRig0FI9tv2T" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<h2 id="å®‰è£åŒ…">å®‰è£åŒ…</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install streamlit streamlit-drawable-canvas numpy opencv-python-headless Pillow PyMuPDF</span><br></pre></td></tr></table></figure>
<h2 id="åœ–ç‰‡ç°½åé è¦½">åœ–ç‰‡ç°½åé è¦½</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">from</span> streamlit_drawable_canvas <span class="keyword">import</span> st_canvas</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­ç½® Streamlit ç•Œé¢</span></span><br><span class="line">st.title(<span class="string">&quot;åœ–ç‰‡ç°½åå·¥å…·&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šå‚³åœ–ç‰‡</span></span><br><span class="line">uploaded_file = st.file_uploader(<span class="string">&quot;ä¸Šå‚³åœ–ç‰‡&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¹ªè£½ç°½å</span></span><br><span class="line">st.write(<span class="string">&quot;ç¹ªè£½ç°½å&quot;</span>)</span><br><span class="line">canvas_result = st_canvas(</span><br><span class="line">    fill_color=<span class="string">&quot;rgba(0, 0, 0, 0)&quot;</span>,  <span class="comment"># èƒŒæ™¯å¡«å……è‰²</span></span><br><span class="line">    stroke_width=<span class="number">3</span>,</span><br><span class="line">    stroke_color=<span class="string">&quot;black&quot;</span>,</span><br><span class="line">    background_color=<span class="string">&quot;rgba(255, 255, 255, 0)&quot;</span>,</span><br><span class="line">    height=<span class="number">150</span>,</span><br><span class="line">    width=<span class="number">400</span>,</span><br><span class="line">    drawing_mode=<span class="string">&quot;freedraw&quot;</span>,</span><br><span class="line">    key=<span class="string">&quot;canvas&quot;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> uploaded_file <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> canvas_result.image_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># è®€å–ä¸Šå‚³çš„åœ–ç‰‡</span></span><br><span class="line">    file_bytes = np.asarray(<span class="built_in">bytearray</span>(uploaded_file.read()), dtype=np.uint8)</span><br><span class="line">    uploaded_image = cv2.imdecode(file_bytes, cv2.IMREAD_UNCHANGED)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯</span></span><br><span class="line">    signature_data = canvas_result.image_data</span><br><span class="line">    signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°‡ç°½åå¤§å°èª¿æ•´ç‚ºåˆé©å¤§å°</span></span><br><span class="line">    sig_h, sig_w, _ = signature.shape</span><br><span class="line">    img_h, img_w, _ = uploaded_image.shape</span><br><span class="line">    x_offset = img_w - sig_w - <span class="number">10</span></span><br><span class="line">    y_offset = img_h - sig_h - <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">        uploaded_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] = \</span><br><span class="line">            signature[:, :, c] * (signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>) + \</span><br><span class="line">            uploaded_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] * (<span class="number">1.0</span> - signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¡¯ç¤ºåˆä½µå¾Œçš„åœ–ç‰‡</span></span><br><span class="line">    st.image(uploaded_image, caption=<span class="string">&#x27;ç°½åå¾Œçš„åœ–ç‰‡&#x27;</span>, use_column_width=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ç›´æ¥ç°½åœ¨åœ–ç‰‡ä¸Š">ç›´æ¥ç°½åœ¨åœ–ç‰‡ä¸Š</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">from</span> streamlit_drawable_canvas <span class="keyword">import</span> st_canvas</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> fitz  <span class="comment"># PyMuPDF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­ç½® Streamlit ç•Œé¢</span></span><br><span class="line">st.title(<span class="string">&quot;PDF ç°½åå·¥å…·&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šå‚³ PDF</span></span><br><span class="line">uploaded_file = st.file_uploader(<span class="string">&quot;ä¸Šå‚³ PDF&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;pdf&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸Šå‚³äº†æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> uploaded_file <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># è®€å–ä¸Šå‚³çš„ PDF</span></span><br><span class="line">    pdf_bytes = uploaded_file.read()</span><br><span class="line">    document = fitz.<span class="built_in">open</span>(<span class="string">&quot;pdf&quot;</span>, pdf_bytes)</span><br><span class="line">    page = document.load_page(<span class="number">0</span>)</span><br><span class="line">    pix = page.get_pixmap()</span><br><span class="line">    background_image = Image.frombytes(<span class="string">&quot;RGB&quot;</span>, [pix.width, pix.height], pix.samples)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># st.write(&quot;ç°½åèª¿æ•´&quot;)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¹ªè£½ç°½å</span></span><br><span class="line">    <span class="comment"># st.write(&quot;ç¹ªè£½ç°½å&quot;)</span></span><br><span class="line">    canvas_result = st_canvas(</span><br><span class="line">        fill_color=<span class="string">&quot;rgba(0, 0, 0, 0)&quot;</span>,  <span class="comment"># èƒŒæ™¯å¡«å……è‰²</span></span><br><span class="line">        stroke_width=<span class="number">3</span>,</span><br><span class="line">        stroke_color=<span class="string">&quot;black&quot;</span>,</span><br><span class="line">        background_image=background_image,</span><br><span class="line">        height=pix.height,</span><br><span class="line">        width=pix.width,</span><br><span class="line">        drawing_mode=<span class="string">&quot;freedraw&quot;</span>,</span><br><span class="line">        key=<span class="string">&quot;canvas&quot;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ»‘æ¡¿èª¿æ•´ç°½åä½ç½®</span></span><br><span class="line">    <span class="comment"># st.write(&quot;èª¿æ•´ç°½åä½ç½®&quot;)</span></span><br><span class="line">    x_offset =<span class="number">0</span><span class="comment"># st.slider(&quot;æ°´å¹³ä½ç½®&quot;, 0, pix.width, 0)</span></span><br><span class="line">    y_offset =<span class="number">0</span><span class="comment"># st.slider(&quot;å‚ç›´ä½ç½®&quot;, 0, pix.height, 0)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> canvas_result.image_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯</span></span><br><span class="line">        signature_data = canvas_result.image_data</span><br><span class="line">        signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)</span><br><span class="line"></span><br><span class="line">        signed_images = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> page_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(document)):</span><br><span class="line">            page = document.load_page(page_num)</span><br><span class="line">            pix = page.get_pixmap()</span><br><span class="line">            image = Image.frombytes(<span class="string">&quot;RGB&quot;</span>, [pix.width, pix.height], pix.samples)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°‡ PIL åœ–åƒè½‰æ›ç‚º OpenCV åœ–åƒ</span></span><br><span class="line">            open_cv_image = np.array(image)</span><br><span class="line">            open_cv_image = cv2.cvtColor(open_cv_image, cv2.COLOR_RGB2BGRA)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç°½åä½ç½®</span></span><br><span class="line">            sig_h, sig_w, _ = signature.shape</span><br><span class="line">            img_h, img_w, _ = open_cv_image.shape</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç¢ºä¿ç°½åä¸è¶…å‡ºé‚Šç•Œ</span></span><br><span class="line">            <span class="keyword">if</span> y_offset + sig_h &gt; img_h:</span><br><span class="line">                sig_h = img_h - y_offset</span><br><span class="line">            <span class="keyword">if</span> x_offset + sig_w &gt; img_w:</span><br><span class="line">                sig_w = img_w - x_offset</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ç°½åå½¢ç‹€åŒ¹é…</span></span><br><span class="line">            resized_signature = cv2.resize(signature, (sig_w, sig_h))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š</span></span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                open_cv_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] = \</span><br><span class="line">                    resized_signature[:, :, c] * (resized_signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>) + \</span><br><span class="line">                    open_cv_image[y_offset:y_offset+sig_h, x_offset:x_offset+sig_w, c] * (<span class="number">1.0</span> - resized_signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°‡ OpenCV åœ–åƒè½‰æ›å› PIL åœ–åƒ</span></span><br><span class="line">            signed_image = Image.fromarray(cv2.cvtColor(open_cv_image, cv2.COLOR_BGRA2RGBA))</span><br><span class="line">            signed_images.append(signed_image)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># é è¦½ç°½åå¾Œçš„ç¬¬ä¸€é </span></span><br><span class="line">        <span class="comment"># st.image(signed_images[0], caption=&#x27;ç°½åå¾Œçš„ PDF é é¢é è¦½&#x27;, use_column_width=True)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å°‡ç°½åå¾Œçš„åœ–åƒä¿å­˜å› PDF</span></span><br><span class="line">        pdf_output = io.BytesIO()</span><br><span class="line">        signed_images[<span class="number">0</span>].save(pdf_output, <span class="string">&quot;PDF&quot;</span>, resolution=<span class="number">100.0</span>, save_all=<span class="literal">True</span>, append_images=signed_images[<span class="number">1</span>:])</span><br><span class="line">        pdf_output.seek(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æä¾›ä¸‹è¼‰éˆæ¥</span></span><br><span class="line">        st.download_button(</span><br><span class="line">            label=<span class="string">&quot;ä¸‹è¼‰ç°½åå¾Œçš„ PDF&quot;</span>,</span><br><span class="line">            data=pdf_output,</span><br><span class="line">            file_name=<span class="string">&quot;signed_document.pdf&quot;</span>,</span><br><span class="line">            mime=<span class="string">&quot;application/pdf&quot;</span></span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<h2 id="æ¯”è¼ƒå®Œæ•´åšæ³•">æ¯”è¼ƒå®Œæ•´åšæ³•</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">from</span> streamlit_drawable_canvas <span class="keyword">import</span> st_canvas</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> fitz  <span class="comment"># PyMuPDF</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">st.set_page_config(</span><br><span class="line">    layout=<span class="string">&quot;wide&quot;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">dict_pdf = &#123;</span><br><span class="line">    <span class="string">&quot;æ¸¬é‡å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;</span>: <span class="string">&quot;6-27.pdf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;åœŸæ–¹å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;</span>: <span class="string">&quot;6-29.pdf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;æ¨¡æ¿å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;</span>: <span class="string">&quot;6-30.pdf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;é‹¼ç­‹å·¥ç¨‹æŠ½æŸ¥è¡¨&quot;</span>: <span class="string">&quot;6-31.pdf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;å…¶ä»–&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">st.sidebar.title(<span class="string">&quot;<span class="github-emoji" alias="writing_hand" style="" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/270d.png?v8">&#x270d;</span> PDF ç°½åå·¥å…·&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é é¢å°èˆª</span></span><br><span class="line">page = st.sidebar.selectbox(<span class="string">&quot;é¸æ“‡é é¢&quot;</span>, [<span class="string">&quot;æ‰‹ç¹ªç°½å&quot;</span>, <span class="string">&quot;æŸ¥çœ‹è¡¨å–®&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ“šé¸æ“‡çš„é é¢é¡¯ç¤ºå…§å®¹</span></span><br><span class="line"><span class="keyword">if</span> page == <span class="string">&quot;æ‰‹ç¹ªç°½å&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨­ç½® Streamlit ç•Œé¢</span></span><br><span class="line">    <span class="comment"># st.title(&quot;PDF ç°½åå·¥å…·&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æŒ‡å®šä¿å­˜çš„æ–‡ä»¶å¤¾è·¯å¾‘</span></span><br><span class="line">    save_folder = <span class="string">&quot;saved_pdfs&quot;</span></span><br><span class="line">    os.makedirs(save_folder, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    form_selection = st.sidebar.selectbox(<span class="string">&quot;é¸æ“‡æŠ½æŸ¥è¡¨&quot;</span>, <span class="built_in">list</span>(dict_pdf.keys()))</span><br><span class="line"></span><br><span class="line">    file_name = <span class="string">&quot;./pdfs/&quot;</span>+dict_pdf[form_selection]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¦‚æœé¸æ“‡äº†â€œå…¶ä»–â€ï¼Œè®“ç”¨æˆ¶ä¸Šå‚³ PDF æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> form_selection == <span class="string">&quot;å…¶ä»–&quot;</span>:</span><br><span class="line">        uploaded_file = st.file_uploader(<span class="string">&quot;ä¸Šå‚³ PDF&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;pdf&quot;</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># å¦å‰‡ï¼Œè®€å–é å®šç¾©çš„ PDF æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            uploaded_file = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> uploaded_file:</span><br><span class="line">        <span class="keyword">if</span> form_selection == <span class="string">&quot;å…¶ä»–&quot;</span>:</span><br><span class="line">            pdf_bytes = uploaded_file.read()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pdf_bytes = uploaded_file</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®€å– PDF</span></span><br><span class="line">        document = fitz.<span class="built_in">open</span>(<span class="string">&quot;pdf&quot;</span>, pdf_bytes)</span><br><span class="line">        page = document.load_page(<span class="number">0</span>)</span><br><span class="line">        pix = page.get_pixmap(matrix=fitz.Matrix(<span class="number">2.0</span>, <span class="number">2.0</span>))  <span class="comment"># ä½¿ç”¨ matrix èª¿æ•´åˆ†è¾¨ç‡</span></span><br><span class="line">        original_width, original_height = pix.width, pix.height</span><br><span class="line">        background_image = Image.frombytes(<span class="string">&quot;RGB&quot;</span>, [pix.width, pix.height], pix.samples)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¹ªè£½ç°½å</span></span><br><span class="line">        canvas_result = st_canvas(</span><br><span class="line">            fill_color=<span class="string">&quot;rgba(0, 0, 0, 0)&quot;</span>,  <span class="comment"># èƒŒæ™¯å¡«å……è‰²</span></span><br><span class="line">            stroke_width=<span class="number">3</span>,</span><br><span class="line">            stroke_color=<span class="string">&quot;black&quot;</span>,</span><br><span class="line">            background_image=background_image,</span><br><span class="line">            height=pix.height,</span><br><span class="line">            width=pix.width,</span><br><span class="line">            drawing_mode=<span class="string">&quot;freedraw&quot;</span>,</span><br><span class="line">            key=<span class="string">&quot;canvas&quot;</span>,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> canvas_result.image_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># ç²å–ç°½åä¸¦è™•ç†é€æ˜èƒŒæ™¯</span></span><br><span class="line">            signature_data = canvas_result.image_data</span><br><span class="line">            signature = cv2.cvtColor(signature_data, cv2.COLOR_RGBA2BGRA)</span><br><span class="line"></span><br><span class="line">            signed_images = []</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¨­ç½®ç°½åä½ç½® (é è¨­å€¼ï¼Œå¯ä»¥æ ¹æ“šéœ€è¦èª¿æ•´)</span></span><br><span class="line">            y_offset, x_offset = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> page_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(document)):</span><br><span class="line">                page = document.load_page(page_num)</span><br><span class="line">                pix = page.get_pixmap(matrix=fitz.Matrix(<span class="number">2.0</span>, <span class="number">2.0</span>))  <span class="comment"># ä½¿ç”¨ç›¸åŒçš„ matrix èª¿æ•´åˆ†è¾¨ç‡</span></span><br><span class="line">                image = Image.frombytes(<span class="string">&quot;RGB&quot;</span>, [pix.width, pix.height], pix.samples)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å°‡ PIL åœ–åƒè½‰æ›ç‚º OpenCV åœ–åƒ</span></span><br><span class="line">                open_cv_image = np.array(image)</span><br><span class="line">                open_cv_image = cv2.cvtColor(open_cv_image, cv2.COLOR_RGB2BGRA)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># ç°½åä½ç½®</span></span><br><span class="line">                sig_h, sig_w, _ = signature.shape</span><br><span class="line">                img_h, img_w, _ = open_cv_image.shape</span><br><span class="line"></span><br><span class="line">                <span class="comment"># èª¿æ•´ç°½åä½ç½®ä»¥åŒ¹é…æ–°çš„è§£æåº¦</span></span><br><span class="line">                adjusted_y_offset = <span class="built_in">int</span>((y_offset / original_height) * img_h)</span><br><span class="line">                adjusted_x_offset = <span class="built_in">int</span>((x_offset / original_width) * img_w)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># ç¢ºä¿ç°½åä¸è¶…å‡ºé‚Šç•Œ</span></span><br><span class="line">                <span class="keyword">if</span> adjusted_y_offset + sig_h &gt; img_h:</span><br><span class="line">                    sig_h = img_h - adjusted_y_offset</span><br><span class="line">                <span class="keyword">if</span> adjusted_x_offset + sig_w &gt; img_w:</span><br><span class="line">                    sig_w = img_w - adjusted_x_offset</span><br><span class="line"></span><br><span class="line">                <span class="comment"># ç°½åå½¢ç‹€åŒ¹é…</span></span><br><span class="line">                resized_signature = cv2.resize(signature, (sig_w, sig_h))</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å°‡ç°½åæ”¾ç½®åœ¨åœ–ç‰‡ä¸Š</span></span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                    open_cv_image[adjusted_y_offset:adjusted_y_offset+sig_h, adjusted_x_offset:adjusted_x_offset+sig_w, c] = \</span><br><span class="line">                        resized_signature[:, :, c] * (resized_signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>) + \</span><br><span class="line">                        open_cv_image[adjusted_y_offset:adjusted_y_offset+sig_h, adjusted_x_offset:adjusted_x_offset+sig_w, c] * (<span class="number">1.0</span> - resized_signature[:, :, <span class="number">3</span>] / <span class="number">255.0</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å°‡ OpenCV åœ–åƒè½‰æ›å› PIL åœ—åƒ</span></span><br><span class="line">                signed_image = Image.fromarray(cv2.cvtColor(open_cv_image, cv2.COLOR_BGRA2RGBA))</span><br><span class="line">                signed_images.append(signed_image)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°‡ç°½åå¾Œçš„åœ–åƒä¿å­˜å› PDF</span></span><br><span class="line">            pdf_output = io.BytesIO()</span><br><span class="line">            signed_images[<span class="number">0</span>].save(pdf_output, <span class="string">&quot;PDF&quot;</span>, resolution=<span class="number">100.0</span>, save_all=<span class="literal">True</span>, append_images=signed_images[<span class="number">1</span>:])</span><br><span class="line">            pdf_output.seek(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å¢åŠ â€œå„²å­˜â€æŒ‰éˆ•</span></span><br><span class="line">            <span class="keyword">if</span> st.button(<span class="string">&quot;å„²å­˜&quot;</span>, <span class="built_in">type</span>=<span class="string">&#x27;primary&#x27;</span>):</span><br><span class="line">                <span class="comment"># ç”Ÿæˆä¿å­˜è·¯å¾‘å’Œæ–‡ä»¶å</span></span><br><span class="line">                base_file_name = form_selection <span class="keyword">if</span> form_selection != <span class="string">&quot;å…¶ä»–&quot;</span> <span class="keyword">else</span> <span class="string">&quot;custom&quot;</span></span><br><span class="line">                existing_files = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(save_folder) <span class="keyword">if</span> f.startswith(base_file_name)]</span><br><span class="line">                file_count = <span class="built_in">len</span>(existing_files) + <span class="number">1</span></span><br><span class="line">                output_file_name = <span class="string">f&quot;<span class="subst">&#123;base_file_name&#125;</span>_<span class="subst">&#123;file_count&#125;</span>.pdf&quot;</span></span><br><span class="line">                save_path = os.path.join(save_folder, output_file_name)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å°‡ç°½åå¾Œçš„ PDF æ–‡ä»¶ä¿å­˜åˆ°æŒ‡å®šè³‡æ–™å¤¾</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(save_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(pdf_output.getbuffer())</span><br><span class="line">                st.success(<span class="string">f&quot;å·²å°‡ç°½åå¾Œçš„ PDF ä¿å­˜åˆ°: <span class="subst">&#123;save_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> page == <span class="string">&quot;æŸ¥çœ‹è¡¨å–®&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æŒ‡å®šä¿å­˜çš„æ–‡ä»¶å¤¾è·¯å¾‘</span></span><br><span class="line">    save_folder = <span class="string">&quot;saved_pdfs&quot;</span></span><br><span class="line">    os.makedirs(save_folder, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç²å–æ‰€æœ‰å·²ä¿å­˜çš„è¡¨å–®</span></span><br><span class="line">    saved_forms = os.listdir(save_folder)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¹æ“šæ–‡ä»¶ååˆ†é¡è¡¨å–®</span></span><br><span class="line">    classified_forms = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> form <span class="keyword">in</span> saved_forms:</span><br><span class="line">        form_type = form.rsplit(<span class="string">&#x27;_&#x27;</span>, <span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> form_type <span class="keyword">not</span> <span class="keyword">in</span> classified_forms:</span><br><span class="line">            classified_forms[form_type] = []</span><br><span class="line">        classified_forms[form_type].append(form)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°‡åˆ†é¡è¡¨å–®è½‰æ›ç‚º DataFrame</span></span><br><span class="line">    df = pd.DataFrame(</span><br><span class="line">        [(key, form) <span class="keyword">for</span> key, forms <span class="keyword">in</span> classified_forms.items() <span class="keyword">for</span> form <span class="keyword">in</span> forms],</span><br><span class="line">        columns=[<span class="string">&quot;è¡¨å–®é¡å‹&quot;</span>, <span class="string">&quot;æ–‡ä»¶å&quot;</span>]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¡¯ç¤º DataFrame ä¸¦å…è¨±ç”¨æˆ¶é¸æ“‡è¦é¡¯ç¤ºçš„è¡¨å–®</span></span><br><span class="line">    selected_forms = st.multiselect(<span class="string">&quot;é¸æ“‡è¦é¡¯ç¤ºçš„è¡¨å–®&quot;</span>, df[<span class="string">&quot;æ–‡ä»¶å&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¡¯ç¤ºé¸æ“‡çš„è¡¨å–®</span></span><br><span class="line">    <span class="keyword">if</span> selected_forms:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> form <span class="keyword">in</span> selected_forms:</span><br><span class="line">            form_path = os.path.join(save_folder, form)</span><br><span class="line">            </span><br><span class="line">            st.markdown(<span class="string">f&quot;####  <span class="subst">&#123;form&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># ä½¿ç”¨ PyMuPDF åŠ è¼‰ PDF æ–‡ä»¶</span></span><br><span class="line">            pdf_doc = fitz.<span class="built_in">open</span>(form_path)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># é¡¯ç¤ºæ¯ä¸€é çš„åœ–åƒå…§å®¹</span></span><br><span class="line">            <span class="keyword">for</span> page_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pdf_doc)):</span><br><span class="line">                page = pdf_doc.load_page(page_num)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°‡ PDF é é¢è½‰æ›ç‚ºåœ–åƒ</span></span><br><span class="line">                pix = page.get_pixmap(matrix=fitz.Matrix(<span class="number">2.0</span>, <span class="number">2.0</span>))  <span class="comment"># ä½¿ç”¨ç›¸åŒçš„ matrix èª¿æ•´åˆ†è¾¨ç‡</span></span><br><span class="line">                img = Image.frombytes(<span class="string">&quot;RGB&quot;</span>, [pix.width, pix.height], pix.samples)</span><br><span class="line">                </span><br><span class="line">                st.image(img, caption=<span class="string">f&quot;ç¬¬ <span class="subst">&#123;page_num + <span class="number">1</span>&#125;</span> é &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        st.write(<span class="string">&quot;ç›®å‰æ²’æœ‰å·²ä¿å­˜çš„è¡¨å–®ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ä»¥å‰åšçš„å°ˆæ¡ˆ">ä»¥å‰åšçš„å°ˆæ¡ˆ</h2>
<p><a href="https://hankvba.blogspot.com/2023/10/excel-vba.html">Excel
VBA@ç°½åæª”å°å·¥å…·</a></p>
<p>å»å¹´æ›¾ç¶“æœ‰æŠŠç°½åæª”åšæˆå¾ˆå¤šä¸åŒç…§ç‰‡ä¾†èª¿æ•´å¤§å°åŠä½ç½®é€²è¡Œè²¼ä¸Šï¼Œä¸éç¶“å»£å¤§ç¶²å‹çš„æª¢è¦–å¾Œï¼Œç™¼ç¾é€™æ¨£å§”å“¡é‚„æ˜¯æœƒä¸å–œæ­¡ï¼Œé‚„æ˜¯å…ˆåšå€‹ç´€éŒ„çµ¦å¤§å®¶åƒè€ƒåƒè€ƒ...</p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
      </tags>
  </entry>
  <entry>
    <title>Streamlitå»ºç«‹æ¬Šé™æ§ç®¡æ©Ÿåˆ¶</title>
    <url>/posts/777227760/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<blockquote>
<p>æ¬Šé™æ§ç®¡é¡§åæ€ç¾©å‰‡æ˜¯è®“æœ‰ç™»è¨˜çš„äººå¯ä»¥é€²ä¾†é›²ç«¯ç¶²é ä¸­æ“ä½œä»‹é¢ï¼Œé€™å°æ–¼ä¸€äº›å…¬å¸å…§éƒ¨æ‰èƒ½æ“ä½œçš„å…§å®¹æœ‰å¾ˆå¤§çš„å¹«åŠ©ã€‚</p>
</blockquote>
<p>æ¬Šé™æ§ç®¡åŸºæœ¬åŠŸèƒ½:</p>
<ul>
<li>è¨»å†Š</li>
<li>ç™»å…¥</li>
<li>å¿˜è¨˜å¯†ç¢¼</li>
<li>é‡ç½®å¯†ç¢¼</li>
</ul>
<p>ç™¼é€é‡ç½®å¯†ç¢¼æ™‚æœƒéš¨æ„ç”¢ç”Ÿä¸€çµ„tokenï¼Œå…§å®¹æœƒåŒ…åœ¨é›»å­éƒµä»¶ä¸­å¯„é€ï¼Œé€™ä¹Ÿç®—æ˜¯ä¸€ç¨®å¤šå› ç´ èªè­‰çš„æ©Ÿåˆ¶ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« å‰ç«¯ä»‹é¢æ¡ç”¨Pythonçš„Streamlitå¥—ä»¶å¯¦ä½œï¼Œå¾Œç«¯é‚è¼¯å‰‡æ¡ç”¨GASå¯¦ä½œï¼Œè³‡æ–™åº«å‰‡æ¡ç”¨GoogleSpreadSheetå„²å­˜ã€‚</p>
<div class="note info"><p>æ­£å¸¸çš„å¸³è™Ÿå¯†ç¢¼å¯¦ä½œæµç¨‹ä¸å»ºè­°æ¡ç”¨æ˜ç¢¼å„²å­˜ï¼Œé€™è£¡åªæ˜¯ä¸€å€‹å¯¦ä½œçš„ç¶“é©—ï¼Œçœ‹ä¹‹å¾Œå¯†ç¢¼çš„éƒ¨åˆ†è¦åŠ é¹½é‚„æ˜¯åšå“ˆå¸ŒåŠ å¯†éƒ½å¯ä»¥å†è¿½åŠ é€²å»ã€‚</p>
</div>
<span id="more"></span>
<h2 id="gasç«¯">GASç«¯</h2>
<p>å…ˆæ–°å¢ä¸€å€‹SpreadSheetä¸¦ä¸”å°‡å·¥ä½œè¡¨è¨­å®šå¦‚ä¸‹:</p>
<h3 id="users">Users</h3>
<table>
<thead>
<tr class="header">
<th>email</th>
<th>username</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<h3 id="resettokens">ResetTokens</h3>
<table>
<thead>
<tr class="header">
<th>email</th>
<th>token</th>
<th>timestamp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>timestampåœ¨GASä¸­çš„ç›®çš„æ˜¯ç‚ºäº†è¦å–å¾—24å°æ™‚å…§çš„tokenæ‰èƒ½æœ‰æ•ˆæ›´æ”¹æ–°å¯†ç¢¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doPost</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> action = e.<span class="property">parameter</span>.<span class="property">action</span>;</span><br><span class="line">  <span class="keyword">var</span> email = e.<span class="property">parameter</span>.<span class="property">email</span>;</span><br><span class="line">  <span class="keyword">var</span> username = e.<span class="property">parameter</span>.<span class="property">username</span>;</span><br><span class="line">  <span class="keyword">var</span> password = e.<span class="property">parameter</span>.<span class="property">password</span>;</span><br><span class="line">  <span class="keyword">var</span> newPassword = e.<span class="property">parameter</span>.<span class="property">newPassword</span>;</span><br><span class="line">  <span class="keyword">var</span> token=e.<span class="property">parameter</span>.<span class="property">token</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (action == <span class="string">&quot;register&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">registerUser</span>(email, username, password);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action == <span class="string">&quot;login&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">loginUser</span>(username, password);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action == <span class="string">&quot;forgotPassword&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">forgotPassword</span>(email);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (action == <span class="string">&quot;updatePassword&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">updatePassword</span>(username,token, newPassword);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Invalid action&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: error.<span class="property">message</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">registerUser</span>(<span class="params">email, username, password</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">0</span>] == email) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Email already registered&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sheet.<span class="title function_">appendRow</span>([email, username, password]);</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;User registered successfully&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loginUser</span>(<span class="params">username, password</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">1</span>] == username &amp;&amp; data[i][<span class="number">2</span>] == password) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Login successful&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Invalid username or password&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updatePassword</span>(<span class="params">email, token, newPassword</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;ResetTokens&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line">  <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">  <span class="keyword">var</span> tokenValid = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">0</span>] == email &amp;&amp; data[i][<span class="number">1</span>] == token) &#123;</span><br><span class="line">      <span class="keyword">var</span> timestamp = data[i][<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> (now - timestamp &lt;= <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>) &#123;  <span class="comment">// Token valid for 24 hours</span></span><br><span class="line">        tokenValid = <span class="literal">true</span>;</span><br><span class="line">        sheet.<span class="title function_">getRange</span>(i+<span class="number">1</span>, <span class="number">3</span>).<span class="title function_">setValue</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (tokenValid) &#123;</span><br><span class="line">    <span class="keyword">var</span> userSheet =<span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> userData = userSheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; userData.<span class="property">length</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (userData[j][<span class="number">0</span>] == email) &#123;</span><br><span class="line">        userSheet.<span class="title function_">getRange</span>(j + <span class="number">1</span>, <span class="number">3</span>).<span class="title function_">setValue</span>(newPassword);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Password updated successfully&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Invalid token or email&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">forgotPassword</span>(<span class="params">email</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet =<span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">0</span>] == email) &#123;</span><br><span class="line">      <span class="comment">// Generate a random token for password reset</span></span><br><span class="line">      <span class="keyword">var</span> token = <span class="title function_">generateToken</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Store the token and timestamp in a separate sheet (or update the existing sheet structure)</span></span><br><span class="line">      <span class="title function_">storeResetToken</span>(email, token);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Send the reset email</span></span><br><span class="line">      <span class="title function_">sendResetEmail</span>(email, token);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Password reset email sent&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Email not found&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">generateToken</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> charset = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> token = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> randomIndex = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * charset.<span class="property">length</span>);</span><br><span class="line">    token += charset[randomIndex];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> token;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">storeResetToken</span>(<span class="params">email, token</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;ResetTokens&#x27;</span>);</span><br><span class="line">  <span class="comment">// if (!sheet) &#123;</span></span><br><span class="line">    <span class="comment">// sheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet(&#x27;ResetTokens&#x27;);</span></span><br><span class="line">    <span class="comment">// sheet.appendRow([&#x27;Email&#x27;, &#x27;Token&#x27;, &#x27;Timestamp&#x27;]);</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="keyword">var</span> timestamp = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">  sheet.<span class="title function_">appendRow</span>([email, token, timestamp]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendResetEmail</span>(<span class="params">email, resetUrl</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> subject = <span class="string">&#x27;Password Reset Request&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> body = <span class="string">&#x27;You requested a password reset. Click the link below to reset your password:\n\n&#x27;</span> + resetUrl + <span class="string">&#x27;\n\nIf you did not request a password reset, please ignore this email.&#x27;</span>;</span><br><span class="line">  <span class="title class_">GmailApp</span>.<span class="title function_">sendEmail</span>(email, subject, body);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å»ºç«‹å®Œæˆä¹‹å¾Œç™¼å¸ƒæˆç‚ºWebAppï¼Œæœƒå¾—åˆ°ä¸€ä¸²URLï¼Œæ­¤ç‚ºPythonä¸­éœ€è¦å¼•å…¥çš„<strong>BASE_URL</strong></p>
<h2 id="pythonç«¯">Pythonç«¯</h2>
<h3 id="app.py">app.py</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">BASE_URL = <span class="string">&#x27;YOUR_GAS_WEB_APP_URL&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register_user</span>(<span class="params">email, username, password</span>):</span><br><span class="line">    response = requests.post(BASE_URL, data=&#123;</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;register&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span>: email,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response.json()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_user</span>(<span class="params">username, password</span>):</span><br><span class="line">    response = requests.post(BASE_URL, data=&#123;</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;login&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response.json()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forgot_password</span>(<span class="params">email</span>):</span><br><span class="line">    response = requests.post(BASE_URL, data=&#123;</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;forgotPassword&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span>: email</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response.json()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_password</span>(<span class="params">username,token, new_password</span>):</span><br><span class="line">    response = requests.post(BASE_URL, data=&#123;</span><br><span class="line">        <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;updatePassword&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;token&#x27;</span>:token,</span><br><span class="line">        <span class="string">&#x27;newPassword&#x27;</span>: new_password</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> response.json()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    st.title(<span class="string">&quot;User Management System&quot;</span>)</span><br><span class="line"></span><br><span class="line">    menu = [<span class="string">&quot;Home&quot;</span>, <span class="string">&quot;Login&quot;</span>, <span class="string">&quot;Register&quot;</span>, <span class="string">&quot;Forgot Password&quot;</span>, <span class="string">&quot;Update Password&quot;</span>]</span><br><span class="line">    choice = st.sidebar.selectbox(<span class="string">&quot;Menu&quot;</span>, menu)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> choice == <span class="string">&quot;Home&quot;</span>:</span><br><span class="line">        st.subheader(<span class="string">&quot;Home&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&quot;Login&quot;</span>:</span><br><span class="line">        st.subheader(<span class="string">&quot;Login&quot;</span>)</span><br><span class="line">        username = st.text_input(<span class="string">&quot;Username&quot;</span>)</span><br><span class="line">        password = st.text_input(<span class="string">&quot;Password&quot;</span>, <span class="built_in">type</span>=<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> st.button(<span class="string">&quot;Login&quot;</span>):</span><br><span class="line">            result = login_user(username, password)</span><br><span class="line">            st.write(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&quot;Register&quot;</span>:</span><br><span class="line">        st.subheader(<span class="string">&quot;Register&quot;</span>)</span><br><span class="line">        email = st.text_input(<span class="string">&quot;Email&quot;</span>)</span><br><span class="line">        username = st.text_input(<span class="string">&quot;Username&quot;</span>)</span><br><span class="line">        password = st.text_input(<span class="string">&quot;Password&quot;</span>, <span class="built_in">type</span>=<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> st.button(<span class="string">&quot;Register&quot;</span>):</span><br><span class="line">            result = register_user(email, username, password)</span><br><span class="line">            st.write(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&quot;Forgot Password&quot;</span>:</span><br><span class="line">        st.subheader(<span class="string">&quot;Forgot Password&quot;</span>)</span><br><span class="line">        email = st.text_input(<span class="string">&quot;Email&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> st.button(<span class="string">&quot;Submit&quot;</span>):</span><br><span class="line">            result = forgot_password(email)</span><br><span class="line">            st.write(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> choice == <span class="string">&quot;Update Password&quot;</span>:</span><br><span class="line">        st.subheader(<span class="string">&quot;Update Password&quot;</span>)</span><br><span class="line">        username = st.text_input(<span class="string">&quot;Username&quot;</span>)</span><br><span class="line">        token=st.text_input(<span class="string">&quot;Token&quot;</span>)</span><br><span class="line">        new_password = st.text_input(<span class="string">&quot;New Password&quot;</span>, <span class="built_in">type</span>=<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> st.button(<span class="string">&quot;Update&quot;</span>):</span><br><span class="line">            result = update_password(username, token,new_password)</span><br><span class="line">            st.write(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å°‡é€™äº›å…§å®¹ç”¨Streamlit run app.py å³å¯çœ‹åˆ°ä½¿ç”¨ä»‹é¢</p>
<figure>
<img src="https://hackmd.io/_uploads/SkGgaL_LR.png" alt="image" />
<figcaption aria-hidden="true">image</figcaption>
</figure>
<p>å¾ŒçºŒè¦åˆ©ç”¨çš„æ™‚å€™å°±æŠŠç™»å…¥æˆåŠŸçš„å…§å®¹æ”¾ç½®æ–¼session_stateä¸­å…ˆå­˜èµ·ä¾†ï¼Œå†é¡¯ç¤ºä¸»è¦æ“ä½œçš„ä»‹é¢å°±å¯ä»¥äº†!</p>
<h2 id="å“ˆå¸ŒåŠ å¯†ç®—æ³•">å“ˆå¸ŒåŠ å¯†ç®—æ³•</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hashPassword</span>(<span class="params">password</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> rawHash = <span class="title class_">Utilities</span>.<span class="title function_">computeDigest</span>(<span class="title class_">Utilities</span>.<span class="property">DigestAlgorithm</span>.<span class="property">SHA_256</span>, password);</span><br><span class="line">  <span class="keyword">var</span> hash = rawHash.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">byte</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> v = (byte &lt; <span class="number">0</span> ? byte + <span class="number">256</span> : byte).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> v.<span class="property">length</span> == <span class="number">1</span> ? <span class="string">&#x27;0&#x27;</span> + v : v;</span><br><span class="line">  &#125;).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">registerUser</span>(<span class="params">email, username, password</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">0</span>] == email) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Email already registered&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hashedPassword = <span class="title function_">hashPassword</span>(password);</span><br><span class="line"></span><br><span class="line">  sheet.<span class="title function_">appendRow</span>([email, username, hashedPassword]);</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;User registered successfully&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loginUser</span>(<span class="params">username, password</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> hashedPassword = <span class="title function_">hashPassword</span>(password);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">1</span>] == username &amp;&amp; data[i][<span class="number">2</span>] == hashedPassword) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Login successful&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Invalid username or password&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updatePassword</span>(<span class="params">email, token, newPassword</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;ResetTokens&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> data = sheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line">  <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">  <span class="keyword">var</span> tokenValid = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[i][<span class="number">0</span>] == email &amp;&amp; data[i][<span class="number">1</span>] == token) &#123;</span><br><span class="line">      <span class="keyword">var</span> timestamp = data[i][<span class="number">2</span>];</span><br><span class="line">      <span class="keyword">if</span> (now - timestamp &lt;= <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>) &#123;  <span class="comment">// Token valid for 24 hours</span></span><br><span class="line">        tokenValid = <span class="literal">true</span>;</span><br><span class="line">        sheet.<span class="title function_">getRange</span>(i + <span class="number">1</span>, <span class="number">3</span>).<span class="title function_">setValue</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (tokenValid) &#123;</span><br><span class="line">    <span class="keyword">var</span> userSheet = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">getActiveSpreadsheet</span>().<span class="title function_">getSheetByName</span>(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> userData = userSheet.<span class="title function_">getDataRange</span>().<span class="title function_">getValues</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> hashedPassword = <span class="title function_">hashPassword</span>(newPassword);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; userData.<span class="property">length</span>; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (userData[j][<span class="number">0</span>] == email) &#123;</span><br><span class="line">        userSheet.<span class="title function_">getRange</span>(j + <span class="number">1</span>, <span class="number">3</span>).<span class="title function_">setValue</span>(hashedPassword);</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Password updated successfully&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">status</span>: <span class="string">&quot;error&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;Invalid token or email&quot;</span> &#125;)).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
      </tags>
  </entry>
  <entry>
    <title>Streamlitå»ºç½®GoogleSheetç°¡æ˜“è³‡æ–™åº«</title>
    <url>/posts/639809757/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>Streamlitæ˜¯ä½¿ç”¨pythonèªè¨€çš„å‰ç«¯å¥—ä»¶ï¼Œä»–æœ€å¤§çš„å¥½è™•æ˜¯å°±èƒ½é€éå¥—ä»¶æœ¬èº«ç¨‹å¼ç¢¼ç”Ÿæˆä¸€ç¯‡ç¯‡é‚„ç®—èƒ½çœ‹çš„ä½¿ç”¨è€…ä»‹é¢ï¼Œå°æ–¼Htmlã€CSSã€Javascriptç­‰å‰ç«¯èªè¨€æ„Ÿåˆ°ä¸èˆ’æœçš„é–‹ç™¼è€…å¯ä»¥å¦¥å–„åˆ©ç”¨ï¼Œåœ¨éƒ¨ç½²ä¸Šé›£åº¦ä¹Ÿä¸é«˜ï¼Œå¹¾ä¹å¯ä»¥ä¸€éµé”æˆã€‚</p>
<p>é™¤äº†pythonæœ¬èº«å…§éµå·²ç¶“æœ‰æœ¬åœ°ç«¯sqliteå¯ä»¥é€²è¡Œè³‡æ–™å­˜å„²ï¼Œå¦‚æœè³‡æ–™éœ€è¦ä¸Šé›²çš„è©±å°±æœƒéœ€è¦é¡å¤–æ‰¾å°‹é›²ç«¯è³‡æ–™åº«ä¾†é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œæ¨™æº–çš„é—œè¯å¼æœ‰MySQLã€postgreSQLã€SQLserverç­‰ç­‰æ¯”è¼ƒå¸¸è¦‹çš„å·¥å…·ã€éé—œè¯å¼è³‡æ–™åº«å‰‡å¯ä»¥é€émongoDBã€firestoreç­‰ç­‰å·¥å…·é€²è¡ŒæŒ‘é¸ã€‚</p>
<blockquote>
<p>æœ¬ç¯‡è¦ä»‹ç´¹çš„å…§å®¹æ˜¯é‡å°æ¯”è¼ƒç°¡æ˜“çš„å‰ç«¯ä»‹é¢ï¼Œå¯ä»¥ç”¨Googleæä¾›çš„GoogleSheetä¾†é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œä¸¦ä¸”é€éGoogleAppScriptsä¾†åšå¾Œç«¯èªè¨€é€²è¡Œæ“ä½œã€‚</p>
</blockquote>
<span id="more"></span>
<h2 id="åŸºæœ¬apiæ¦‚å¿µ">åŸºæœ¬APIæ¦‚å¿µ</h2>
<p>æ‰€è¬‚å‰ç«¯èˆ‡å¾Œç«¯åˆ†é›¢é–‹ç™¼ï¼Œå°±æ˜¯é€éAPIçš„æ–¹å¼é€²è¡Œè³‡æ–™äº¤æ›ï¼ŒAPIå°±æ˜¯ä¸€ä¸²ç¶²å€(URL)å¤–åŠ ä¸€äº›å¤¾å¸¶çš„åƒæ•¸ï¼Œåƒæ•¸å¯ä»¥æ˜¯ç´”æ–‡å­—ã€ä¹Ÿå¯ä»¥æ˜¯ç‰©ä»¶ï¼Œç„¶è€Œç‰©ä»¶çš„éƒ¨åˆ†åˆå¯åˆ†ç‚ºXMLæˆ–JSONï¼Œé€™å…©é …æ˜¯æœ€å¸¸è¢«æ‹¿ä¾†ä½¿ç”¨æ–¼APIçš„è³‡æ–™äº¤æ›ï¼ŒåŒ…å«è¼¸å…¥åˆ°å¾Œç«¯å­˜æ”¾è³‡æ–™æˆ–è€…æ˜¯å¾è³‡æ–™åº«å–å‡ºè³‡æ–™åˆ°å‰ç«¯é€²è¡Œæ¸²æŸ“ã€‚</p>
<p>å…¬å…±å·¥ç¨‹å¸¸ç”¨çš„ä¼°åƒ¹ç³»çµ±(PCCES)ä¾¿æ˜¯ä»¥XMLé€²è¡Œè³‡æ–™äº¤æ›ï¼Œè©³æƒ…å¯è¦‹<a
href="https://hankvba.blogspot.com/2024/02/excel-vba-pcces.html">ExcelVBA@PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†</a>ï¼Œåœ¨æ­¤ä¸å¤šåšèªªæ˜</p>
<h2 id="json">JSON</h2>
<p>å¤§å¤šæ•¸çš„ç¬¬ä¸‰æ–¹APIéƒ½æ˜¯æ¡ç”¨JSONæ ¼å¼é€²è¡Œå‚³è¼¸ï¼Œé€™ä¹Ÿæ˜¯æœ¬ç¯‡ä¸»è¦è³‡æ–™æ ¼å¼ï¼Œé—œæ–¼JSONçš„æ ¼å¼é€šå¸¸æ˜¯ä»¥éµ-å€¼å°çš„æ–¹å¼å„²å­˜ï¼Œä¹Ÿå°±æ˜¯æ‰€è¬‚çš„key-valueï¼Œè¦é€²è¡Œè³‡æ–™å–ç”¨æˆ–çµ„è£æ™‚ç‰¹åˆ¥çš„æ–¹ä¾¿ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼æœƒé¸ç”¨ä»–ä¾†åšç‚ºæˆ‘åœ¨streamlitåŠGASä¸­çš„äº¤æ›åª’ä»‹ã€‚</p>
<p>JSONè³‡æ–™å¯ä»¥åˆ†ç‚ºGASå°è±¡ã€JSONå­—ä¸²ã€pythonå°è±¡ï¼Œæ¯å€‹è³‡æ–™éƒ½å¯ä»¥äº’ç›¸è½‰ç§»ï¼ŒJSONå­—ä¸²ä¸»è¦æ˜¯åœ¨APIä¸­æ‰€å¤¾å¸¶çš„å­—ä¸²ï¼Œå…¶é¤˜pythonå°è±¡ã€GASå°è±¡å‰‡æ˜¯ä¾ç…§ä¸åŒèªè¨€è§£ææˆç›¸å°æ‡‰çš„ç‰©ä»¶ã€‚</p>
<p>è¬ä¸€é‡è¦‹è™•ç†å¤šå·¢éšå±¤çš„éç¨‹å¯ä»¥è—‰ç”±æ‰å¹³åŒ–(å°‡å·¢ç‹€éµå€¼å°è™•ç†åˆ°é ‚å±¤)çš„æ–¹æ³•æ–¹ä¾¿è³‡æ–™å–ç”¨ï¼Œä¹Ÿå¯ä»¥é€éåæ‰å¹³åŒ–çš„æ–¹æ³•å°‡åŸæœ¬çš„è³‡æ–™æ¢å¾©åŸç‹€ã€‚</p>
<h3 id="åœ¨gasä¸­é—œæ–¼jsonæ ¼å¼çš„è½‰æ›">åœ¨GASä¸­é—œæ–¼JSONæ ¼å¼çš„è½‰æ›</h3>
<h4 id="json.parse">JSON.parse()</h4>
<p><code>JSON.parse()</code> æ–¹æ³•ç”¨æ–¼å°‡ JSON å­—ä¸²è§£æç‚º JavaScript
ç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹åˆæ³•çš„ JSON å­—ä¸²ä¸¦è¿”å›è§£æå¾Œçš„ JavaScript å€¼ã€‚</p>
<h4 id="json.stringify">JSON.stringify()</h4>
<p><code>JSON.stringify()</code> æ–¹æ³•ç”¨æ–¼å°‡ JavaScript ç‰©ä»¶è½‰æ›ç‚º JSON
å­—ä¸²ã€‚å®ƒæ¥å—ä¸€å€‹ JavaScript ç‰©ä»¶ä¸¦è¿”å›ç›¸æ‡‰çš„ JSON æ ¼å¼å­—ä¸²ã€‚</p>
<h3 id="åœ¨pythonä¸­é—œæ–¼jsonæ ¼å¼çš„è½‰æ›">åœ¨Pythonä¸­é—œæ–¼JSONæ ¼å¼çš„è½‰æ›</h3>
<h4 id="json.dumps">json.dumps()</h4>
<p><code>json.dumps()</code> æ–¹æ³•ç”¨æ–¼å°‡ Python ç‰©ä»¶è½‰æ›ç‚º JSON
å­—ä¸²ã€‚å®ƒæ¥å—ä¸€å€‹ Python ç‰©ä»¶ä¸¦è¿”å›ç›¸æ‡‰çš„ JSON æ ¼å¼å­—ä¸²ã€‚</p>
<h4 id="json.loads">json.loads()</h4>
<p><code>json.loads()</code> æ–¹æ³•ç”¨æ–¼å°‡ JSON å­—ä¸²è§£æç‚º Python
ç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹åˆæ³•çš„ JSON å­—ä¸²ä¸¦è¿”å›è§£æå¾Œçš„ Python å€¼ã€‚</p>
<h4 id="json.loadç›®å‰æ²’ç”¨åˆ°">json.load()&gt;ç›®å‰æ²’ç”¨åˆ°</h4>
<p><code>json.load()</code> æ–¹æ³•ç”¨æ–¼å¾æª”æ¡ˆä¸­è®€å– JSON è³‡æ–™ä¸¦å°‡å…¶è§£æç‚º
Python ç‰©ä»¶ã€‚å®ƒæ¥å—ä¸€å€‹å¯è®€å–çš„æª”æ¡ˆç‰©ä»¶ï¼Œä¸¦è¿”å›è§£æå¾Œçš„ Python å€¼ã€‚</p>
<h3 id="pythonå°è±¡æ“ä½œ">Pythonå°è±¡æ“ä½œ</h3>
<h4 id="å–®å±¤">å–®å±¤</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = json.loads(json_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å–ä¸€å±¤çµæ§‹</span></span><br><span class="line">name = data[<span class="string">&#x27;person&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">age = data[<span class="string">&#x27;person&#x27;</span>][<span class="string">&#x27;age&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å–å¤šå±¤çµæ§‹</span></span><br><span class="line">city = data[<span class="string">&#x27;person&#x27;</span>][<span class="string">&#x27;address&#x27;</span>][<span class="string">&#x27;city&#x27;</span>]</span><br><span class="line">zipcode = data[<span class="string">&#x27;person&#x27;</span>][<span class="string">&#x27;address&#x27;</span>][<span class="string">&#x27;zipcode&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(name)     <span class="comment"># Output: John</span></span><br><span class="line"><span class="built_in">print</span>(age)      <span class="comment"># Output: 30</span></span><br><span class="line"><span class="built_in">print</span>(city)     <span class="comment"># Output: New York</span></span><br><span class="line"><span class="built_in">print</span>(zipcode)  <span class="comment"># Output: 10001</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="å¤šå±¤">å¤šå±¤</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">json_str = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  &quot;person&quot;: &#123;</span></span><br><span class="line"><span class="string">    &quot;name&quot;: &quot;John&quot;,</span></span><br><span class="line"><span class="string">    &quot;age&quot;: 30,</span></span><br><span class="line"><span class="string">    &quot;address&quot;: &#123;</span></span><br><span class="line"><span class="string">      &quot;city&quot;: &quot;New York&quot;,</span></span><br><span class="line"><span class="string">      &quot;zipcode&quot;: &quot;10001&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_json</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">dict</span>):</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> data.items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Key: <span class="subst">&#123;key&#125;</span>, Value: <span class="subst">&#123;value&#125;</span>&#x27;</span>)</span><br><span class="line">            process_json(value)  <span class="comment"># éè¿´è™•ç†å€¼</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(data, <span class="built_in">list</span>):</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">            process_json(item)  <span class="comment"># éè¿´è™•ç†åˆ—è¡¨ä¸­çš„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">data = json.loads(json_str)</span><br><span class="line">process_json(data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="gaså°è±¡æ“ä½œ">GASå°è±¡æ“ä½œ</h2>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>: <span class="string">&quot;John&quot;</span>, <span class="attr">age</span>: <span class="number">30</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> jsonString = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = obj.<span class="property">name</span>;</span><br><span class="line"><span class="keyword">var</span> age = obj[<span class="string">&#x27;age&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¨­ç½®</span></span><br><span class="line"></span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&#x27;Alice&#x27;</span>;</span><br><span class="line">obj[<span class="string">&#x27;age&#x27;</span>] = <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¾ªç’°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">        <span class="title class_">Logger</span>.<span class="title function_">log</span>(key + <span class="string">&#x27;: &#x27;</span> + obj[key]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç¶œåˆæ“ä½œ">ç¶œåˆæ“ä½œ</h2>
<h3 id="streamlit">streamlit</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, datetime</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡æ‹Ÿä¸€äº› session state æ•°æ®</span></span><br><span class="line">st.session_state.current_page = <span class="string">&quot;render_page0&quot;</span></span><br><span class="line">st.session_state.submitted = <span class="literal">False</span></span><br><span class="line">st.session_state.costs = &#123;</span><br><span class="line">    <span class="string">&quot;open_channel&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;æ¸ é“å·¥ç¨‹&quot;</span>, <span class="string">&quot;unit_cost&quot;</span>: <span class="number">0</span>, <span class="string">&quot;length&quot;</span>: <span class="number">0</span>, <span class="string">&quot;total_cost&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">    <span class="string">&quot;bridge&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;ç‰ˆæ©‹å·¥ç¨‹&quot;</span>, <span class="string">&quot;unit_cost&quot;</span>: <span class="number">0</span>, <span class="string">&quot;quantity&quot;</span>: <span class="number">0</span>, <span class="string">&quot;total_cost&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">    <span class="string">&quot;wall&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;æ“‹åœŸç‰†&quot;</span>, <span class="string">&quot;unit_cost&quot;</span>: <span class="number">0</span>, <span class="string">&quot;length&quot;</span>: <span class="number">0</span>, <span class="string">&quot;total_cost&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">    <span class="string">&quot;road&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;é“è·¯å·¥ç¨‹&quot;</span>, <span class="string">&quot;unit_cost&quot;</span>: <span class="number">0</span>, <span class="string">&quot;quantity&quot;</span>: <span class="number">0</span>, <span class="string">&quot;total_cost&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">    <span class="string">&quot;falsework&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;ç‰ˆæ¨å·¥ç¨‹&quot;</span>, <span class="string">&quot;unit_cost&quot;</span>: <span class="number">0</span>, <span class="string">&quot;quantity&quot;</span>: <span class="number">0</span>, <span class="string">&quot;total_cost&quot;</span>: <span class="number">0</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line">st.session_state.totalcost = <span class="number">0</span></span><br><span class="line">st.session_state.inf = &#123;</span><br><span class="line">    <span class="string">&quot;work_place&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_place2&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_station&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_name&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_benefit&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_place_detail&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;work_water_check&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&quot;work_start_date&quot;</span>: date.today(),</span><br><span class="line">    <span class="string">&quot;work_end_date&quot;</span>: date.today(),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šä¹‰ JSON åºåˆ—åŒ–å™¨ï¼Œç”¨äºå¤„ç†æ—¥æœŸå­—æ®µ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DateTimeEncoder</span>(json.JSONEncoder):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">default</span>(<span class="params">self, obj</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, (datetime, date)):</span><br><span class="line">            <span class="keyword">return</span> obj.isoformat()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().default(obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå°† st.session_state è½¬æ¢ä¸º JSON</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">session_state_to_json</span>():</span><br><span class="line">    selected_fields = [<span class="string">&quot;costs&quot;</span>, <span class="string">&quot;inf&quot;</span>] <span class="comment"># æŒ‡å®šéœ€è¦è½¬æ¢çš„å­—æ®µ</span></span><br><span class="line">    session_state_dict = &#123;key: value <span class="keyword">for</span> key, value <span class="keyword">in</span> st.session_state.items()<span class="keyword">if</span> key <span class="keyword">in</span> selected_fields&#125;</span><br><span class="line">    json_data = json.dumps(session_state_dict, cls=DateTimeEncoder)</span><br><span class="line">    <span class="keyword">return</span> json_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å‡½æ•°å¹¶å±•ç¤ºç»“æœ</span></span><br><span class="line">json_result = session_state_to_json()</span><br><span class="line">st.write(st.session_state)</span><br><span class="line">st.write(json_result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> st.button(<span class="string">&quot;Submit&quot;</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨­ç½® Google Apps Script Web æ‡‰ç”¨ç¨‹å¼çš„ URL</span></span><br><span class="line">    url = <span class="string">&quot;your_gas_url&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç™¼é€ POST è«‹æ±‚ä¸¦å‚³é JSON è³‡æ–™</span></span><br><span class="line">    response = requests.post(url, data=json_result)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æª¢æŸ¥è«‹æ±‚æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">        st.write(<span class="string">&quot;Request successful!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        st.write(<span class="string">&quot;Error:&quot;</span>, response.status_code)</span><br></pre></td></tr></table></figure>
<h3 id="gas">GAS</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰Google Sheetsçš„ID</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SHEET_ID</span> = <span class="string">&#x27;your_sheet_id&#x27;</span>; <span class="comment">// æ›¿æ¢ä¸ºæ‚¨çš„Google Sheets ID</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doPost</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">// ä» POST è¯·æ±‚ä¸­è·å– JSON å­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="keyword">var</span> jsonString = e.<span class="property">postData</span>.<span class="property">contents</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è§£æ JSON å­—ç¬¦ä¸²ä¸ºå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">var</span> dataOrigin = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonString);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> data = <span class="title function_">flattenObject</span>(dataOrigin);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è·å–æ´»åŠ¨å·¥ä½œè¡¨</span></span><br><span class="line">  <span class="keyword">var</span> ss = <span class="title class_">SpreadsheetApp</span>.<span class="title function_">openById</span>(<span class="variable constant_">SHEET_ID</span>);</span><br><span class="line">  <span class="keyword">var</span> sheet = ss.<span class="title function_">getActiveSheet</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è·å–æœ€åä¸€è¡Œï¼Œä»¥ä¾¿åœ¨æœ«å°¾æ·»åŠ æ–°æ•°æ®</span></span><br><span class="line">  <span class="keyword">var</span> lastRow = sheet.<span class="title function_">getLastRow</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å°†æ•°æ®å†™å…¥å·¥ä½œè¡¨çš„ä¸‹ä¸€è¡Œ</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> columnIndex = <span class="title function_">getColumnIndex</span>(sheet, key);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (columnIndex === -<span class="number">1</span>) &#123; <span class="comment">// å¦‚æœåˆ—ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°åˆ—</span></span><br><span class="line">      columnIndex = sheet.<span class="title function_">getLastColumn</span>() + <span class="number">1</span>;</span><br><span class="line">      sheet.<span class="title function_">getRange</span>(<span class="number">1</span>, columnIndex).<span class="title function_">setValue</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastRow===<span class="number">0</span> )&#123;</span><br><span class="line">      sheet.<span class="title function_">getRange</span>(lastRow + <span class="number">2</span>, columnIndex).<span class="title function_">setValue</span>(data[key]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      sheet.<span class="title function_">getRange</span>(lastRow + <span class="number">1</span>, columnIndex).<span class="title function_">setValue</span>(data[key]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è¿”å›å›åº”ç»™å®¢æˆ·ç«¯ï¼Œè¿™æ˜¯å¯é€‰çš„</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(<span class="string">&#x27;Success&#x27;</span>).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">TEXT</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–åˆ—çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›-1</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getColumnIndex</span>(<span class="params">sheet, columnName</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> maxColumns = sheet.<span class="title function_">getMaxColumns</span>(); <span class="comment">// è·å–å·¥ä½œè¡¨çš„æœ€å¤§åˆ—æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (maxColumns &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// å¦‚æœæ²¡æœ‰åˆ—å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å› -1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> headersRange = sheet.<span class="title function_">getRange</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, maxColumns);</span><br><span class="line">  <span class="keyword">var</span> headersValues = headersRange.<span class="title function_">getValues</span>()[<span class="number">0</span>]; <span class="comment">// åªè·å–ç¬¬ä¸€è¡Œæ•°æ®</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; headersValues.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (headersValues[i] === columnName) &#123;</span><br><span class="line">      <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è¿”å› -1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ‰å¹³åŒ–åµŒå¥—å¯¹è±¡çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">flattenObject</span>(<span class="params">obj, parentKey = <span class="string">&#x27;&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="comment">// æ£€æŸ¥ obj æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸º undefined æˆ– null</span></span><br><span class="line">  <span class="keyword">if</span> (!obj || <span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">entries</span>(obj)) &#123;</span><br><span class="line">    <span class="keyword">const</span> newKey = parentKey ? <span class="string">`<span class="subst">$&#123;parentKey&#125;</span>.<span class="subst">$&#123;key&#125;</span>`</span> : key;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&#x27;object&#x27;</span> &amp;&amp; value !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> flattened = <span class="title function_">flattenObject</span>(value, newKey);</span><br><span class="line">      result = &#123; ...result, ...flattened &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result[newKey] = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="jsonç‰©ä»¶ç‰¹æ®Šè™•ç†">JSONç‰©ä»¶ç‰¹æ®Šè™•ç†</h2>
<h3 id="è³‡æ–™æ‰å¹³åŒ–">è³‡æ–™æ‰å¹³åŒ–</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">doPost</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> jsonData = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;John&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">30</span>,<span class="string">&quot;address&quot;</span>:&#123;<span class="string">&quot;city&quot;</span>:<span class="string">&quot;New York&quot;</span>,<span class="string">&quot;country&quot;</span>:<span class="string">&quot;USA&quot;</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰å¹³åŒ–å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">const</span> flattenedObject = <span class="title function_">flattenObject</span>(jsonData);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// å°†æ‰å¹³åŒ–åçš„å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="keyword">const</span> jsonString = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(flattenedObject);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è¿”å› JSON æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ContentService</span>.<span class="title function_">createTextOutput</span>(jsonString).<span class="title function_">setMimeType</span>(<span class="title class_">ContentService</span>.<span class="property">MimeType</span>.<span class="property">JSON</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ‰å¹³åŒ–åµŒå¥—å¯¹è±¡çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">flattenObject</span>(<span class="params">obj, parentKey = <span class="string">&#x27;&#x27;</span></span>) &#123;</span><br><span class="line">  <span class="comment">// æ£€æŸ¥ obj æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸º undefined æˆ– null</span></span><br><span class="line">  <span class="keyword">if</span> (!obj || <span class="keyword">typeof</span> obj !== <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">entries</span>(obj)) &#123;</span><br><span class="line">    <span class="keyword">const</span> newKey = parentKey ? <span class="string">`<span class="subst">$&#123;parentKey&#125;</span>.<span class="subst">$&#123;key&#125;</span>`</span> : key;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&#x27;object&#x27;</span> &amp;&amp; value !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> flattened = <span class="title function_">flattenObject</span>(value, newKey);</span><br><span class="line">      result = &#123; ...result, ...flattened &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      result[newKey] = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">const</span> nestedObject = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;John&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">30</span>,</span><br><span class="line">  <span class="attr">address</span>: &#123;</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;New York&quot;</span>,</span><br><span class="line">    <span class="attr">country</span>: <span class="string">&quot;USA&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flattenedObject = <span class="title function_">flattenObject</span>(nestedObject);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(flattenedObject);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(flattenedObject))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="title function_">values</span>(flattenedObject))</span><br><span class="line"></span><br><span class="line"><span class="comment">//[name,age,address.city,address.country]</span></span><br><span class="line"><span class="comment">//[John,30,New York,USA]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="è³‡æ–™æ‰å¹³åŒ–å›å¾©">è³‡æ–™æ‰å¹³åŒ–å›å¾©</h3>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unflattenObject</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥å­˜å‚¨æ¢å¤åçš„æ•°æ®</span></span><br><span class="line">  <span class="keyword">let</span> result = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éå†æ‰å¹³åŒ–åçš„å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(obj, key)) &#123;</span><br><span class="line">      <span class="comment">// å°†é”®åæ‹†åˆ†æˆå„çº§åˆ«çš„åµŒå¥—é”®å</span></span><br><span class="line">      <span class="keyword">const</span> keys = key.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">      <span class="keyword">let</span> nestedObj = result;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// è¿­ä»£åµŒå¥—é”®åï¼Œå¹¶åœ¨æ–°å¯¹è±¡ä¸­é‡æ–°åˆ›å»ºåµŒå¥—ç»“æ„</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> nestedKey = keys[i];</span><br><span class="line">        <span class="keyword">if</span> (i === keys.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœæ˜¯æœ€åä¸€çº§é”®åï¼Œç›´æ¥å°†å€¼èµ‹ç»™æœ€åä¸€çº§é”®</span></span><br><span class="line">          nestedObj[nestedKey] = obj[key];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// å¦‚æœä¸æ˜¯æœ€åä¸€çº§é”®åï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦åˆ›å»ºåµŒå¥—å¯¹è±¡</span></span><br><span class="line">          nestedObj[nestedKey] = nestedObj[nestedKey] || &#123;&#125;;</span><br><span class="line">          nestedObj = nestedObj[nestedKey];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="vbaéƒ¨åˆ†">VBAéƒ¨åˆ†</h2>
<blockquote>
<p>åªæ˜¯å…ˆåšç´€éŒ„ï¼Œä¹‹å¾Œå†è·Ÿcollectionçš„è³‡æ–™æ ¼å¼ä¸€èµ·ä»‹ç´¹</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> TestDictionary()</span><br><span class="line">    <span class="keyword">Dim</span> jsonData <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">    <span class="keyword">Set</span> jsonData = CreateObject(<span class="string">&quot;Scripting.Dictionary&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; æ·»åŠ ?å€¼?</span></span><br><span class="line">    jsonData(<span class="string">&quot;name&quot;</span>) = <span class="string">&quot;John&quot;</span></span><br><span class="line">    jsonData(<span class="string">&quot;age&quot;</span>) = <span class="number">30</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; æ·»åŠ åµŒå¥—çš„å­—å…¸?è±¡</span></span><br><span class="line">    <span class="keyword">Dim</span> address <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">    <span class="keyword">Set</span> address = CreateObject(<span class="string">&quot;Scripting.Dictionary&quot;</span>)</span><br><span class="line">    address(<span class="string">&quot;city&quot;</span>) = <span class="string">&quot;New York&quot;</span></span><br><span class="line">    address(<span class="string">&quot;country&quot;</span>) = <span class="string">&quot;USA&quot;</span></span><br><span class="line">    <span class="keyword">Set</span> jsonData(<span class="string">&quot;address&quot;</span>) = address</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ???å€¼?</span></span><br><span class="line">    Debug.Print <span class="string">&quot;Name: &quot;</span> &amp; jsonData(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    Debug.Print <span class="string">&quot;Age: &quot;</span> &amp; jsonData(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">    Debug.Print <span class="string">&quot;City: &quot;</span> &amp; jsonData(<span class="string">&quot;address&quot;</span>)(<span class="string">&quot;city&quot;</span>)</span><br><span class="line">    Debug.Print <span class="string">&quot;Country: &quot;</span> &amp; jsonData(<span class="string">&quot;address&quot;</span>)(<span class="string">&quot;country&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p><a
href="https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas">VBA-JSON
åƒè€ƒ</a></p>
<h2 id="ç¸½çµ">ç¸½çµ</h2>
<ol type="1">
<li><strong>ä½¿ç”¨Streamlitå’ŒGoogle Sheets</strong>ï¼š
<ul>
<li>Streamlitèƒ½å¿«é€Ÿç”Ÿæˆå‰ç«¯ä»‹é¢ï¼Œå°ä¸ç†Ÿæ‚‰å‰ç«¯æŠ€è¡“çš„é–‹ç™¼è€…å‹å¥½ã€‚</li>
<li>Google Sheetsä½œç‚ºé›²ç«¯è³‡æ–™åº«ï¼ŒçµåˆGoogle Apps Script
(GAS)å¯¦ç¾è³‡æ–™æ“ä½œã€‚</li>
</ul></li>
<li><strong>JSONæ ¼å¼çš„å„ªå‹¢</strong>ï¼š
<ul>
<li>JSONæ˜¯APIè³‡æ–™äº¤æ›ä¸­å¸¸ç”¨çš„æ ¼å¼ï¼Œæ–¹ä¾¿è³‡æ–™å–ç”¨å’Œçµ„è£ã€‚</li>
<li>æ–‡ç« ä»‹ç´¹äº†åœ¨Pythonå’ŒGASä¸­å¦‚ä½•é€²è¡ŒJSONè³‡æ–™çš„è§£æå’Œç”Ÿæˆã€‚</li>
</ul></li>
<li><strong>å¤šå±¤è³‡æ–™çµæ§‹è™•ç†æŠ€è¡“</strong>ï¼š
<ul>
<li>ä½¿ç”¨æ‰å¹³åŒ–å’Œåæ‰å¹³åŒ–æŠ€è¡“ï¼Œæ–¹ä¾¿è™•ç†å’Œé‚„åŸå¤šå±¤åµŒå¥—çš„è³‡æ–™çµæ§‹ã€‚</li>
<li>æä¾›äº†Pythonå’ŒGASä¸­è™•ç†å¤šå±¤è³‡æ–™çµæ§‹çš„ç¯„ä¾‹ã€‚</li>
</ul></li>
<li><strong>å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹</strong>ï¼š
<ul>
<li>å±•ç¤ºäº†å¦‚ä½•åœ¨Streamlitæ‡‰ç”¨ä¸­å°‡è³‡æ–™è½‰æ›ç‚ºJSONæ ¼å¼ï¼Œä¸¦é€šéHTTP
POSTè«‹æ±‚ç™¼é€åˆ°GASå¾Œç«¯ã€‚</li>
<li>åœ¨GASå¾Œç«¯æ¥æ”¶ä¸¦è§£æJSONè³‡æ–™ï¼Œå°‡å…¶å¯«å…¥Google Sheetsçš„å…·é«”æ­¥é©Ÿã€‚</li>
</ul></li>
<li><strong>Pythonå’ŒGASä¸­çš„JSONæ“ä½œæ–¹æ³•</strong>ï¼š
<ul>
<li>è©³è¿°äº†åœ¨Pythonä¸­ä½¿ç”¨<code>json.dumps()</code>å’Œ<code>json.loads()</code>é€²è¡ŒJSONæ ¼å¼è½‰æ›ã€‚</li>
<li>èªªæ˜äº†åœ¨GASä¸­ä½¿ç”¨<code>JSON.stringify()</code>å’Œ<code>JSON.parse()</code>è™•ç†JSONè³‡æ–™ã€‚</li>
</ul></li>
</ol>
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
        <tag>GAS</tag>
      </tags>
  </entry>
  <entry>
    <title>VBAæ©«æ–·é¢æ³•é¢ç©æ‰¹æ¬¡è™•ç†</title>
    <url>/posts/2533511128/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>å·¥ç¨‹ç‰¹æ€§å¦‚ç‚ºå¸¶ç‹€å·¥ç¨‹ï¼Œæ¯”å¦‚:æ°´æºã€é“è·¯ç­‰ç­‰ï¼Œé€šå¸¸æœƒä»¥æ©«æ–·é¢æ³•ä½œç‚ºåœŸæ–¹è¨ˆç®—çš„æ•¸é‡ä¾æ“šï¼Œæ­¤æŒ‡åœŸæ–¹è¨ˆç®—ä¸å¤–ä¹ç‚º:æŒ–æ–¹ã€å¡«æ–¹ã€å›å¡«æ–¹ã€CLSMä¹‹é¡ã€‚</p>
<p>åœ¨ç¹ªè£½åœŸæ–¹åŸºæœ¬è³‡æ–™æ™‚ï¼Œé¢ç©çš„æ¡†é¸ä¾¿æœƒæ˜¯æ±ºå®šæ•¸é‡å¾ˆé‡è¦çš„éƒ¨åˆ†ï¼Œå¯¦å‹™ä¸Šçš„åœŸæ–¹è¨ˆç®—æµç¨‹ç‚º:</p>
<p>åœ–å±¤è¨­å®š:</p>
<ul>
<li>åŸåœ°é¢ç·š</li>
<li>çµæ§‹ç·š</li>
<li>é–‹æŒ–ç·š</li>
<li>å¡«æ–¹ç·š</li>
<li>é–‹æŒ–é¢ç©</li>
<li>æŒ–æ–¹é¢ç©</li>
</ul>
<ol type="1">
<li>ç¹ªè£½æŒ–æ–¹é¢ç©æ™‚ï¼Œå°‡åŸåœ°é¢ç·šèˆ‡é–‹æŒ–ç·šéš”é›¢é¡¯ç¤ºï¼Œé€éBOæˆ–HATCHç”Ÿæˆé¢ç©</li>
<li>ç¹ªè£½å¡«æ–¹é¢ç©æ™‚ï¼Œå°‡å›å¡«ç·šã€çµæ§‹ç·šã€é–‹æŒ–ç·šéš”é›¢é¡¯ç¤ºï¼Œé€éBOæˆ–HATCHç”Ÿæˆé¢ç©</li>
</ol>
<blockquote>
<p>å°é–‰èšåˆç·š</p>
</blockquote>
<p>CADå…§å»ºæŒ‡ä»¤'BO'æœƒå‡ºç¾ä¸€å¼µä»‹é¢ï¼Œå¯ä»¥è—‰ç”±é»é¸å…§éƒ¨é»ç”Ÿæˆå°é–‰èšåˆç·šï¼ŒæŒ‡ä»¤'-BO'å‰‡å¯ä»¥ç•¥éä»‹é¢çš„ç¨‹åºç›´æ¥é»é¸ï¼Œæ­¤æ™‚å°é–‰èšåˆç·šæœƒæœ‰'é¢ç©'å±¬æ€§ã€‚</p>
<blockquote>
<p>å¡«å……ç·š</p>
</blockquote>
<p>CADå…§å»ºæŒ‡ä»¤'HATCH'å¯ä»¥é»é¸å…§éƒ¨é»ç”Ÿæˆå¡«å……ç·šï¼Œæ­¤æ™‚å¡«å……ç·šæœƒæœ‰'é¢ç©'å±¬æ€§ï¼Œé ˆæ³¨æ„ä¹‹å‰æ¸¬è©¦é<strong>HATCHå¯èƒ½æœƒæœ‰äº›è¨±çš„èª¤å·®</strong>ï¼Œé€™å€‹ä¹Ÿä¸æ¸…æ¥šåŸå› ç‚ºä½•...</p>
<span id="more"></span>
<h2 id="vbaæ‰¹æ¬¡è™•ç†æµç¨‹">VBAæ‰¹æ¬¡è™•ç†æµç¨‹</h2>
<p>æ­£å¸¸çš„ä½œæ¥­æµç¨‹æœƒå°‡æ¯ä¸€å€‹æ¨è™Ÿåº•ä¸‹çš„é¢ç©é€ç­†ç´€éŒ„ä½œåŠ ç¸½ï¼Œç®—å®Œçš„æ•¸æ“šæœƒä¿®æ”¹åˆ°æ©«æ–·é¢ä¸Šæ‰€è¨˜è¼‰çš„æŒ–æ–¹é¢ç©æ•¸å­—ã€å¡«æ–¹é¢ç©æ•¸å­—ï¼Œå¾ŒçºŒå†å°‡é€™äº›æ•¸å­—å¡«å ±åˆ°åœŸæ–¹è¨ˆç®—è¡¨ï¼Œç¨æœ‰æç¥å‰‡å®¹æ˜“å‡ºéŒ¯ï¼Œä¹Ÿå› æ­¤è‹¥é€™äº›å…§å®¹éƒ½å¯ä»¥ç”¨CADä¸­å°æ‡‰åœ–å…ƒçš„é¢ç©å±¬æ€§é€²è¡Œè™•ç†ï¼Œä¸¦ä¸”å°‡è³‡æ–™å‚³è¼¸åˆ°åœŸæ–¹è¨ˆç®—è¡¨åŠå›æ­¸åˆ°åœ–é¢ä¿®è¨‚è¨˜è¼‰æ•¸å­—ï¼Œé€™æœƒè®“æ•´å€‹åœŸæ–¹è¨ˆç®—ä½œæ¥­ç°¡å–®å¾ˆå¤šã€‚</p>
<blockquote>
<p>ç›®æ¨™ç‚ºå¸Œæœ›èƒ½å¤ æ¡†é¸ä¸€æ¬¡ç¯„åœï¼Œå°±å°‡æ‰€æœ‰çš„é¢ç©è¨ˆç®—å®Œç•¢ä¸¦ä¸”æ”¾ç½®æ–¼å°æ‡‰çš„æ¨è™Ÿï¼Œçœä¸‹ä½œæ¥­æ™‚é–“!!!</p>
</blockquote>
<p>è¦å°‡åœ–é¢é€²è¡Œæ‰¹æ¬¡è™•ç†æ™‚ï¼Œæœƒéœ€è¦é€²è¡Œä¸‹åˆ—æ­¥é©Ÿæ­é…VBAåŸ·è¡Œä¾¿èƒ½é †åˆ©å®Œæˆ</p>
<h3 id="ä¸»è¦ä»‹é¢">ä¸»è¦ä»‹é¢</h3>
<figure>
<img src="upload_0667e12aec332c0df8989682a27406ac.png"
alt="æ©«æ–·é¢åœ–ç¯„ä¾‹" />
<figcaption aria-hidden="true">æ©«æ–·é¢åœ–ç¯„ä¾‹</figcaption>
</figure>
<figure>
<img src="upload_600f965523bfbad7cbb664384cbd23e1.png"
alt="è³‡æ–™åº«ä»‹é¢" />
<figcaption aria-hidden="true">è³‡æ–™åº«ä»‹é¢</figcaption>
</figure>
<h3 id="å»ºç«‹æ¨è™Ÿå¤–æ¡†">å»ºç«‹æ¨è™Ÿå¤–æ¡†</h3>
<p>æ¯ä¸€å€‹æ©«æ–·é¢åœ–éƒ½æœƒæœ‰å®ƒæ‰€ä»£è¡¨çš„æ¨è™Ÿåç¨±åŠæ©«æ–·é¢åœ–ç¯„åœ(æ­¤è™•æ˜¯æŒ‡BORDERæ¬„ä½)ï¼Œå°‡å¤–æ¡†å®Œæˆä¹‹å¾Œåšé©ç•¶çš„æ”¾å¤§ç¸®å°ï¼Œç›®æ¨™æ˜¯è®“æ‰€æœ‰èˆ‡è©²æ¨è™Ÿç›¸é—œçš„åœŸæ–¹é¢ç©'å½¢å¿ƒ'éƒ½èƒ½è¢«å®Œæ•´åŒ…è¦†åœ¨æ¡†æ¡†è£¡é¢ï¼Œå¾ŒçºŒè¦åˆ¤æ–·é¢ç©æ­¸å±¬æ™‚å¯ä»¥é †åˆ©åŸ·è¡Œã€‚</p>
<h3 id="é»é¸é¢ç©">é»é¸é¢ç©</h3>
<p>é¢ç©éƒ¨åˆ†æœ‰å…©ç¨®å¯¦ä½œæ–¹å¼</p>
<ol type="1">
<li><p>å¦‚å‰è¨€æ‰€è¿°ç”¨ä¸åŒçš„åœ–å±¤ä¾†é å…ˆå®šç¾©é¢ç©æ­¸å±¬é …ç›®(æŒ–æ–¹ã€å¡«æ–¹)ä¸¦ä¸”é€éBOæˆ–HATCHä¾†é»æ“Š'å…§éƒ¨é»'ï¼Œä½†é€™æ¨£é‚„æ˜¯å…ä¸äº†æœƒæœ‰æ‰‹å‹•è™•ç†çš„éƒ¨åˆ†ã€‚</p></li>
<li><p>ç”¨å¹¾ä½•æ•¸å­¸æ–¹æ³•ä¾†è™•ç†ï¼ŒåŸåœ°é¢ç·šæ˜¯f(x)ï¼Œé–‹æŒ–ç·šæ˜¯g(x)ï¼Œé–‹æŒ–ç·šå…ˆå°‡å…©ç«¯ç”¨CADä¸­çš„IntersectWithåšå»¶ä¼¸å¾Œï¼Œåœ¨ç”¨f(x)èˆ‡g(x)çš„å¹¾ä½•é—œä¿‚è¨ˆç®—é¢ç©ï¼Œç›¸é—œVBAç¨‹å¼ç¢¼å¯¦ä½œå¦‚ä¸‹:</p></li>
</ol>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="comment">&#x27;===Main Function===</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> plotDigLine(<span class="keyword">ByVal</span> EG <span class="keyword">As</span> <span class="type">Object</span>, <span class="keyword">ByVal</span> EGVertices)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> IsIntersect <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> CAD.GetBoundingBox(buttomCONC, MinX, MinY, MaxX, MaxY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> vertices(<span class="number">4</span> * <span class="number">2</span> - <span class="number">1</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">vertices(<span class="number">0</span>) = MinX - <span class="number">300</span> - <span class="number">30</span></span><br><span class="line">vertices(<span class="number">1</span>) = MinY + <span class="number">100</span></span><br><span class="line">vertices(<span class="number">2</span>) = MinX - <span class="number">300</span></span><br><span class="line">vertices(<span class="number">3</span>) = MinY</span><br><span class="line">vertices(<span class="number">4</span>) = MaxX + <span class="number">300</span></span><br><span class="line">vertices(<span class="number">5</span>) = MinY</span><br><span class="line">vertices(<span class="number">6</span>) = MaxX + <span class="number">300</span> + <span class="number">30</span></span><br><span class="line">vertices(<span class="number">7</span>) = MinY + <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> DL = CAD.AddLWPolyLine(vertices)</span><br><span class="line"><span class="keyword">Call</span> CAD.setLayer(DL, <span class="string">&quot;CAL&quot;</span>)</span><br><span class="line"><span class="comment">&#x27;DL.Layer = &quot;CAL&quot; &#x27; &quot;æ©«æ–·é¢-æŒ–æ–¹ç·š&quot;</span></span><br><span class="line"></span><br><span class="line">retpt = myFunc.SortPTArray(CAD.IntersectWith(DL, EG, <span class="number">1</span>, IsIntersect))</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> IsIntersect = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line">vertices(<span class="number">0</span>) = retpt(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">vertices(<span class="number">1</span>) = retpt(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">vertices(<span class="number">6</span>) = retpt(UBound(retpt, <span class="number">1</span>), <span class="number">0</span>) <span class="comment">&#x27;- 3 + 1)</span></span><br><span class="line">vertices(<span class="number">7</span>) = retpt(UBound(retpt, <span class="number">1</span>), <span class="number">1</span>) <span class="comment">&#x27;- 3 + 2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;========ä»¥é‚Šç•Œç‚ºåŸºæº–================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;vertices(0) = EGVertices(0)</span></span><br><span class="line"><span class="comment">&#x27;vertices(1) = EGVertices(1)</span></span><br><span class="line"><span class="comment">&#x27;vertices(6) = EGVertices(UBound(EGVertices) - 1)</span></span><br><span class="line"><span class="comment">&#x27;vertices(7) = EGVertices(UBound(EGVertices))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;====================================</span></span><br><span class="line"></span><br><span class="line">DL.Delete</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> DL2 = CAD.AddLWPolyLine(vertices)</span><br><span class="line"></span><br><span class="line">DL2.Layer = <span class="string">&quot;CAL&quot;</span> <span class="comment">&#x27;&quot;æ©«æ–·é¢-æŒ–æ–¹ç·š&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;============åŒ¯å…¥æŒ–æ–¹é¢ç©==================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> stoneObj <span class="keyword">As</span> <span class="built_in">New</span> clsStone</span><br><span class="line"></span><br><span class="line">DLArea = stoneObj.getDLArea(EG, DL2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Sheets(<span class="string">&quot;ä¸­å¿ƒç·š&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> rng = .Columns(<span class="number">1</span>).Find(loc)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> <span class="built_in">Not</span> rng <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">    r = rng.Row</span><br><span class="line">    .Cells(r, <span class="number">5</span>) = DLArea</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;====clsCAD===</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> IntersectWith(<span class="keyword">ByVal</span> PL1, <span class="keyword">ByVal</span> PL2, <span class="keyword">ByVal</span> mode <span class="keyword">As</span> <span class="type">Byte</span>, <span class="keyword">ByRef</span> IsIntersect <span class="keyword">As</span> <span class="type">Boolean</span>)</span><br><span class="line"></span><br><span class="line">IsIntersect = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> coll <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> ERRORHANDLE <span class="comment">&#x27;20210901 éŒ¯èª¤åµæ¸¬</span></span><br><span class="line">    <span class="keyword">Set</span> retpt = PL1.IntersectWith(PL2, mode) <span class="comment">&#x27;acExtendThisEntity)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> retpt</span><br><span class="line">    </span><br><span class="line">        coll.Add it.x</span><br><span class="line">        coll.Add it.y</span><br><span class="line">        coll.Add it.Z</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> coll <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line"><span class="symbol">ERRORHANDLE:</span></span><br><span class="line">        <span class="comment">&#x27;intersectWith = &quot;EMPTY&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        IntersectWith = myFunc.tranColl2Array(coll)</span><br><span class="line">        IsIntersect = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"></span><br><span class="line">    retpt = PL1.IntersectWith(PL2, mode) <span class="comment">&#x27;acExtendThisEntity)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> UBound(retpt) = -<span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line">       <span class="comment">&#x27; IntersectWith = &quot;EMPTY&quot;</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        IntersectWith = retpt</span><br><span class="line">        IsIntersect = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;====clsStone===</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;<span class="doctag">TODO:</span></span></span><br><span class="line"><span class="comment">&#x27;1.sort X coordinate</span></span><br><span class="line"><span class="comment">&#x27;2.define border</span></span><br><span class="line"><span class="comment">&#x27;3.decide X-value</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getDLArea(<span class="keyword">ByVal</span> EG, <span class="keyword">ByVal</span> DL)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> PLobj1 = RevisePL(EG)</span><br><span class="line">EG.Delete</span><br><span class="line"></span><br><span class="line">PL1_X = myFunc.tranColl2Array(getcoll(PLobj1, <span class="string">&quot;X&quot;</span>))</span><br><span class="line">PL1_Y = myFunc.tranColl2Array(getcoll(PLobj1, <span class="string">&quot;Y&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> PLobj2 = RevisePL(DL)</span><br><span class="line">DL.Delete</span><br><span class="line"></span><br><span class="line">PL2_X = myFunc.tranColl2Array(getcoll(PLobj2, <span class="string">&quot;X&quot;</span>))</span><br><span class="line">PL2_Y = myFunc.tranColl2Array(getcoll(PLobj2, <span class="string">&quot;Y&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> defineBorder(PL1_X, PL2_X, BL, BR)</span><br><span class="line"></span><br><span class="line">getDLArea = calculateArea_test(PL1_X, PL1_Y, PL2_X, PL2_Y, BL, BR)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> RevisePL(<span class="keyword">ByVal</span> PLobj) <span class="comment">&#x27;ç”±å·¦è‡³å³æ’åº</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> coll <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">co = <span class="number">3</span></span><br><span class="line"><span class="keyword">If</span> TypeName(PLobj) <span class="built_in">Like</span> <span class="string">&quot;*LWPolyline&quot;</span> <span class="keyword">Then</span> co = <span class="number">2</span>  <span class="comment">&#x27;IIcadLightWeightPolyline</span></span><br><span class="line"></span><br><span class="line">arr = CAD.tranIPoints(PLobj.coordinates)</span><br><span class="line"></span><br><span class="line">Debug.Print TypeName(PLobj)</span><br><span class="line"></span><br><span class="line">X1 = arr(<span class="number">0</span>)</span><br><span class="line">Xn = arr(UBound(arr) - co + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> X1 &gt; Xn <span class="keyword">Then</span></span><br><span class="line">    <span class="keyword">Set</span> RevisePL = CAD.ReverseLine(<span class="keyword">ByVal</span> PLobj)</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    <span class="keyword">Set</span> RevisePL = PLobj</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(arr) - co <span class="keyword">Step</span> co</span><br><span class="line"></span><br><span class="line">    X1 = arr(i)</span><br><span class="line">    X2 = arr(i + co)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> X1 = X2 <span class="keyword">Then</span> arr(i + co) = arr(i + co) + <span class="number">0.001</span> <span class="comment">&#x27;è‹¥ç‚ºå‚ç›´å‰‡å¾®èª¿å¾€å³åç§»</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> RevisePL = CAD.AddLWPolyLine(arr)</span><br><span class="line">RevisePL.Layer = PLobj.Layer</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> calculateArea_test(<span class="keyword">ByVal</span> PL1_X, <span class="keyword">ByVal</span> PL1_Y, <span class="keyword">ByVal</span> PL2_X, <span class="keyword">ByVal</span> PL2_Y, <span class="keyword">ByVal</span> BL, <span class="keyword">ByVal</span> BR)</span><br><span class="line"></span><br><span class="line">X_sort = myFunc.BubbleSort_array(myFunc.combineArray(PL1_X, PL2_X))</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> i = LBound(X_sort) <span class="keyword">To</span> UBound(X_sort) - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    X1 = X_sort(i)</span><br><span class="line">    X2 = X_sort(i + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    dx = X2 - X1</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> X1 &gt;= BL <span class="built_in">And</span> X2 &lt;= BR <span class="keyword">Then</span></span><br><span class="line">        </span><br><span class="line">        Y1f = getYbyX(X1, PL1_X, PL1_Y)</span><br><span class="line">        Y2f = getYbyX(X1, PL2_X, PL2_Y)</span><br><span class="line">        </span><br><span class="line">        dYf = Y1f - Y2f</span><br><span class="line">        </span><br><span class="line">        Y1b = getYbyX(X2, PL1_X, PL1_Y)</span><br><span class="line">        Y2b = getYbyX(X2, PL2_X, PL2_Y)</span><br><span class="line">        </span><br><span class="line">        dYb = Y1b - Y2b</span><br><span class="line"></span><br><span class="line">        <span class="keyword">If</span> dYf &gt; <span class="number">0</span> <span class="built_in">And</span> dYb &lt; <span class="number">0</span> <span class="keyword">Then</span> <span class="comment">&#x27;èˆ‡åŸºæº–ç·šäº¤å‰(æ­£åˆ°è² )</span></span><br><span class="line">        </span><br><span class="line">            X_intersect = getIntersectX(X1, X2, Y1f, Y1b, Y2f, Y2b)</span><br><span class="line">            dA = dYf * (X_intersect - X1) / <span class="number">2</span></span><br><span class="line">            <span class="comment">&#x27;Set lineObj = CAD.AddLineCO(X1, Y1f, X1, Y2f)</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">ElseIf</span> dYf &lt; <span class="number">0</span> <span class="built_in">And</span> dYb &gt; <span class="number">0</span> <span class="keyword">Then</span> <span class="comment">&#x27;èˆ‡åŸºæº–ç·šäº¤å‰(è² åˆ°æ­£)</span></span><br><span class="line">        </span><br><span class="line">            X_intersect = getIntersectX(X1, X2, Y1f, Y1b, Y2f, Y2b)</span><br><span class="line">            dA = dYb * (X2 - X_intersect) / <span class="number">2</span></span><br><span class="line">            <span class="comment">&#x27;Set lineObj = CAD.AddLineCO(X2, Y1b, X2, Y2b)</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">ElseIf</span> dYf &gt;= <span class="number">0</span> <span class="built_in">And</span> dYb &gt;= <span class="number">0</span> <span class="keyword">Then</span> <span class="comment">&#x27;çš†åœ¨åŸºæº–ç·šä¸‹æ–¹</span></span><br><span class="line">        </span><br><span class="line">            dA = (dYf + dYb) * dx / <span class="number">2</span></span><br><span class="line">            <span class="comment">&#x27;Set lineObj = CAD.AddLineCO(X1, Y1f, X1, Y2f)</span></span><br><span class="line">            <span class="comment">&#x27;Set lineObj = CAD.AddLineCO(X2, Y1b, X2, Y2b)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            dA = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;Debug.Print &quot;dYf=&quot; &amp; dYf &amp; &quot;,dYb=&quot; &amp; dYb &amp; &quot;,dA=&quot; &amp; dA</span></span><br><span class="line">        sA = sA + dA</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">calculateArea_test = Round(sA / <span class="number">1000000</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getIntersectX(<span class="keyword">ByVal</span> X1 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> X2 <span class="keyword">As</span> <span class="type">Double</span>, _</span><br><span class="line">                        <span class="keyword">ByVal</span> Y1f <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> Y1b <span class="keyword">As</span> <span class="type">Double</span>, _</span><br><span class="line">                        <span class="keyword">ByVal</span> Y2f <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> Y2b <span class="keyword">As</span> <span class="type">Double</span>)</span><br><span class="line"></span><br><span class="line">dx = X2 - X1</span><br><span class="line"></span><br><span class="line">y1_slope = (Y1b - Y1f) / dx</span><br><span class="line">y2_slope = (Y2b - Y2f) / dx</span><br><span class="line"></span><br><span class="line">slope_change = Abs(y1_slope - y2_slope)</span><br><span class="line">dY_f = Abs(Y1f - Y2f)</span><br><span class="line"></span><br><span class="line">getIntersectX = X1 + dY_f / slope_change</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getYbyX(<span class="keyword">ByVal</span> x <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> PL_X, <span class="keyword">ByVal</span> PL_Y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> i = LBound(PL_X) <span class="keyword">To</span> UBound(PL_X) - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    X1 = PL_X(i)</span><br><span class="line">    X2 = PL_X(i + <span class="number">1</span>)</span><br><span class="line">    Y1 = PL_Y(i)</span><br><span class="line">    Y2 = PL_Y(i + <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> X1 = X2 <span class="keyword">Then</span> X2 = X2 + <span class="number">0.001</span>: <span class="keyword">Stop</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> x &gt;= X1 <span class="built_in">And</span> x &lt;= X2 <span class="keyword">Then</span></span><br><span class="line">        </span><br><span class="line">        s1 = x - X1</span><br><span class="line">        s2 = X2 - x</span><br><span class="line">        getYbyX = (s1 * Y2 + s2 * Y1) / (s1 + s2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">      </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ¤æ–·é¢ç©æ­¸å±¬">åˆ¤æ–·é¢ç©æ­¸å±¬</h3>
<p>é¢ç©æ­¸å±¬çš„åˆ¤å®šæ–¹æ³•ç‚ºè©²å°é–‰èšåˆç·šçš„å½¢å¿ƒé»æˆ–å¡«å……ç·šçš„å½¢å¿ƒé»ä½æ–¼å“ªå€‹æ¨è™Ÿå¤–æ¡†ä¸­ï¼Œåˆ¤å®šå±¬æ–¼å“ªå€‹å¤–æ¡†å¾Œå–å‡ºé¢ç©ä¸¦åšæŒ–æ–¹åŠ ç¸½æˆ–å¡«æ–¹åŠ ç¸½(çœ‹å–å‡ºçš„åœ–å±¤æ˜¯å“ªä¸€ç¨®)ï¼Œé—œæ–¼é»èˆ‡å¤–æ¡†çš„ä½ç½®åˆ¤å®šé—œä¿‚è«‹åƒè€ƒä¸‹åˆ—ç¨‹å¼ç¢¼:</p>
<p>æ­¤è™•ç¯„ä¾‹æ˜¯ç”¨HATCHçš„é¢ç©å–å‡ºå…¶å€¼ï¼ŒssetAreaså…ˆåšå¥½Hatchçš„ç¯©é¸æ‰é€²è¡Œå¾ŒçºŒå…§å®¹ï¼Œæœ‰éœ€è¦è€…å¯ä»¥æ”¹ç”¨polyline</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> CalcCABA() <span class="comment">&#x27;20210720 update</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> ssetAreas = CAD.CreateSSET(<span class="string">&quot;HA&quot;</span>, <span class="string">&quot;0&quot;</span>, <span class="string">&quot;Hatch&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> ssetArea <span class="keyword">In</span> ssetAreas</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;<span class="doctag">TODO:</span></span></span><br><span class="line">    <span class="comment">&#x27;1.getMidPoint</span></span><br><span class="line">    <span class="comment">&#x27;2.searchLoc</span></span><br><span class="line">    <span class="comment">&#x27;3.getAreaCol</span></span><br><span class="line">    <span class="comment">&#x27;4.keyinArea</span></span><br><span class="line">    </span><br><span class="line">    r = getRowFromBorder(ssetArea)</span><br><span class="line">    c = getColFromLayerName(ssetArea)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> r &lt;&gt; <span class="string">&quot;&quot;</span> <span class="built_in">And</span> c &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> shtCL.Cells(r, c) = ssetArea.area / <span class="number">1000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getColFromLayerName(<span class="keyword">ByVal</span> ha)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> shtCL</span><br><span class="line"></span><br><span class="line">    CD = ha.Layer <span class="comment">&#x27;æ©«æ–·é¢-æŒ–æ–¹</span></span><br><span class="line">    </span><br><span class="line">    targetColName = Split(CD, <span class="string">&quot;-&quot;</span>)(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rng = .Rows(<span class="number">2</span>).Find(targetColName)</span><br><span class="line">    </span><br><span class="line">    getColFromLayerName = rng.Column</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getRowFromBorder(<span class="keyword">ByVal</span> ha)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Call</span> CAD.GetBoundingBox(ha, MinX, MinY, MaxX, MaxY)</span><br><span class="line">    midX = (MinX + MaxX) / <span class="number">2</span></span><br><span class="line">    midY = (MinY + MaxY) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">With</span> shtCL</span><br><span class="line"></span><br><span class="line">        lr = .Cells(.Rows.Count, <span class="number">1</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">For</span> r = <span class="number">3</span> <span class="keyword">To</span> lr</span><br><span class="line">        </span><br><span class="line">            BorderPTs = Split(.Cells(r, <span class="number">3</span>), <span class="string">&quot;,&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">If</span> UBound(BorderPTs) = <span class="number">3</span> <span class="keyword">Then</span></span><br><span class="line">        </span><br><span class="line">                Border_minX = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">0</span>))</span><br><span class="line">                Border_minY = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">1</span>))</span><br><span class="line">                Border_maxX = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">2</span>))</span><br><span class="line">                Border_maxY = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">3</span>))</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">If</span> midX &gt;= Border_minX <span class="built_in">And</span> midX &lt;= Border_maxX <span class="built_in">And</span> midY &gt;= Border_minY <span class="built_in">And</span> midY &lt;= Border_maxY <span class="keyword">Then</span></span><br><span class="line">                    </span><br><span class="line">                    getRowFromBorder = r</span><br><span class="line">                    <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="æ•¸æ“šå›æ­¸åœ–é¢">æ•¸æ“šå›æ­¸åœ–é¢</h3>
<p>æˆ‘é€™è£¡æ˜¯æ¡ç”¨å±¬æ€§åœ–å¡Šæ–¹å¼è™•ç†ï¼Œå¦‚æœä¸è¦é‚£éº¼éº»ç…©ä¹Ÿå¯ä»¥ç”¨æœ€ç°¡å–®çš„textåˆ¤å®šæ¨è™Ÿçš„å½¢å¿ƒä½ç½®å¾Œï¼Œåšç›¸å°æ–‡å­—åç§»ä¸¦ä¸”åŠ å…¥æŒ–æ–¹å¡«æ–¹é¢ç©æ–‡å­—å°±å¯ä»¥äº†ï¼Œé€™æ¨£å¯ä»¥æœ‰æ•ˆé¿å…æ²’æœ‰åœ–å¡Šçš„å•é¡Œã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DrawCABA_Main() <span class="comment">&#x27;å°‡æ©«æ–·é¢èªªæ˜çš„CLã€CAã€BAåˆªé™¤å¾Œé‡æ•´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> sset = CAD.CreateSSET(<span class="string">&quot;Title&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;TITLE&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> sset</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">If</span> TypeName(it) = <span class="string">&quot;IAcadBlockReference&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">        myAttr = it.GetAttributes</span><br><span class="line">        HSecLoc = myAttr(<span class="number">0</span>).TextString</span><br><span class="line">        </span><br><span class="line">        s = returnCABA(HSecLoc)</span><br><span class="line">        </span><br><span class="line">        tmp = Split(s, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        myAttr(<span class="number">1</span>).TextString = tmp(<span class="number">0</span>)</span><br><span class="line">        myAttr(<span class="number">2</span>).TextString = <span class="string">&quot;æŒ–æ–¹=&quot;</span> &amp; Round(tmp(<span class="number">1</span>), <span class="number">2</span>) &amp; <span class="string">&quot; m2&quot;</span></span><br><span class="line">        myAttr(<span class="number">3</span>).TextString = <span class="string">&quot;å¡«æ–¹=&quot;</span> &amp; Round(tmp(<span class="number">2</span>), <span class="number">2</span>) &amp; <span class="string">&quot; m2&quot;</span></span><br><span class="line">        <span class="comment">&#x27;myAttr(4).TextString = &quot;CLSM=&quot; &amp; Round(tmp(3), 2) &amp; &quot; m2&quot;</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">ERRORHANDLE:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Function</span> returnCABA(<span class="keyword">ByVal</span> HSecLoc <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> shtCL</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> rng = .Cells.Find(HSecLoc)</span><br><span class="line">    </span><br><span class="line">    r = rng.Row</span><br><span class="line">    </span><br><span class="line">    deltaH = .Cells(r, <span class="number">2</span> + <span class="number">2</span>)</span><br><span class="line">    CA = .Cells(r, <span class="number">3</span> + <span class="number">2</span>)</span><br><span class="line">    BA = .Cells(r, <span class="number">4</span> + <span class="number">2</span>)</span><br><span class="line">    RA = .Cells(r, <span class="number">5</span> + <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    returnCABA = deltaH &amp; <span class="string">&quot;,&quot;</span> &amp; CA &amp; <span class="string">&quot;,&quot;</span> &amp; BA &amp; <span class="string">&quot;,&quot;</span> &amp; RA</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆå ±å‘Š">ç”Ÿæˆå ±å‘Š</h3>
<p>é€™è£¡å°±æ˜¯å–®ç´”çš„å°æ ¼å­å¡è³‡æ–™è¨ˆç®—ç¸½æ•¸è€Œå·²ï¼Œåƒ…æä¾›æˆæœä¾›åƒã€‚</p>
<figure>
<img src="upload_85c9fc6b507cc57c8285967bf25cd55b.png"
alt="åœŸæ–¹å ±å‘Šæˆæœ" />
<figcaption aria-hidden="true">åœŸæ–¹å ±å‘Šæˆæœ</figcaption>
</figure>
<h2 id="æ›´å¤šç´°ç¯€">æ›´å¤šç´°ç¯€</h2>
<p>æœ‰éœ€è¦æ›´å¤šæŠ€è¡“ç´°ç¯€å…§å®¹å†è«‹ä¾†ä¿¡è¨è«–æˆ–LINEé€²è¡Œè¯ç¹«ã€‚</p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>AutoCAD VBA</tag>
        <tag>Excel VBA</tag>
      </tags>
  </entry>
  <entry>
    <title>VBAç·¨è¼¯å™¨ä¸Šçš„ç‰ˆæœ¬æ§åˆ¶</title>
    <url>/posts/3829840047/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨æ’°å¯«ç¨‹å¼ç¢¼æ™‚ï¼Œè¨±å¤šäººç¿’æ…£å°‡ç¨‹å¼èˆ‡æª”æ¡ˆç¶å®šï¼Œä¸¦åˆ©ç”¨æ–‡ä»¶åç¨±ä¾†æ¨™è¨˜æ¯æ¬¡ç‰ˆæœ¬çš„ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼Œå°‡ç•¶å¤©æ—¥æœŸåŠ åœ¨æª”æ¡ˆåç¨±å¾Œä¾†å€éš”ç‰ˆæœ¬ï¼Œå¦‚
<code>ç¸±æ–·é¢ç¹ªåœ–20230622.xls</code>ã€‚é€™æ˜¯æˆ‘éå»å°<strong>ç‰ˆæœ¬æ§åˆ¶</strong>çš„ç†è§£ï¼Œç„¶è€Œï¼Œé€™æ¨£åšçš„å•é¡Œæ˜¯æª”æ¡ˆæ•¸é‡å¿«é€Ÿå¢é•·ï¼Œä¸”æª”æ¡ˆåç¨±ç„¡æ³•æ¸…æ¥šæ¨™ç¤ºæ¯æ¬¡ä¿®æ”¹çš„å…·é«”å…§å®¹ã€‚</p>
<p>æ›´ç³Ÿçš„æ˜¯ï¼Œç•¶é€™äº›æª”æ¡ˆåˆ†æ•£æ–¼ä¸åŒçš„é›»è…¦å’Œè³‡æ–™å¤¾ä¸­ï¼Œè‹¥åŒåçš„æª”æ¡ˆæœ‰æ‰€ä¸åŒï¼Œå»<strong>ç„¡æ³•å¾—çŸ¥å…·é«”æ”¹å‹•äº†å“ªäº›éƒ¨åˆ†</strong>ã€‚é€™æ¨£çš„ç®¡ç†æ–¹å¼æœƒé€ æˆå¾ˆå¤§çš„å›°æ“¾ï¼Œä¹Ÿä¿ƒä½¿æˆ‘é–‹å§‹å°‹æ‰¾æ›´æœ‰æ•ˆçš„ç‰ˆæœ¬æ§åˆ¶æ–¹æ³•ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘é–‹å§‹æ¢ç´¢å¦‚ä½•åœ¨ VBA ä¸­å¯¦ç¾ã€ŒçœŸã€ç‰ˆæœ¬æ§åˆ¶ï¼Œä¸¦çµåˆ
<strong>Git</strong> ä¾†ç®¡ç†ç¨‹å¼ç¢¼ã€‚</p>
<h2 id="æ›´æ–°è¨»è¨˜-20240519">æ›´æ–°è¨»è¨˜ (2024/05/19)</h2>
<p>ç•¶æˆ‘å°‡ç¨‹å¼ä¸Šå‚³è‡³ GitHub æ™‚ï¼Œç™¼ç¾å› ç‚ºç­†è¨˜æœ¬çš„é è¨­ç·¨ç¢¼ç‚º
"ANSI"ï¼Œä¸Šå‚³çš„ä¸­æ–‡éƒ¨åˆ†æœƒé¡¯ç¤ºç‚ºäº‚ç¢¼ã€‚ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œæˆ‘å°‡ç·¨ç¢¼å¦å­˜ç‚º
"UTF-8"ï¼Œé€™æ¨£å¯ä»¥æ­£å¸¸é¡¯ç¤ºã€‚ä½†æ˜¯ï¼Œè‹¥å°‡ "UTF-8" ç·¨ç¢¼åŒ¯å…¥ Excel VBA IDE
æ™‚ï¼Œç”±æ–¼ Excel é è¨­æ”¯æ´ ANSI ç·¨ç¢¼ï¼Œä¸­æ–‡æœƒå‡ºç¾éŒ¯èª¤ã€‚</p>
<span id="more"></span>
<h2 id="ç·¨è¼¯å™¨é–‹ç™¼ç’°å¢ƒ">ç·¨è¼¯å™¨é–‹ç™¼ç’°å¢ƒ</h2>
<p>åœ¨æ’°å¯« VBA ç¨‹å¼ç¢¼æ™‚ï¼Œä¸»è¦æœƒæœ‰ä»¥ä¸‹å¹¾å€‹å€åŸŸä¾†æ”¾ç½®ç¨‹å¼ç¢¼ï¼š</p>
<ul>
<li>Excel ç‰©ä»¶ï¼ˆå¦‚ ThisWorkbook, Worksheetï¼‰</li>
<li>æ¨¡çµ„ï¼ˆModuleï¼‰</li>
<li>ç‰©ä»¶é¡åˆ¥æ¨¡çµ„ï¼ˆClassï¼‰</li>
<li>è¡¨å–®ï¼ˆFormï¼‰</li>
</ul>
<p>åœ¨é€™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å‡è¨­ç¨‹å¼ç¢¼ä¸¦æœªç›´æ¥å¯«åœ¨ Worksheet
ä¸­ï¼Œå› ç‚ºé€™æ¨£çš„ç¨‹å¼ç¢¼æœƒå¸¶ä¾†è¨±å¤šåŒ¯å…¥ä¸Šçš„éº»ç…©ã€‚è€Œ <code>ThisWorkbook</code>
é›–ç„¶å±¬æ–¼ <code>doccls</code>
é¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä½†å…¶ä¸­å¯èƒ½æœƒæœ‰éœ€è¦æ‰‹å‹•è™•ç†çš„ç‰¹æ®Šæƒ…æ³ï¼Œé–‹ç™¼è€…éœ€æ ¹æ“šéœ€è¦è‡ªè¡Œè™•ç†é€™äº›å…§å®¹ã€‚</p>
<h2 id="git-åŸºæœ¬æ“ä½œ">GIT åŸºæœ¬æ“ä½œ</h2>
<p>å°æ–¼ GIT
çš„åŸºæœ¬æ“ä½œï¼Œç¶²è·¯ä¸Šæœ‰è¨±å¤šè³‡æºå¯ä»¥åƒè€ƒã€‚æ„Ÿè¬<strong>å…­è§’å­¸é™¢çš„Youtubeæ•™å­¸</strong>ã€‚</p>
<p>å¸¸è¦‹çš„ GIT æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li><code>git init</code>ï¼šåˆå§‹åŒ–è³‡æ–™å¤¾</li>
<li><code>git add</code>ï¼šå°‡æª”æ¡ˆåŠ å…¥ç´¢å¼•</li>
<li><code>git commit</code>ï¼šæäº¤ç‰ˆæœ¬è¨»è¨˜</li>
<li><code>git push</code>ï¼šå°‡ç¨‹å¼ç¢¼ä¸Šå‚³è‡³ GitHub</li>
<li><code>git clone</code>ï¼šå¾ GitHub ä¸‹è¼‰ç¨‹å¼ç¢¼</li>
<li><code>git fetch</code>ï¼šå¾ GitHub ä¸‹è¼‰ä¸¦æ›´æ–°è‡³æœ¬åœ°è³‡æ–™å¤¾</li>
<li><code>git checkout</code>ï¼šåˆ‡æ›åˆ†æ”¯æˆ–ç‰ˆæœ¬</li>
</ul>
<h2 id="æ“ä½œæ­¥é©Ÿ">æ“ä½œæ­¥é©Ÿ</h2>
<ol type="1">
<li><p><strong>å•Ÿç”¨ VBA è¨­å®š</strong>ï¼šåœ¨ Excel
ä¸­ï¼Œæ‰“é–‹ã€Œé–‹ç™¼è€…ã€é¸å–®ï¼Œä¸¦é¸æ“‡ã€Œä¿¡ä»»å­˜å– VBA å°ˆæ¡ˆç‰©ä»¶æ¨¡å‹ã€ã€‚</p></li>
<li><p><strong>åˆå§‹åŒ– Git</strong>ï¼šæ‰“é–‹ Git Bashï¼ŒæŒ‡å®šä¸€å€‹è³‡æ–™å¤¾ä¸¦åŸ·è¡Œ
<code>git init</code>ã€‚</p></li>
<li><p><strong>åŒ¯å…¥ Git æ¨¡çµ„</strong>ï¼šåœ¨ç›®å‰çš„ VBA IDE ä¸­åŒ¯å…¥
<code>GIT.bas</code> æ¨¡çµ„ã€‚</p></li>
<li><p><strong>å°å‡ºç¨‹å¼ç¢¼</strong>ï¼šåŸ·è¡Œå·¨é›†
<code>ExportCodesToFolder</code>ï¼Œä¸¦é¸æ“‡ç¬¬äºŒæ­¥ä¸­æŒ‡å®šçš„è³‡æ–™å¤¾ã€‚</p></li>
<li><p><strong>ç¢ºèªç‰ˆæœ¬</strong>ï¼šè‹¥ç¢ºå®šç„¡èª¤ï¼Œç¹¼çºŒä½¿ç”¨ Git
é€²è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚è‹¥æœ‰ä»»ä½•å•é¡Œï¼Œå›åˆ°ç¬¬ 4 æ­¥é‡æ–°æª¢æŸ¥ã€‚</p></li>
<li><p><strong>é€²è¡Œ Git æ“ä½œ</strong>ï¼šä½¿ç”¨ Git Bash é€²è¡Œ
<code>git add</code>ã€<code>git commit</code>ã€<code>git push</code>
ç­‰æ“ä½œã€‚</p></li>
</ol>
<h2 id="è™•ç†ç¨‹å¼ç¢¼ç‰ˆæœ¬å•é¡Œ">è™•ç†ç¨‹å¼ç¢¼ç‰ˆæœ¬å•é¡Œ</h2>
<p>è‹¥ç™¼ç¾é–‹å•Ÿç¨‹å¼ç¢¼å¾Œç™¼ç¾æœ‰å•é¡Œï¼Œå¯ä»¥åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š</p>
<ol type="1">
<li>åœ¨ VBA IDE ä¸­åŒ¯å…¥ GIT æ¨¡çµ„ã€‚</li>
<li>åŸ·è¡Œ <code>DeleteCodes</code> ä¾†åˆªé™¤èˆŠæœ‰çš„ç¨‹å¼ç¢¼ã€‚</li>
<li>åŸ·è¡Œ
<code>ImportCodes</code>ï¼Œä¸¦é¸æ“‡æŒ‡å®šçš„è³‡æ–™å¤¾ä¾†åŒ¯å…¥æœ€æ–°ç‰ˆæœ¬çš„ç¨‹å¼ç¢¼ã€‚</li>
</ol>
<h2 id="vba-ç¨‹å¼ç¢¼ç¯„ä¾‹">VBA ç¨‹å¼ç¢¼ç¯„ä¾‹</h2>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ Git æ§åˆ¶ VBA ç¨‹å¼ç¢¼ç‰ˆæœ¬çš„æ ¸å¿ƒç¨‹å¼ç¢¼ç¯„ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&#x27;TODO:Export folder need to be killed</span><br><span class="line"></span><br><span class="line">Sub ExportCodesToFolder()</span><br><span class="line"></span><br><span class="line">&#x27;Type: 1=bas,2=cls,3=frm</span><br><span class="line"></span><br><span class="line">myFolder = getSavedFolder</span><br><span class="line"></span><br><span class="line">Call killFilesInFolder(myFolder)</span><br><span class="line"></span><br><span class="line">Set VBProj = ThisWorkbook.VBProject</span><br><span class="line">For Each VBComp In VBProj.VBComponents</span><br><span class="line">    </span><br><span class="line">    Select Case VBComp.Type</span><br><span class="line">    </span><br><span class="line">        Case 1: myExtension = &quot;.bas&quot;</span><br><span class="line">        Case 2: myExtension = &quot;.cls&quot;</span><br><span class="line">        Case 3: myExtension = &quot;.frm&quot;</span><br><span class="line">        </span><br><span class="line">        Case 100: myExtension = &quot;.doccls&quot;</span><br><span class="line">    </span><br><span class="line">    End Select</span><br><span class="line">    </span><br><span class="line">    full_path = myFolder &amp; &quot;\&quot; &amp; VBComp.Name &amp; myExtension</span><br><span class="line">    </span><br><span class="line">    If myExtension &lt;&gt; &quot;&quot; Then</span><br><span class="line">    </span><br><span class="line">        VBComp.Export (full_path)</span><br><span class="line">    </span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">    If myExtension = &quot;.doccls&quot; And CountFileLines(full_path) = 9 Then Kill full_path</span><br><span class="line">    </span><br><span class="line">Next VBComp</span><br><span class="line">    </span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub killFilesInFolder(folderPath)</span><br><span class="line"></span><br><span class="line">Set coll_path = GetFilePathsInFolder(folderPath)</span><br><span class="line"></span><br><span class="line">For Each filePath In coll_path</span><br><span class="line"></span><br><span class="line">    Filename = mid(filePath, InStrRev(filePath, &quot;\&quot;) + 1)</span><br><span class="line">    fileExtension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)</span><br><span class="line">    </span><br><span class="line">    If fileExtension = &quot;frm&quot; Or fileExtension = &quot;bas&quot; Or fileExtension = &quot;cls&quot; Or fileExtension = &quot;doccls&quot; Then</span><br><span class="line">        Kill filePath</span><br><span class="line">    End If</span><br><span class="line">Next</span><br><span class="line"></span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub ImportCodes()</span><br><span class="line"></span><br><span class="line">myFolder = getSavedFolder</span><br><span class="line"></span><br><span class="line">Set coll_path = GetFilePathsInFolder(myFolder)</span><br><span class="line"></span><br><span class="line">Call DeleteCodes</span><br><span class="line"></span><br><span class="line">For Each filePath In coll_path</span><br><span class="line"></span><br><span class="line">    Filename = mid(filePath, InStrRev(filePath, &quot;\&quot;) + 1)</span><br><span class="line">    fileExtension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)</span><br><span class="line">    </span><br><span class="line">    If fileExtension = &quot;frm&quot; Or fileExtension = &quot;bas&quot; Or fileExtension = &quot;cls&quot; Then</span><br><span class="line">        Call ImportCode(filePath, Filename)</span><br><span class="line">    End If</span><br><span class="line"></span><br><span class="line">Next</span><br><span class="line"></span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub ImportCode(ByVal filePath As String, ByVal Filename As String)</span><br><span class="line"></span><br><span class="line">extension = mid(Filename, InStrRev(Filename, &quot;.&quot;) + 1)</span><br><span class="line">CodeName = mid(Filename, 1, InStrRev(Filename, &quot;.&quot;) - 1)</span><br><span class="line"></span><br><span class="line">If CodeName = &quot;GIT&quot; Then Exit Sub</span><br><span class="line"></span><br><span class="line">Set VBProj = ThisWorkbook.VBProject</span><br><span class="line"></span><br><span class="line">&#x27;If checkIfCodeExist(CodeName) = True Then</span><br><span class="line">&#x27;</span><br><span class="line">&#x27;    Set vbcomp = VBProj.VBComponents(CodeName)</span><br><span class="line">&#x27;    VBProj.VBComponents.Remove (vbcomp)</span><br><span class="line">&#x27;</span><br><span class="line">&#x27;End If</span><br><span class="line"></span><br><span class="line">VBProj.VBComponents.Import (filePath)</span><br><span class="line"></span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub DeleteCodes()</span><br><span class="line"></span><br><span class="line">&#x27;Type: 1=bas,2=cls,3=frm</span><br><span class="line"></span><br><span class="line">Set VBProj = ThisWorkbook.VBProject</span><br><span class="line">For Each VBComp In VBProj.VBComponents</span><br><span class="line">    </span><br><span class="line">    Select Case VBComp.Type</span><br><span class="line">    </span><br><span class="line">        Case 1: myExtension = &quot;.bas&quot;</span><br><span class="line">        Case 2: myExtension = &quot;.cls&quot;</span><br><span class="line">        Case 3: myExtension = &quot;.frm&quot;</span><br><span class="line">        </span><br><span class="line">        Case 100: myExtension = &quot;.doccls&quot;</span><br><span class="line">    </span><br><span class="line">    End Select</span><br><span class="line">    </span><br><span class="line">    If VBComp.Type &lt;&gt; 100 And VBComp.Name &lt;&gt; &quot;GIT&quot; Then</span><br><span class="line"></span><br><span class="line">        VBProj.VBComponents.Remove (VBComp)</span><br><span class="line">        </span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">Next VBComp</span><br><span class="line"></span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">&#x27;--------FUNCTION------------</span><br><span class="line"></span><br><span class="line">Function GetFilePathsInFolder(ByVal folderPath As String)</span><br><span class="line"></span><br><span class="line">    Dim coll As New Collection</span><br><span class="line"></span><br><span class="line">    Dim fso As Object</span><br><span class="line">    &#x27;Dim folderPath As String</span><br><span class="line">    Dim folder As Object</span><br><span class="line">    Dim file As Object</span><br><span class="line"></span><br><span class="line">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</span><br><span class="line"></span><br><span class="line">   &#x27; folderPath = getSavedFolder</span><br><span class="line">    Set folder = fso.GetFolder(folderPath)</span><br><span class="line">    </span><br><span class="line">    For Each file In folder.Files</span><br><span class="line"></span><br><span class="line">        coll.Add file.Path</span><br><span class="line">        </span><br><span class="line">    Next file</span><br><span class="line">    </span><br><span class="line">    Set file = Nothing</span><br><span class="line">    Set folder = Nothing</span><br><span class="line">    Set fso = Nothing</span><br><span class="line">    </span><br><span class="line">    Set GetFilePathsInFolder = coll</span><br><span class="line">    </span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function getSavedFolder()</span><br><span class="line"></span><br><span class="line">    Set fldr = Application.FileDialog(4)</span><br><span class="line">    </span><br><span class="line">    With fldr</span><br><span class="line">        .Title = &quot;Select a Folder&quot;</span><br><span class="line">        .AllowMultiSelect = False</span><br><span class="line">        .InitialFileName = ThisWorkbook.Path</span><br><span class="line">        If .Show = -1 Then FolderName = .SelectedItems(1)</span><br><span class="line">    End With</span><br><span class="line">getSavedFolder = FolderName</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function checkIfCodeExist(ByVal checkName As String) &#x27;useless</span><br><span class="line"></span><br><span class="line">Set VBProj = ThisWorkbook.VBProject</span><br><span class="line">Set VBComps = VBProj.VBComponents</span><br><span class="line"></span><br><span class="line">checkIfCodeExist = False</span><br><span class="line"></span><br><span class="line">For Each it In VBComps</span><br><span class="line"></span><br><span class="line">    If it.Name = checkName Then</span><br><span class="line">        </span><br><span class="line">        checkIfCodeExist = True: Exit Function</span><br><span class="line">        </span><br><span class="line">    End If</span><br><span class="line">Next</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">Function CountFileLines(ByVal filePath)</span><br><span class="line"></span><br><span class="line">    Dim FileContent As String</span><br><span class="line">    Dim fileNumber As Integer</span><br><span class="line">    Dim lineCount As Long</span><br><span class="line">    </span><br><span class="line">    &#x27; Open the text file</span><br><span class="line">    fileNumber = FreeFile</span><br><span class="line">    Open filePath For Input As fileNumber</span><br><span class="line">    </span><br><span class="line">    &#x27; Read the file content line by line and count the lines</span><br><span class="line">    Do Until EOF(fileNumber)</span><br><span class="line">        Line Input #fileNumber, FileContent</span><br><span class="line">        lineCount = lineCount + 1</span><br><span class="line">    Loop</span><br><span class="line">    </span><br><span class="line">    &#x27; Close the file</span><br><span class="line">    Close fileNumber</span><br><span class="line">    </span><br><span class="line">    &#x27; Display the line count in cell A1</span><br><span class="line">    CountFileLines = lineCount</span><br><span class="line">    </span><br><span class="line">End Function</span><br><span class="line"></span><br><span class="line">&#x27;--------TMP_CODE-------------</span><br><span class="line"></span><br><span class="line">Function tmp_deleteCodes()</span><br><span class="line"></span><br><span class="line">Set VBProj = ThisWorkbook.VBProject</span><br><span class="line">Set VBComps = VBProj.VBComponents</span><br><span class="line"></span><br><span class="line">For Each it In VBComps</span><br><span class="line">    </span><br><span class="line">    If it.Name Like &quot;*2&quot; And it.Type &lt;&gt; 100 Then</span><br><span class="line"></span><br><span class="line">        CodeName = it.Name</span><br><span class="line">        </span><br><span class="line">        Set VBComp = VBProj.VBComponents(CodeName)</span><br><span class="line">        VBProj.VBComponents.Remove (VBComp)</span><br><span class="line">        </span><br><span class="line">    End If</span><br><span class="line">    </span><br><span class="line">Next</span><br><span class="line"></span><br><span class="line">End Function</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºæœ¬åŸç†</category>
      </categories>
      <tags>
        <tag>GIT</tag>
        <tag>Github</tag>
      </tags>
  </entry>
  <entry>
    <title>openpyxlç…§ç‰‡è™•ç†ç­†è¨˜</title>
    <url>/posts/1384887565/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ç›®å‰åœ¨è™•ç†è¼¸å‡ºå ±è¡¨çš„å¯¦å‹™ä¸Šæœƒé‡åˆ°è¦è²¼ä¸Šç…§ç‰‡çš„å•é¡Œï¼Œæœ‰é—œpythonåœ¨è™•ç†Excelç…§ç‰‡éƒ¨åˆ†æœƒéœ€è¦é€éopenpyxlè£¡é¢ç›¸é—œçš„å¥—ä»¶é€²è¡Œï¼Œå¸Œæœ›èƒ½å¤ é”æˆä¸‹åˆ—æƒ…æ³:</p>
<p><strong>çµ¦å®šç…§ç‰‡ä¹‹å¾Œå¯ä»¥ä¾ç…§å„²å­˜æ ¼çš„ç¯„åœè²¼ä¸Šç…§ç‰‡ï¼Œå„²å­˜æ ¼å¯èƒ½æ˜¯å–®ä¸€å„²å­˜æ ¼æˆ–è€…æ˜¯åˆä½µå„²å­˜æ ¼ï¼Œæ‰¾å‡ºå„²å­˜æ ¼ç¯„åœå¯¬åº¦ã€å„²å­˜æ ¼ç¯„åœé«˜åº¦</strong></p>
<blockquote>
<p>æœ€é©åˆçš„æ–¹å¼è¨ˆç®—éç¨‹</p>
</blockquote>
<ul>
<li>ç…§ç‰‡å¯¬çš„ï¼Œæ¯”ä¾‹è¨­å®šç‚ºå„²å­˜æ ¼ç¯„åœå¯¬åº¦/ç…§ç‰‡å¯¬åº¦ï¼Œç…§ç‰‡é•·å¯¬åŒä¹˜ä¸Šé€™å€‹æ¯”ä¾‹æ”¾å¤§ç¸®å°</li>
<li>ç…§ç‰‡é•·çš„ï¼Œæ¯”ä¾‹è¨­å®šç‚ºå„²å­˜æ ¼ç¯„åœé«˜åº¦/ç…§ç‰‡é«˜åº¦ï¼Œç…§ç‰‡é•·å¯¬åŒä¹˜ä¸Šé€™å€‹æ¯”ä¾‹æ”¾å¤§ç¸®å°</li>
</ul>
<span id="more"></span>
<h2 id="ç…§ç‰‡è²¼ä¸Šæ–¹å¼">ç…§ç‰‡è²¼ä¸Šæ–¹å¼</h2>
<h3 id="è²¼åˆ°ä¸€å®šç¯„åœé–“">è²¼åˆ°ä¸€å®šç¯„åœé–“</h3>
<p>https://openpyxl.readthedocs.io/en/latest/_modules/openpyxl/drawing/spreadsheet_drawing.html#TwoCellAnchor</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line"><span class="keyword">from</span> openpyxl.drawing.image <span class="keyword">import</span> Image <span class="keyword">as</span> OpenpyxlImage</span><br><span class="line"><span class="keyword">from</span> openpyxl.drawing.spreadsheet_drawing <span class="keyword">import</span> AnchorMarker,TwoCellAnchor</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_merged_cell</span>(<span class="params">ws, col, row</span>):</span><br><span class="line">    <span class="keyword">for</span> merged_range <span class="keyword">in</span> ws.merged_cells.ranges:</span><br><span class="line">        <span class="keyword">if</span> ws.cell(row=row+<span class="number">1</span>, column=col+<span class="number">1</span>).coordinate <span class="keyword">in</span> merged_range:</span><br><span class="line">            <span class="keyword">return</span> merged_range</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">insert_image</span>(<span class="params">worksheet,img,target_row,target_col</span>):</span><br><span class="line"></span><br><span class="line">    col1,row1,col2,row2=(is_merged_cell(worksheet, target_col,target_row).bounds)</span><br><span class="line"></span><br><span class="line">    marker1=AnchorMarker(col=col1-<span class="number">1</span>, row=row1-<span class="number">1</span>)</span><br><span class="line">    marker2=AnchorMarker(col=col2, row=row2)</span><br><span class="line">    img.anchor = TwoCellAnchor(_<span class="keyword">from</span>=marker1, to=marker2)</span><br><span class="line">    worksheet.add_image(img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Streamlit application title</span></span><br><span class="line">st.title(<span class="string">&quot;Excel Image Insertion Tool&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># File upload</span></span><br><span class="line">uploaded_excel = st.file_uploader(<span class="string">&quot;Upload Excel file&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;xlsx&quot;</span>])</span><br><span class="line">uploaded_image = st.file_uploader(<span class="string">&quot;Upload image file&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;png&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>])</span><br><span class="line">uploaded_image2 = st.file_uploader(<span class="string">&quot;Upload image file2&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;png&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Input for sheet name and cell location</span></span><br><span class="line">sheet_name = st.text_input(<span class="string">&quot;Enter sheet name&quot;</span>, <span class="string">&quot;æ¦‚è¦è¡¨&quot;</span>)</span><br><span class="line">cell_location = st.text_input(<span class="string">&quot;Enter cell location for image insertion&quot;</span>, <span class="string">&quot;E3&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> uploaded_excel <span class="keyword">and</span> uploaded_image <span class="keyword">and</span> uploaded_image2:</span><br><span class="line">    <span class="comment"># Read Excel file</span></span><br><span class="line">    workbook = load_workbook(filename=uploaded_excel)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Check if sheet exists</span></span><br><span class="line">    <span class="keyword">if</span> sheet_name <span class="keyword">not</span> <span class="keyword">in</span> workbook.sheetnames:</span><br><span class="line">        st.error(<span class="string">f&quot;Sheet &#x27;<span class="subst">&#123;sheet_name&#125;</span>&#x27; does not exist!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        worksheet = workbook[sheet_name]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Load image</span></span><br><span class="line">        img = OpenpyxlImage(uploaded_image)</span><br><span class="line">        img2=OpenpyxlImage(uploaded_image2)</span><br><span class="line"></span><br><span class="line">        insert_image(worksheet,img,<span class="number">3</span>,<span class="number">5</span>) <span class="comment">#E3</span></span><br><span class="line">        insert_image(worksheet,img2,<span class="number">14</span>,<span class="number">5</span>) <span class="comment">#E14</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Save modified Excel file</span></span><br><span class="line">        output = io.BytesIO()</span><br><span class="line">        workbook.save(output)</span><br><span class="line">        output.seek(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Provide download link</span></span><br><span class="line">        st.download_button(label=<span class="string">&quot;Download modified Excel file&quot;</span>,</span><br><span class="line">                           data=output,</span><br><span class="line">                           file_name=<span class="string">&quot;modified_excel.xlsx&quot;</span>)</span><br><span class="line"></span><br><span class="line">        st.success(<span class="string">&quot;Image successfully inserted into Excel file!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ç›´æ¥è²¼åˆ°å·¦ä¸Šè§’é»">ç›´æ¥è²¼åˆ°å·¦ä¸Šè§’é»</h3>
<p>ç›®å‰openpyxlçš„å¥—ä»¶åªèƒ½é€éOneCellAnchorè™•ç†ï¼Œä½†æ˜¯ç…§ç‰‡å¤§å°ç„¡å¾é©æ‡‰(ä¹Ÿè¨±æ˜¯æˆ‘é‚„æ²’æ‰¾åˆ°æ–¹æ³•)ã€‚</p>
<h3
id="è²¼åˆ°å·¦ä¸Šè§’é»ä¹‹å¾Œé€²è¡Œåç§»ç›®å‰æ–½å·¥ç…§ç‰‡æ˜¯é€™æ¨£è™•ç†">è²¼åˆ°å·¦ä¸Šè§’é»ä¹‹å¾Œé€²è¡Œåç§»(ç›®å‰æ–½å·¥ç…§ç‰‡æ˜¯é€™æ¨£è™•ç†)</h3>
<p>VBA å…§å®¹</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line">dblGap = <span class="number">2</span>#</span><br><span class="line">Count = <span class="number">0</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> fleTmp <span class="keyword">In</span> fldMain.Files</span><br><span class="line">    strTmp = UCase(fsoMain.GetExtensionName(fleTmp.path))</span><br><span class="line">    <span class="keyword">If</span> strTmp = <span class="string">&quot;JPG&quot;</span> <span class="built_in">Or</span> strTmp = <span class="string">&quot;JPEG&quot;</span> <span class="keyword">Then</span></span><br><span class="line">        Count = Count + <span class="number">1</span></span><br><span class="line">        <span class="keyword">With</span> shtAct</span><br><span class="line">            <span class="keyword">Set</span> ranOri = .Range(.Cells(<span class="number">2</span> + (Count - <span class="number">1</span>) * <span class="number">14</span>, <span class="number">4</span>), .Cells(<span class="number">2</span> + (Count - <span class="number">1</span>) * <span class="number">14</span>, <span class="number">4</span>))</span><br><span class="line">            <span class="keyword">Set</span> ranNum = ranOri.Offset(<span class="number">2</span>, -<span class="number">2</span>)</span><br><span class="line">            ranNum = Count</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        <span class="keyword">Set</span> picAct = shtAct.Pictures.Insert(fleTmp.path)</span><br><span class="line">        <span class="keyword">With</span> picAct</span><br><span class="line">            .ShapeRange.LockAspectRatio = msoTrue <span class="comment">&#x27;é–å®šç…§ç‰‡é•·å¯¬æ¯”</span></span><br><span class="line">            <span class="keyword">If</span> .Height &gt; .Width <span class="keyword">Then</span> <span class="comment">&#x27;ç›´å¼</span></span><br><span class="line">                <span class="keyword">Set</span> ranOri = ranOri.Resize(<span class="number">13</span>, <span class="number">1</span>) <span class="comment">&#x27;.Merge</span></span><br><span class="line">                ranOri.Merge</span><br><span class="line">            <span class="keyword">Else</span> <span class="comment">&#x27;æ©«å¼</span></span><br><span class="line">                <span class="keyword">Set</span> ranOri = ranOri.Offset(<span class="number">4</span>, -<span class="number">2</span>).Resize(<span class="number">9</span>, <span class="number">3</span>) <span class="comment">&#x27;.Merge</span></span><br><span class="line">                ranOri.Merge</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            dblRatioPic = .Width / .Height</span><br><span class="line">            dblRatioOri = ranOri.Width / ranOri.Height</span><br><span class="line">            <span class="keyword">If</span> dblRatioPic &gt; dblRatioOri <span class="keyword">Then</span> <span class="comment">&#x27;å¯¬åº¦æ§åˆ¶</span></span><br><span class="line">                .Width = ranOri.Width - <span class="number">2</span> * dblGap</span><br><span class="line">                .Top = ranOri.Top + <span class="number">0.5</span> * ranOri.Height - <span class="number">0.5</span> * .Height</span><br><span class="line">                .Left = ranOri.Left + dblGap</span><br><span class="line">            <span class="keyword">Else</span>                                <span class="comment">&#x27;é«˜åº¦æ§åˆ¶</span></span><br><span class="line">                .Height = ranOri.Height - <span class="number">2</span> * dblGap</span><br><span class="line">                .Top = ranOri.Top + dblGap</span><br><span class="line">                .Left = ranOri.Left + <span class="number">0.5</span> * ranOri.Width - <span class="number">0.5</span> * .Width</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">Next</span> fleTmp</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="é–‹ç™¼å°å•é¡Œ">é–‹ç™¼å°å•é¡Œ</h2>
<p>I/O operation on closed file</p>
<mark class="label [primary]">Sol:</mark>
<p>å¦‚æœuploaded_fileæ²’æœ‰å…ˆç¶“éimg_fileé€²è¡Œå„²å­˜çš„è©±ï¼Œæœƒåœ¨OpenpyxlImageè™•ç†å®Œç•¢ä¹‹å¾Œå°±close</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">img1_file = io.BytesIO(st.session_state.uploaded_file1.getvalue())</span><br><span class="line">img1 = OpenpyxlImage(img1_file)</span><br><span class="line">img2_file = io.BytesIO(st.session_state.uploaded_file2.getvalue())</span><br><span class="line">img2 = OpenpyxlImage(img2_file)</span><br><span class="line">img3_file = io.BytesIO(st.session_state.uploaded_file3.getvalue())</span><br><span class="line">img3 = OpenpyxlImage(img3_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># img1=OpenpyxlImage(st.session_state.uploaded_file1)</span></span><br><span class="line">insert_image(sheet,img1,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment"># img2=OpenpyxlImage(st.session_state.uploaded_file2)</span></span><br><span class="line">insert_image(sheet,img2,<span class="number">14</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment"># img3=OpenpyxlImage(st.session_state.uploaded_file3)</span></span><br><span class="line">insert_image(sheet,img3,<span class="number">14</span>,<span class="number">8</span>)</span><br></pre></td></tr></table></figure>
<h2 id="ref">ref</h2>
<p>https://blog.csdn.net/chenliang1038/article/details/119410308</p>
]]></content>
      <categories>
        <category>åŸºæœ¬åŸç†</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonè£½ä½œå·¥ç¨‹è¨­è¨ˆç°¡åœ–</title>
    <url>/posts/3601177192/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ–è¡¨è·Ÿåœ–ç‰‡éƒ½æ˜¯ç”¨ä¾†è®“ç¶²é å…ƒç´ æ›´ç‚ºè±å¯Œçš„æ‰‹æ®µï¼Œåœ–è¡¨ç‚ºæ•¸æ“šçµ±è¨ˆå¾Œçš„æˆæœã€åœ–ç‰‡å‰‡ç‚ºå°‡æŠ½è±¡çš„æ–‡å­—è½‰æ›æˆåœ–ç‰‡å½¢å¼é€²è¡Œè¼¸å‡º(æ¯”å¦‚æ¸ é“çš„é•·ç›¸)ï¼ŒæŠ½è±¡çš„æ–‡å­—å¾€å¾€ä¸æ¯”åœ–ç‰‡çš„ä»‹ç´¹ä¾†çš„å®¹æ˜“æ¥å—è¨±å¤šï¼Œè€Œé€™ä¹Ÿæ˜¯è³‡æ–™å¯è¦–åŒ–çš„ç›®æ¨™ä¹‹ä¸€ã€‚</p>
<h3 id="ä½¿ç”¨æƒ…å¢ƒ">ä½¿ç”¨æƒ…å¢ƒ</h3>
<p>åœ¨æå ±å·¥ç¨‹æ¦‚è¦è¡¨æ™‚ï¼Œæœƒéœ€è¦è®“ä¸Šé¢äº†è§£æœªä¾†è¦æ–½ä½œçš„å·¥ç¨‹å…§å®¹ï¼Œå› æ­¤æœƒæ‹æ”ç¾å ´çš„ç…§ç‰‡åŠé™„ä¸Šå·¥ç¨‹è¨­è¨ˆç°¡åœ–ï¼Œè€Œå·¥ç¨‹è¨­è¨ˆç°¡åœ–çš„è£½ä½œéç¨‹éå¸¸ç¹ç‘£ï¼Œæ“ä½œéç¨‹å¦‚ä¸‹:</p>
<ol type="1">
<li>é–‹å•ŸCAD</li>
<li>ç•«å‡ºæ¸ é“å½¢ç‹€ã€æ¨™ç¤ºæ–‡å­—å…§å®¹</li>
<li>é è¦½åˆ—å°</li>
<li>æˆªåœ–é è¦½åˆ—å°å…§å®¹å¦å­˜æˆåœ–ç‰‡æª”</li>
<li>åœ–ç‰‡æª”è²¼é™„åˆ°Excelä¸Šé¢</li>
</ol>
<p>å› æ­¤æœ¬æ¬¡å°ˆæ¡ˆé æœŸæœƒè®“ä½¿ç”¨è€…è¼¸å…¥æ¸ é“çš„å°ºå¯¸ã€å‘¨é‚Šç’°å¢ƒé—œä¿‚ä¾†è£½ä½œä¸€å¼µç°¡åœ–ï¼Œæ”¾ç½®æ–¼"å·¥ç¨‹æ¦‚è¦è¡¨"è®“é•·å®˜äº†è§£æœªä¾†è¦æ–½ä½œçš„å·¥ç¨‹å…§å®¹ï¼Œåˆ©ç”¨pythonçš„PILå¥—ä»¶ç¸®çŸ­<strong>ç¹ªè£½å·¥ç¨‹è¨­è¨ˆç°¡åœ–</strong>çš„æµç¨‹ã€‚</p>
<span id="more"></span>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>PILå…¨åç‚ºPillowï¼Œæ˜¯ç›®å‰åœ¨é–‹ç™¼pythonæ™‚å¸¸ç”¨çš„ä¸€é …ç¹ªåœ–å·¥å…·</p>
<blockquote>
<p>åº§æ¨™é—œä¿‚</p>
</blockquote>
<p>PILä»¥<strong>ç¬¬äºŒè±¡é™</strong>é–‹å§‹ï¼ŒXå¾€å³éå¢ï¼ŒYå¾€ä¸‹éå¢ã€‚
CADä»¥ç¬¬ä¸€è±¡é™é–‹å§‹ï¼ŒXå¾€å³éå¢ï¼ŒYå¾€<strong>ä¸Š</strong>éå¢ã€‚</p>
<blockquote>
<p>å…ƒç´ ç”¨æ³•</p>
</blockquote>
<h3 id="ç•«ç·š">ç•«ç·š</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_line</span>(<span class="params">draw, start_point, end_point, fill=<span class="string">&#x27;black&#x27;</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.line([start_point, end_point], fill=fill, width=width)</span><br></pre></td></tr></table></figure>
<h3 id="ç•«å¤šæ®µç·š">ç•«å¤šæ®µç·š</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_polyline</span>(<span class="params">draw, points, fill=<span class="string">&#x27;black&#x27;</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.line(points, fill=fill, width=width)</span><br></pre></td></tr></table></figure>
<h3 id="å¯«æ–‡å­—">å¯«æ–‡å­—</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_text</span>(<span class="params">draw, text, position, font_size, font_path, fill=<span class="string">&#x27;black&#x27;</span></span>):</span><br><span class="line">    font = ImageFont.truetype(font_path, font_size)</span><br><span class="line">    draw.text(position, text, font=font, fill=fill)</span><br></pre></td></tr></table></figure>
<ul>
<li>é€™è£¡çš„font_pathå¦‚æœæ˜¯ä¸­æ–‡ï¼Œå¯èƒ½æœƒæœ‰å‡ºç¾äº‚ç¢¼çš„å•é¡Œï¼Œå¯ä»¥å…ˆå»Google
fontä¹‹é¡å…ˆä¸‹è¼‰ä¸‹ä¾†åˆ°é–‹ç™¼ç›®éŒ„è®“ä»–å¼•ç”¨ã€‚ç›®å‰ä¸­æ–‡çš„éƒ¨åˆ†æˆ‘ç”¨<a
href="https://fonts.google.com/noto/specimen/Noto+Sans">NotoSansTC-Regular.ttf</a></li>
</ul>
<h3 id="å¡«å……ç·š">å¡«å……ç·š</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_polygon</span>(<span class="params">draw, points, outline=<span class="string">&#x27;black&#x27;</span>, fill=<span class="literal">None</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.polygon(points, outline=outline, fill=fill)</span><br><span class="line">    <span class="keyword">if</span> fill:</span><br><span class="line">        draw.line(points + [points[<span class="number">0</span>]], fill=outline, width=width)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_gradient_polygon</span>(<span class="params">draw, vertices, start_color, end_color</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¹ªè£½æ¼¸å±¤é¡è‰²çš„å¤šé‚Šå½¢</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param draw: PIL.ImageDrawå°è±¡</span></span><br><span class="line"><span class="string">    :param vertices: å¤šé‚Šå½¢é ‚é»åº§æ¨™åˆ—è¡¨ [(x1, y1), (x2, y2), ...]</span></span><br><span class="line"><span class="string">    :param start_color: é–‹å§‹é¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    :param end_color: çµæŸé¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    x_coords, y_coords = <span class="built_in">zip</span>(*vertices)</span><br><span class="line">    min_y, max_y = <span class="built_in">min</span>(y_coords), <span class="built_in">max</span>(y_coords)</span><br><span class="line">    height = max_y - min_y</span><br><span class="line">    gradient_colors = create_gradient_color(start_color, end_color, height)</span><br><span class="line">    <span class="keyword">for</span> i, color <span class="keyword">in</span> <span class="built_in">enumerate</span>(gradient_colors):</span><br><span class="line">        draw.line([(<span class="built_in">min</span>(x_coords), min_y + i), (<span class="built_in">max</span>(x_coords), min_y + i)], fill=color)</span><br><span class="line"></span><br><span class="line">        </span><br></pre></td></tr></table></figure>
<h3 id="æ¨™è¨»å°ºå¯¸">æ¨™è¨»å°ºå¯¸</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_dimension_line</span>(<span class="params">draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path,dim_space=<span class="number">20</span>,arrow_length=<span class="number">10</span></span>):</span><br><span class="line"></span><br><span class="line">    text_color=<span class="string">&#x27;#e85fd6&#x27;</span></span><br><span class="line">    <span class="comment"># font_size=30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> Y1_DIM==Y2_DIM:</span><br><span class="line"></span><br><span class="line">        dim_txt=<span class="built_in">str</span>(<span class="built_in">int</span>(X2_DIM-X1_DIM))</span><br><span class="line"></span><br><span class="line">        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/<span class="number">2</span>-font_size/<span class="number">2</span>,(Y1_DIM+Y2_DIM)/<span class="number">2</span>-font_size*<span class="number">2.5</span>-dim_space), font_size, font_path, fill=text_color)</span><br><span class="line">        draw_line(draw, (X1_DIM, Y1_DIM-dim_space), (X1_DIM, Y1_DIM-arrow_length-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X2_DIM, Y2_DIM-dim_space), (X2_DIM, Y2_DIM-arrow_length-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X1_DIM, Y1_DIM-arrow_length/<span class="number">2</span>-dim_space), (X2_DIM, Y2_DIM-arrow_length/<span class="number">2</span>-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> X1_DIM==X2_DIM:</span><br><span class="line"></span><br><span class="line">        dim_txt=<span class="built_in">str</span>(<span class="built_in">int</span>(Y2_DIM-Y1_DIM))</span><br><span class="line"></span><br><span class="line">        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/<span class="number">2</span>-dim_space-<span class="number">2.5</span>*font_size,(Y1_DIM+Y2_DIM)/<span class="number">2</span>-font_size), font_size, font_path, fill=text_color)</span><br><span class="line">        draw_line(draw, (X1_DIM-dim_space, Y1_DIM), (X1_DIM-arrow_length-dim_space, Y1_DIM), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X2_DIM-dim_space, Y2_DIM), (X2_DIM-arrow_length-dim_space, Y2_DIM), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X1_DIM-arrow_length/<span class="number">2</span>-dim_space, Y1_DIM), (X2_DIM-arrow_length/<span class="number">2</span>-dim_space, Y2_DIM), fill=text_color, width=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="é æœŸæˆæœ">é æœŸæˆæœ</h2>
<figure>
<img src="U.JPG" alt="Fig1.å·¥ç¨‹è¨­è¨ˆç°¡åœ–" />
<figcaption aria-hidden="true">Fig1.å·¥ç¨‹è¨­è¨ˆç°¡åœ–</figcaption>
</figure>
<h2 id="å®Œæ•´åšæ³•">å®Œæ•´åšæ³•</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_text</span>(<span class="params">draw, text, position, font_size, font_path, fill=<span class="string">&#x27;black&#x27;</span></span>):</span><br><span class="line">    font = ImageFont.truetype(font_path, font_size)</span><br><span class="line">    draw.text(position, text, font=font, fill=fill)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_line</span>(<span class="params">draw, start_point, end_point, fill=<span class="string">&#x27;black&#x27;</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.line([start_point, end_point], fill=fill, width=width)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_polygon</span>(<span class="params">draw, points, outline=<span class="string">&#x27;black&#x27;</span>, fill=<span class="literal">None</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.polygon(points, outline=outline, fill=fill)</span><br><span class="line">    <span class="keyword">if</span> fill:</span><br><span class="line">        draw.line(points + [points[<span class="number">0</span>]], fill=outline, width=width)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_polyline</span>(<span class="params">draw, points, fill=<span class="string">&#x27;black&#x27;</span>, width=<span class="number">3</span></span>):</span><br><span class="line">    draw.line(points, fill=fill, width=width)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_gradient_color</span>(<span class="params">start_color, end_color, height</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å‰µå»ºå‚ç›´æ¼¸å±¤é¡è‰²åˆ—è¡¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param start_color: é–‹å§‹é¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    :param end_color: çµæŸé¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    :param height: é«˜åº¦ï¼ˆæ¼¸å±¤çš„ç¸½è¡Œæ•¸ï¼‰</span></span><br><span class="line"><span class="string">    :return: æ¼¸å±¤é¡è‰²åˆ—è¡¨</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    gradient = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">        ratio = i / height</span><br><span class="line">        r = <span class="built_in">int</span>(start_color[<span class="number">0</span>] * (<span class="number">1</span> - ratio) + end_color[<span class="number">0</span>] * ratio)</span><br><span class="line">        g = <span class="built_in">int</span>(start_color[<span class="number">1</span>] * (<span class="number">1</span> - ratio) + end_color[<span class="number">1</span>] * ratio)</span><br><span class="line">        b = <span class="built_in">int</span>(start_color[<span class="number">2</span>] * (<span class="number">1</span> - ratio) + end_color[<span class="number">2</span>] * ratio)</span><br><span class="line">        gradient.append((r, g, b))</span><br><span class="line">    <span class="keyword">return</span> gradient</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_gradient_polygon</span>(<span class="params">draw, vertices, start_color, end_color</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¹ªè£½æ¼¸å±¤é¡è‰²çš„å¤šé‚Šå½¢</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param draw: PIL.ImageDrawå°è±¡</span></span><br><span class="line"><span class="string">    :param vertices: å¤šé‚Šå½¢é ‚é»åº§æ¨™åˆ—è¡¨ [(x1, y1), (x2, y2), ...]</span></span><br><span class="line"><span class="string">    :param start_color: é–‹å§‹é¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    :param end_color: çµæŸé¡è‰² (r, g, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    x_coords, y_coords = <span class="built_in">zip</span>(*vertices)</span><br><span class="line">    min_y, max_y = <span class="built_in">min</span>(y_coords), <span class="built_in">max</span>(y_coords)</span><br><span class="line">    height = max_y - min_y</span><br><span class="line">    gradient_colors = create_gradient_color(start_color, end_color, height)</span><br><span class="line">    <span class="keyword">for</span> i, color <span class="keyword">in</span> <span class="built_in">enumerate</span>(gradient_colors):</span><br><span class="line">        draw.line([(<span class="built_in">min</span>(x_coords), min_y + i), (<span class="built_in">max</span>(x_coords), min_y + i)], fill=color)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_dimension_line</span>(<span class="params">draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path,dim_space=<span class="number">20</span>,arrow_length=<span class="number">10</span></span>):</span><br><span class="line"></span><br><span class="line">    text_color=<span class="string">&#x27;#e85fd6&#x27;</span></span><br><span class="line">    <span class="comment"># font_size=30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> Y1_DIM==Y2_DIM:</span><br><span class="line"></span><br><span class="line">        dim_txt=<span class="built_in">str</span>(<span class="built_in">int</span>(X2_DIM-X1_DIM))</span><br><span class="line"></span><br><span class="line">        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/<span class="number">2</span>-font_size/<span class="number">2</span>,(Y1_DIM+Y2_DIM)/<span class="number">2</span>-font_size*<span class="number">2.5</span>-dim_space), font_size, font_path, fill=text_color)</span><br><span class="line">        draw_line(draw, (X1_DIM, Y1_DIM-dim_space), (X1_DIM, Y1_DIM-arrow_length-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X2_DIM, Y2_DIM-dim_space), (X2_DIM, Y2_DIM-arrow_length-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X1_DIM, Y1_DIM-arrow_length/<span class="number">2</span>-dim_space), (X2_DIM, Y2_DIM-arrow_length/<span class="number">2</span>-dim_space), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">elif</span> X1_DIM==X2_DIM:</span><br><span class="line"></span><br><span class="line">        dim_txt=<span class="built_in">str</span>(<span class="built_in">int</span>(Y2_DIM-Y1_DIM))</span><br><span class="line"></span><br><span class="line">        draw_text(draw, dim_txt,((X1_DIM+X2_DIM)/<span class="number">2</span>-dim_space-<span class="number">2.5</span>*font_size,(Y1_DIM+Y2_DIM)/<span class="number">2</span>-font_size), font_size, font_path, fill=text_color)</span><br><span class="line">        draw_line(draw, (X1_DIM-dim_space, Y1_DIM), (X1_DIM-arrow_length-dim_space, Y1_DIM), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X2_DIM-dim_space, Y2_DIM), (X2_DIM-arrow_length-dim_space, Y2_DIM), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line">        draw_line(draw, (X1_DIM-arrow_length/<span class="number">2</span>-dim_space, Y1_DIM), (X2_DIM-arrow_length/<span class="number">2</span>-dim_space, Y2_DIM), fill=text_color, width=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›¸é—œåƒæ•¸</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_Uchannel</span>(<span class="params">B,H,T,env_left_txt,env_right_txt,env_left,env_right</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># B=200</span></span><br><span class="line">    <span class="comment"># H=120</span></span><br><span class="line">    <span class="comment"># T=25</span></span><br><span class="line"></span><br><span class="line">    X_left,X_right,Y_top,Y_bottom=<span class="number">150</span>,<span class="number">150</span>,<span class="number">150</span>,<span class="number">100</span></span><br><span class="line"></span><br><span class="line">    X0=X_left+T+B/<span class="number">2</span></span><br><span class="line">    Y0=Y_top+H</span><br><span class="line"></span><br><span class="line">    <span class="comment"># env_left_txt=&quot;è·¯&quot;</span></span><br><span class="line">    <span class="comment"># env_left=20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># env_right_txt=&quot;ç”°&quot;</span></span><br><span class="line">    <span class="comment"># env_right=60</span></span><br><span class="line"></span><br><span class="line">    env_left_body=H-env_left+T</span><br><span class="line">    env_right_body=H-env_right+T</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¨­ç½®åœ–åƒå°ºå¯¸å’Œè§£æåº¦</span></span><br><span class="line">    width, height = X_left+X_right+<span class="number">2</span>*T+B, Y_top+Y_bottom+H+T</span><br><span class="line">    dpi = <span class="number">100</span>  <span class="comment"># é«˜ DPI è¨­ç½®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‰µå»ºåœ–åƒ</span></span><br><span class="line">    image = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height), <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">    draw = ImageDraw.Draw(image)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­—é«”è¨­ç½®</span></span><br><span class="line">    font_path = <span class="string">&quot;NotoSansTC-Regular.ttf&quot;</span>  <span class="comment"># å­—é«”æ–‡ä»¶çš„è·¯å¾‘</span></span><br><span class="line">    font_size = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¹ªè£½æ–‡å­—</span></span><br><span class="line">    draw_text(draw, env_left_txt, (X0-B/<span class="number">2</span>-T-X_left/<span class="number">2</span>-<span class="number">20</span>, Y0-H+env_left-font_size*<span class="number">2</span>), font_size*<span class="number">1.2</span>, font_path)</span><br><span class="line">    draw_text(draw, env_right_txt, (X0+B/<span class="number">2</span>+T+X_right/<span class="number">2</span>, Y0-H+env_right-font_size*<span class="number">2</span>), font_size*<span class="number">1.2</span>, font_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åœŸé«”</span></span><br><span class="line">    polygon_points = [ (X0-B/<span class="number">2</span>-T, Y0-H+env_left), (X0-B/<span class="number">2</span>-T-X_left, Y0-H+env_left),  (X0-B/<span class="number">2</span>-T-X_left, Y0-H+env_left+env_left_body), (X0-B/<span class="number">2</span>-T, Y0-H+env_left+env_left_body)]</span><br><span class="line">    draw_gradient_polygon(draw, polygon_points, (<span class="number">51</span>, <span class="number">26</span>, <span class="number">0</span>),(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åœŸé«”</span></span><br><span class="line"></span><br><span class="line">    polygon_points = [ (X0+B/<span class="number">2</span>+T, Y0-H+env_right), (X0+B/<span class="number">2</span>+T+X_right, Y0-H+env_right), (X0+B/<span class="number">2</span>+T+X_right, Y0-H+env_right+env_right_body), (X0+B/<span class="number">2</span>+T, Y0-H+env_right+env_right_body)]</span><br><span class="line">    draw_gradient_polygon(draw, polygon_points, (<span class="number">51</span>, <span class="number">26</span>, <span class="number">0</span>),(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># é¢å±¤</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> env_left_txt==<span class="string">&quot;ç”°&quot;</span>:</span><br><span class="line">        draw_line(draw, (X0-B/<span class="number">2</span>-T, Y0-H+env_left), (X0-B/<span class="number">2</span>-T-X_left, Y0-H+env_left), fill=<span class="string">&#x27;green&#x27;</span>, width=<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        draw_line(draw, (X0-B/<span class="number">2</span>-T, Y0-H+env_left), (X0-B/<span class="number">2</span>-T-X_left, Y0-H+env_left), fill=(<span class="number">0</span>, <span class="number">26</span>, <span class="number">51</span>), width=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> env_right_txt==<span class="string">&quot;è·¯&quot;</span>:</span><br><span class="line">        draw_line(draw, (X0+B/<span class="number">2</span>+T, Y0-H+env_right), (X0+B/<span class="number">2</span>+T+X_right, Y0-H+env_right), fill=(<span class="number">0</span>, <span class="number">26</span>, <span class="number">51</span>), width=<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        draw_line(draw, (X0+B/<span class="number">2</span>+T, Y0-H+env_right), (X0+B/<span class="number">2</span>+T+X_right, Y0-H+env_right), fill=<span class="string">&#x27;green&#x27;</span>, width=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># çµæ§‹é«”</span></span><br><span class="line"></span><br><span class="line">    pts =[(X0,Y0),(X0-B/<span class="number">2</span>,Y0),(X0-B/<span class="number">2</span>,Y0-H),(X0-B/<span class="number">2</span>-T,(Y0-H)),(X0-B/<span class="number">2</span>-T,(Y0+T)),(X0+B/<span class="number">2</span>+T,(Y0+T)),(X0+B/<span class="number">2</span>+T,(Y0-H)),(X0+B/<span class="number">2</span>,(Y0-H)),(X0+B/<span class="number">2</span>,Y0),(X0,Y0)]</span><br><span class="line"></span><br><span class="line">    draw_polygon(draw, pts, outline=<span class="string">&#x27;black&#x27;</span>, fill=<span class="string">&#x27;gray&#x27;</span>, width=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## å°ºå¯¸æ¨™è¨»</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">### æ°´å¹³æ–¹å‘</span></span><br><span class="line"></span><br><span class="line">    X1_DIM,Y1_DIM=X0-B/<span class="number">2</span>-T,Y0-H</span><br><span class="line">    X2_DIM,Y2_DIM=X0-B/<span class="number">2</span>,Y0-H</span><br><span class="line"></span><br><span class="line">    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)</span><br><span class="line"></span><br><span class="line">    X1_DIM,Y1_DIM=X0-B/<span class="number">2</span>,Y0-H</span><br><span class="line">    X2_DIM,Y2_DIM=X0+B/<span class="number">2</span>,Y0-H</span><br><span class="line"></span><br><span class="line">    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)</span><br><span class="line"></span><br><span class="line">    X1_DIM,Y1_DIM=X0+B/<span class="number">2</span>,Y0-H</span><br><span class="line">    X2_DIM,Y2_DIM=X0+B/<span class="number">2</span>+T,Y0-H</span><br><span class="line"></span><br><span class="line">    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment">### å‚ç›´æ–¹å‘</span></span><br><span class="line"></span><br><span class="line">    X1_DIM,Y1_DIM=X0-B/<span class="number">2</span>-T,Y0-H</span><br><span class="line">    X2_DIM,Y2_DIM=X0-B/<span class="number">2</span>-T,Y0</span><br><span class="line"></span><br><span class="line">    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)</span><br><span class="line"></span><br><span class="line">    X1_DIM,Y1_DIM=X0-B/<span class="number">2</span>-T,Y0</span><br><span class="line">    X2_DIM,Y2_DIM=X0-B/<span class="number">2</span>-T,Y0+T</span><br><span class="line"></span><br><span class="line">    draw_dimension_line(draw, X1_DIM,Y1_DIM,X2_DIM,Y2_DIM, font_size, font_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜é«˜è§£æåº¦åœ–åƒ</span></span><br><span class="line">    image.save(<span class="string">&quot;high_quality_drawing.png&quot;</span>, dpi=(dpi, dpi))</span><br><span class="line">    image.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># çµ¦å®šå°ºå¯¸</span></span><br><span class="line">    plot_Uchannel(<span class="number">300</span>,<span class="number">200</span>,<span class="number">30</span>,<span class="string">&quot;ç”°&quot;</span>,<span class="string">&quot;ç”°&quot;</span>,<span class="number">20</span>,<span class="number">50</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Streamlitå·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–</title>
    <url>/posts/43562660/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>å·¥ç¨‹é€²è¡ŒæœŸé–“æœƒæœ‰å¾ˆå¤šä¸åŒçš„ä»»å‹™ï¼Œæ¯å€‹ä»»å‹™æœƒæœ‰è‡ªå·±æ‰€éœ€è¦èŠ±è²»çš„é‡‘é¡ã€èµ·å§‹æ—¥æœŸã€æŒçºŒå¤©æ•¸ï¼Œè—‰ç”±é€™äº›ä»»å‹™çš„çµ„åˆå¯ä»¥çµ±æ•´å‡ºå·¥ç¨‹çš„é å®šé€²åº¦æƒ…æ³ï¼Œå°‡ä¸åŒä»»å‹™ç¹ªè£½åœ¨åŒä¸€å€‹æ™‚é–“è»¸ä¸Šå¯ä»¥æ¸…æ¥šçš„äº†è§£åˆ°ç¾éšæ®µæœ‰é‚£äº›ä»»å‹™æ‡‰è©²è¦è¢«å®Œæˆä»¥åŠæœªä¾†é‚„æœ‰å“ªäº›ä»»å‹™éœ€è¦å®Œæˆï¼Œå°æ–¼ä»»å‹™å–®ç´”çš„å·¥ç¨‹å¾ˆæœ‰å¤§çš„åŠ©ç›Šã€‚</p>
<p>å‰é™£å­åœ¨é–‹ç™¼æ–½å·¥æ—¥èªŒçš„æ™‚å€™ï¼Œå¦‚æœæ¡ç”¨æ–½å·¥è¨ˆç•«æ›¸ä¸Šçš„æ¯15æ—¥ç´¯ç©é€²åº¦åšå…§å·®å–å€¼æœƒæ¯”è¼ƒå®¹æ˜“å¤±çœŸï¼Œå¾Œä¾†æƒ³æƒ³ï¼Œå…¶å¯¦é€™å€‹ç´¯ç©é€²åº¦çš„ä¾†æºä¹Ÿæ˜¯æŒ‰ç…§ç”˜ç‰¹åœ–çš„æ¯”ä¾‹æ‰€å¾—å‡ºçš„çµæœ?ä½†ç¸½æ­¸å¦‚ä½•ï¼Œé‚„æ˜¯èŠ±äº†ä¸€äº›æ™‚é–“ç†Ÿæ‚‰ä¸€ä¸‹matplotlibçš„åšåœ–å¥—ä»¶ï¼Œä¸¦ä¸”æ­é…streamlitå‰ç«¯ä»‹é¢åšä¸€å€‹é›²ç«¯æœå‹™ï¼Œç›®æ¨™æ˜¯å¸Œæœ›èƒ½å¤ ç”¢å‡º<strong>å·¥ç¨‹ç”˜ç‰¹åœ–</strong>åŠ<strong>æ¯æ—¥é€²åº¦çš„CSVæª”æ¡ˆ</strong>ï¼Œæœªä¾†å¯ä»¥åŒ¯å…¥å…¶ä»–çš„æ—¥å ±VBAå·¥å…·ã€‚</p>
<span id="more"></span>
<h2 id="æ“ä½œä»‹é¢">æ“ä½œä»‹é¢</h2>
<figure>
<img src="upload_a58406d159b6d33c6dfc15715aef2378.png" alt="æ“ä½œä»‹é¢" />
<figcaption aria-hidden="true">æ“ä½œä»‹é¢</figcaption>
</figure>
<ol type="1">
<li>é€²å…¥ç³»çµ±ä¹‹å¾Œå·¦å´ç‚ºä»»å‹™ç·¨è¼¯å€å¡Šï¼Œå³å´ç‚ºç”˜ç‰¹åœ–</li>
<li>ä»»å‹™ç·¨è¼¯å€å¡Šå¯ä»¥é€²è¡Œæ–°å¢ã€åˆªé™¤ã€ç·¨è¼¯</li>
<li>æ¯æ¬¡çš„æ›´å‹•éƒ½æœƒé‡æ–°ç”Ÿæˆç”˜ç‰¹åœ–ï¼Œä¸‹è¼‰CSVä¹Ÿæœƒå³æ™‚æ›´æ–°</li>
</ol>
<p>å¦‚æœ‰çœ‹ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥é»é¸<strong>å½±ç‰‡æ“ä½œæ•™å­¸</strong></p>
<h2 id="ç¶²é é€£çµ">ç¶²é é€£çµ</h2>
<p><a href="https://progress.streamlit.app/"><span class="github-emoji"
data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
å·¥ç¨‹é€²åº¦V0.1.0 ç¶²é é€£çµ</a></p>
<h2 id="å®Œæ•´åšæ³•">å®Œæ•´åšæ³•</h2>
<blockquote>
<p>Githubä¸Šé¢çš„æ˜¯å·²ç¶“ç²¾æŒ‘ç´°é¸éçš„ç¨‹å¼ç¢¼ï¼Œè£½ä½œæœŸé–“æœ‰é™¸é™¸çºŒçºŒç æ‰ä¸€äº›åŠŸèƒ½ï¼Œå¯ä»¥åƒç…§ä¸‹é¢çš„è¨»è§£è™•ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.dates <span class="keyword">as</span> mdates</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib.font_manager <span class="keyword">import</span> FontProperties</span><br><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</span><br><span class="line"></span><br><span class="line"><span class="comment">### Init ###</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main_zh</span>():</span><br><span class="line"></span><br><span class="line">    SYSTEM_VERSION=<span class="string">&quot;V1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># st.set_page_config(layout=&#x27;wide&#x27;)</span></span><br><span class="line"></span><br><span class="line">    font_prop = FontProperties(fname=<span class="string">&#x27;./NotoSansCJK-Regular.ttc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æ•¸æ“šï¼Œå¦‚æœ st.session_state ä¸­æ²’æœ‰å­˜å„²æ•¸æ“š</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># btn_sample = st.button(&quot;è¼‰å…¥æ¸¬è©¦æ¡ˆä¾‹&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;data&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> st.session_state:</span><br><span class="line">        <span class="comment"># df = pd.DataFrame(columns=[&#x27;é …ç›®åç¨±&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;, &#x27;èµ·å§‹æ—¥æœŸ&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;, &#x27;çµæŸæ—¥æœŸ&#x27;])</span></span><br><span class="line">    <span class="comment">#     st.session_state[&#x27;data&#x27;]=[</span></span><br><span class="line">    <span class="comment">#         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹A&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line">    <span class="comment">#         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹B&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line">    <span class="comment">#         &#123;&#x27;é …ç›®åç¨±&#x27;: &#x27;é»æˆ‘ä¿®æ”¹C&#x27;, &#x27;èŠ±è²»é‡‘é¡&#x27;: 1000, &#x27;èµ·å§‹æ—¥æœŸ&#x27;: &#x27;2024-07-01&#x27;, &#x27;æŒçºŒå¤©æ•¸&#x27;: 5, &#x27;çµæŸæ—¥æœŸ&#x27;: &#x27;&#x27;&#125;</span></span><br><span class="line">    <span class="comment">#         ]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># # st.json(st.session_state)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># if btn_sample:</span></span><br><span class="line">        <span class="comment"># data = &#123;</span></span><br><span class="line">        <span class="comment">#     &#x27;é …ç›®åç¨±&#x27;: [&#x27;åŸºç¤æ§‹é€ &#x27;, &#x27;çµæ§‹åŠ å›º&#x27;, &#x27;åœ°åŸºå·¥ç¨‹&#x27;, &#x27;å±‹é ‚ä¿®å¾©&#x27;, &#x27;å®¤å…§è£ä¿®&#x27;, &#x27;é›»åŠ›ç³»çµ±å‡ç´š&#x27;, &#x27;æ°´åˆ©è¨­æ–½å»ºè¨­&#x27;, &#x27;é“è·¯æ“´å»º&#x27;, &#x27;ç¶ åŒ–å·¥ç¨‹&#x27;, &#x27;æ¶ˆé˜²å®‰å…¨ç³»çµ±&#x27;],</span></span><br><span class="line">        <span class="comment">#     &#x27;èŠ±è²»é‡‘é¡&#x27;: [50000, 120000, 80000, 100000, 60000, 70000, 90000, 110000, 80000, 90000],</span></span><br><span class="line">        <span class="comment">#     &#x27;èµ·å§‹æ—¥æœŸ&#x27;: [&#x27;2024-07-01&#x27;, &#x27;2024-07-15&#x27;, &#x27;2024-08-01&#x27;, &#x27;2024-07-01&#x27;, &#x27;2024-07-05&#x27;, &#x27;2024-07-20&#x27;, &#x27;2024-07-25&#x27;, &#x27;2024-08-05&#x27;, &#x27;2024-08-10&#x27;, &#x27;2024-08-15&#x27;],</span></span><br><span class="line">        <span class="comment">#     &#x27;æŒçºŒå¤©æ•¸&#x27;: [5, 12, 8, 10, 6, 7, 9, 11, 8, 9],</span></span><br><span class="line">        <span class="comment">#     &#x27;çµæŸæ—¥æœŸ&#x27;: [&#x27;&#x27;] * 10</span></span><br><span class="line">        <span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># st.session_state[&#x27;data&#x27;]=[]</span></span><br><span class="line"></span><br><span class="line">        sample_data = [</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;åŸºç¤æ§‹é€ &#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">50000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-01&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;çµæ§‹åŠ å›º&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">120000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-15&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">12</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;åœ°åŸºå·¥ç¨‹&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">80000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-08-01&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;å±‹é ‚ä¿®å¾©&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">100000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-01&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;å®¤å…§è£ä¿®&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">60000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-05&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">6</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;é›»åŠ›ç³»çµ±å‡ç´š&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">70000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-20&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;æ°´åˆ©è¨­æ–½å»ºè¨­&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">90000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-07-25&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">9</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;é“è·¯æ“´å»º&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">110000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-08-05&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">11</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;ç¶ åŒ–å·¥ç¨‹&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">80000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-08-10&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>: <span class="string">&#x27;æ¶ˆé˜²å®‰å…¨ç³»çµ±&#x27;</span>, <span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>: <span class="number">90000</span>, <span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>: <span class="string">&#x27;2024-08-15&#x27;</span>, <span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>: <span class="number">9</span>, <span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;,</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># df = pd.DataFrame(data)</span></span><br><span class="line">        <span class="comment"># df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] = pd.to_datetime(df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;])</span></span><br><span class="line">        <span class="comment"># df[&#x27;çµæŸæ—¥æœŸ&#x27;] = df[&#x27;èµ·å§‹æ—¥æœŸ&#x27;] + pd.to_timedelta(df[&#x27;æŒçºŒå¤©æ•¸&#x27;], unit=&#x27;D&#x27;)</span></span><br><span class="line">        <span class="comment"># st.session_state.data = df</span></span><br><span class="line"></span><br><span class="line">        st.session_state[<span class="string">&#x27;data&#x27;</span>]=sample_data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># for item in st.session_state[&#x27;data&#x27;]:</span></span><br><span class="line">    <span class="comment">#     st.write(item)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¾ st.session_state ä¸­ç²å– DataFrame</span></span><br><span class="line">    <span class="comment"># df = st.session_state.data.dropna(subset=[&#x27;æŒçºŒå¤©æ•¸&#x27;])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    col1, col2 = st.columns([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> col1:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        st.markdown(<span class="string">&quot;### :spiral_calendar_pad: å·¥ç¨‹é€²åº¦ &quot;</span>+SYSTEM_VERSION)</span><br><span class="line">        st.info(<span class="string">&quot;ä½œè€…:**HankLin @202407**&quot;</span>)</span><br><span class="line">        st.markdown(<span class="string">&quot;---&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–°å¢æ–¹å¼ï¼Œå›é¥‹åˆ° st.session_state</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># with st.form(&quot;C&quot;, True):</span></span><br><span class="line">        <span class="comment">#     myitem = st.text_input(&quot;æ–½ä½œé …ç›®:&quot;)</span></span><br><span class="line">        <span class="comment">#     mycost = st.number_input(&quot;èŠ±è²»é‡‘é¡:&quot;)</span></span><br><span class="line">        <span class="comment">#     mystart_date = st.date_input(&quot;é–‹å§‹æ—¥æœŸ:&quot;)</span></span><br><span class="line">        <span class="comment">#     mydays = st.number_input(&quot;æŒçºŒå¤©æ•¸&quot;)</span></span><br><span class="line">        <span class="comment">#     # st.json(st.session_state[&#x27;data&#x27;])</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#     if st.form_submit_button(&quot;æ–°å¢&quot;):</span></span><br><span class="line">        <span class="comment">#         new_item = &#123;</span></span><br><span class="line">        <span class="comment">#             # &#x27;é …ç›®ç·¨è™Ÿ&#x27;: max(df[&#x27;é …ç›®ç·¨è™Ÿ&#x27;], default=0) + 1,  # è‡ªå‹•åˆ†é…æ–°çš„é …ç›®ç·¨è™Ÿ</span></span><br><span class="line">        <span class="comment">#             &#x27;é …ç›®åç¨±&#x27;: myitem,</span></span><br><span class="line">        <span class="comment">#             &#x27;èŠ±è²»é‡‘é¡&#x27;: mycost,</span></span><br><span class="line">        <span class="comment">#             &#x27;èµ·å§‹æ—¥æœŸ&#x27;: pd.to_datetime(mystart_date),</span></span><br><span class="line">        <span class="comment">#             &#x27;æŒçºŒå¤©æ•¸&#x27;: mydays,</span></span><br><span class="line">        <span class="comment">#             &#x27;çµæŸæ—¥æœŸ&#x27;: &quot;&quot;#pd.to_datetime(mystart_date) + pd.to_timedelta(mydays, unit=&#x27;D&#x27;)</span></span><br><span class="line">        <span class="comment">#         &#125;</span></span><br><span class="line">        <span class="comment">#         # df = pd.concat([df, pd.DataFrame([new_item])], ignore_index=True)</span></span><br><span class="line">        <span class="comment">#         # new_items=st.session_state[&#x27;data&#x27;].append(new_item)</span></span><br><span class="line">        <span class="comment">#         # st.json(st.session_state[&#x27;data&#x27;])</span></span><br><span class="line">        <span class="comment">#         # st.session_state.data = df</span></span><br><span class="line">        <span class="comment">#         st.session_state[&#x27;data&#x27;].append(new_item)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#         st.success(&quot;æˆåŠŸæ–°å¢æ–½å·¥é …ç›®ï¼&quot;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¸½è¡¨ï¼ˆç·¨è¼¯æ–¹å¼ï¼‰ï¼Œå›é¥‹åˆ° st.session_state</span></span><br><span class="line">        st.markdown(<span class="string">&quot;##### 		<span class="github-emoji" alias="point_down" style="" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png?v8">&#x1f447;</span> æ–½å·¥é …ç›®å¡«å¯«&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># st.json(st.session_state)</span></span><br><span class="line"></span><br><span class="line">        df=pd.DataFrame(st.session_state[<span class="string">&#x27;data&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># st.write(len(df))</span></span><br><span class="line">        </span><br><span class="line">        df[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        edited_df = st.data_editor(df, use_container_width=<span class="literal">True</span>,num_rows=<span class="string">&#x27;dynamic&#x27;</span>,</span><br><span class="line">                                column_config=&#123;</span><br><span class="line">                                    <span class="string">&quot;èµ·å§‹æ—¥æœŸ&quot;</span>: st.column_config.DateColumn(</span><br><span class="line">                                        <span class="string">&quot;èµ·å§‹æ—¥æœŸ&quot;</span>,</span><br><span class="line">                                        min_value=date(<span class="number">2024</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">                                        max_value=date(<span class="number">2030</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">                                        <span class="built_in">format</span>=<span class="string">&quot;YYYY-MM-DD&quot;</span>,</span><br><span class="line">                                        step=<span class="number">1</span>,</span><br><span class="line">                                    )</span><br><span class="line">                                &#125;,</span><br><span class="line">                                hide_index=<span class="literal">True</span>, column_order=(<span class="string">&quot;é …ç›®åç¨±&quot;</span>, <span class="string">&quot;èŠ±è²»é‡‘é¡&quot;</span>, <span class="string">&quot;èµ·å§‹æ—¥æœŸ&quot;</span>, <span class="string">&quot;æŒçºŒå¤©æ•¸&quot;</span>))</span><br><span class="line"></span><br><span class="line">        edited_df[<span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>] = edited_df[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>] + pd.to_timedelta(edited_df[<span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>], unit=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        is_show_text=st.toggle(<span class="string">&quot;åœ–å¡Šæ–‡å­—&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">### è¨ˆç®—æµç¨‹ä»¥ä¸‹éƒ½æ²’å•é¡Œï¼Œå¯ä»¥å…ˆå¼•å…¥session_stateå¾Œé–‹å§‹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># final_df=st.session_state.data</span></span><br><span class="line"></span><br><span class="line">    final_df=edited_df</span><br><span class="line">    <span class="comment"># final_df = edited_df.dropna(subset=[&#x27;æŒçºŒå¤©æ•¸&#x27;])</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(final_df)==<span class="number">0</span>:</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># è¨ˆç®—æ¯æ—¥è€—è²»æˆæœ¬</span></span><br><span class="line">        total_cost = final_df[<span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">        start_date = final_df[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line">        end_date = final_df[<span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>].<span class="built_in">max</span>()</span><br><span class="line">        date_range = pd.date_range(start=start_date, end=end_date, freq=<span class="string">&#x27;D&#x27;</span>)  <span class="comment"># æ¯æ—¥é »ç‡</span></span><br><span class="line">        daily_cost = np.zeros(<span class="built_in">len</span>(date_range))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i, row <span class="keyword">in</span> final_df.iterrows():</span><br><span class="line">            cost_per_day = row[<span class="string">&#x27;èŠ±è²»é‡‘é¡&#x27;</span>] / row[<span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>]</span><br><span class="line">            daily_cost[(date_range &gt; row[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>]) &amp; (date_range &lt;= row[<span class="string">&#x27;çµæŸæ—¥æœŸ&#x27;</span>])] += cost_per_day</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¨ˆç®—ç´¯ç©èŠ±è²»é‡‘é¡å’Œæ¯æ—¥é€²åº¦ç™¾åˆ†æ¯”</span></span><br><span class="line">        cumulative_cost = np.cumsum(daily_cost)</span><br><span class="line"></span><br><span class="line">        daily_progress = (daily_cost / total_cost) * <span class="number">100</span></span><br><span class="line">        cumulative_progress = (cumulative_cost / total_cost) * <span class="number">100</span></span><br><span class="line"></span><br><span class="line">        csv_data = pd.DataFrame(&#123;</span><br><span class="line">            <span class="string">&#x27;æ—¥æœŸ&#x27;</span>: date_range,</span><br><span class="line">            <span class="string">&#x27;ç•¶æ—¥è²»ç”¨&#x27;</span>: daily_cost,</span><br><span class="line">            <span class="string">&#x27;ç´¯ç©è²»ç”¨&#x27;</span>: cumulative_cost,</span><br><span class="line">            <span class="string">&#x27;ç•¶æ—¥é€²åº¦&#x27;</span>: daily_progress,</span><br><span class="line">            <span class="string">&#x27;ç´¯ç©é€²åº¦&#x27;</span>: cumulative_progress</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># st.dataframe(csv_data)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> col2:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># plt.xticks(rotation=45)</span></span><br><span class="line"></span><br><span class="line">        fig, ax1 = plt.subplots(figsize=(<span class="number">14</span>, <span class="number">10</span>))</span><br><span class="line">        <span class="comment"># ax1=plt.xticks(rotation=45)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç•«ç”˜ç‰¹åœ–ï¼Œèª¿æ•´é¡è‰²å’Œé€æ˜åº¦ï¼ŒåŠ å…¥æ ¼ç·š</span></span><br><span class="line">        colors = plt.cm.Set3.colors  <span class="comment"># ä½¿ç”¨å–®ä¸€è‰²ç³»</span></span><br><span class="line">        <span class="comment"># st.json(final_df.to_json())</span></span><br><span class="line">        cnt=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i, row <span class="keyword">in</span> final_df.iterrows():</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pd.isna(row[<span class="string">&quot;æŒçºŒå¤©æ•¸&quot;</span>]):</span><br><span class="line">                color = colors[i % <span class="built_in">len</span>(colors)]</span><br><span class="line">                ax1.barh(row[<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>], row[<span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>], left=row[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>], height=<span class="number">0.3</span>, color=color)</span><br><span class="line">                <span class="keyword">if</span> is_show_text==<span class="literal">True</span>:</span><br><span class="line">                    ax1.text(row[<span class="string">&#x27;èµ·å§‹æ—¥æœŸ&#x27;</span>], cnt, <span class="string">f&quot;<span class="subst">&#123;row[<span class="string">&#x27;é …ç›®åç¨±&#x27;</span>]&#125;</span>: <span class="subst">&#123;<span class="built_in">int</span>(row[<span class="string">&#x27;æŒçºŒå¤©æ•¸&#x27;</span>])&#125;</span>å¤©&quot;</span>, color=<span class="string">&#x27;black&#x27;</span>, verticalalignment=<span class="string">&#x27;center&#x27;</span>, fontsize=<span class="number">10</span>, fontproperties=font_prop)</span><br><span class="line">                cnt=cnt+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¨­ç½®æ¨™ç±¤å’Œæ¨™é¡Œ</span></span><br><span class="line">        ax1.set_xlabel(<span class="string">&#x27;æ—¥æœŸ&#x27;</span>, fontproperties=font_prop)</span><br><span class="line">        ax1.set_title(<span class="string">&#x27;æ–½å·¥é€²åº¦ç”˜ç‰¹åœ–&#x27;</span>, fontproperties=font_prop)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> label <span class="keyword">in</span> ax1.get_yticklabels():</span><br><span class="line">            label.set_fontproperties(font_prop)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åœ¨åŒä¸€å¼µåœ–ä¸Šç¹ªè£½æ¯æ—¥ç´¯ç©é€²åº¦åœ–ä¸¦æ¨™ç¤ºç¯€é»ç™¾åˆ†æ¯”</span></span><br><span class="line">        ax2 = ax1.twinx()</span><br><span class="line">        ax2.plot(date_range, cumulative_progress, marker=<span class="string">&#x27;o&#x27;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, color=<span class="string">&#x27;orange&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i, txt <span class="keyword">in</span> <span class="built_in">enumerate</span>(cumulative_progress):</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">5</span>== <span class="number">0</span> <span class="keyword">or</span> txt==<span class="number">100</span>:  <span class="comment"># æ¯10%æ¨™ç¤ºä¸€æ¬¡</span></span><br><span class="line">                ax2.annotate(<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">int</span>(txt)&#125;</span>%&#x27;</span>, (date_range[i], cumulative_progress[i]), textcoords=<span class="string">&quot;offset points&quot;</span>, xytext=(<span class="number">0</span>,<span class="number">10</span>), ha=<span class="string">&#x27;center&#x27;</span>, fontproperties=font_prop)</span><br><span class="line"></span><br><span class="line">        ax2.set_ylabel(<span class="string">&#x27;ç´¯ç©é€²åº¦ç™¾åˆ†æ¯” (%)&#x27;</span>, fontproperties=font_prop)</span><br><span class="line">        ax2.yaxis.set_major_locator(ticker.MultipleLocator(base=<span class="number">10</span>))</span><br><span class="line">        <span class="comment"># èª¿æ•´ x è»¸æ—¥æœŸé¡¯ç¤ºç‚ºæ¯åŠå€‹æœˆ</span></span><br><span class="line">        ax1.xaxis.set_major_locator(mdates.DayLocator(interval=<span class="number">10</span>))  <span class="comment"># æ¯10é¡¯ç¤ºä¸€æ¬¡æ—¥æœŸ</span></span><br><span class="line">        ax1.xaxis.set_minor_locator(mdates.DayLocator(interval=<span class="number">1</span>))  <span class="comment"># æ¯å¤©éƒ½é¡¯ç¤ºæ—¥æœŸ</span></span><br><span class="line">        ax1.xaxis.set_major_formatter(mdates.DateFormatter(<span class="string">&#x27;%Y-%m-%d&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ·»åŠ ç¶²æ ¼ç·š</span></span><br><span class="line">        ax2.grid(<span class="literal">True</span>, which=<span class="string">&#x27;both&#x27;</span>, linestyle=<span class="string">&#x27;:&#x27;</span>, linewidth=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ·»åŠ åœ–ä¾‹ï¼Œå°‡ä½ç½®èª¿æ•´åˆ°å³ä¸‹è§’</span></span><br><span class="line">        <span class="comment"># ax1.legend([&#x27;å·¥ç¨‹é …ç›®&#x27;], loc=&#x27;upper left&#x27;, prop=font_prop)</span></span><br><span class="line">        ax2.legend([<span class="string">&#x27;ç´¯ç©é€²åº¦&#x27;</span>], loc=<span class="string">&#x27;lower right&#x27;</span>, prop=font_prop)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># èª¿æ•´åœ–å½¢æ’ç‰ˆ</span></span><br><span class="line">        fig.tight_layout()</span><br><span class="line"></span><br><span class="line">        ax1.set_xlim(start_date - pd.Timedelta(days=<span class="number">3</span>), end_date + pd.Timedelta(days=<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># é¡¯ç¤ºåœ–å½¢</span></span><br><span class="line">        st.pyplot(fig)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸‹è¼‰ CSV æŒ‰éˆ•</span></span><br><span class="line">    csv_data = pd.DataFrame(&#123;</span><br><span class="line">        <span class="string">&#x27;date&#x27;</span>: date_range,</span><br><span class="line">        <span class="string">&#x27;progress(%)&#x27;</span>: daily_progress/<span class="number">100</span>,</span><br><span class="line">        <span class="string">&#x27;sum_progress(%)&#x27;</span>: cumulative_progress/<span class="number">100</span></span><br><span class="line">    &#125;)</span><br><span class="line">    csv_data[<span class="string">&#x27;date&#x27;</span>] = csv_data[<span class="string">&#x27;date&#x27;</span>].dt.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)  <span class="comment"># å°‡æ—¥æœŸè½‰æ›ç‚ºå­—ä¸²æ ¼å¼</span></span><br><span class="line">    csv_string = csv_data.to_csv(index=<span class="literal">False</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æä¾›ä¸‹è¼‰æŒ‰éˆ•</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> col1:</span><br><span class="line"></span><br><span class="line">        st.download_button(</span><br><span class="line">            label=<span class="string">&quot;ä¸‹è¼‰ CSV æª”æ¡ˆ&quot;</span>,</span><br><span class="line">            data=csv_string,</span><br><span class="line">            file_name=<span class="string">&#x27;progress_data.csv&#x27;</span>,</span><br><span class="line">            mime=<span class="string">&#x27;text/csv&#x27;</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="comment"># def main_eng():</span></span><br><span class="line"><span class="comment">#     ### Initialization ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     SYSTEM_VERSION = &quot;V1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     font_prop = FontProperties(fname=&#x27;./NotoSansCJK-Regular.ttc&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # Initialize data if not stored in st.session_state</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     if &#x27;data&#x27; not in st.session_state:</span></span><br><span class="line"><span class="comment">#         sample_data = [</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Foundation Construction&#x27;, &#x27;cost&#x27;: 50000, &#x27;start_date&#x27;: &#x27;2024-07-01&#x27;, &#x27;duration_days&#x27;: 5, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Structural Reinforcement&#x27;, &#x27;cost&#x27;: 120000, &#x27;start_date&#x27;: &#x27;2024-07-15&#x27;, &#x27;duration_days&#x27;: 12, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Foundation Engineering&#x27;, &#x27;cost&#x27;: 80000, &#x27;start_date&#x27;: &#x27;2024-08-01&#x27;, &#x27;duration_days&#x27;: 8, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Roof Repair&#x27;, &#x27;cost&#x27;: 100000, &#x27;start_date&#x27;: &#x27;2024-07-01&#x27;, &#x27;duration_days&#x27;: 10, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Interior Decoration&#x27;, &#x27;cost&#x27;: 60000, &#x27;start_date&#x27;: &#x27;2024-07-05&#x27;, &#x27;duration_days&#x27;: 6, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Power System Upgrade&#x27;, &#x27;cost&#x27;: 70000, &#x27;start_date&#x27;: &#x27;2024-07-20&#x27;, &#x27;duration_days&#x27;: 7, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Water Facilities Construction&#x27;, &#x27;cost&#x27;: 90000, &#x27;start_date&#x27;: &#x27;2024-07-25&#x27;, &#x27;duration_days&#x27;: 9, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Road Expansion&#x27;, &#x27;cost&#x27;: 110000, &#x27;start_date&#x27;: &#x27;2024-08-05&#x27;, &#x27;duration_days&#x27;: 11, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Greening Project&#x27;, &#x27;cost&#x27;: 80000, &#x27;start_date&#x27;: &#x27;2024-08-10&#x27;, &#x27;duration_days&#x27;: 8, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#             &#123;&#x27;project_name&#x27;: &#x27;Fire Safety System&#x27;, &#x27;cost&#x27;: 90000, &#x27;start_date&#x27;: &#x27;2024-08-15&#x27;, &#x27;duration_days&#x27;: 9, &#x27;end_date&#x27;: &#x27;&#x27;&#125;,</span></span><br><span class="line"><span class="comment">#         ]</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         st.session_state[&#x27;data&#x27;] = sample_data</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # Display UI</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     col1, col2 = st.columns([1, 2])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     with col1:</span></span><br><span class="line"><span class="comment">#         st.markdown(&quot;### :spiral_calendar_pad: Project Progress &quot; + SYSTEM_VERSION)</span></span><br><span class="line"><span class="comment">#         st.info(&quot;Author: **HankLin @202407**&quot;)</span></span><br><span class="line"><span class="comment">#         st.markdown(&quot;---&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         st.markdown(&quot;##### <span class="github-emoji" alias="point_down" style="" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f447.png?v8">&#x1f447;</span> Edit Construction Projects&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         df = pd.DataFrame(st.session_state[&#x27;data&#x27;])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         edited_df = st.data_editor(df, use_container_width=True, num_rows=&#x27;dynamic&#x27;,</span></span><br><span class="line"><span class="comment">#                                 column_config=&#123;</span></span><br><span class="line"><span class="comment">#                                     &quot;start_date&quot;: st.column_config.DateColumn(</span></span><br><span class="line"><span class="comment">#                                         &quot;Start Date&quot;,</span></span><br><span class="line"><span class="comment">#                                         min_value=date(2024, 1, 1),</span></span><br><span class="line"><span class="comment">#                                         max_value=date(2030, 1, 1),</span></span><br><span class="line"><span class="comment">#                                         format=&quot;YYYY-MM-DD&quot;,</span></span><br><span class="line"><span class="comment">#                                         step=1,</span></span><br><span class="line"><span class="comment">#                                     )</span></span><br><span class="line"><span class="comment">#                                 &#125;,</span></span><br><span class="line"><span class="comment">#                                 hide_index=True, column_order=(&quot;project_name&quot;, &quot;cost&quot;, &quot;start_date&quot;, &quot;duration_days&quot;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         edited_df[&#x27;end_date&#x27;] = edited_df[&#x27;start_date&#x27;] + pd.to_timedelta(edited_df[&#x27;duration_days&#x27;], unit=&#x27;D&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         is_show_text = st.toggle(&quot;Show Block Text&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     with col2:</span></span><br><span class="line"><span class="comment">#         fig, ax1 = plt.subplots(figsize=(14, 10))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         colors = plt.cm.Set3.colors</span></span><br><span class="line"><span class="comment">#         cnt = 0</span></span><br><span class="line"><span class="comment">#         for i, row in edited_df.iterrows():</span></span><br><span class="line"><span class="comment">#             if not pd.isna(row[&quot;duration_days&quot;]):</span></span><br><span class="line"><span class="comment">#                 color = colors[i % len(colors)]</span></span><br><span class="line"><span class="comment">#                 ax1.barh(row[&#x27;project_name&#x27;], row[&#x27;duration_days&#x27;], left=row[&#x27;start_date&#x27;], height=0.3, color=color)</span></span><br><span class="line"><span class="comment">#                 if is_show_text:</span></span><br><span class="line"><span class="comment">#                     ax1.text(row[&#x27;start_date&#x27;], cnt, f&quot;&#123;row[&#x27;project_name&#x27;]&#125;: &#123;int(row[&#x27;duration_days&#x27;])&#125; days&quot;, color=&#x27;black&#x27;, verticalalignment=&#x27;center&#x27;, fontsize=10, fontproperties=font_prop)</span></span><br><span class="line"><span class="comment">#                 cnt += 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         ax1.set_xlabel(&#x27;Date&#x27;, fontproperties=font_prop)</span></span><br><span class="line"><span class="comment">#         ax1.set_title(&#x27;Construction Progress Gantt Chart&#x27;, fontproperties=font_prop)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         for label in ax1.get_yticklabels():</span></span><br><span class="line"><span class="comment">#             label.set_fontproperties(font_prop)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         ax2 = ax1.twinx()</span></span><br><span class="line"><span class="comment">#         ax2.plot(date_range, cumulative_progress, marker=&#x27;o&#x27;, linestyle=&#x27;-&#x27;, color=&#x27;orange&#x27;)</span></span><br><span class="line"><span class="comment">#         for i, txt in enumerate(cumulative_progress):</span></span><br><span class="line"><span class="comment">#             if i % 5 == 0 or txt == 100:</span></span><br><span class="line"><span class="comment">#                 ax2.annotate(f&#x27;&#123;int(txt)&#125;%&#x27;, (date_range[i], cumulative_progress[i]), textcoords=&quot;offset points&quot;, xytext=(0, 10), ha=&#x27;center&#x27;, fontproperties=font_prop)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         ax2.set_ylabel(&#x27;Cumulative Progress (%)&#x27;, fontproperties=font_prop)</span></span><br><span class="line"><span class="comment">#         ax2.yaxis.set_major_locator(ticker.MultipleLocator(base=10))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         ax1.xaxis.set_major_locator(mdates.DayLocator(interval=10))</span></span><br><span class="line"><span class="comment">#         ax1.xaxis.set_minor_locator(mdates.DayLocator(interval=1))</span></span><br><span class="line"><span class="comment">#         ax1.xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y-%m-%d&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         ax2.grid(True, which=&#x27;both&#x27;, linestyle=&#x27;:&#x27;, linewidth=0.5)</span></span><br><span class="line"><span class="comment">#         ax2.legend([&#x27;Cumulative Progress&#x27;], loc=&#x27;lower right&#x27;, prop=font_prop)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         fig.tight_layout()</span></span><br><span class="line"><span class="comment">#         ax1.set_xlim(start_date - pd.Timedelta(days=3), end_date + pd.Timedelta(days=3))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#         st.pyplot(fig)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     # Download CSV button</span></span><br><span class="line"><span class="comment">#     csv_data = pd.DataFrame(&#123;</span></span><br><span class="line"><span class="comment">#         &#x27;date&#x27;: date_range,</span></span><br><span class="line"><span class="comment">#         &#x27;progress(%)&#x27;: daily_progress/100,</span></span><br><span class="line"><span class="comment">#         &#x27;sum_progress(%)&#x27;: cumulative_progress/100</span></span><br><span class="line"><span class="comment">#     &#125;)</span></span><br><span class="line"><span class="comment">#     csv_data[&#x27;date&#x27;] = csv_data[&#x27;date&#x27;].dt.strftime(&#x27;%Y-%m-%d&#x27;)</span></span><br><span class="line"><span class="comment">#     csv_string = csv_data.to_csv(index=False, encoding=&#x27;utf-8-sig&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     with col1:</span></span><br><span class="line"><span class="comment">#         st.download_button(</span></span><br><span class="line"><span class="comment">#             label=&quot;Download CSV File&quot;,</span></span><br><span class="line"><span class="comment">#             data=csv_string,</span></span><br><span class="line"><span class="comment">#             file_name=&#x27;progress_data.csv&#x27;,</span></span><br><span class="line"><span class="comment">#             mime=&#x27;text/csv&#x27;</span></span><br><span class="line"><span class="comment">#         )</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    </span><br><span class="line">    st.set_page_config(layout=<span class="string">&#x27;wide&#x27;</span>)</span><br><span class="line">    <span class="comment"># language_check=st.checkbox(&quot;English&quot;)</span></span><br><span class="line">    <span class="comment"># if language_check==True:</span></span><br><span class="line">        <span class="comment"># main_eng()</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    main_zh()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="é–‹ç™¼éç¨‹ç´€éŒ„">é–‹ç™¼éç¨‹ç´€éŒ„</h2>
<ul>
<li>åœ¨dataframeä¸­è™•ç†æ—¥æœŸè¦æŠŠå­—ä¸²é¡å‹çš„æ—¥æœŸé€é'pd.to_datetime'è½‰å‹æ‰èƒ½ç”¨</li>
<li>ä¸­æ–‡é¡¯ç¤ºæœƒæœ‰å•é¡Œçš„åœ°æ–¹è¦å…ˆä¸‹è¼‰å¥½å­—å‹æª”è®“'fontproperties'å¼•ç”¨</li>
<li>ç”˜ç‰¹åœ–èˆ‡ç´¯ç©é€²åº¦åœ–è¦äº¤ç–Šåœ¨åŒä¸€å¼µåœ–è¦é€é'ax2=ax1.twinx()'æ‰èƒ½é€£ä¸€èµ·</li>
<li>èª¿æ•´Xè»¸åº§æ¨™é¡¯ç¤ºæ™‚ï¼Œå¯ä»¥ç”¨'ax1.set_xlim(start_date -
pd.Timedelta(days=3), end_date +
pd.Timedelta(days=3))'ä¾†å°‡å‰å¾Œå„å¾€å¤–æ“´ä¸€äº›</li>
</ul>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
      </tags>
  </entry>
  <entry>
    <title>LINEæ©Ÿå™¨äººè‡ªå‹•å‚™ä»½ç¾¤çµ„ç…§ç‰‡</title>
    <url>/posts/3782846762/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨åŸ·è¡Œå·¥ç¨‹æ™‚ï¼Œç¶“å¸¸æœƒç‚ºäº†è¯çµ¡ç›¸é—œäº‹å®œå»ºç«‹LINEç¾¤çµ„ä¾†é€²è¡Œäº¤è«‡ï¼Œé€šå¸¸æ–½å·¥ç…§ç‰‡ä¹Ÿæœƒåœ¨é€™å€‹ç¾¤è£¡é¢é€²è¡Œä¸Šå‚³è®“å¤§å®¶å¯ä»¥ç¢ºèªå…§å®¹ï¼Œä¸Šå‚³ç…§ç‰‡åˆ°LINEç¾¤çµ„çš„æ™‚å€™é™¤äº†ç›´æ¥ä¸Šå‚³å¤–ï¼Œä¹Ÿå¯ä»¥é€éå»ºç«‹ç›¸ç°¿å°‡ç…§ç‰‡æ°¸ä¹…ä¿å­˜ã€‚</p>
<p>åœ¨LINEç¾¤çµ„çš„æª”æ¡ˆæ©Ÿåˆ¶ï¼Œç…§ç‰‡æˆ–æ–‡ä»¶æœƒæœ‰ä¸€å®šæ™‚é–“çš„å­˜æ´»æœŸï¼Œç•¶éäº†å­˜æ´»æœŸä¹‹å¾Œç…§ç‰‡å°±æœƒå‘ˆç¾ç„¡æ³•ä¸‹è¼‰çš„æƒ…å½¢ï¼Œå› æ­¤å°‡ç…§ç‰‡åšä¸€å€‹é¡å¤–å­˜æ”¾çš„å‹•ä½œç®—æ˜¯æ»¿é‡è¦çš„ä¸€å€‹æ‰‹æ®µï¼Œè€Œé€™ä»¶äº‹é™¤äº†ç¹ç‘£ä¹Ÿå¾ˆå¯èƒ½æœƒå› ç‚ºå†æ¬¡è«‹æ±‚ä¸Šå‚³çš„éç¨‹å¤šå­˜äº†ä¸å°‘å¼µ<strong>é‡è¤‡çš„ç…§ç‰‡</strong>ï¼Œè€Œé€™å€‹éƒ¨åˆ†ç›¸ä¿¡å¤§å¤šæ•¸äººéƒ½æ˜¯é€éäººçœ¼ä¾†é€²è¡Œåˆ¤åˆ¥ï¼Œç«çœ¼é‡‘ç›ç”¨ä¹…ä¹Ÿæ˜¯æœƒç´¯çš„ã€‚</p>
<blockquote>
<p>å¸Œæœ›èƒ½å¤ æ‰“é€ ä¸€å€‹ç•¶ç¾¤çµ„å…§åˆ¤å®šåˆ°ç…§ç‰‡è³‡æ–™æ™‚ï¼Œèƒ½å¤ è‡ªå‹•å‚™ä»½åˆ°æŒ‡å®šç¡¬ç¢Ÿä¸¦æ±°é™¤é‡è¤‡ç…§ç‰‡çš„æ©Ÿå™¨äººï¼Œæ¸›å°‘é€™äº›ç‘£äº‹çš„ç™¼ç”Ÿã€‚</p>
</blockquote>
<p>è‡³æ–¼ç…§ç‰‡å¾ŒçºŒè¦é€²è¡Œè™•ç†å°±å¯ä»¥åˆ©ç”¨<a
href="https://www.hanksvba.com/posts/144473154/">æ–½å·¥ç…§ç‰‡VBA</a>é€²è¡Œè³‡æ–™æ’åºã€æ‰¹æ¬¡æ”¹åã€å ±è¡¨è¼¸å‡ºã€‚</p>
<span id="more"></span>
<h2 id="æ“ä½œç•«é¢">æ“ä½œç•«é¢</h2>
<figure>
<img src="upload_53cc488e0a27cf493cd07d4905969356.png"
alt="Fig1.LINEç¾¤çµ„ç•«é¢" />
<figcaption aria-hidden="true">Fig1.LINEç¾¤çµ„ç•«é¢</figcaption>
</figure>
<figure>
<img src="upload_62b06ad5bf5b96e4922d9c01ab1de029.png"
alt="Fig2.æœ¬åœ°ç«¯å„²å­˜ç•«é¢" />
<figcaption aria-hidden="true">Fig2.æœ¬åœ°ç«¯å„²å­˜ç•«é¢</figcaption>
</figure>
<h2 id="åŸºæœ¬å·¥å…·">åŸºæœ¬å·¥å…·</h2>
<ul>
<li>LINEBOT
<ul>
<li>MessengerAPI</li>
</ul></li>
<li>ngrok
<ul>
<li>ä¸»è¦æ˜¯ç”¨ä¾†å»ºç«‹httpsé€£ç·šçµ¦LINEBOTçš„webhookä½¿ç”¨</li>
</ul></li>
<li>python
<ul>
<li>flask</li>
<li>linebotsdk</li>
</ul></li>
</ul>
<h3 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h3>
<ul>
<li><a
href="https://github.com/yaoandy107/line-bot-tutorial">LINEBOTåŸºæœ¬å»ºç«‹</a></li>
<li><a href="https://ngrok.com/download">ngrok</a></li>
<li><a
href="https://ithelp.ithome.com.tw/m/articles/10295654">æœ¬åœ°ç«¯ä½¿ç”¨ngrok</a></li>
</ul>
<h2 id="å¯¦ä½œé‚è¼¯">å¯¦ä½œé‚è¼¯</h2>
<h3 id="é å…ˆæº–å‚™å…§å®¹">é å…ˆæº–å‚™å…§å®¹</h3>
<ol type="1">
<li>å»ºç«‹flaskä¸¦å•Ÿç”¨app</li>
<li>å•Ÿç”¨ngrok</li>
<li>è¤‡è£½å°‡ngrokä¸Šé¢çš„å°å¤–é€£ç·šIP</li>
<li>è²¼åˆ°LINEBOTçš„webhook</li>
</ol>
<h3 id="è¨Šæ¯æ¥æ”¶éç¨‹">è¨Šæ¯æ¥æ”¶éç¨‹</h3>
<ol type="1">
<li>LINEBOTåœ¨æ¥å—åˆ°ç¾¤çµ„å…§çš„è¨Šæ¯æ™‚</li>
<li>åˆ¤å®šè¨Šæ¯å±¬æ€§æ˜¯å¦ç‚ºImage</li>
<li>åœ–ç‰‡å…§å®¹æœƒå…ˆæš«æ™‚æ”¾åœ¨LINEæ©Ÿæˆ¿ä¸¦ä¸”ç”Ÿæˆä¸€çµ„token</li>
<li>æ”¶åˆ°è¨Šæ¯çš„åŒæ™‚æœƒåŸ·è¡ŒAPI(Webhookæ©Ÿåˆ¶)</li>
<li>APIä¸­æœƒå°‡è¨Šæ¯åšéæ¿¾ï¼Œè—‰ç”±tokenå–å¾—ç…§ç‰‡åˆ°æœ¬åœ°ç«¯</li>
<li>æœ¬åœ°ç«¯è³‡æ–™åº«æœƒè¨˜éŒ„å·²ç¶“å­˜æ”¾çš„ç…§ç‰‡è·ŸImage_hash</li>
<li>åˆ¤å®šæ˜¯å¦æœ‰é‡è¤‡çš„image_hashï¼Œå¦‚æœ‰å‰‡å›å‚³"åœ–ç‰‡å·²å­˜åœ¨"</li>
<li>é€šéé‡è¤‡æ±°é™¤æ©Ÿåˆ¶éæ¿¾å®Œæˆå¾Œå¯å°‡ç…§ç‰‡å­˜æ”¾åˆ°æŒ‡å®šä½ç½®</li>
</ol>
<h2 id="ç¨‹å¼ç¢¼">ç¨‹å¼ç¢¼</h2>
<h3 id="webhook">webhook</h3>
<blockquote>
<p>app_local.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å­˜æ”¾åœ¨æœ¬åœ°ç«¯sqlite+æœ¬åœ°ç«¯ç¡¬ç¢Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, abort</span><br><span class="line"><span class="keyword">from</span> linebot <span class="keyword">import</span> LineBotApi, WebhookHandler</span><br><span class="line"><span class="keyword">from</span> linebot.exceptions <span class="keyword">import</span> InvalidSignatureError</span><br><span class="line"><span class="keyword">from</span> linebot.models <span class="keyword">import</span> MessageEvent, ImageMessage, TextSendMessage</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sql_utils <span class="keyword">import</span> get_db, save_photo_to_db, is_image_hash_exist</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­å®šä½ çš„ Channel Access Token å’Œ Channel Secret</span></span><br><span class="line">CHANNEL_ACCESS_TOKEN = <span class="string">&#x27;YOUR_CHANNEL_ACCESS_TOKEN&#x27;</span></span><br><span class="line">CHANNEL_SECRET = <span class="string">&#x27;YOUR_CHANNEL_SECRET&#x27;</span></span><br><span class="line"></span><br><span class="line">line_bot_api = LineBotApi(CHANNEL_ACCESS_TOKEN)</span><br><span class="line">handler = WebhookHandler(CHANNEL_SECRET)</span><br><span class="line"></span><br><span class="line">PHOTOS_DIR = <span class="string">&#x27;photos&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(PHOTOS_DIR):</span><br><span class="line">    os.makedirs(PHOTOS_DIR)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/callback&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">callback</span>():</span><br><span class="line">    <span class="comment"># ç²å– X-Line-Signature header</span></span><br><span class="line">    signature = request.headers[<span class="string">&#x27;X-Line-Signature&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç²å–è«‹æ±‚é«”</span></span><br><span class="line">    body = request.get_data(as_text=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        handler.handle(body, signature)</span><br><span class="line">    <span class="keyword">except</span> InvalidSignatureError:</span><br><span class="line">        abort(<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;OK&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@handler.add(<span class="params">MessageEvent, message=ImageMessage</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_image_message</span>(<span class="params">event</span>):</span><br><span class="line">    <span class="comment"># ç²å–åœ–åƒå…§å®¹</span></span><br><span class="line">    message_content = line_bot_api.get_message_content(event.message.<span class="built_in">id</span>)</span><br><span class="line">    image_data = message_content.content</span><br><span class="line">    image_hash = calculate_image_hash(image_data)</span><br><span class="line">    user_id = event.source.user_id</span><br><span class="line">    group_id = event.source.group_id</span><br><span class="line">    photo_properties = &#123;<span class="string">&quot;edit&quot;</span>: <span class="string">&quot;false&quot;</span>&#125;</span><br><span class="line">    photo_url=<span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">next</span>(get_db()) <span class="keyword">as</span> db:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æª¢æŸ¥åœ–ç‰‡æ˜¯å¦å·²å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> is_image_hash_exist(db, image_hash):</span><br><span class="line">            reply_text = <span class="string">&quot;åœ–ç‰‡å·²å­˜åœ¨ï¼Œæœªä¿å­˜ã€‚&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä¿å­˜åœ–ç‰‡åˆ°æœ¬åœ°è³‡æ–™å¤¾</span></span><br><span class="line">            file_name = <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&#x27;.jpg&#x27;</span></span><br><span class="line">            file_path = os.path.join(PHOTOS_DIR, file_name)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> chunk <span class="keyword">in</span> message_content.iter_content():</span><br><span class="line">                    f.write(chunk)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># ä¿å­˜åœ–ç‰‡åˆ°è³‡æ–™åº«</span></span><br><span class="line">            saved_photo = save_photo_to_db(db, user_id, group_id, file_name, photo_url, photo_properties, image_hash)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Photo saved successfully:&quot;</span>, saved_photo)</span><br><span class="line"></span><br><span class="line">            reply_text = <span class="string">&quot;åœ–ç‰‡å·²ä¿å­˜åˆ°æœ¬åœ°ç«¯ï¼&quot;</span></span><br><span class="line"></span><br><span class="line">    line_bot_api.reply_message(</span><br><span class="line">        event.reply_token,</span><br><span class="line">        TextSendMessage(text=reply_text)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_image_hash</span>(<span class="params">image_data</span>):</span><br><span class="line">    hasher = hashlib.sha256()</span><br><span class="line">    hasher.update(image_data)</span><br><span class="line">    <span class="keyword">return</span> hasher.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="meta">@handler.add(<span class="params">MessageEvent</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_message</span>(<span class="params">event</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(event.message, ImageMessage):</span><br><span class="line">        reply_text = <span class="string">&quot;è«‹å‚³é€åœ–ç‰‡è¨Šæ¯ã€‚&quot;</span></span><br><span class="line">        line_bot_api.reply_message(</span><br><span class="line">            event.reply_token,</span><br><span class="line">            TextSendMessage(text=reply_text)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>sql_utils.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine, Column, Integer, String, DateTime, JSON</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker,declarative_base</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> Session</span><br><span class="line"></span><br><span class="line">DATABASE_URL=<span class="string">&quot;sqlite:///photos.db&quot;</span></span><br><span class="line">engine = create_engine(DATABASE_URL)</span><br><span class="line">Base = declarative_base()</span><br><span class="line">SessionLocal = sessionmaker(autocommit=<span class="literal">False</span>, autoflush=<span class="literal">False</span>, bind=engine)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šç¾©æ•¸æ“šåº«æ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Photo</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&#x27;photos_backup&#x27;</span></span><br><span class="line">    <span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>, index=<span class="literal">True</span>)</span><br><span class="line">    user_id = Column(String)</span><br><span class="line">    group_id = Column(String)</span><br><span class="line">    photo_name = Column(String)</span><br><span class="line">    photo_url = Column(String)</span><br><span class="line">    photo_thumbnail_url = Column(String)</span><br><span class="line">    created_time = Column(DateTime, default=datetime.utcnow)</span><br><span class="line">    photo_properties = Column(JSON)</span><br><span class="line">    photo_image_hash = Column(String)<span class="comment">#, unique=True, nullable=False)</span></span><br><span class="line"></span><br><span class="line">Base.metadata.create_all(bind=engine)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç²å–æ•¸æ“šåº«æœƒè©±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_db</span>():</span><br><span class="line">    db = SessionLocal()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span> db</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_photo_to_db</span>(<span class="params">db, user_id,group_id, photo_name, photo_url, photo_properties,image_hash</span>):</span><br><span class="line">    new_photo = Photo(</span><br><span class="line">        user_id=user_id,</span><br><span class="line">        group_id=group_id,</span><br><span class="line">        photo_name=photo_name,</span><br><span class="line">        photo_url=photo_url,</span><br><span class="line">        photo_properties=photo_properties,</span><br><span class="line">        photo_image_hash=image_hash</span><br><span class="line">    )</span><br><span class="line">    db.add(new_photo)</span><br><span class="line">    db.commit()</span><br><span class="line">    db.refresh(new_photo)</span><br><span class="line">    <span class="keyword">return</span> new_photo</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_photo_by_id</span>(<span class="params">db: Session, photo_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">return</span> db.query(Photo).<span class="built_in">filter</span>(Photo.<span class="built_in">id</span> == photo_id).first()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_all_photos</span>(<span class="params">db: Session</span>):</span><br><span class="line">    <span class="keyword">return</span> db.query(Photo).<span class="built_in">all</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_photo_from_db</span>(<span class="params">db: Session, photo_id: <span class="built_in">int</span></span>):</span><br><span class="line">    photo = db.query(Photo).<span class="built_in">filter</span>(Photo.<span class="built_in">id</span> == photo_id).first()</span><br><span class="line">    <span class="keyword">if</span> photo:</span><br><span class="line">        db.delete(photo)</span><br><span class="line">        db.commit()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Photo with ID <span class="subst">&#123;photo_id&#125;</span> deleted successfully from database.&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;No photo found with ID <span class="subst">&#123;photo_id&#125;</span>.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_image_hash_exist</span>(<span class="params">db, image_hash</span>):</span><br><span class="line">    <span class="keyword">return</span> db.query(Photo).<span class="built_in">filter</span>(Photo.photo_image_hash == image_hash).first() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="çµèª">çµèª</h2>
<p>å¦‚æœæ‚¨æœ¬èº«åŸ·è¡Œå·¥ç¨‹å°ˆæ¡ˆæ™‚æœ‰å¤§é‡çš„ç…§ç‰‡éœ€è¦é€²è¡Œè‡ªå‹•å‚™ä»½ï¼ŒåŒæ™‚åˆæœ‰ä¸€å°é›»è…¦å¯ä»¥ä¸é—œæ©Ÿç•¶ä½œserverç”¨é€”ï¼Œå¯ä»¥å°‡ä»–å»ºç«‹å¥½pythonåŸ·è¡Œç’°å¢ƒä¸¦åƒè€ƒä¸Šè¿°çš„å…§å®¹æ­é…ä½¿ç”¨ï¼Œå¦‚æœ‰ä¸æ‡‚çš„å…§å®¹ä¹Ÿæ­¡è¿è¯ç¹«ä½œè€…ä¾†<strong>å”åŠ©æ¶è¨­LINEç¾¤çµ„æ©Ÿå™¨äºº</strong>ï¼Œè‡ªå‹•å‚™ä»½å·¥ç¨‹ç¾¤çµ„å…§éƒ¨ç…§ç‰‡çœæ™‚åˆçœåŠ›ã€‚</p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>flask</tag>
        <tag>LINEBOT</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-V3.6.0ç³»åˆ—æ›´æ–°èªªæ˜</title>
    <url>/posts/3015163677/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ <a
href="https://www.hanksvba.com/posts/1000661249/#more">æ–½å·¥æ—¥èªŒVBA-V3.5.0</a>
ç‰ˆæœ¬æ“ä½œæ•™å­¸ï¼Œéå¸¸æ„Ÿè¬å„è·¯å¥½å‹æä¾›å¯¶è²´æ„è¦‹ï¼Œæœ¬ç¯‡ä¸‹æ–¹æœƒè©³åˆ—å„ç‰ˆæœ¬ä¿®æ”¹é€²ç¨‹ä¾›å„ä½åšåƒè€ƒã€‚</p>
<ul>
<li>Feature:æ–°å¢åŠŸèƒ½</li>
<li>Fix:éŒ¯èª¤ä¿®å¾©</li>
</ul>
<span id="more"></span>
<h2 id="ä¸»è¦åŠŸèƒ½èªªæ˜">ä¸»è¦åŠŸèƒ½èªªæ˜</h2>
<h3 id="å¥‘ç´„è¨­å®šå¾Œè™•ç†å·¥å…·åŒ¯å…¥">[å¥‘ç´„è¨­å®š]å¾Œè™•ç†å·¥å…·åŒ¯å…¥</h3>
<figure>
<img src="1.png" alt="Fig1. åŒ¯å…¥ç•«é¢" />
<figcaption aria-hidden="true">Fig1. åŒ¯å…¥ç•«é¢</figcaption>
</figure>
<p>è€ƒé‡æœ‰äº›å°ˆæ¡ˆä¸ä¸€å®šæœƒç”¨PCCESä¾†è™•ç†é ç®—æ›¸å…§å®¹ï¼Œå¯èƒ½åªæ˜¯ä¸€å€‹<strong>å¾ˆåƒ</strong>çš„EXCELæª”ï¼Œæ•…æä¾›"å¥‘ç´„è¨­å®šæ¨¡æ¿"ç¯„æœ¬ä¾›ä½¿ç”¨è€…æ‰‹å‹•å¡«å¯«å†é€²è¡ŒåŒ¯å…¥ï¼Œéœ€æ³¨æ„å¡«å¯«éç¨‹<strong>é …æ¬¡ä¸èƒ½é‡è¤‡</strong>ã€‚</p>
<h3 id="æ—¥å ±å¡«å¯«å¥‘ç´„é …ç›®æœå°‹">[æ—¥å ±å¡«å¯«]å¥‘ç´„é …ç›®æœå°‹</h3>
<figure>
<img src="2.png" alt="Fig2. å¡«å¯«ç•«é¢" />
<figcaption aria-hidden="true">Fig2. å¡«å¯«ç•«é¢</figcaption>
</figure>
<p>å¥‘ç´„é …ç›®çš„ä¸‹æ‹‰å¼é¸å–®çµ„æˆç‚º"å¥‘ç´„é …æ¬¡&gt;&gt;å¥‘ç´„é …ç›®"ï¼Œæ•…å¯ä»¥é€²è¡Œå¥‘ç´„é …ç›®é—œéµå­—çš„æœå°‹æˆ–è€…å¥‘ç´„é …æ¬¡çš„é—œéµå­—æœå°‹ã€‚</p>
<blockquote>
<p>èˆ‰ä¾‹: <img src="3.png" alt="Fig3. ç¯„ä¾‹" /></p>
</blockquote>
<blockquote>
<ul>
<li>å¦‚è¦é€²è¡Œå¥‘ç´„é …æ¬¡çš„æœå°‹ï¼Œè¼¸å…¥é—œéµå­—ã€Œ<strong>ç”².å£¹</strong>ã€ï¼Œå‰‡æœƒåˆ—å‡ºæ‰€æœ‰ç”².å£¹é–‹é ­çš„å¥‘ç´„é …ç›®</li>
<li>å¦‚è¦é€²è¡Œå¥‘ç´„é …ç›®çš„æœå°‹ï¼Œè¼¸å…¥é—œéµå­—ã€Œ<strong>å®‰å…¨åœç±¬</strong>ã€ï¼Œå‰‡æœƒåˆ—å‡ºæ‰€æœ‰åç¨±å…·æœ‰<strong>å®‰å…¨åœç±¬</strong>çš„å¥‘ç´„é …ç›®ã€‚</li>
</ul>
</blockquote>
<h3 id="ä¸è¨ˆå·¥æœŸåŠŸèƒ½">ä¸è¨ˆå·¥æœŸåŠŸèƒ½</h3>
<figure>
<img src="4.png" alt="Fig4. é€²åº¦è¨­å®šç•«é¢" />
<figcaption aria-hidden="true">Fig4. é€²åº¦è¨­å®šç•«é¢</figcaption>
</figure>
<p>å»ºç«‹ä¸è¨ˆå·¥æœŸå·¥ä½œè¡¨ï¼Œå¦‚ç‚ºä¸è¨ˆå·¥æœŸçš„æ—¥æœŸæ™‚ï¼Œé€²åº¦èˆ‡å‰æ—¥æœ‰è¨ˆå·¥æœŸæ™‚ç›¸åŒ</p>
<figure>
<img src="5.png" alt="Fig5. ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig5. ç¯„ä¾‹</figcaption>
</figure>
<h3 id="è‡ªå‹•æ›è¡Œ">è‡ªå‹•æ›è¡Œ</h3>
<p>è¼¸å‡ºæ–½å·¥æ—¥èªŒæ™‚ï¼Œå¦‚æœ‰å¥‘ç´„é …ç›®æ¯”è¼ƒé•·çš„æƒ…æ³ï¼Œä»¥å¾€æ¡ç”¨æ¬„ä½å…§æ–‡å­—å¤§å°è‡ªå‹•ç¸®æ”¾é€²è¡Œè™•ç†ï¼Œç„¶è€Œå¦‚æ–‡å­—é•·åº¦éé•·æ™‚ï¼Œæœƒè®“å¥‘ç´„é …ç›®è®Šå¾—ç„¡æ³•è‚‰çœ¼è­˜åˆ¥ï¼Œå› æ­¤æ”¹ç”¨è‡ªå‹•æ›è¡Œæ­é…åˆ—é«˜è‡ªå‹•èª¿æ•´è™•ç†ã€‚</p>
<hr />
<h2 id="ä¸»è¦éŒ¯èª¤èªªæ˜">ä¸»è¦éŒ¯èª¤èªªæ˜</h2>
<h3 id="æ¬„ä½å¯¬åº¦æ‘ºç–Šé¡¯ç¤º">æ¬„ä½å¯¬åº¦æ‘ºç–Šé¡¯ç¤º</h3>
<figure>
<img src="6.png" alt="Fig6. æ¬„ä½æ‘ºç–Šç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig6. æ¬„ä½æ‘ºç–Šç¯„ä¾‹</figcaption>
</figure>
<p>æ¬„ä½å¯¬åº¦ä¸è¶³ä»¥é¡¯ç¤ºæ—¥æœŸæ™‚ï¼ŒEXCELå…§å»ºçš„æœå°‹åŠŸèƒ½æœƒå¤±æ•ˆï¼Œæ•…åœ¨é€²è¡Œæœå°‹å‰å…ˆé‡å°é è¨ˆè¦æœå°‹çš„å·¥ä½œè¡¨é€²è¡Œæ¬„å¯¬è‡ªå‹•é©æ‡‰ã€‚</p>
<h3 id="å·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿ">å·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿ</h3>
<p>åŸå·¥æ–™è¨­å®šéç¨‹åœ¨ç·¨è™Ÿæ™‚æœƒé€éè¨ˆç®—åŒæ€§è³ªçš„å€‹æ•¸åšåŠ ç¸½å¾ŒåŠ ä¸€æ›ç®—ï¼Œå¦‚æœæœ‰å…ˆé€²è¡Œåˆªé™¤å†è‡ªå‹•ç·¨è™Ÿçš„è©±æœƒæœ‰ç·¨è™Ÿé‡ç–Šçš„å•é¡Œï¼Œå°è‡´å ±è¡¨è¼¸å‡ºæ™‚çš„æœå°‹åŠŸèƒ½ç•°å¸¸ï¼Œæ•…æ”¹ç‚ºè‡ªå‹•ç·¨è™Ÿä¹‹å‰å…ˆé‡å°åŒæ€§è³ªçš„å…§å®¹æ’åºå¾Œå–æœ€å¤§å€¼åŠ ä¸€æ›ç®—ã€‚</p>
<hr />
<h2 id="ç‰ˆæœ¬ç´°ç¯€">ç‰ˆæœ¬ç´°ç¯€</h2>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 8%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="header">
<th>ç‰ˆæœ¬è™Ÿ</th>
<th>å‹æ…‹</th>
<th>å…§å®¹</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>V3.6.6</td>
<td>Feature</td>
<td>æ•¸é‡è¨ˆç®—è¡¨é å°¾åŠ å…¥ç¬¬Oé /å…±Oé </td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>ä¿®æ­£å·¥æ–™è¨­å®šè‡ªå‹•ç·¨è™Ÿé‡è¤‡å•é¡Œ</td>
</tr>
<tr class="odd">
<td>V3.6.5</td>
<td>Fix</td>
<td>èª¿æ•´å„è¡¨æ¬„ä½è‡ªå‹•ç¸®æ”¾ï¼Œé¿å…å‡ºç¾###å½±éŸ¿æœå°‹</td>
</tr>
<tr class="even">
<td>V3.6.4</td>
<td>Fix</td>
<td>åˆ—å°å ±è¡¨æ™‚é è¨­ç‚ºç¬¬ä¸€å€‹å ±è¡¨é …ç›®</td>
</tr>
<tr class="odd">
<td>V3.6.3</td>
<td>Fix</td>
<td>ç¬¬å…­é …åˆ—é«˜è‡ªå‹•èª¿æ•´</td>
</tr>
<tr class="even">
<td>V3.6.2</td>
<td>Fix</td>
<td>ä¿®å¾©clsInfoæŸ¥æ‰¾æ¬„ä½å•é¡Œã€åˆ—å°æ—¥å ±å‰æœƒå…ˆé€²è¡Œé€²åº¦é‡æ•´</td>
</tr>
<tr class="odd">
<td>V3.6.1</td>
<td>Fix</td>
<td>ä¿®å¾©å‘ˆç¾ç«£å·¥æ—¥æœŸæ¬„ä½æ‰¾å°‹å•é¡Œ(clsReport)</td>
</tr>
<tr class="even">
<td>V3.6.0</td>
<td>Feature</td>
<td>ç¬¬äºŒå¤§é …è·Ÿç¬¬ä¸‰å¤§é …æ•¸é‡æ²’æœ‰å°±å¢åˆ—ä¸€è¡Œç©ºç™½åˆ—</td>
</tr>
<tr class="odd">
<td></td>
<td>Feature</td>
<td>æ–½å·¥æ—¥èªŒæˆæœä¾ç…§æ—¥æœŸå‘ˆç¾(åŸæœ¬è¨­è¨ˆç‚ºæŒ‰ç…§ç·¨è™Ÿ)</td>
</tr>
<tr class="even">
<td></td>
<td>Feature</td>
<td>æ©Ÿå…·ã€äººåŠ›ã€ææ–™æŒ‰ç…§é¡åˆ¥æ’åº</td>
</tr>
<tr class="odd">
<td>V3.5.12</td>
<td>Fix</td>
<td>æ•¸é‡è¨ˆç®—è¡¨åŸå‘ˆç¾0.00ä¿®æ­£ç‚º-</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>å‰æœŸå®Œæˆæ•¸é‡å…¬å¼ä¿®æ­£</td>
</tr>
<tr class="odd">
<td></td>
<td>Fix</td>
<td>æ•¸é‡è¨ˆç®—è¡¨è¡¨å ±ç·¨è™Ÿæ¬„ä½è£œä¸ŠéŒ¯èª¤æ§åˆ¶</td>
</tr>
<tr class="even">
<td>V3.5.11</td>
<td>Fix</td>
<td>å·¥æ–™è¨­å®šä¸‹æ‹‰å¼é¸å–®æ›´æ–°ï¼Œä¿®æ”¹ç”Ÿæ•ˆæ—¥æ§åˆ¶ï¼Œå¯ä»¥é€²è¡Œåˆªé™¤</td>
</tr>
<tr class="odd">
<td></td>
<td>Feature</td>
<td>frmDataå‰©é¤˜æ•¸é‡æé†’ç´…å­—å¢åŠ è­¦å‘Šè¦–çª—!</td>
</tr>
<tr class="even">
<td></td>
<td>Feature</td>
<td>è¡¨å–®é¡¯ç¤ºä¿®æ”¹æˆ"ä¸"å¼·åˆ¶éŸ¿æ‡‰</td>
</tr>
<tr class="odd">
<td></td>
<td>Fix</td>
<td>P008 åˆ—é«˜è‡ªå‹•èª¿æ•´</td>
</tr>
<tr class="even">
<td>V3.5.10</td>
<td>Feature</td>
<td>åŠ å…¥æœå°‹åŠŸèƒ½ï¼Œå¯ä»¥æœå°‹é …ç›®æˆ–æœå°‹é …æ¬¡ï¼Œç©ºç™½å‰‡å…¨é¡¯</td>
</tr>
<tr class="odd">
<td></td>
<td>Feature</td>
<td>åŠ å…¥æ–°å ±è¡¨ï¼Œå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ä¸å«é …æ¬¡)ï¼Œä¿®å¾©æœ¬æ—¥ä¸æ–½å·¥æ¬„ä½</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>æ–°å¢æ•¸é‡è¨ˆç®—è¡¨ï¼Œå·¥ä½œè¡¨åç‚ºå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(æœˆåº•)</td>
</tr>
<tr class="odd">
<td></td>
<td>Fix</td>
<td>æ–½å·¥é …ç›®å‘ˆç¾çš„æ•¸é‡åˆ°å°æ•¸é»å¾Œç¬¬2ä½ï¼ŒNumberformatlocal</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>è¡¨å ±ç·¨è™Ÿé¡¯ç¤ºä¿®æ”¹ç‚º&lt;<å¥‘ç´„ç·¨è™Ÿ>&gt;ï¼Œä½¿ç”¨å­—ä¸²æ ¼å¼</td>
</tr>
<tr class="odd">
<td>V3.5.9</td>
<td>Feature</td>
<td>åŠ å…¥æ–°å ±è¡¨ï¼Œå»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(æœˆåº•)ï¼Œç‚ºæ•¸é‡è¨ˆç®—è¡¨</td>
</tr>
<tr class="even">
<td></td>
<td>Feature</td>
<td>è¼¸å‡ºå ±è¡¨æ™‚å­—é«”å¤§å°è¨­ç½®10ptç‚ºè‡ªå‹•æ›è¡Œï¼ŒåšAutoFité¡¯ç¤º</td>
</tr>
<tr class="odd">
<td></td>
<td>Fix</td>
<td>èª¿æ•´å¥‘ç´„é …ç›®ä¸»é …å¤§é¡åˆ¤å®šæ¬„ä½ç‚º"å–®ä½"=ç©ºç™½</td>
</tr>
<tr class="even">
<td></td>
<td>Feature</td>
<td>åŠ å…¥å¥‘ç´„é …ç›®æ¨™è¨˜"H"ç‚ºæŠ˜ç–Šé …ç›®</td>
</tr>
<tr class="odd">
<td>V3.5.8</td>
<td>Fix</td>
<td>ä¿®å¾©eng_pgs&lt;&gt;1çš„éŒ¯èª¤ï¼Œå¦‚æœç‚ºdoubleéœ€è¦å…ˆåšround(x,6)</td>
</tr>
<tr class="even">
<td></td>
<td>Feature</td>
<td>åŠ å…¥ä¸è¨ˆå·¥æœŸåŠŸèƒ½ï¼ŒåŠŸèƒ½ä½æ–¼frmPgsçš„å³ä¸‹è§’</td>
</tr>
<tr class="odd">
<td>V3.5.7</td>
<td>Fix</td>
<td>åŠ å…¥"æœ¬æ—¥ç„¡æ–½å·¥"é …ç›®ï¼Œé è¨­é€²åº¦ç‚ºå‰æ—¥ç´¯è¨ˆé€²åº¦</td>
</tr>
<tr class="even">
<td>V3.5.6</td>
<td>Fix</td>
<td>åˆ—å°å ±è¡¨æ™‚éš±è—ç©ºç™½åˆ—ä½ææ–™åç¨±åµæ¸¬ä¿®å¾©(hideEmptyRow)</td>
</tr>
<tr class="odd">
<td>V3.5.5</td>
<td>Feature</td>
<td>åŸºæœ¬æ“ä½œæ¬Šé™æ§ç®¡åŠ å…¥clsFetchURL</td>
</tr>
<tr class="even">
<td>V3.5.4</td>
<td>Fix</td>
<td>å¥‘ç´„é …ç›®ä¸­ä¸»é …ç›®åˆ¤å®šä¿®å¾©(IsMainItems(cont))</td>
</tr>
<tr class="odd">
<td></td>
<td>Feature</td>
<td>å¥‘ç´„é …ç›®å¯ä»¥å¼•å…¥å¾Œè™•ç†å·¥å…·ç”¢ç”Ÿä¹‹excel</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>ä¸è¨ˆå…¥é€²åº¦é …ç›®ä»æä¾›çµ¦ä½¿ç”¨è€…é€²è¡Œå¡«å¯«</td>
</tr>
<tr class="odd">
<td>V3.5.3</td>
<td>TODO</td>
<td>æ–°å¢ç›£é€ å ±è¡¨(ç®¡ç†è™•)ç‰ˆæœ¬-å°šæœªå®Œæˆ</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>è®Šæ›´è¨­è¨ˆå¾Œå…¶å¥‘ç´„æ•¸é‡ç‚º0çš„ç›£é€ æ—¥å ±é¡¯ç¤ºæ–‡å­—ä¿®æ­£</td>
</tr>
<tr class="odd">
<td></td>
<td>Feature</td>
<td>æ–°å¢getRangeByKeyï¼Œå„ªåŒ–adjustRowã€hideEmptyRow</td>
</tr>
<tr class="even">
<td>V3.5.2</td>
<td>Fix</td>
<td>è³‡æ–™è¦é€²å…¥å„è¡¨æ™‚ï¼Œå…ˆåšå¥½æ¬„ä½æ ¼å¼è™•ç†(æ—¥æœŸ)</td>
</tr>
<tr class="odd">
<td>V3.5.1</td>
<td>Fix</td>
<td>ç•¶ç·¨è¼¯æ—¥å ±å¼•å…¥è³‡æ–™è‡³frmDataæ™‚ï¼Œå†é€²è¡Œæ–°å¢ç„¡æ³•æ¸…ç©º(clearFrmDataInfo)</td>
</tr>
<tr class="even">
<td></td>
<td>Fix</td>
<td>æ—¥å ±è¡¨å–®åŸæœ¬é è¨­éæ˜¯å³ç„¡ï¼Œæ–°å¢ç©ºç™½é …ç›®ä¸¦è¨­å®šç‚ºé è¨­</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
        <tag>ExcelVBA</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡</title>
    <url>/posts/997099184/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ <a
href="https://www.hanksvba.com/posts/1000661249/#more">æ–½å·¥æ—¥èªŒVBA-V3.5.0</a>
ç‰ˆæœ¬æ“ä½œæ•™å­¸</p>
<p>ç‰ˆé¢æ ¼å¼æœ‰å¯èƒ½å› ç‚ºæ¥­ä¸»çš„è¦æ±‚æˆ–å§”å“¡çš„è¦æ±‚è€Œæœ‰äº›è¨±ä¸åŒï¼Œé›£ä»¥åƒç¯‡ä¸€å¾‹çš„å…§å®¹æ‡‰ä»˜æ‰€æœ‰çš„æ©Ÿé—œï¼Œç•¶åˆåœ¨è¨­è¨ˆè»Ÿé«”æ™‚å°±æœ‰è€ƒé‡åˆ°é€™å€‹éƒ¨åˆ†ï¼Œæ•…è®“å ±è¡¨ç”Ÿæˆçš„éç¨‹ç›¡å¯èƒ½çš„å½ˆæ€§ï¼Œèƒ½å¤ åœ¨é€™å€‹èªªAæ”¹Bçš„ç’°å¢ƒä¸‹å¥½å¥½é©æ‡‰å„ç¨®ç‹€æ³ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç´¹æ–½å·¥æ—¥èªŒVBAå¯ä¾›è¼¸å‡ºçš„å ±è¡¨æ ¼å¼åŠå¾®èª¿ç‰ˆå‹çš„æ–¹æ³•ï¼Œç›¡å¯èƒ½ä»¥å…¬ç‰ˆä½œç‚ºé è¨­ï¼ŒçœŸçš„éœ€è¦å†ä¾†èª¿æ•´ã€‚</p>
<p>ä»¥ä¸‹ç›¸é—œè¨­å®šæŒ‰éˆ•çš†éœ€é€éå·¥ä½œè¡¨"ç‰ˆæœ¬èªªæ˜"é»é¸æŒ‰éˆ•ã€åŠŸèƒ½ä¸»è¦ç•«é¢ã€‘å¾Œé€²è¡Œã€‚</p>
<span id="more"></span>
<h2 id="å ±è¡¨æ ¼å¼">å ±è¡¨æ ¼å¼</h2>
<figure>
<img src="1.png" alt="Fig1. åˆ—å°æ—¥å ±ä»‹é¢" />
<figcaption aria-hidden="true">Fig1. åˆ—å°æ—¥å ±ä»‹é¢</figcaption>
</figure>
<h3 id="å¥‘ç´„é …ç›®åˆ†é¡">å¥‘ç´„é …ç›®åˆ†é¡</h3>
<ul>
<li>ç´¯ç©æ•¸é‡ä¸ç‚º0(æ›¾ç¶“æ–½ä½œçš„å·¥é …)</li>
<li>æœ¬æ—¥æ•¸é‡ä¸ç‚º0(ä»Šå¤©æ–½ä½œçš„å·¥é …)</li>
<li>å…¨éƒ¨å¥‘ç´„é …ç›®</li>
</ul>
<h3 id="ç‰ˆå‹åˆ†é¡">ç‰ˆå‹åˆ†é¡</h3>
<ul>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯)</li>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯)</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>ç›£é€ å ±è¡¨(ç¬¬ä¸€è¯)</li>
</ul>
<blockquote>
<p>å¦‚æœ<strong>å¥‘ç´„é …ç›®åˆ†é¡</strong>æ¡ç”¨<strong>æœ¬æ—¥æ•¸é‡ä¸ç‚º0</strong>é™¤æ¯æ—¥å›ºå®šè¦è¼¸å‡ºçš„ç¬¬ä¸€è¯å¤–ï¼Œæœƒåœ¨æ¯æœˆæˆ–æ¯å‘¨å†å¦å¤–è£½ä½œç¬¬äºŒè¯ï¼Œé »ç‡è¦–æ©Ÿé—œè¦å®šè€Œå®šã€‚</p>
</blockquote>
<h2 id="å¾®èª¿ç‰ˆå‹">å¾®èª¿ç‰ˆå‹</h2>
<p>æ¯å€‹æª”æ¡ˆéƒ½æœƒæœ‰å›ºå®šçš„ç‰ˆå‹ï¼Œå…¶ç¯„æœ¬ä½æ–¼å·¥ä½œè¡¨åç¨±:</p>
<ul>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ</li>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>ç›£é€ æ—¥å ±</li>
</ul>
<figure>
<img src="2.png" alt="Fig2. ç‰ˆå‹å·¥ä½œè¡¨" />
<figcaption aria-hidden="true">Fig2. ç‰ˆå‹å·¥ä½œè¡¨</figcaption>
</figure>
<h3 id="ä¸»è¦é—œéµå­—">ä¸»è¦é—œéµå­—</h3>
<p>ç¯„æœ¬ä¸­ç”±&lt;&lt;&gt;&gt;åŒ…ä½çš„å„²å­˜æ ¼æ–‡å­—<strong>ä¸èƒ½æ”¹è®Š</strong>ï¼Œèˆ‰ä¾‹:&lt;<å·¥ç¨‹åç¨±>&gt;</p>
<h3 id="æ–‡å­—å¤§å°å¾®èª¿">æ–‡å­—å¤§å°å¾®èª¿</h3>
<p>å¦‚æœåˆ—å°æ™‚ç™¼ç¾<strong>æ–‡å­—å¤ªå¤§æˆ–å¤§å°</strong>ï¼Œéƒ½å¯ä»¥<strong>ç›´æ¥ä¿®æ”¹</strong>ï¼Œä¸è¦å½±éŸ¿åˆ°åŸæœ¬çš„æ–‡å­—å…§å®¹å³å¯ã€‚</p>
<h3 id="é¡å¤–åŠ è¨»æ–‡å­—">é¡å¤–åŠ è¨»æ–‡å­—</h3>
<p>å¯ä»¥åœ¨ä¸å½±éŸ¿åŸæœ¬çš„å„²å­˜æ ¼æ–‡å­—å…§å®¹ä¸‹ï¼Œé¡å¤–åŠ å…¥è¨»è¨˜äº‹é …åˆ°ç‰ˆé¢ä¸­ï¼ŒæƒŸé ˆæ³¨æ„ä¸èƒ½è½åœ¨åŸæœ¬è¦ç”Ÿæˆæ¸…å–®çš„è·¯ç·šä¸Šã€‚</p>
<p>èˆ‰ä¾‹:å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒçš„ç¬¬äºŒé …ã€å·¥åœ°ææ–™ç®¡ç†æ¦‚æ³(åˆ—è™Ÿ108~128)é›–ç„¶éƒ½æ˜¯ç©ºç™½çš„ï¼Œä½†å®ƒå±¬æ–¼ææ–™çš„æ¸…å–®æ˜ç´°è·¯ç·šï¼Œä¸èƒ½å†æ’å…¥å…¶ä»–é—œéµå­—ä½¿ç”¨ã€‚</p>
<figure>
<img src="3.png" alt="Fig3. ä¸èƒ½é¡å¤–åŠ è¨»ä¹‹æ¸…å–®æ˜ç´°" />
<figcaption aria-hidden="true">Fig3. ä¸èƒ½é¡å¤–åŠ è¨»ä¹‹æ¸…å–®æ˜ç´°</figcaption>
</figure>
<h2 id="åˆ—å°æˆæœ">åˆ—å°æˆæœ</h2>
<h3 id="æ¸¬è©¦ç‰ˆ">æ¸¬è©¦ç‰ˆ</h3>
<ul>
<li>é è¨­åˆ—å°æˆpdf(æœ‰åŠ å…¥æµ®æ°´å°ï¼Œåƒ…ä¾›<strong>æ¸¬è©¦åŠŸèƒ½ä½¿ç”¨</strong>)</li>
</ul>
<figure>
<img src="4.png" alt="Fig4. æ¸¬è©¦ç‰ˆæˆå“" />
<figcaption aria-hidden="true">Fig4. æ¸¬è©¦ç‰ˆæˆå“</figcaption>
</figure>
<hr />
<h3 id="æ­£å¼ç‰ˆ">æ­£å¼ç‰ˆ</h3>
<ul>
<li>é è¨­åˆ—å°æˆxls(å¯ä»¥ç›´æ¥æ‰¹æ¬¡è¼¸å‡ºï¼Œåˆ—å°æ™‚å¯ä»¥é¸æ“‡<strong>åˆ—å°æ•´æœ¬æ´»é ç°¿</strong>)</li>
</ul>
<figure>
<img src="5.png" alt="Fig5. æ­£å¼ç‰ˆæˆå“" />
<figcaption aria-hidden="true">Fig5. æ­£å¼ç‰ˆæˆå“</figcaption>
</figure>
<h2 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h2>
<p><a href="https://www.hanksvba.com/posts/1990910755"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/426352985"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡</title>
    <url>/posts/426352985/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ <a
href="https://www.hanksvba.com/posts/1000661249/#more">æ–½å·¥æ—¥èªŒVBA-V3.5.0</a>
ç‰ˆæœ¬æ“ä½œæ•™å­¸</p>
<p>å¾å‰ç¯‡ç¬¬1æ­¥é©Ÿé–‹å§‹é€²è¡Œçš„æœ‹å‹ï¼Œæœƒç™¼ç¾æœ‰ä¸€å€‹ç”Ÿæ•ˆæ—¥æ˜¯ç©ºç™½çš„ï¼Œé€™å°±æ˜¯è®“ä½¿ç”¨è€…è¦é–‹å§‹å¡«å¯«æ—¥å ±å‰çš„æœ€å¾Œç¢ºèªï¼Œç¢ºèªç„¡èª¤å¾Œä¾¿æœƒå°‡ç”Ÿæ•ˆæ—¥åŠ è¨»(ç¬¬ä¸€æ¬¡åŠ è¨»æœƒèˆ‡é–‹å·¥æ—¥ç›¸åŒ)ï¼Œæ­¤æ™‚<strong>æ‰èƒ½é–‹å§‹å¡«å¯«æ—¥å ±</strong>ï¼Œå¡«å¯«æ—¥å ±å¾Œéœ€è¦é»é¸"å„²å­˜æ—¥å ±"è³‡æ–™æ‰æœƒç”Ÿæ•ˆï¼Œå–æ¶ˆå¡«å¯«æ™‚åªèƒ½é€éæŒ‰éˆ•"å–æ¶ˆå¡«å¯«"ï¼Œä¸èƒ½é»é¸å³ä¸Šè§’çš„Xã€‚</p>
<p>å¡«å¯«æ—¥å ±çš„éç¨‹ï¼Œå¯ä»¥åœ¨ç‰ˆæœ¬èªªæ˜ä¸­çš„"åŠŸèƒ½ä¸»è¦ç•«é¢"è£¡é¢å°æ—¥å ±é€²è¡Œæ–°å¢ã€ç·¨è¼¯ã€åˆªé™¤ï¼Œæœ‰é—œæ—¥å ±å¡«å¯«å…§å®¹åˆ†ç‚ºä»¥ä¸‹å¹¾ç¨®å…§å®¹:</p>
<ol type="1">
<li>åŸºæœ¬è³‡è¨Š</li>
<li>å¥‘ç´„é …ç›®</li>
<li>ææ–™</li>
<li>äººåŠ›</li>
<li>æ©Ÿå…·</li>
<li>å…¶ä»–å‚™è¨»</li>
<li>ç›£é€ éƒ¨åˆ†</li>
</ol>
<span id="more"></span>
<h2 id="åŸºæœ¬è³‡è¨Š">åŸºæœ¬è³‡è¨Š</h2>
<h3 id="æ—¥æœŸ">æ—¥æœŸ</h3>
<p>æ—¥æœŸåœ¨é€²è¡Œæ–°å¢æ—¥å ±çš„æ™‚å€™ä¾¿æœƒè¦æ±‚è¼¸å…¥ï¼Œå¦‚æœæœ‰é‡è¤‡å‰‡æœƒè­¦ç¤ºå·²ç¶“æœ‰å¡«å¯«éäº†ï¼Œæœ¬ç¯‡æ—¨åœ¨ä»‹ç´¹å·¥ç¨‹å°ˆæ¡ˆé¡å‹ï¼Œè€Œéé–‹å£å¥‘ç´„é¡å‹ï¼ŒåŸå‰‡æ¯æ—¥æœƒæœ‰ä¸€ç¯‡æ—¥å ±ä½œç‚ºç´€éŒ„ä½¿ç”¨ã€‚</p>
<p>æˆ‘æœ‰é ç•™ä¸€æ—¥å¤šè¡¨çš„æ“´å……ç¨‹å¼ç¢¼ï¼Œå¦‚æœæœ‰éœ€è¦è«‹è¯çµ¡æˆ‘é€²è¡Œä¿®æ”¹ã€‚</p>
<h3 id="å¤©æ°£">å¤©æ°£</h3>
<p>å¤©æ°£éƒ¨åˆ†åˆ†ç‚ºä¸Šåˆè·Ÿä¸‹åˆï¼Œå…§å®¹æœ‰æ™´ã€é™°ã€é›¨ï¼Œæœªä¾†é å®šæœƒæä¾›ä¸€å€‹åƒè€ƒæ¸¬ç«™ï¼Œé€éä¸­å¤®æ°£è±¡å±€APIå»å–å¾—ç›¸å°æ™‚æ®µçš„è‡ªå‹•æ¸¬å ±å…§å®¹ã€‚</p>
<h2 id="å¥‘ç´„é …ç›®">å¥‘ç´„é …ç›®</h2>
<h3 id="é …ç›®">é …ç›®</h3>
<figure>
<img src="upload_002d5b23b669e4f8fc082cd7b630bd9a.png"
alt="Fig1. é …ç›®" />
<figcaption aria-hidden="true">Fig1. é …ç›®</figcaption>
</figure>
<p>å¥‘ç´„é …ç›®å¡«å¯«ä¾†æºç‚ºå¥‘ç´„è¨­å®šçš„é …ç›®ï¼Œæœ‰é—œå¥‘ç´„é …ç›®æœ‰å…©é …ç‰¹åˆ¥è¦æ³¨æ„çš„äº‹é …:</p>
<ol type="1">
<li>è¨­å®šç‚ºä¸åˆ—å…¥é€²åº¦é …ç›®ï¼Œå‰‡ä¸æœƒè¢«è¨ˆå…¥é€²åº¦æ›ç®—æ™‚çš„åˆ†æ¯ã€‚</li>
<li>è¨­å®šç‚ºç™¼åŒ…å·¥ä½œè²»å¤–çš„é …ç›®ï¼Œå‰‡ä¸æœƒé¡¯ç¤ºæ–¼ä¸‹æ‹‰å¼é¸å–®ä¸­ã€‚</li>
</ol>
<p>é¸å–å¥‘ç´„é …ç›®å¾Œï¼ŒæœƒåŒæ­¥å‘ˆç¾è©²é …ç›®ä¹‹å¥‘ç´„æ•¸é‡ã€ç´¯è¨ˆæ•¸é‡ï¼Œå¡«å¯«æ–½ä½œæ•¸é‡æ™‚ï¼ŒæœƒåŒæ™‚æ–¼å³å´é¡¯ç¤ºå‰©é¤˜æ•¸é‡ï¼Œå¦‚å‡ºç¾ç´…è‰²è¡¨ç¤ºå‰©é¤˜æ•¸é‡ç‚ºè² å€¼ã€ç¶ è‰²è¡¨ç¤ºä»æœ‰å‰©é¤˜æ•¸é‡å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>è¼¸å…¥å®Œç•¢é»é¸"æ–°å¢"ï¼Œé …ç›®å°‡æœƒåˆ—æ–¼ä¸‹æ–¹æš«å­˜å€åŸŸï¼Œå¯ä»¥ç­‰æ‰€æœ‰é …ç›®(åŒ…å«å¾ŒçºŒå…§å®¹çš†å®Œæˆå¾Œ)åœ¨ä¸€ä½µé»é¸"å„²å­˜æ—¥å ±"ï¼Œæ­¤æ™‚è³‡æ–™æ‰æœƒæ­£å¼åŒ¯å…¥æ—¥å ±ä¸­ã€‚</p>
<h3 id="é€²åº¦">é€²åº¦</h3>
<p>é€²å…¥ç•«é¢æ™‚ï¼Œæœƒé å…ˆå–å¾—ç´¯ç©è‡³å‰æ—¥ä¹‹é‡‘é¡åŠé€²åº¦ï¼Œç•¶å¡«å¯«é …ç›®å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•æ›ç®—æœ¬æ—¥é‡‘é¡èˆ‡æœ¬æ—¥é€²åº¦å‘ˆç¾æ–¼å·¦ä¸‹è§’ï¼Œå…©æ¨£æ•¸å€¼åŠ ç¸½å¾Œå–å¾—æœ¬æ—¥ç´¯ç©å¯¦éš›é€²åº¦ï¼ŒåŒæ™‚æœƒæ ¹æ“šå¯¦éš›é€²åº¦èˆ‡é å®šé€²åº¦çš„å·®ç•°å‘ˆç¾ç´…è‰²æˆ–ç¶ è‰²ã€‚</p>
<h2 id="ææ–™äººåŠ›æ©Ÿå…·">ææ–™ã€äººåŠ›ã€æ©Ÿå…·</h2>
<p>é …ç›®ä¾†æºç‚ºå·¥æ–™è¨­å®šï¼Œé€™è£¡æ¯”è¼ƒå–®ç´”æ²’æœ‰å…¶ä»–å…§å®¹ï¼Œåƒ…ä½œç‚ºç´€éŒ„ä½¿ç”¨ï¼Œæ–¼å·¥æ–™è¨­å®šä¸­å¦‚æœ‰å¡«å¯«å…¶ç›¸é—œå–®åƒ¹ï¼Œæœªä¾†å¯ä»¥åŠ å…¥åŠŸèƒ½è¼¸å‡ºçµ±è¨ˆé•·è¡¨ï¼Œè®“ç®¡ç†è€…æ¸…æ¥šç›®å‰æ‰€æ”¯å‡ºçš„å…§å®¹ï¼ŒåŒ…å«äººåŠ›è²»ç”¨ã€ææ–™è²»ç”¨ã€æ©Ÿå…·è²»ç”¨ï¼Œæ–¹ä¾¿èˆ‡ä¼°é©—è«‹æ¬¾å¾Œçš„ç¾é‡‘æµåšæ¯”å°è©•ä¼°è²¡å‹™æ”¯å‡ºæ”¶å…¥ç‹€æ³ã€‚</p>
<figure>
<img src="upload_abe97fd1ed633682823960c24a3542af.png"
alt="Fig2. å·¥æ–™è¨­å®šç•«é¢" />
<figcaption aria-hidden="true">Fig2. å·¥æ–™è¨­å®šç•«é¢</figcaption>
</figure>
<h2 id="å…¶ä»–å‚™è¨»">å…¶ä»–å‚™è¨»</h2>
<figure>
<img src="upload_f1f414d001074694b0a6fd123c72f45f.png"
alt="Fig3. å…¶ä»–å‚™è¨»" />
<figcaption aria-hidden="true">Fig3. å…¶ä»–å‚™è¨»</figcaption>
</figure>
<p>æœ‰é—œå…¶ä»–æ¯”è¼ƒé•·çš„æ–‡å­—ç´€éŒ„éƒ¨åˆ†çš†æœƒåœ¨æ­¤é€²è¡Œï¼Œä¹‹å‰å§”å“¡æœ‰èªªéæ ¼å­ä¸èƒ½å¡—é»‘ï¼Œè¦æ‰“å‹¾ï¼Œé€™è£¡æœ‰æä¾›é¸é …çµ¦ä½¿ç”¨è€…é¸å–ï¼Œå¦‚æœè®“é›»è…¦æ‰“å‹¾ä¹Ÿä¸è¡Œï¼Œè«‹é¸å–å…©é‚Šéƒ½æ˜¯ç©ºç™½æ¡†æ¡†ã€‚</p>
<p>å¦é—œæ–¼æ–½å·¥å–æ¨£è©¦é©—ç´€éŒ„èˆ‡é‡è¦äº‹é …ç´€éŒ„æœªä¾†é è¨ˆæœƒèˆ‡æ”¶ç™¼æ–‡ç³»çµ±ã€å“ç®¡ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼Œè«‹å†ç¨ç­‰ä¸‹!</p>
<h2 id="ç›£é€ éƒ¨åˆ†">ç›£é€ éƒ¨åˆ†</h2>
<p>å¦‚æœåªæœ‰å–®ç´”è¦åšæ–½å·¥æ—¥èªŒçš„ä½¿ç”¨è€…ï¼Œå¯ä»¥è·³éé€™ä¸€å€‹æ­¥é©Ÿã€‚</p>
<figure>
<img src="4.png" alt="Fig4. ç›£é€ éƒ¨åˆ†" />
<figcaption aria-hidden="true">Fig4. ç›£é€ éƒ¨åˆ†</figcaption>
</figure>
<p>æœ‰é—œå…¶ä»–æ¯”è¼ƒé•·çš„æ–‡å­—ç´€éŒ„éƒ¨åˆ†çš†æœƒåœ¨æ­¤é€²è¡Œï¼Œæ‰“å‹¾æƒ…æ³ä¸€æ¨£æœ‰åšè€ƒé‡ï¼ŒåŒæ¨£æä¾›ä¸‰ç¨®æƒ…æ³ä¾›ä½¿ç”¨è€…é¸å–ã€‚</p>
<p>ç›®å‰å·¥ç¨‹é€²è¡Œæƒ…æ³ï¼Œå¯ä»¥<strong>è‡ªè¡Œå¡«å¯«</strong>æˆ–è€…æ˜¯é€éå‰é¢å¡«å¯«ä¹‹å¥‘ç´„é …ç›®åš<strong>ç™¾åˆ†æ¯”æ›ç®—</strong>å‘ˆç¾(å¦‚ä¸‹åœ–)ã€‚</p>
<figure>
<img src="5.png" alt="Fig5. ç™¾åˆ†æ¯”ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig5. ç™¾åˆ†æ¯”ç¯„ä¾‹</figcaption>
</figure>
<p>å¦é—œæ–¼æª¢é©—åœç•™é»åŠæŠ½æŸ¥ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼ŒæŸ¥æ ¸ææ–™è¦æ ¼åŠå“è³ªèˆ‡å“ç®¡ç³»çµ±ä½œç‚ºç¶å®šä½¿ç”¨ï¼Œè«‹å†ç¨ç­‰ä¸‹!</p>
<h2 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h2>
<p><a href="https://www.hanksvba.com/posts/1990910755"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/997099184"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-ç‰ˆæœ¬èªªæ˜</title>
    <url>/posts/1512537146/</url>
    <content><![CDATA[<h2 id="ç‰ˆæœ¬å…§å®¹æ¯”è¼ƒ">ç‰ˆæœ¬å…§å®¹æ¯”è¼ƒ</h2>
<table>
<thead>
<tr class="header">
<th>é …ç›®</th>
<th>è¨‚é–±ç‰ˆ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>åŸºæœ¬åŠŸèƒ½</strong></td>
<td>O</td>
</tr>
<tr class="even">
<td><strong>éŒ¯èª¤ä¿®å¾©</strong></td>
<td>O</td>
</tr>
<tr class="odd">
<td><strong>æŠ€è¡“æ”¯æ´</strong></td>
<td>O</td>
</tr>
<tr class="even">
<td><strong>åŸå§‹ç¢¼</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>ä½¿ç”¨æœŸé™</strong></td>
<td>å·¥ç¨‹æœŸé–“</td>
</tr>
</tbody>
</table>
<h2 id="å‚™è¨»äº‹é …">å‚™è¨»äº‹é …</h2>
<div class="note info"><ol type="1">
<li><p>æ–½å·¥æ—¥èªŒèˆŠç‰ˆ(ç¤¾ç¾¤ç‰ˆ)æ­£åœ¨ä½¿ç”¨ä¸­çš„æœ‹å‹<strong>ä»å¯ä½¿ç”¨åˆ°2024å¹´åº•</strong>ï¼Œå¦‚éœ€è½‰æ›è‡³æ–°ç‰ˆè«‹è¯ç¹«ä½œè€…å”åŠ©ã€‚</p></li>
<li><p>å¦‚æ¬²è³¼ç½®æ–½å·¥æ—¥èªŒæ–°ç‰ˆ(V3.5.0)ç³»åˆ—å¾Œä¹‹è¨‚é–±åŒ…å¥—æœå‹™(åŒ…å«è®Šæ›´è¨­è¨ˆã€å±•å»¶å·¥æœŸã€å¥‘ç´„é …ç›®å°å…¥)ï¼Œè«‹æä¾›ä»¥ä¸‹è³‡æ–™ä¸¦è¯ç¹«ä½œè€…</p></li>
</ol>
<ul>
<li>å·¥ç¨‹åç¨±</li>
<li>å¥‘ç´„é‡‘é¡</li>
<li>å·¥ç¨‹æ—¥æ•¸</li>
</ul>
<ol start="3" type="1">
<li>è¯ç¹«æ–¹å¼</li>
</ol>
<ul>
<li>LINE(ID:<span class="citation"
data-cites="903qzhwa">@903qzhwa</span>)</li>
<li>é›»å­éƒµä»¶(apple84026113@gmail.com)</li>
</ul>
</div>
<span id="more"></span>
<h3 id="åŸºæœ¬åŠŸèƒ½">åŸºæœ¬åŠŸèƒ½</h3>
<ul>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯ã€ç¬¬äºŒè¯)</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬ä¸€è¯ã€ç¬¬äºŒè¯)</li>
<li>ç›£é€ æ—¥å ±</li>
</ul>
<h3 id="éŒ¯èª¤ä¿®å¾©">éŒ¯èª¤ä¿®å¾©</h3>
<ul>
<li>ä¿®å¾©é‡å¤§ç³»çµ±éŒ¯èª¤</li>
</ul>
<h3 id="æŠ€è¡“æ”¯æ´">æŠ€è¡“æ”¯æ´</h3>
<ul>
<li>å…¬ç‰ˆå ±è¡¨å¾®èª¿</li>
<li>å®¢è£½åŠŸèƒ½æ“´å……(æŒ‰å·¥æ™‚å¦è¨ˆ)</li>
<li>è®Šæ›´è¨­è¨ˆç•°å‹•</li>
<li>å±•å»¶å·¥æœŸèª¿æ•´</li>
</ul>
<h2 id="æ³•è¦ä¾†æº">æ³•è¦ä¾†æº</h2>
<p><a
href="https://www.nlma.gov.tw/%E6%9C%80%E6%96%B0%E8%A8%8A%E6%81%AF/%E5%88%97%E5%8D%B0/17819.html">å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ</a></p>
<p><a
href="https://lawweb.pcc.gov.tw/LawContent.aspx?id=FL003734">å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ</a></p>
<h2 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h2>
<p><a href="https://www.hanksvba.com/posts/1000661249/#more"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-V3.5.0</a></p>
<p><a href="https://www.hanksvba.com/posts/1990910755"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/426352985"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/997099184"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡</title>
    <url>/posts/1990910755/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« å»¶ä¼¸æ–¼ <a
href="https://www.hanksvba.com/posts/1000661249/#more">æ–½å·¥æ—¥èªŒVBA-V3.5.0</a>
ç‰ˆæœ¬æ“ä½œæ•™å­¸</p>
<p>å–å¾—ä¸»ç¨‹å¼æ™‚ï¼Œæœƒé è¨­å­˜åœ¨ç¯„ä¾‹è³‡æ–™ï¼Œå¯å…ˆç”±ç¯„ä¾‹è³‡æ–™å¤§è‡´äº†è§£æœªä¾†ä½¿ç”¨éç¨‹ä¸­è³‡æ–™çš„æ¨¡æ¨£æœƒå¦‚ä½•ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥å…ˆè©¦è¡Œè¼¸å‡ºå ±è¡¨ï¼Œç¢ºèªæ˜¯å¦ç¬¦åˆè²´å¸éœ€æ±‚ã€‚</p>
<p>å¦‚æ¬²é–‹å§‹é€²è¡Œä½¿ç”¨ï¼Œå»ºè­°ä¾ç…§ä¸‹åˆ—é †åºé€²è¡Œï¼Œé™¤åŸºæœ¬è¨­å®šæœƒå¦å¤–åšé‡ç½®è¡Œç‚ºéœ€å„ªå…ˆè¨­å®šå¤–ï¼Œå…¶é¤˜è¨­å®šä¸ä¸€å®šè¦æŒ‰ç…§é †åºã€‚</p>
<p>ä»¥ä¸‹ç›¸é—œè¨­å®šæŒ‰éˆ•çš†éœ€é€éå·¥ä½œè¡¨"ç‰ˆæœ¬èªªæ˜"é»é¸æŒ‰éˆ•ã€åŠŸèƒ½ä¸»è¦ç•«é¢ã€‘å¾Œé€²è¡Œã€‚</p>
<span id="more"></span>
<h2 id="åŸºæœ¬è¨­å®š">1.åŸºæœ¬è¨­å®š</h2>
<blockquote>
<p>è¨­å®šåŸºæœ¬è³‡æ–™</p>
</blockquote>
<h3 id="æ­¥é©Ÿ">æ­¥é©Ÿ</h3>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€1.åŸºæœ¬è¨­å®šã€‘</li>
<li>è«‹ç¢ºèªæ˜¯å¦æ¸…é™¤æ—¢æœ‰è³‡æ–™ä¸¦å»ºç«‹æ–°çš„å·¥ç¨‹å°ˆæ¡ˆ?(æ˜¯/å¦)</li>
<li>(æ˜¯)è‡ªå‹•åŸ·è¡Œå‚™ä»½ï¼Œå‚™ä»½è·¯å¾‘ç‚ºåŒç›®éŒ„ä¸‹çš„ã€backupã€‘è³‡æ–™å¤¾</li>
<li>å‚™ä»½å®Œæˆå¾Œæœƒå°‡è³‡æ–™æ¸…ç©º
<ul>
<li>åŸºæœ¬è¨­å®šã€å…¶ä»–è¨­å®š</li>
<li>æ•¸é‡è¡¨ã€ææ–™è¡¨ã€æ©Ÿå…·è¡¨ã€äººåŠ›è¡¨ã€å…¶ä»–è¡¨</li>
</ul></li>
<li>è«‹è¼¸å…¥å·¥ç¨‹åç¨±</li>
<li>è«‹è¼¸å…¥æ‰¿æ”¬å» å•†</li>
<li>è«‹è¼¸å…¥æ–½å·¥åœ°é»</li>
<li>è«‹è¼¸å…¥å¥‘ç´„ç·¨è™Ÿ</li>
<li>è«‹è¼¸å…¥ç‰Œç…§è™Ÿç¢¼</li>
</ol>
<h3 id="æˆæœ">æˆæœ</h3>
<p>è³‡æ–™æœƒå„²å­˜æ–¼å·¥ä½œè¡¨"åŸºæœ¬è¨­å®š"ï¼Œæœ‰é—œå€‹åˆ¥æ¬„ä½ä»‹ç´¹è«‹åƒè€ƒä¸‹è¡¨</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>å…§å®¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ç”Ÿæ•ˆæ—¥</td>
<td>(ç©ºç™½)</td>
<td>æ–°å¢æ—¥å ±å‰ç¢ºèªè¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œèˆ‡é–‹å·¥æ—¥æœŸåŒ</td>
</tr>
<tr class="even">
<td>å·¥ç¨‹åç¨±</td>
<td>OOOOæ”¹å–„å·¥ç¨‹</td>
<td></td>
</tr>
<tr class="odd">
<td>æ‰¿æ”¬å» å•†</td>
<td>OOç‡Ÿé€ æœ‰é™å…¬å¸</td>
<td>åŒæ‰¿é€ äºº</td>
</tr>
<tr class="even">
<td>æ–½å·¥åœ°é»</td>
<td>OOç¸£OOå¸‚</td>
<td></td>
</tr>
<tr class="odd">
<td>å¥‘ç´„ç·¨è™Ÿ</td>
<td>A123456</td>
<td></td>
</tr>
<tr class="even">
<td>é–‹å·¥æ—¥æœŸ</td>
<td>(ç©ºç™½)</td>
<td>é€²åº¦è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºé¦–æ—¥æ—¥æœŸ</td>
</tr>
<tr class="odd">
<td>ç«£å·¥æ—¥æœŸ</td>
<td>(ç©ºç™½)</td>
<td>é€²åº¦è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºæœ«æ—¥æ—¥æœŸ</td>
</tr>
<tr class="even">
<td>ç‰Œç…§è™Ÿç¢¼</td>
<td>åºœå»ºç®¡å­—ç¬¬OOOOOè™Ÿ</td>
<td>å»º/é›œ/æ‹†ç…§è™Ÿç¢¼ä½¿ç”¨</td>
</tr>
<tr class="odd">
<td>å¥‘ç´„é‡‘é¡</td>
<td>(ç©ºç™½)</td>
<td>å¥‘ç´„è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜</td>
</tr>
<tr class="even">
<td>é€²åº¦é‡‘é¡</td>
<td>(ç©ºç™½)</td>
<td>å¥‘ç´„è¨­å®šå¾Œè‡ªå‹•è¨»è¨˜ï¼Œç‚ºé€²åº¦è¨ˆç®—æ™‚ä¹‹åˆ†æ¯</td>
</tr>
</tbody>
</table>
<h2 id="å¥‘ç´„è¨­å®š">2.å¥‘ç´„è¨­å®š</h2>
<blockquote>
<p>è¨­å®šå¥‘ç´„é …ç›®ï¼Œé€™ä¸€æ­¥æœƒæ¯”è¼ƒé‡è¦ä¸”ç¹ç‘£ï¼Œæœ‰éœ€è¦å¯ä¾†ä¿¡è¨è«–æˆ–ä»£å·¥</p>
</blockquote>
<h3 id="è¨­å®šåŸå‰‡">è¨­å®šåŸå‰‡</h3>
<ul>
<li>é …æ¬¡ä¸èƒ½é‡è¤‡</li>
<li>è¤‡åƒ¹ç¸½å’Œç‚ºå¥‘ç´„é‡‘é¡</li>
<li>åˆ†é¡ç‚º<strong>P</strong>ä¸ç´å…¥é€²åº¦è¨ˆç®—åˆ†æ¯</li>
<li>åˆ†é¡ç‚º<strong>N</strong>ç‚ºç™¼åŒ…å·¥ä½œè²»å¤–é …ç›®</li>
</ul>
<h3 id="æ­¥é©Ÿ-1">æ­¥é©Ÿ</h3>
<h4 id="pccesçš„xls">PCCESçš„XLS</h4>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€2.å¥‘ç´„è¨­å®šã€‘</li>
<li>é»é¸æŒ‰éˆ•ã€å¼•å…¥PCCESã€‘</li>
<li>é¸æ“‡PCCESç”¢å‡ºä¹‹XLSæª”æ¡ˆ</li>
<li>å¦‚æœ‰èˆŠè³‡æ–™å­˜åœ¨ï¼Œå‰‡è·³æé†’"ä½ æœ‰èˆŠè³‡æ–™å­˜åœ¨ï¼Œç¢ºå®šè¦åˆªé™¤?"</li>
<li>(æ˜¯)æ¸…ç©ºè³‡æ–™åŠåˆ†é¡ï¼Œä¸¦å°‡XLSå…§å®¹å°å…¥</li>
<li>æŒ‘é¸ç™¼åŒ…å·¥ä½œè²»å¤–çš„é …ç›®</li>
<li>æŒ‘é¸ä¸è¨ˆå…¥é€²åº¦è¨ˆç®—çš„é …ç›®</li>
<li>é—œé–‰å¾Œæœƒè‡ªå‹•å°‡"å¥‘ç´„é‡‘é¡"ã€"é€²åº¦é‡‘é¡"ä»£å…¥åˆ°"åŸºæœ¬è¨­å®š"</li>
</ol>
<p><strong>å‚™è¨»</strong>
é¸æ“‡PCCESç”¢å‡ºä¹‹XLSä¹‹å‰ï¼Œå¯ä»¥å…ˆå°‡æ±ºæ¨™å–®åƒ¹ä¿®æ”¹åˆ°XLSçš„é ç®—å–®åƒ¹ï¼Œæœªä¾†æ‰ä¸ç”¨é€å€‹ä¿®æ­£ã€‚</p>
<h4 id="pccesçš„xml">PCCESçš„XML</h4>
<p>åŸºæœ¬ä¸Šèƒ½å–å¾—XMLä¹Ÿå°±èƒ½å°‡å®ƒåŒ¯å…¥åˆ°PCCESå¾Œè¼¸å‡ºXLSäº†ï¼Œé™¤éçœŸçš„æ²’æœ‰è¾¦æ³•ï¼Œæ‰æœƒæ¡è¡Œä¸‹åˆ—å¾Œè™•ç†å·¥å…·é€²è¡Œã€‚</p>
<p>å¦è©³ <a
href="https://hankvba.blogspot.com/2024/02/excel-vba-pcces.html">Excel
VBA @ PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†</a></p>
<h4 id="å…¶ä»–xls">å…¶ä»–XLS</h4>
<p>å¯ä»¥è¤‡è£½è²¼ä¸Šåˆ°å·¥ä½œè¡¨"å¥‘ç´„è¨­å®š"æˆ–å…¶ä»–ä»»ä½•æ–¹å¼</p>
<h3 id="æˆæœ-1">æˆæœ</h3>
<table>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>å…§å®¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>é …æ¬¡</td>
<td>å£¹.ä¸€.1</td>
<td>é …æ¬¡ä¸èƒ½é‡è¤‡</td>
</tr>
<tr class="even">
<td>é …ç›®</td>
<td>æ–½å·¥å‘Šç¤ºç‰Œ</td>
<td></td>
</tr>
<tr class="odd">
<td>å–®ä½</td>
<td>ç‰‡</td>
<td></td>
</tr>
<tr class="even">
<td>æ•¸é‡</td>
<td>2</td>
<td></td>
</tr>
<tr class="odd">
<td>å–®åƒ¹</td>
<td>2500</td>
<td></td>
</tr>
<tr class="even">
<td>è¤‡åƒ¹</td>
<td>5000</td>
<td></td>
</tr>
<tr class="odd">
<td>åˆ†é¡</td>
<td>(ç©ºç™½)</td>
<td>Pä¸ç´å…¥é€²åº¦ã€Nç‚ºç™¼åŒ…å·¥ä½œè²»å¤–</td>
</tr>
</tbody>
</table>
<ul>
<li>ä¸»é …å¤§é¡å¦‚æ²’æœ‰ç´°é …ï¼Œå»ºè­°å°‡å–®åƒ¹ã€è¤‡åƒ¹çš†æ­¸0ï¼Œé¿å…å½±éŸ¿å¥‘ç´„é‡‘é¡ç¸½å’Œã€‚</li>
</ul>
<h2 id="å·¥æ–™è¨­å®š">3.å·¥æ–™è¨­å®š</h2>
<blockquote>
<p>è¨­å®šå¥‘ç´„é …ç›®</p>
</blockquote>
<h3 id="æ­¥é©Ÿ-2">æ­¥é©Ÿ</h3>
<h4 id="æ–°å¢">æ–°å¢</h4>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘</li>
<li>é¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)</li>
<li>è¼¸å…¥é …ç›®ã€å–®ä½ã€æ•¸é‡ã€å–®åƒ¹</li>
<li>é»é¸æŒ‰éˆ•"æ–°å¢"</li>
</ol>
<h4 id="åˆªé™¤">åˆªé™¤</h4>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘</li>
<li>é¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)</li>
<li>é»é¸è¦åˆªé™¤çš„é …ç›®åç™½å¾Œ</li>
<li>é»é¸æŒ‰éˆ•"åˆªé™¤"</li>
</ol>
<h4 id="ç·¨è¼¯">ç·¨è¼¯</h4>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€3.å·¥æ–™è¨­å®šã€‘</li>
<li>é¸æ“‡å±¬æ€§åˆ†é¡(ææ–™)</li>
<li>æŒ‘é¸è¦ç·¨è¼¯çš„é …ç›®å¾Œå¿«é»å…©ä¸‹</li>
<li>è¼¸å…¥æ­£ç¢ºæ•¸é‡</li>
<li>è¼¸å…¥æ­£ç¢ºå–®åƒ¹</li>
</ol>
<h3 id="æˆæœ-2">æˆæœ</h3>
<table>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>å…§å®¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>é …æ¬¡</td>
<td>E0001</td>
<td></td>
</tr>
<tr class="even">
<td>é …ç›®</td>
<td>æŒ–åœŸæ©Ÿ</td>
<td>é …ç›®åç¨±ä¸èƒ½é‡è¤‡</td>
</tr>
<tr class="odd">
<td>å–®ä½</td>
<td>å¤©</td>
<td></td>
</tr>
<tr class="even">
<td>æ•¸é‡</td>
<td>200</td>
<td></td>
</tr>
<tr class="odd">
<td>å–®åƒ¹</td>
<td>1000</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>Eé–‹é ­ç‚ºæ©Ÿå…·</li>
<li>Lé–‹é ­ç‚ºäººåŠ›</li>
<li>Mé–‹é ­ç‚ºææ–™</li>
</ul>
<h2 id="é€²åº¦è¨­å®š">4.é€²åº¦è¨­å®š</h2>
<blockquote>
<p>è¨­å®šé€²åº¦é …ç›®ï¼ŒåŒ…å«é–‹å·¥æ—¥æœŸã€ç«£å·¥æ—¥æœŸã€é å®šé€²åº¦</p>
</blockquote>
<p>æ­£ç¢ºè¨­å®šé€²åº¦æµç¨‹æ˜¯æ¡ç”¨æ‹†é …ç›®ã€é‡‘é¡çš„æ–¹å¼å®‰æ’èµ·è¨–æ—¥é€²è¡Œï¼Œé€™æ¨£æœƒæ¯”è¼ƒç¬¦åˆå¯¦éš›æ‰€éœ€ï¼Œå¦‚è¦æ¡ç”¨è¼ƒç°¡ä¾¿çš„æ–¹å¼ï¼Œå¯ä»¥å°‡æ–½å·¥è¨ˆç•«æ›¸ä¸­çš„é å®šé€²åº¦è¡¨å–æ¯åŠæœˆæˆ–æ¯æœˆä¹‹é å®šç´¯ç©é€²åº¦åšå…§æ’æ›ç®—ã€‚</p>
<h3 id="æ­¥é©Ÿ-3">æ­¥é©Ÿ</h3>
<h4 id="è‡ªè¡Œè¼¸å…¥">è‡ªè¡Œè¼¸å…¥</h4>
<ol type="1">
<li>é»é¸æŒ‰éˆ•ã€4.é€²åº¦è¨­å®šã€‘</li>
<li>é¸å–è¦ä½¿ç”¨å“ªå€‹æ–¹æ³•å¼•å…¥(1.è‡ªè¡Œè¼¸å…¥,2.å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·)</li>
<li>(é¸æ“‡1)</li>
<li>è¼¸å…¥æ—¥æœŸã€è©²æ—¥é å®šç´¯ç©é€²åº¦å¾ŒåŠ å…¥</li>
<li>é»é¸æŒ‰éˆ•ã€é€²åº¦è¨ˆç®—ã€‘</li>
</ol>
<h4 id="å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·">å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·</h4>
<ul>
<li>è©³ç´°æ“ä½œæ­¥é©Ÿblog <a
href="https://www.hanksvba.com/posts/43562660/#more">Streamlitå·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–</a></li>
<li>å·¥å…·ç¶²é  <a
href="https://progress.streamlit.app/">å·¥ç¨‹é€²åº¦ç”˜ç‰¹åœ–å·¥å…·</a></li>
</ul>
<ol type="1">
<li>æ ¹æ“šä¸Šè¿°å…§å®¹è£½ä½œå®Œæˆå¾Œç•™å­˜XLSå‚™ç”¨</li>
<li>é»é¸æŒ‰éˆ•ã€4.é€²åº¦è¨­å®šã€‘</li>
<li>é¸å–è¦ä½¿ç”¨å“ªå€‹æ–¹æ³•å¼•å…¥(1.è‡ªè¡Œè¼¸å…¥,2.å¼•å…¥ç”˜ç‰¹åœ–å·¥å…·)</li>
<li>(é¸æ“‡2)</li>
<li>é¸å–æ­¥é©Ÿ1ä¹‹XLS</li>
</ol>
<h3 id="æˆæœ-3">æˆæœ</h3>
<table>
<thead>
<tr class="header">
<th>æ¬„ä½åç¨±</th>
<th>å…§å®¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ—¥æœŸ</td>
<td>2024/9/25</td>
<td></td>
</tr>
<tr class="even">
<td>é å®šé€²åº¦</td>
<td>0.00%</td>
<td></td>
</tr>
<tr class="odd">
<td>å¯¦éš›é€²åº¦</td>
<td>(ç©ºç™½)</td>
<td>å¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜</td>
</tr>
<tr class="even">
<td>ä¸Šåˆå¤©æ°£</td>
<td>(ç©ºç™½)</td>
<td>å¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜</td>
</tr>
<tr class="odd">
<td>ä¸‹åˆå¤©æ°£</td>
<td>(ç©ºç™½)</td>
<td>å¡«å¯«æ—¥å ±å„²å­˜å¾Œè‡ªå‹•è¨»è¨˜</td>
</tr>
</tbody>
</table>
<h2 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h2>
<p><a href="https://www.hanksvba.com/posts/426352985"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/997099184"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥æ—¥èªŒVBA-V3.5.0æ­£å¼ç™¼ä½ˆ</title>
    <url>/posts/1000661249/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>è‡ª2018å¹´ç™¼å¸ƒç›£é€ æ—¥å ±è¡¨VBAåŠ2022å¹´ç™¼å¸ƒå…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒè³‡æ–™åº«VBAå¾Œï¼Œé™¸çºŒæœ‰æ”¶åˆ°å¾ˆå¤šæœ‹å‹çš„å›é¥‹ï¼Œç¶“éä¸€æ¬¡åˆä¸€æ¬¡çš„è¿­ä»£ä¿®æ”¹ï¼Œè©²é‡åˆ°çš„å•é¡Œå·®ä¸å¤šä¹Ÿå·²ç¶“è§£æ±ºäº†ï¼Œå°æ–¼æª”æ¡ˆä¸­é•·æœŸç´¯ç©çš„ç¨‹å¼ç¢¼æˆ–è¨±å› ç‚ºåœ¨ä¸‹çš„åŠŸåŠ›ä¸å¤ æ·±åšï¼Œéºç•™ä¸‹å¤§é‡çš„æŠ€è¡“å‚µï¼Œæ¯æ¬¡çš„ç¨‹å¼ç¢¼ç·¨è¼¯æœƒè€—è²»ä¸å°‘æ™‚é–“ï¼Œè€Œä¸”ä¹Ÿéœ€è¦åšå¤§é‡çš„æ¸¬è©¦ï¼Œç‚ºäº†ä¸è¦å‚µç•™å­å­«ï¼Œç‰¹åœ°èŠ±äº†ä¸€äº›æ™‚é–“é€šç›¤æª¢è¨é€²è¡Œä¸€æ¬¡å®Œæ•´çš„é‡æ§‹ï¼Œä¹Ÿå°±æ˜¯æœ¬ç¯‡æ–‡ç« çš„ä¸»è§’-<strong>æ–½å·¥æ—¥èªŒVBA-V3.5.0.</strong>ã€‚</p>
<figure>
<img src="/images/constructionLog.png" alt="Fig1.é¸å–®å…§å®¹" />
<figcaption aria-hidden="true">Fig1.é¸å–®å…§å®¹</figcaption>
</figure>
<span id="more"></span>
<h2 id="å½±ç‰‡æ“ä½œ">å½±ç‰‡æ“ä½œ</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/P068pURRRFI?si=S_-2Iab7OGOnhVF_" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
<h2 id="é¦–é ">é¦–é </h2>
<figure>
<img src="1.png" alt="Fig2.ä¸»è¦é€²å…¥é»" />
<figcaption aria-hidden="true">Fig2.ä¸»è¦é€²å…¥é»</figcaption>
</figure>
<h2 id="åŠŸèƒ½">åŠŸèƒ½</h2>
<p>ä¸»è¦æ¶æ§‹å¯åˆ†ç‚ºè¨­å®šã€ç´€éŒ„è¡¨ã€æ ¼å¼åŠè³‡æ–™å‚™ä»½ï¼Œæ¦‚è¿°å¦‚ä¸‹</p>
<h3 id="è¨­å®šç›¸é—œ">è¨­å®šç›¸é—œ</h3>
<blockquote>
<p>åŸºæœ¬è¨­å®š</p>
</blockquote>
<p>ç¶œç†å„æ©Ÿé—œç¯„æœ¬æ‰€éœ€ä¹‹åŸºæœ¬è³‡æ–™ï¼Œæ‰€éœ€å¤§è‡´ç‚º</p>
<ul>
<li>å·¥ç¨‹åç¨±</li>
<li>æ‰¿æ”¬å» å•†(æ‰¿é€ äºº)</li>
<li>æ–½å·¥åœ°é»</li>
<li>å¥‘ç´„ç·¨è™Ÿ</li>
<li>å¥‘ç´„é‡‘é¡</li>
<li>é–‹å·¥æ—¥æœŸ</li>
<li>ç«£å·¥æ—¥æœŸ</li>
<li>å»º/é›œ/æ‹†ç…§è™Ÿç¢¼</li>
</ul>
<blockquote>
<p>å¥‘ç´„è¨­å®š</p>
</blockquote>
<p><strong>å¥‘ç´„é …æ¬¡</strong>ä¸èƒ½é‡è¤‡ï¼Œå¯å¼•å…¥PCCESæˆ–å¾Œè™•ç†å·¥å…·</p>
<figure>
<img src="3.png" alt="Fig3.å¥‘ç´„è¨­å®šç•«é¢" />
<figcaption aria-hidden="true">Fig3.å¥‘ç´„è¨­å®šç•«é¢</figcaption>
</figure>
<blockquote>
<p>å·¥æ–™è¨­å®š</p>
</blockquote>
<p><strong>äººæ©Ÿæ–™åç¨±</strong>ä¸èƒ½é‡è¤‡</p>
<figure>
<img src="4.png" alt="Fig4.å·¥æ–™è¨­å®šç•«é¢" />
<figcaption aria-hidden="true">Fig4.å·¥æ–™è¨­å®šç•«é¢</figcaption>
</figure>
<blockquote>
<p>é€²åº¦è¨­å®š</p>
</blockquote>
<p>å¯ä»¥é€éæ—¥æœŸèˆ‡é å®šç´¯ç©é€²åº¦æ›ç®—æˆ–åŒ¯å…¥<a
href="https://progress.streamlit.app/">ç”˜ç‰¹åœ–å·¥å…·</a>ä¹‹æˆæœ</p>
<figure>
<img src="5.png" alt="Fig5.é€²åº¦è¨­å®šç•«é¢" />
<figcaption aria-hidden="true">Fig5.é€²åº¦è¨­å®šç•«é¢</figcaption>
</figure>
<h3 id="ç´€éŒ„è¡¨ç›¸é—œ">ç´€éŒ„è¡¨ç›¸é—œ</h3>
<ul>
<li>æ–°å¢æ—¥å ±</li>
<li>ç·¨è¼¯æ—¥å ±</li>
<li>åˆªé™¤æ—¥å ±</li>
<li>åˆ—å°æ—¥å ±</li>
</ul>
<p>ç´€éŒ„å…§å®¹åŒ…å«å¥‘ç´„é …ç›®ã€å¤©æ°£ç‹€æ³ã€äººæ©Ÿæ–™ã€å‚™è¨»åŠç›£é€ éƒ¨åˆ†</p>
<figure>
<img src="6.png" alt="Fig6.å¥‘ç´„é …ç›®ç·¨è¼¯ç•«é¢" />
<figcaption aria-hidden="true">Fig6.å¥‘ç´„é …ç›®ç·¨è¼¯ç•«é¢</figcaption>
</figure>
<figure>
<img src="7.png" alt="Fig7.æ–½å·¥æ—¥èªŒå‚™è¨»ç·¨è¼¯ç•«é¢" />
<figcaption aria-hidden="true">Fig7.æ–½å·¥æ—¥èªŒå‚™è¨»ç·¨è¼¯ç•«é¢</figcaption>
</figure>
<figure>
<img src="8.png" alt="Fig8.ç›£é€ å ±è¡¨å‚™è¨»ç·¨è¼¯ç•«é¢" />
<figcaption aria-hidden="true">Fig8.ç›£é€ å ±è¡¨å‚™è¨»ç·¨è¼¯ç•«é¢</figcaption>
</figure>
<h3 id="æ ¼å¼ç›¸é—œ">æ ¼å¼ç›¸é—œ</h3>
<figure>
<img src="9.png" alt="Fig9.åˆ—å°æ—¥å ±ç•«é¢" />
<figcaption aria-hidden="true">Fig9.åˆ—å°æ—¥å ±ç•«é¢</figcaption>
</figure>
<ul>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ</li>
<li>å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ</li>
<li>å»ºç¯‰ç‰©æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)</li>
<li>ç›£é€ å ±è¡¨</li>
</ul>
<figure>
<img src="10.png" alt="Fig10.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ" />
<figcaption aria-hidden="true">Fig10.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ</figcaption>
</figure>
<figure>
<img src="11.png" alt="Fig11.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)æˆæœ" />
<figcaption
aria-hidden="true">Fig11.å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒ(ç¬¬äºŒè¯)æˆæœ</figcaption>
</figure>
<figure>
<img src="12.png" alt="Fig12. å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ" />
<figcaption aria-hidden="true">Fig12. å…¬å…±å·¥ç¨‹æ–½å·¥æ—¥èªŒæˆæœ</figcaption>
</figure>
<figure>
<img src="13.png" alt="Fig13. ç›£é€ å ±è¡¨æˆæœ" />
<figcaption aria-hidden="true">Fig13. ç›£é€ å ±è¡¨æˆæœ</figcaption>
</figure>
<h3 id="å‚™ä»½é‚„åŸ">å‚™ä»½é‚„åŸ</h3>
<p>å•Ÿå‹•æ™‚é»</p>
<ol type="1">
<li>æ¸…ç©ºè³‡æ–™åº«</li>
<li>ç‰ˆæœ¬æ›´æ–°</li>
</ol>
<p>å°‡è¨­å®šèˆ‡ç´€éŒ„è¡¨åŒ¯å‡ºæˆæ–°çš„æ´»é ç°¿ï¼Œå¦‚ç‰ˆæœ¬æ›´æ–°æ™‚ï¼Œå¯å°‡è©²æ´»é ç°¿é‚„åŸé€²å»ã€‚</p>
<h2 id="çµèª">çµèª</h2>
<p>é–‹ç™¼ç›®æ¨™ç›¡é‡ä»¥é€šç”¨ç‚ºä¸»ï¼Œä½†é›£å…æœ‰æ©Ÿé—œæœƒæœ‰è‡ªå·±çš„æ ¼å¼ï¼Œä½†é€™éƒ½æ˜¯<strong>å¯ä»¥è™•ç†</strong>çš„ï¼Œç•¶åˆåœ¨é–‹ç™¼æ™‚å·²ç¶“å°‡æ“´å……çš„æ¬„ä½ç”šè‡³æ˜¯å ±è¡¨çš„ç”Ÿæˆçš†å·²é€²è¡Œè€ƒé‡ï¼Œæœ‰ç‰¹æ®Šéœ€æ±‚çš„äººå¯ä»¥é€éå·¦å´è³‡è¨Šæ¬„è¯ç¹«æˆ‘(LINEæˆ–Email)ï¼ŒèˆŠç‰ˆæœ¬çš„æ–½å·¥æ—¥èªŒVBAé è¨ˆåªç¶­è­·åˆ°ä»Šå¹´å¹´åº•ï¼Œ<strong>æ˜å¹´1/1èµ·</strong>å°‡ä¸å†æä¾›ç¶­è­·ï¼Œçš†æœƒæ¡ç”¨æ–°ç‰ˆé€²è¡Œï¼Œå¦‚æœ‰è³¼ç½®ä½¿ç”¨çš„æœ‹å‹å¯å”åŠ©è½‰æ›è‡³æ–°ç‰ˆã€‚</p>
<blockquote>
<p>æ–½å·¥æ—¥èªŒVBAç›¸é—œç‰ˆæœ¬å…§å®¹è«‹åƒè€ƒ<a
href="https://www.hanksvba.com/posts/1512537146/">ç‰ˆæœ¬èªªæ˜</a></p>
</blockquote>
<p><span class="github-emoji" data-alias="star" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">â­</span>
æœ‰éœ€è¦è«‹LINE(ID:<span class="citation"
data-cites="903qzhwa">@903qzhwa</span>)è¯ç¹«æˆ–é›»å­éƒµä»¶(apple84026113@gmail.com)è¯ç¹«</p>
<h2 id="ç›¸é—œé€£çµ">ç›¸é—œé€£çµ</h2>
<p><a href="https://www.hanksvba.com/posts/1990910755"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨­å®šç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/426352985"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-è¨˜éŒ„ç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/997099184"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-åˆ—å°ç¯‡</a></p>
<p><a href="https://www.hanksvba.com/posts/3015163677"><span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
æ–½å·¥æ—¥èªŒVBA-V3.6.0ç³»åˆ—æ›´æ–°èªªæ˜</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥æ—¥èªŒ</tag>
        <tag>ç›£é€ å ±è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–½å·¥ç…§ç‰‡VBA-å¯¦ä½œæµç¨‹</title>
    <url>/posts/144473154/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>å·¥ç¨‹é€²è¡Œéšæ®µå› ç‚ºæ¥­ä¸»ã€ç›£é€ ä¸ä¸€å®šéƒ½æœƒåœ¨ç¾å ´ï¼Œç„¡è«–æ–½å·¥æŠ½æŸ¥ã€å“è³ªç®¡ç†ã€éš±è”½éƒ¨åˆ†å°ºå¯¸ç´€éŒ„ã€ç£å°æœƒå‹˜...ç­‰ç­‰å…§å®¹ï¼Œå¤§å¤šæ•¸æ–‡ä»¶éƒ½æœƒéœ€è¦ç…§ç‰‡ä½œç‚ºä½è­‰è³‡æ–™ï¼Œå°¤å…¶æ˜¯å‡è¨­å·¥ç¨‹ã€éš±è”½éƒ¨åˆ†æ›´æ˜¯éœ€è¦ï¼Œå› æ­¤æ•´å€‹å·¥ç¨‹æ¡ˆé€²è¡Œéç¨‹å¯èƒ½æœƒç´¯ç©å¤§é‡çš„ç…§ç‰‡ï¼Œå¾ŒçºŒçš„è«‹æ¬¾å ±è¡¨ç…§ç‰‡è²¼é™„ã€ç…§ç‰‡æª”æ¡ˆæŸ¥æ‰¾ï¼Œæœƒæ˜¯è®“å…§æ¥­äººå“¡ç›¸ç•¶èŠ±è²»æ™‚é–“çš„ä¸€ç’°ã€‚</p>
<p>å¯¦å‹™ä¸Šå¤§å¤šæœƒæ¡ç”¨LINEç¾¤çµ„é€²è¡Œç…§ç‰‡ä¸Šå‚³ï¼Œç…§ç‰‡èªªæ˜æœƒå‡ºç¾åœ¨ç•«é¢ä¸­çš„å°ç™½æ¿ï¼Œå†ç”±å…§æ¥­äººå“¡è‡ªè¡Œä¸‹è¼‰å‚™å­˜ï¼Œæ”¾åœ¨æœ¬æ©Ÿç¡¬ç¢Ÿä¸­æˆ–è€…æ˜¯æ”¾åœ¨å…¬å¸çš„NASè£¡é¢ï¼Œæœªä¾†éœ€è¦åˆ©ç”¨æ™‚å†å»è‡ªå·±æ‰€åˆ†é¡çš„è³‡æ–™å¤¾ä¸­æ¯”å°ã€ä¸‹è¼‰ã€è²¼é™„ï¼Œå› æ­¤å°æ–¼è™•ç†ç…§ç‰‡çš„æª”æ¡ˆç®¡ç†ã€å ±è¡¨è¼¸å‡ºæˆ‘æƒ³éœ€è¦æœ‰æ–¹æ³•ä¾†å®Œæˆå¤§é‡ã€ç¹è¤‡ã€ç°¡å–®çš„å·¥ä½œæµç¨‹ï¼Œç¯€çœæ™‚é–“ä¾†åšå…¶ä»–æ¥­å‹™å…§å®¹ã€‚</p>
<p>å› æ­¤ï¼Œæ–½å·¥ç…§ç‰‡VBAèª•ç”Ÿäº†ï¼Œæ–¼2023å¹´1æœˆç™¼å¸ƒçµ¦å¤§çœ¾ä½¿ç”¨é‹è¡Œè‡³ä»Šï¼Œè©²ä¿®å¾©çš„å…§å®¹å¤§æ¦‚å·²ç¶“å®Œæˆï¼Œä»¥ä¸‹ç‚ºç›®å‰æ‰€é‡‹å‡ºçš„æ–½å·¥ç…§ç‰‡VBAéƒ¨åˆ†å…§å®¹ï¼Œå®Œæ•´å…§å®¹è«‹åƒè€ƒ<a
href="https://portaly.cc/hanksvba/product/pkCLtQZcV6u4H7jGRH6e">æ–½å·¥ç…§ç‰‡VBAå®Œæ•´åŸå§‹ç¢¼</a>ã€‚</p>
<span id="more"></span>
<h2 id="demo">DEMO</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/UYwLdFSH5cE?si=XU_UnH55pF831T2g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<hr />
<h2 id="ç¬¬ä¸€ç« ç¯€-è³‡æ–™å¤¾">ç¬¬ä¸€ç« ç¯€ è³‡æ–™å¤¾</h2>
<h3 id="å–å¾—è³‡æ–™å¤¾">1-1 å–å¾—è³‡æ–™å¤¾</h3>
<blockquote>
<p>å­¸ç¿’å¦‚ä½•é€éVBAå…§å»ºçš„è³‡æ–™å¤¾é¸æ“‡è¦–çª—å°‡ç…§ç‰‡å­˜æ”¾è·¯å¾‘æ”¾ç½®åˆ°å·¥ä½œè¡¨</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SelectFolder()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> objDialog <span class="keyword">As</span> FileDialog</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> objDialog = Application.FileDialog(msoFileDialogFolderPicker)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> objDialog</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> .Show = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">        Sheets(<span class="string">&quot;Main&quot;</span>).Range(<span class="string">&quot;B2&quot;</span>) = objDialog.SelectedItems(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹è³‡æ–™å¤¾">1-2 æŸ¥çœ‹è³‡æ–™å¤¾</h3>
<blockquote>
<p>å­¸ç¿’å¦‚ä½•é€éShellçš„æ–¹æ³•ä¾†é–‹å•ŸæŒ‡å®šè³‡æ–™å¤¾</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> showFolder()</span><br><span class="line"></span><br><span class="line">main_path = Sheets(<span class="string">&quot;Main&quot;</span>).Range(<span class="string">&quot;B2&quot;</span>)</span><br><span class="line"></span><br><span class="line">Shell <span class="string">&quot;explorer.exe &quot;</span> &amp; main_path, vbNormalFocus</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¬¬äºŒç« ç¯€-ç…§ç‰‡åŸºæœ¬è³‡æ–™">ç¬¬äºŒç« ç¯€ ç…§ç‰‡åŸºæœ¬è³‡æ–™</h2>
<h3 id="ç…§ç‰‡æª”æ¡ˆç®¡ç†">2-1 ç…§ç‰‡æª”æ¡ˆç®¡ç†</h3>
<figure>
<img src="upload_15df3895983a9426f8514c36e8fb088f.png"
alt="è³‡æ–™åº«ä»‹é¢" />
<figcaption aria-hidden="true">è³‡æ–™åº«ä»‹é¢</figcaption>
</figure>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getDataFromFolder()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> clsInf <span class="keyword">As</span> <span class="built_in">New</span> clsInformation</span><br><span class="line"><span class="keyword">Dim</span> objFile <span class="keyword">As</span> <span class="built_in">New</span> clsmyFile</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Sheets(<span class="string">&quot;Main&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;If MsgBox(&quot;æ˜¯å¦è¦è²¼ä¸Šç¸®åœ–?&quot;, vbYesNo) = vbYes Then</span></span><br><span class="line"><span class="keyword">If</span> clsInf.IsPasteIMG = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    objFile.IsPaste = <span class="literal">True</span></span><br><span class="line">    mywidth = <span class="built_in">CInt</span>(clsInf.getIMGwidth) <span class="comment">&#x27;  CInt(InputBox(&quot;è«‹è¼¸å…¥ç¸®åœ–å¯¬åº¦:&quot;))</span></span><br><span class="line">    objFile.photo_width = mywidth / <span class="number">4</span></span><br><span class="line">    objFile.photo_height = mywidth</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">objFile.main_path = .Range(<span class="string">&quot;B2&quot;</span>)</span><br><span class="line"></span><br><span class="line">objFile.delRng <span class="comment">&#x27;åˆªé™¤æ—¢æœ‰æ¬„ä½</span></span><br><span class="line">objFile.getAllFolder <span class="comment">&#x27;å¾ªç’°å–å¾—æŒ‡å®šè³‡æ–™å¤¾ä¸­æ‰€æœ‰ç…§ç‰‡è·¯å¾‘</span></span><br><span class="line">objFile.PastePictures  <span class="comment">&#x27;ä¾åºè²¼ä¸Šåˆ°æ“ä½œä»‹é¢</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> extractNames <span class="comment">&#x27;ç”±æª”åèƒå–è‡³ä»‹é¢æ¬„ä½</span></span><br><span class="line"><span class="keyword">Call</span> ApplyFilterToAllUsedCells <span class="comment">&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>åˆªé™¤æ—¢æœ‰æ¬„ä½</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> delRng()</span><br><span class="line"></span><br><span class="line">tmp = split(main_path, <span class="string">&quot;\&quot;</span>)</span><br><span class="line">main_folder = tmp(UBound(tmp))</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> shtResult</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;.Range(&quot;A1:F1&quot;) = Array(&quot;ID&quot;, &quot;ç¸®åœ–&quot;, &quot;å…¨è·¯å¾‘&quot;, &quot;è³‡æ–™å¤¾(&quot; &amp; main_folder &amp; &quot;)&quot;, &quot;æª”å&quot;, &quot;æ›´æ”¹æª”å&quot;)</span></span><br><span class="line"></span><br><span class="line">.Range(<span class="string">&quot;D1&quot;</span>) = <span class="string">&quot;è³‡æ–™å¤¾(&quot;</span> &amp; main_folder &amp; <span class="string">&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> rng_last = .Cells.SpecialCells(xlCellTypeLastCell)</span><br><span class="line"></span><br><span class="line">lr = .Cells(.Rows.Count, <span class="number">1</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line">lc = .Cells(<span class="number">1</span>, .Columns.Count).<span class="keyword">End</span>(xlToLeft).Column</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> lr &gt; <span class="number">1</span> <span class="keyword">Then</span> .Range(<span class="string">&quot;A2&quot;</span>).Resize(rng_last.Row, rng_last.Column).Clear</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> Shape <span class="keyword">In</span> .Shapes</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Debug.Print Shape.Address</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> Shape.TopLeftCell.Row &lt;&gt; <span class="number">1</span> <span class="keyword">Then</span> Shape.Delete</span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å–å¾—æŒ‡å®šè³‡æ–™å¤¾ä¸‹æ‰€æœ‰ç…§ç‰‡è·¯å¾‘</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getAllFolder()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> objFolder <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> objFolder = objFso.GetFolder(main_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> getAllFile(objFolder)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> getAllFile(<span class="keyword">ByVal</span> objFolder <span class="keyword">As</span> <span class="type">Object</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> objFolder.Files.Count &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> objFile <span class="keyword">In</span> objFolder.Files</span><br><span class="line">    </span><br><span class="line">    s = objFso.GetExtensionName(objFile)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> IsPhoto(s) <span class="keyword">Then</span> coll_photo_path.Add objFile.path</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> objFolder.subFolders.Count &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> objSubFolder <span class="keyword">In</span> objFolder.subFolders</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Call</span> getAllFile(objSubFolder)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è²¼ä¸Šç…§ç‰‡åˆ°æ“ä½œä»‹é¢</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> PastePictures()</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> shtResult</span><br><span class="line">    </span><br><span class="line">    lr = .Cells(<span class="number">1</span>, <span class="number">1</span>).<span class="keyword">End</span>(xlDown).Row</span><br><span class="line">    lc = .Cells(<span class="number">1</span>, <span class="number">1</span>).<span class="keyword">End</span>(xlToRight).Column - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> rng_last = .Cells(lr, lc)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;Set rng_last = .Cells.SpecialCells(xlCellTypeLastCell)</span></span><br><span class="line">    </span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> photo_path <span class="keyword">In</span> coll_photo_path</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> IsPaste = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">            <span class="keyword">Set</span> objTargetCell = .Cells(r, <span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">            objTargetCell.ColumnWidth = photo_width</span><br><span class="line">            objTargetCell.RowHeight = photo_height</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">Set</span> pic = .Pictures.Insert(photo_path)</span><br><span class="line">            <span class="comment">&#x27;Set pic = .Pictures.Insert(imagePath).ShapeRange.PictureFormat.Compression = 75</span></span><br><span class="line">            <span class="comment">&#x27;Set pic = .Shapes.AddPicture(photo_path) &#x27;, True, True, objTargetCell.Left + 2, objTargetCell.Top + 2, objTargetCell.Width - 4, objTargetCell.Height - 4)</span></span><br><span class="line">            <span class="comment">&#x27;pic.LockAspectRatio = msoFalse</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">With</span> pic</span><br><span class="line">            </span><br><span class="line">                dblGap = <span class="number">2</span>#</span><br><span class="line">            </span><br><span class="line">                .ShapeRange.LockAspectRatio = msoTrue <span class="comment">&#x27;é–å®šç…§ç‰‡é•·å¯¬æ¯”</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">Set</span> ranOri = objTargetCell</span><br><span class="line"></span><br><span class="line">                dblRatioPic = .Width / .Height</span><br><span class="line">                dblRatioOri = ranOri.Width / ranOri.Height</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">If</span> dblRatioPic &gt; dblRatioOri <span class="keyword">Then</span> <span class="comment">&#x27;å¯¬åº¦æ§åˆ¶</span></span><br><span class="line">                    .Width = ranOri.Width - <span class="number">2</span> * dblGap</span><br><span class="line">                    .Top = ranOri.Top + <span class="number">0.5</span> * ranOri.Height - <span class="number">0.5</span> * .Height</span><br><span class="line">                    .Left = ranOri.Left + dblGap</span><br><span class="line">                <span class="keyword">Else</span>                                <span class="comment">&#x27;é«˜åº¦æ§åˆ¶</span></span><br><span class="line">                    .Height = ranOri.Height - <span class="number">2</span> * dblGap</span><br><span class="line">                    .Top = ranOri.Top + dblGap</span><br><span class="line">                    .Left = ranOri.Left + <span class="number">0.5</span> * ranOri.Width - <span class="number">0.5</span> * .Width</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        .Cells(r, <span class="number">1</span>) = r - <span class="number">1</span></span><br><span class="line">        .Cells(r, <span class="number">3</span>) = photo_path</span><br><span class="line">        .Cells(r, <span class="number">4</span>) = getParentFolder(photo_path) <span class="comment">&#x27;å–å¾—ä¸Šå±¤ç›®éŒ„</span></span><br><span class="line">        .Cells(r, <span class="number">5</span>) = getFileName(photo_path) <span class="comment">&#x27;å–å¾—æª”æ¡ˆåç¨±</span></span><br><span class="line">        </span><br><span class="line">        .Cells(r, <span class="number">1</span>).Resize(<span class="number">1</span>, rng_last.Column).Borders.LineStyle = <span class="number">1</span></span><br><span class="line">        .Cells(r, <span class="number">6</span>).Resize(<span class="number">1</span>, rng_last.Column).HorizontalAlignment = xlLeft</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;Call getMarkDetail(.Cells(r, 5), r)</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        r = r + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;====å–å¾—ä¸Šå±¤ç›®éŒ„è·¯å¾‘=====</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getParentFolder(<span class="keyword">ByVal</span> path <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line">tmp_folder = Replace(path, main_path, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">tmp = split(tmp_folder, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"></span><br><span class="line">tmp_filename = tmp(UBound(tmp))</span><br><span class="line"></span><br><span class="line">getParentFolder = Replace(tmp_folder, tmp_filename, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;====å–å¾—æª”æ¡ˆåç¨±=====</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> getFileName(<span class="keyword">ByVal</span> path <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line">tmp = split(path, <span class="string">&quot;\&quot;</span>)</span><br><span class="line"></span><br><span class="line">getFileName = tmp(UBound(tmp))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬è³‡æ–™ç™»éŒ„">2-2 åŸºæœ¬è³‡æ–™ç™»éŒ„</h3>
<figure>
<img src="upload_5006a277fccef045e65c4a45909d3250.png"
alt="æ“ä½œä»‹é¢è¡¨å–®åŒ–" />
<figcaption aria-hidden="true">æ“ä½œä»‹é¢è¡¨å–®åŒ–</figcaption>
</figure>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&#x27;Initialize</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> UserForm_Initialize()</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Sheets(<span class="string">&quot;Result&quot;</span>)</span><br><span class="line"></span><br><span class="line">    lr = .Cells(.Rows.Count, <span class="number">1</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Me</span>.Label2.Caption = <span class="string">&quot;å…±&quot;</span> &amp; lr - <span class="number">1</span> &amp; <span class="string">&quot;å¼µ&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Me</span>.Label3.Caption = .Cells(<span class="number">1</span>, <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">Me</span>.Label4.Caption = .Cells(<span class="number">1</span>, <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">Me</span>.Label5.Caption = .Cells(<span class="number">1</span>, <span class="number">9</span>)</span><br><span class="line">    <span class="keyword">Me</span>.Label6.Caption = .Cells(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">Me</span>.Label7.Caption = .Cells(<span class="number">1</span>, <span class="number">11</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Me</span>.TextBox1 = <span class="string">&quot;1&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Me</span>.ComboBox1.AddItem <span class="string">&quot;æ–½å·¥æŠ½æŸ¥&quot;</span></span><br><span class="line">    <span class="keyword">Me</span>.ComboBox1.AddItem <span class="string">&quot;å“è³ªç®¡åˆ¶&quot;</span></span><br><span class="line">    <span class="keyword">Me</span>.ComboBox1.AddItem <span class="string">&quot;ç¼ºå¤±æ”¹å–„&quot;</span></span><br><span class="line">    <span class="keyword">Me</span>.ComboBox1.AddItem <span class="string">&quot;æ–½å·¥ä¸­&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;ç¯€éŒ„ç…§ç‰‡å…§å®¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> TextBox1_Change()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> clsI <span class="keyword">As</span> <span class="built_in">New</span> clsInformation</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;If clsI.IsShowEditForm = False Then Exit Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> TextBox1.Value &lt;&gt; <span class="string">&quot;0&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">s = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;On Error Resume Next</span></span><br><span class="line"></span><br><span class="line">Image1.Picture = LoadPicture(s)</span><br><span class="line"></span><br><span class="line">ImageTmp.TextBox2 = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">7</span>)</span><br><span class="line">ImageTmp.TextBox3 = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">8</span>)</span><br><span class="line">ImageTmp.TextBox4 = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">9</span>)</span><br><span class="line">ImageTmp.ComboBox1 = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line"><span class="comment">&#x27;ImageTmp.TextBox5 = Cells(TextBox1.Value + 1, 10)</span></span><br><span class="line">ImageTmp.TextBox6 = Cells(TextBox1.Value + <span class="number">1</span>, <span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ç¬¬ä¸‰ç« ç¯€-å ±è¡¨ç‰ˆå‹">ç¬¬ä¸‰ç« ç¯€ å ±è¡¨ç‰ˆå‹</h2>
<h3 id="å ±è¡¨åŸºæœ¬ç‰ˆå‹">3-1 å ±è¡¨åŸºæœ¬ç‰ˆå‹</h3>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getReportShts()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> coll <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> sht <span class="keyword">In</span> Sheets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> sht.Name <span class="built_in">Like</span> <span class="string">&quot;*-*&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">    coll.Add sht.Name</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> coll</span><br><span class="line"></span><br><span class="line">    j = j + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    p = p &amp; j &amp; <span class="string">&quot;.&quot;</span> &amp; it &amp; vbNewLine</span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">AGAIN:</span></span><br><span class="line"></span><br><span class="line">mode = InputBox(<span class="string">&quot;è«‹é¸æ“‡åˆ—å°ç‰ˆå‹:&quot;</span> &amp; vbNewLine &amp; p)</span><br><span class="line"></span><br><span class="line">Sheets(coll(<span class="built_in">CInt</span>(mode))).PrintPreview</span><br><span class="line"></span><br><span class="line">msg = MsgBox(<span class="string">&quot;é€™æ˜¯æ‚¨è¦çš„ç‰ˆå‹å—?&quot;</span>, vbYesNo)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> msg = vbYes <span class="keyword">Then</span></span><br><span class="line">    Sheets(<span class="string">&quot;Main&quot;</span>).Range(<span class="string">&quot;B4&quot;</span>) = coll(<span class="built_in">CInt</span>(mode))</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    <span class="keyword">GoTo</span> AGAIN</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">Sheets(<span class="string">&quot;Main&quot;</span>).Activate</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h3 id="å ±è¡¨å®¢è£½ç‰ˆå‹">3-2 å ±è¡¨å®¢è£½ç‰ˆå‹<span class="github-emoji"
data-alias="star" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">â­</span></h3>
<p>å­¸ç¿’å¦‚ä½•å¾æ—¢æœ‰ç‰ˆå‹èª¿æ•´æ¨™ç±¤å¡Šåˆ°æŒ‡å®šä½ç½®ä¸¦èª¿æ•´æ•¸é‡ï¼Œæ‰¹æ¬¡ä»£å…¥å·¥ä½œè¡¨</p>
<ul>
<li>&lt;<ç…§ç‰‡-1>&gt; å¼•å…¥ç…§ç‰‡</li>
<li>&lt;<ä½ç½®-1>&gt; å°æ‡‰Hæ¬„</li>
<li>&lt;<æ—¥æœŸ-1>&gt; å°æ‡‰Gæ¬„</li>
<li>&lt;<èªªæ˜-1>&gt; å°æ‡‰Iæ¬„</li>
</ul>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> checkReportFormat()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> coll <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; éæ­·å ±è¡¨ä¸­çš„æ‰€æœ‰å„²å­˜æ ¼</span></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> Sheets(getReportShtName).UsedRange</span><br><span class="line"></span><br><span class="line">        <span class="comment">&#x27; å¦‚æœå„²å­˜æ ¼çš„å€¼åŒ¹é… &quot;&lt;&lt;*&gt;&gt;&quot;</span></span><br><span class="line">        <span class="keyword">If</span> rng.Value <span class="built_in">Like</span> <span class="string">&quot;&lt;&lt;*&gt;&gt;&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&#x27; å»æ‰ &lt;&lt; å’Œ &gt;&gt;</span></span><br><span class="line">            tmp = Replace(rng.Value, <span class="string">&quot;&lt;&lt;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            tmp = Replace(tmp, <span class="string">&quot;&gt;&gt;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment">&#x27; å°‡çµæœåŠ å…¥åˆ° coll é›†åˆä¸­</span></span><br><span class="line">            coll.Add tmp</span><br><span class="line"></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> coll_unique <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; æª¢æŸ¥å ±è¡¨ä¸­æ¯å€‹æ¨™è¨»é …ç›®çš„å°æ‡‰è¡¨é ­åç¨±</span></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> coll</span><br><span class="line"></span><br><span class="line">        <span class="comment">&#x27; å°‡ coll ä¸­çš„æ¯å€‹é …ç›®æŒ‰ &quot;-&quot; æ‹†åˆ†ï¼Œå–å¾—é—œéµå­— ky</span></span><br><span class="line">        s = Split(it, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">        ky = s(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; åœ¨ &quot;Result&quot; è¡¨çš„ç¬¬ä¸€è¡ŒæŸ¥æ‰¾é€™å€‹é—œéµå­—</span></span><br><span class="line">        <span class="keyword">Set</span> rng = Sheets(<span class="string">&quot;Result&quot;</span>).Rows(<span class="number">1</span>).Find(ky)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; å¦‚æœæ‰¾ä¸åˆ°ï¼Œä¸”é—œéµå­—ä¸ç­‰æ–¼ &quot;ç…§ç‰‡&quot;ï¼Œé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ä¸¦é¸ä¸­å ±è¡¨ä¸­çš„å°æ‡‰ä½ç½®</span></span><br><span class="line">        <span class="keyword">If</span> rng <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="built_in">And</span> ky &lt;&gt; <span class="string">&quot;ç…§ç‰‡&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            Sheets(getReportShtName).Activate</span><br><span class="line">            MsgBox <span class="string">&quot;ã€&quot;</span> &amp; it &amp; <span class="string">&quot;ã€‘:å°æ‡‰ä¸åˆ°Resultçš„è¡¨é ­åç¨±&quot;</span></span><br><span class="line">            <span class="keyword">Set</span> rng_focus = Sheets(getReportShtName).Cells.Find(<span class="string">&quot;&lt;&lt;&quot;</span> &amp; it &amp; <span class="string">&quot;&gt;&gt;&quot;</span>)</span><br><span class="line">            rng_focus.<span class="keyword">Select</span></span><br><span class="line">            <span class="keyword">End</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; å°‡å”¯ä¸€çš„ç·¨è™Ÿ num æ·»åŠ åˆ° coll_unique é›†åˆä¸­</span></span><br><span class="line">        num = s(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">        coll_unique.Add num, <span class="built_in">CStr</span>(num)</span><br><span class="line">        <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> coll_count <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; è¨ˆç®—æ¯å€‹å”¯ä¸€ç·¨è™Ÿå‡ºç¾çš„æ¬¡æ•¸</span></span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> it_unique <span class="keyword">In</span> coll_unique</span><br><span class="line"></span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> coll</span><br><span class="line"></span><br><span class="line">            s = Split(it, <span class="string">&quot;-&quot;</span>)</span><br><span class="line">            num = s(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">If</span> num = it_unique <span class="keyword">Then</span></span><br><span class="line">                cnt = cnt + <span class="number">1</span></span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&#x27; å°‡çµæœä»¥ &quot;ç·¨è™Ÿ-æ¬¡æ•¸&quot; çš„æ ¼å¼æ·»åŠ åˆ° coll_count é›†åˆä¸­</span></span><br><span class="line">        coll_count.Add it_unique &amp; <span class="string">&quot;-&quot;</span> &amp; cnt</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27; æª¢æŸ¥æ¯å€‹å”¯ä¸€ç·¨è™Ÿçš„å‡ºç¾æ¬¡æ•¸æ˜¯å¦ä¸€è‡´</span></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> coll_count.Count - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        s_cnt = Split(coll_count(i), <span class="string">&quot;-&quot;</span>)(<span class="number">1</span>)</span><br><span class="line">        e_cnt = Split(coll_count(i + <span class="number">1</span>), <span class="string">&quot;-&quot;</span>)(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">If</span> s_cnt &lt;&gt; e_cnt <span class="keyword">Then</span></span><br><span class="line">            MsgBox <span class="string">&quot;å ±è¡¨ä½ç½®è¨»è¨˜é …ç›®ï¼Œä¸åŒç·¨è™Ÿæ‡‰å…·æœ‰ç›¸åŒæ•¸é‡!&quot;</span> &amp; vbNewLine &amp; _</span><br><span class="line">            <span class="string">&quot;è«‹æª¢æ ¸ç¬¬&quot;</span> &amp; Split(coll_count(i), <span class="string">&quot;-&quot;</span>)(<span class="number">0</span>) &amp; <span class="string">&quot;æ¬¡èˆ‡ç¬¬&quot;</span> &amp; Split(coll_count(i + <span class="number">1</span>), <span class="string">&quot;-&quot;</span>)(<span class="number">0</span>) &amp; <span class="string">&quot;æ¬¡!&quot;</span>, vbCritical</span><br><span class="line">            <span class="keyword">End</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–‡å­—ç´°ç¯€èª¿æ•´">3-3 æ–‡å­—ç´°ç¯€èª¿æ•´</h3>
<blockquote>
<p>æ—¥æœŸæ˜¯å¦å‡ºç¾æ–¼å³ä¸‹è§’çš„æµ®æ°´å°æ–‡å­—å¡Šï¼Œèª¿æ•´å…¶æ–‡å­—é¡è‰²åŠç¶²åº•é¡è‰²</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> AddText(<span class="keyword">ByVal</span> txtX, <span class="keyword">ByVal</span> txtY, <span class="keyword">ByVal</span> txtHeight, <span class="keyword">ByVal</span> txtWidth, <span class="keyword">ByVal</span> txtStr, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> RGB_Selector <span class="keyword">As</span> <span class="type">Integer</span> = <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> o <span class="keyword">As</span> <span class="built_in">New</span> clsInformation</span><br><span class="line"><span class="keyword">Dim</span> r <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Dim</span> g <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Dim</span> b <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Dim</span> r2 <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Dim</span> g2 <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="keyword">Dim</span> b2 <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> o.IsPrintDate = <span class="literal">False</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line">RGB_Interior = o.getInteriorColor</span><br><span class="line"><span class="keyword">Call</span> o.VBLongToRGB(RGB_Interior, r, g, b)</span><br><span class="line">RGB_Font = o.getFontColor</span><br><span class="line"><span class="keyword">Call</span> o.VBLongToRGB(RGB_Font, r2, g2, b2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> ThisWorkbook.Sheets(report_shtname)</span><br><span class="line"></span><br><span class="line">    .Activate</span><br><span class="line"></span><br><span class="line">    ActiveSheet.Shapes.AddTextbox(msoTextOrientationHorizontal, txtX, txtY, txtHeight * Len(txtStr) * <span class="number">0.33</span>, txtHeight).<span class="keyword">Select</span></span><br><span class="line">    Selection.ShapeRange(<span class="number">1</span>).TextFrame2.TextRange.Characters.<span class="keyword">text</span> = txtStr</span><br><span class="line">        </span><br><span class="line">    Selection.ShapeRange.Fill.Visible = msoFalse</span><br><span class="line">    Selection.ShapeRange.Line.Visible = msoFalse</span><br><span class="line">    Selection.ShapeRange.ZOrder msoBringToFront</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">With</span> Selection.ShapeRange(<span class="number">1</span>).TextFrame2.TextRange.Characters.Font</span><br><span class="line"></span><br><span class="line">        .Bold = msoTrue</span><br><span class="line">        .Fill.ForeColor.RGB = RGB(r2, g2, b2)</span><br><span class="line">        .Size = txtHeight * <span class="number">0.5</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> o.IsPrintDateBack = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">With</span> Selection.ShapeRange(<span class="number">1</span>).Fill</span><br><span class="line">            .Visible = msoTrue</span><br><span class="line">            .ForeColor.RGB = RGB(r, g, b)</span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¬¬å››ç« ç¯€-å ±è¡¨è¼¸å‡º">ç¬¬å››ç« ç¯€ å ±è¡¨è¼¸å‡º</h2>
<h3 id="å ±è¡¨è¼¸å‡ºæ–¹æ³•">4-1 å ±è¡¨è¼¸å‡ºæ–¹æ³• <span class="github-emoji"
data-alias="star" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2b50.png?v8">â­</span></h3>
<blockquote>
<p>å»ºç«‹åˆ—å°ç¾¤çµ„ï¼Œæ ¹æ“šç‰ˆå‹æ±ºå®šæ¯å¹¾å¼µè¦æ›é ï¼Œç”±å·¥ä½œè¡¨æœªéš±è—çš„åˆ—æ±ºå®šåˆ—å°é †åºï¼Œæœªä¾†äº¦å¯å»ºç«‹è‡ªå·±çš„åˆ—å°è¦å‰‡ï¼Œå°‡å‚™è¨»æ¬„çš„è³‡æ–™ç¯©é¸ä½µå…¥ä½œç‚ºåˆ—å°çš„è§¸ç™¼æ“´å……é …ç›®(æ¯”å¦‚è¨­å®šæ”¹å–„ç·¨è™Ÿã€é æ¬¡ä¾†å°‡å·¥ä½œè¡¨çš„é †åºé€²è¡Œé‡æ–°èª¿æ•´)ã€‚</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getPrintGroups()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> checkDateFormat</span><br><span class="line"><span class="keyword">Call</span> checkReportFormat</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> f <span class="keyword">As</span> <span class="built_in">New</span> clsMyfunction</span><br><span class="line"><span class="keyword">Dim</span> coll_rows_final <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> coll_rows = getRowsUnHidden</span><br><span class="line">    </span><br><span class="line">    folder_name = Format(Now(), <span class="string">&quot;YYYYMMDD-HHMMSS &quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> r <span class="keyword">In</span> coll_rows</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">With</span> Sheets(<span class="string">&quot;Result&quot;</span>)</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">If</span> .Cells(r, .Columns.Count).<span class="keyword">End</span>(xlToLeft).Column &gt; <span class="number">5</span> <span class="keyword">Then</span></span><br><span class="line">        </span><br><span class="line">            coll_rows_final.Add r</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> coll_rows_final.Count &gt; <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">Call</span> printFilesByRows(coll_rows_final, <span class="literal">True</span>, folder_name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Set</span> coll_rows_final = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line">Sheets(<span class="string">&quot;Main&quot;</span>).Activate</span><br><span class="line"></span><br><span class="line">Workbooks(Workbooks.Count).Activate</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>åˆ—å°ç›¸é—œä»£ç¢¼ï¼ŒåŒ…å«åˆ—å°æˆPDFè·Ÿåˆ—å°æˆXLS</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> printFilesByRows(<span class="keyword">ByVal</span> coll_rows, <span class="keyword">ByVal</span> IsXLS <span class="keyword">As</span> <span class="type">Boolean</span>, <span class="keyword">ByVal</span> folder_name <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> o <span class="keyword">As</span> <span class="built_in">New</span> clsReport</span><br><span class="line"><span class="keyword">Dim</span> f <span class="keyword">As</span> <span class="built_in">New</span> clsMyfunction</span><br><span class="line"><span class="keyword">Dim</span> coll_recover <span class="keyword">As</span> <span class="built_in">New</span> Collection</span><br><span class="line"></span><br><span class="line">report_shtname = Sheets(<span class="string">&quot;Main&quot;</span>).Range(<span class="string">&quot;B4&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> coll_key = getKeyWords <span class="comment">&#x27;ç¬¬Gæ¬„é–‹å§‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> wb = Workbooks.Add</span><br><span class="line"></span><br><span class="line">ThisWorkbook.Activate</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> r <span class="keyword">In</span> coll_rows</span><br><span class="line"></span><br><span class="line"><span class="symbol">KeepPrint:</span></span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> <span class="keyword">Each</span> s <span class="keyword">In</span> coll_key</span><br><span class="line">        </span><br><span class="line">        myKey = split(s, <span class="string">&quot;,&quot;</span>)(<span class="number">0</span>)</span><br><span class="line">        col = split(s, <span class="string">&quot;,&quot;</span>)(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">        myAddress = getAddressByKeyWord(myKey, <span class="built_in">CStr</span>(i))</span><br><span class="line">        </span><br><span class="line"><span class="comment">&#x27;        If i = 4 Then Stop</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> myAddress &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">If</span> myKey = <span class="string">&quot;ç…§ç‰‡&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            </span><br><span class="line">                file_name = file_name &amp; r &amp; <span class="string">&quot;-&quot;</span></span><br><span class="line">                <span class="comment">&#x27;paste photo</span></span><br><span class="line">                <span class="keyword">Call</span> o.PastePhoto_giveRng(Sheets(getReportShtName).Range(myAddress), Sheets(<span class="string">&quot;Result&quot;</span>).Cells(r, <span class="string">&quot;C&quot;</span>), Sheets(<span class="string">&quot;Result&quot;</span>).Cells(r, <span class="built_in">CInt</span>(col)))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">ElseIf</span> myKey = <span class="string">&quot;æ—¥æœŸ&quot;</span> <span class="keyword">Then</span></span><br><span class="line">                </span><br><span class="line">                Sheets(getReportShtName).Range(myAddress) = f.tranStrToDate(Sheets(<span class="string">&quot;Result&quot;</span>).Cells(r, <span class="built_in">CInt</span>(col)))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">            </span><br><span class="line">                Sheets(getReportShtName).Range(myAddress) = Sheets(<span class="string">&quot;Result&quot;</span>).Cells(r, <span class="built_in">CInt</span>(col))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            </span><br><span class="line">            coll_recover.Add <span class="string">&quot;&lt;&lt;&quot;</span> &amp; myKey &amp; <span class="string">&quot;-&quot;</span> &amp; <span class="built_in">CStr</span>(i) &amp; <span class="string">&quot;&gt;&gt;;&quot;</span> &amp; myAddress</span><br><span class="line">            IsPrinted = <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            </span><br><span class="line">            IsPrinted = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">If</span> IsXLS = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">                <span class="keyword">Call</span> printReportPDF(file_name)</span><br><span class="line">            <span class="keyword">Else</span></span><br><span class="line">                <span class="keyword">Call</span> printReportToWb(wb, file_name)</span><br><span class="line">            <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">Call</span> clearReport(coll_recover)</span><br><span class="line">            file_name = <span class="string">&quot;&quot;</span></span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">            <span class="keyword">GoTo</span> KeepPrint</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> IsPrinted = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> IsXLS = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">Call</span> printReportPDF(file_name)</span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        <span class="keyword">Call</span> printReportToWb(wb, file_name)</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> clearReport(coll_recover)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> IsXLS = <span class="literal">True</span> <span class="keyword">Then</span> <span class="keyword">Call</span> printReportToWb_Save(wb, folder_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ç…§ç‰‡æ­¸æª”">4-2 ç…§ç‰‡æ­¸æª”</h3>
<blockquote>
<p>å°‡å·¥ä½œè¡¨ä¸Šæ‰‹å‹•ç´€éŒ„çš„è³‡æ–™å…§å®¹ä¾ç…§æŒ‡å®šæ–¹å¼æ‰¹æ¬¡é‡å°ç…§ç‰‡åŸå§‹æª”æ¡ˆé€²è¡Œæª”åæ›´æ”¹ï¼Œæœªä¾†å¼•å…¥æ™‚æœƒå…ˆåˆ¤å®šæª”åå…§å®¹å¼•å…¥å·¥ä½œè¡¨ç›¸å°æ‡‰è³‡æ–™ã€‚</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ChangeAllFileName()</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> Sheets(<span class="string">&quot;Result&quot;</span>).AutoFilterMode <span class="keyword">Then</span></span><br><span class="line">    Sheets(<span class="string">&quot;Result&quot;</span>).AutoFilterMode = <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> getCombineNames</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> objFile <span class="keyword">As</span> <span class="built_in">New</span> clsmyFile</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Sheets(<span class="string">&quot;Main&quot;</span>)</span><br><span class="line"></span><br><span class="line">    objFile.main_path = .Range(<span class="string">&quot;B2&quot;</span>)</span><br><span class="line">    objFile.changeFileName</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> getDataFromFolder <span class="comment">&#x27;reloading</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> getCombineNames()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> clsInf <span class="keyword">As</span> <span class="built_in">New</span> clsInformation</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> coll = clsInf.getCollStructure(clsInf.getReNameStruc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> Sheets(<span class="string">&quot;Result&quot;</span>)</span><br><span class="line"></span><br><span class="line">    lr = .Cells(.Rows.Count, <span class="number">1</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> r = <span class="number">2</span> <span class="keyword">To</span> lr</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> .Cells(r, .Columns.Count).<span class="keyword">End</span>(xlToLeft).Column &gt; <span class="number">5</span> <span class="keyword">Then</span></span><br><span class="line">        </span><br><span class="line">            p = <span class="string">&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">For</span> <span class="keyword">Each</span> col <span class="keyword">In</span> coll</span><br><span class="line">            </span><br><span class="line">                p = p &amp; .Cells(r, col) &amp; <span class="string">&quot;_&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">Next</span></span><br><span class="line">            </span><br><span class="line">            .Cells(r, <span class="string">&quot;F&quot;</span>) = <span class="keyword">mid</span>(p, <span class="number">1</span>, Len(p) - <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ”¹åéƒ¨åˆ†</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Sub</span> changeFileName()</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> shtResult</span><br><span class="line"></span><br><span class="line">    lr = .Cells(.Rows.Count, <span class="number">1</span>).<span class="keyword">End</span>(xlUp).Row</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> r = <span class="number">2</span> <span class="keyword">To</span> lr</span><br><span class="line">    </span><br><span class="line">        oldname = .Cells(r, <span class="number">3</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">If</span> .Cells(r, <span class="number">6</span>) <span class="built_in">Like</span> <span class="string">&quot;*.jp*&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            newname = main_path &amp; .Cells(r, <span class="number">4</span>) &amp; .Cells(r, <span class="number">6</span>)</span><br><span class="line">        <span class="keyword">Else</span></span><br><span class="line">            newname = main_path &amp; .Cells(r, <span class="number">4</span>) &amp; .Cells(r, <span class="number">6</span>) &amp; <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">If</span> .Cells(r, <span class="number">6</span>) &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">            </span><br><span class="line">            Debug.Print <span class="string">&quot;old:&quot;</span> &amp; oldname</span><br><span class="line">            Debug.Print <span class="string">&quot;new:&quot;</span> &amp; newname</span><br><span class="line">            </span><br><span class="line">            Name oldname <span class="keyword">As</span> newname</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>æ–½å·¥ç…§ç‰‡</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸åŒç‰ˆæœ¬é–“çš„CADé–‹ç™¼</title>
    <url>/posts/2144300187/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>CADç‰ˆæœ¬æœ‰éå¸¸å¤šç¨®ï¼Œæˆ‘ç›®å‰æœ‰æ¥è§¸éçš„å°±æœ‰AutoCADã€ZWCADä»¥åŠç¾åœ¨æ­£åœ¨ä½¿ç”¨ä¸­çš„ProgeCADã€‚</p>
<p>åœ¨ä½¿ç”¨VBAé€²è¡ŒäºŒæ¬¡é–‹ç™¼çš„éç¨‹ï¼Œéœ€è¦è€ƒé‡<strong>å¼•ç”¨ç‰©ä»¶æ¨¡å‹</strong>ä¹‹é–“çš„å·®ç•°ï¼Œå°±ç›®å‰é–‹ç™¼ç¶“é©—ä¸­ï¼ŒAutoCADèˆ‡ZWCADå¯ä»¥é€éä¿®æ”¹å¼•ç”¨åç¨±å°±å¯ä»¥æœ‰å¾ˆå¥½çš„è½‰æ›é«”é©—ï¼Œä½†æ˜¯ProgeCADçš„<strong>åŸºåº•ç‰©ä»¶</strong>æœ‰æ¯”è¼ƒä¸åŒçš„è¨­è¨ˆï¼Œæ•…æœ¬ç¯‡è¦ä¾†è§£é‡‹å¾AutoCADçš„VBAcodeå¦‚ä½•é€éæˆ‘æ‰€æ’°å¯«çš„ç‰©ä»¶è½‰æ›å‡½æ•¸é€²è¡Œç›¸å®¹ï¼Œè®“ç¨‹å¼ç¢¼åœ¨ProgeCADä¹Ÿå¯ä»¥é †åˆ©å‹•èµ·ä¾†ã€‚</p>
<p><a
href="https://hankvba.blogspot.com/2021/07/cadlibraryclsacad.html">ğŸ”—HanksVBAå­¸ç¿’æ­·ç¨‹-ä¸åŒCADç‰ˆæœ¬é–“ä¹Ÿå¯ä»¥å¼•ç”¨çš„Library(clsACAD)</a></p>
<span id="more"></span>
<h2 id="ç‰ˆæœ¬æ²¿é©">ğŸ¯ç‰ˆæœ¬æ²¿é©</h2>
<h3 id="autocad">AutoCAD</h3>
<p>AutoCADç‚ºAutodeskå…¬å¸æ——ä¸‹ç”¢å“ï¼Œç”¢å“æ¯”è¼ƒæ²’æœ‰ç•°å¸¸ï¼Œç¨‹å¼ç¢¼ç¯„ä¾‹è±å¯Œï¼Œç¤¾ç¾¤æ”¯æ´å®Œæ•´åº¦è¼ƒé«˜ï¼ŒåŒæ™‚ä¹Ÿæ˜¯æœ€æ˜‚è²´çš„è»Ÿé«”ã€‚</p>
<h3 id="zwcad">ZWCAD</h3>
<p>ZWCADç‚ºä¸­æœ›å…¬å¸æ——ä¸‹ç”¢å“ï¼Œå…¶å¯¦èˆ‡AutoCADéƒ½å¤§åŒå°ç•°ï¼Œè²»ç”¨æ¯”AutoCADä¾†çš„ä¾¿å®œï¼Œå¯æƒœæ”¿åºœæ©Ÿé—œä¸èƒ½æ¥å—ä¸­è³‡ï¼Œæ€•æœ‰è³‡å®‰ç–‘æ…®ã€‚</p>
<h3 id="progecad">ProgeCAD</h3>
<p>ProgeCADç¸½éƒ¨è¨­ç«‹æ–¼ç¾©å¤§åˆ©ï¼Œæ¡ç”¨IntelliCADå¼•æ“é©…å‹•ï¼Œå°±ä½¿ç”¨ä¸Šä¸çŸ¥æ€éº¼èªªï¼Œå°±æ˜¯è¦ºå¾—èˆ‡AutoCADå°‘äº†ä¸€å‘³ï¼Œç¨‹å¼ç¢¼çš„é‹ä½œæ¯”è¼ƒç·©æ…¢ï¼Œæœ‰äº›ä»‹é¢æœƒè·ŸAutoCADæœ‰äº›è¨±è½å·®ã€‚</p>
<h2 id="é–‹ç™¼å·®ç•°">ğŸ“Œé–‹ç™¼å·®ç•°</h2>
<p>ä¹‹å‰çš„å°ˆæ¡ˆå¤§å¤šéƒ½æ˜¯ç”¨æ–¼AutoCADé‹ä½œï¼Œè‡ªå¾æ©Ÿé—œè²·æ–·ProgeCADä¹‹å¾Œï¼Œç‚ºäº†æŠŠç¨‹å¼ç¢¼ç§»è½‰åˆ°ProgeCADé€²è¡Œï¼Œéœ€è¦äº†è§£ä¸€ä¸‹ç¨‹å¼ç¢¼é–‹ç™¼ä¹‹é–“çš„å·®ç•°ã€‚</p>
<h3 id="å…¬å…±è®Šæ•¸">å…¬å…±è®Šæ•¸</h3>
<p>å…¬å…±è®Šæ•¸çš„ç›®çš„æ˜¯ç‚ºäº†èƒ½å¤ åœ¨å„å€‹functionä¸­ç›¸äº’å‚³éè®Šæ•¸ä½¿ç”¨</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Private</span> mo <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Private</span> pa <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Public</span> acadDoc <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Public</span> CADVer <span class="keyword">As</span> <span class="type">String</span></span><br></pre></td></tr></table></figure>
<h3 id="é€£æ¥æ‡‰ç”¨ç¨‹å¼">é€£æ¥æ‡‰ç”¨ç¨‹å¼</h3>
<p>é€™è£¡æˆ‘åœ¨Sheets("ç¸½è¡¨")ä¸Šé¢åšäº†ä¸€å€‹é¸å–®ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥æŒ‘é¸è¦å•Ÿç”¨å“ªå€‹å¾ŒæœŸç¹«çµå­—ä¸²ï¼ŒstrCADç‚ºVBAå‘¼å«CADæ‡‰ç”¨ç¨‹å¼é€£æ¥å­—ä¸²ï¼ŒCADVerç‚ºå„functioné€£æ¥å¾Œçš„ç´°å¾®èª¿æ•´åˆ¤æ–·ã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Class_Initialize()</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> Sheets(<span class="string">&quot;ç¸½è¡¨&quot;</span>).optAutoCAD = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    strCAD = <span class="string">&quot;AutoCAD.application&quot;</span></span><br><span class="line">    CADVer = <span class="string">&quot;AUTOCAD&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">ElseIf</span> Sheets(<span class="string">&quot;ç¸½è¡¨&quot;</span>).optZWCAD = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">    strCAD = <span class="string">&quot;ZWCAD.Application&quot;</span></span><br><span class="line">    CADVer = <span class="string">&quot;ZWCAD&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">ElseIf</span> Sheets(<span class="string">&quot;ç¸½è¡¨&quot;</span>).optICAD = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    strCAD = <span class="string">&quot;ICAD.application&quot;</span></span><br><span class="line">    CADVer = <span class="string">&quot;ICAD&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> CADInit(strCAD)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CADInit(<span class="keyword">ByVal</span> strCAD <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> acadApp = GetObject(, strCAD) <span class="comment">&#x27;æŸ¥çœ‹å®‰è£</span></span><br><span class="line"><span class="keyword">If</span> Err &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">Set</span> acadApp = CreateObject(strCAD)</span><br><span class="line">acadApp.Visible = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> mo = acadApp.ActiveDocument.ModelSpace</span><br><span class="line"><span class="keyword">Set</span> pa = acadApp.ActiveDocument.PaperSpace</span><br><span class="line"><span class="keyword">Set</span> acadDoc = acadApp.ActiveDocument</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<h2 id="ç‰©ä»¶ç›¸å®¹è½‰æ›å‡½æ•¸">ğŸŒŸç‰©ä»¶ç›¸å®¹è½‰æ›å‡½æ•¸</h2>
<ul>
<li>AutoCADçš„é»ç‰©ä»¶æ˜¯ä»¥ä¸€å€‹é™£åˆ—(array)å„²å­˜(0,1,2)doubleè®Šæ•¸è€Œæˆã€‚</li>
<li>AutoCADçš„ç·šç‰©ä»¶å‰‡åˆ†ç‚ºLightWeightPolylineè·Ÿ3dPolyline
<ul>
<li>LightWeigtPolylineæ˜¯ä»¥ä¸€å€‹é™£åˆ—(vertice)<strong>è‡³å°‘</strong>å„²å­˜(0,1,2,3)ç”Ÿæˆï¼Œéç¨‹ä¸­ä¸å„²å­˜é«˜ç¨‹ï¼Œæ‰€ä»¥æ¯2å€‹å€¼ç‚ºä¸€å€‹é»ã€‚</li>
<li>3DPolylineæ˜¯ä»¥ä¸€å€‹é™£åˆ—(vertice)<strong>è‡³å°‘</strong>å„²å­˜(0,1,2,3,4,5)ç”Ÿæˆï¼Œéç¨‹ä¸­å„²å­˜é«˜ç¨‹ï¼Œæ‰€ä»¥æ¯3å€‹å€¼ç‚ºä¸€å€‹é»ã€‚</li>
</ul></li>
<li>ProgeCADçš„é»ç‰©ä»¶æ˜¯ä»¥ä¸€å€‹é»ç‰©ä»¶(Point)ï¼Œç”±X,Y,Zä¸‰å€‹å±¬æ€§å„²å­˜å…¶è®Šæ•¸è€Œæˆã€‚</li>
<li>ProgeCADçš„ç·šç‰©ä»¶æ˜¯ä»¥é»ç¾¤ç‰©ä»¶(Points)å„²å­˜é»ç‰©ä»¶(Point)ï¼Œå–å…¶è®Šæ•¸è€Œæˆã€‚</li>
</ul>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> tranPoint(<span class="keyword">ByVal</span> CADpt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> tranPoint = CADpt: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> tranPoint = Library.CreatePoint(CADpt(<span class="number">0</span>), CADpt(<span class="number">1</span>), CADpt(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> tranIPoint(<span class="keyword">ByVal</span> ICADpt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> tranIPoint = ICADpt: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> tmp(<span class="number">2</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">tmp(<span class="number">0</span>) = ICADpt.X</span><br><span class="line">tmp(<span class="number">1</span>) = ICADpt.Y</span><br><span class="line">tmp(<span class="number">2</span>) = ICADpt.Z</span><br><span class="line"></span><br><span class="line">tranIPoint = tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> tranPoints(<span class="keyword">ByVal</span> vertices, <span class="keyword">Optional</span> cnt <span class="keyword">As</span> <span class="type">Byte</span> = <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> tranPoints = vertices: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> vertices(<span class="number">2</span>) = <span class="number">0</span> <span class="keyword">Then</span> cnt = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> myPline, myPoints, pt</span><br><span class="line">    </span><br><span class="line"><span class="keyword">Set</span> myPoints = Library.CreatePoints</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> cnt = <span class="number">2</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(vertices) <span class="keyword">Step</span> cnt</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Set</span> pt = Library.CreatePoint(vertices(i), vertices(i + <span class="number">1</span>))</span><br><span class="line">    </span><br><span class="line">        myPoints.Add</span><br><span class="line">        myPoints(myPoints.Count - <span class="number">1</span>).X = pt.X</span><br><span class="line">        myPoints(myPoints.Count - <span class="number">1</span>).Y = pt.Y</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(vertices) <span class="keyword">Step</span> cnt</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Set</span> pt = Library.CreatePoint(vertices(i), vertices(i + <span class="number">1</span>), vertices(i + <span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">        myPoints.Add</span><br><span class="line">        myPoints(myPoints.Count - <span class="number">1</span>).X = pt.X</span><br><span class="line">        myPoints(myPoints.Count - <span class="number">1</span>).Y = pt.Y</span><br><span class="line">        myPoints(myPoints.Count - <span class="number">1</span>).Z = pt.Z</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> tranPoints = myPoints</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> tranIPoints(<span class="keyword">ByVal</span> myPoints)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> tranIPoints = myPoints: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> vertices()</span><br><span class="line"><span class="keyword">ReDim</span> vertices(myPoints.Count * <span class="number">3</span> - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> it <span class="keyword">In</span> myPoints</span><br><span class="line"></span><br><span class="line">vertices(<span class="number">0</span> + j) = it.X</span><br><span class="line">vertices(<span class="number">0</span> + j + <span class="number">1</span>) = it.Y</span><br><span class="line">vertices(<span class="number">0</span> + j + <span class="number">2</span>) = it.Z</span><br><span class="line"></span><br><span class="line">j = j + <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">tranIPoints = vertices</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬ç‰©ä»¶">åŸºæœ¬ç‰©ä»¶</h3>
<p>ç•«é»ã€ç•«åœ“ã€ç•«ç·šã€å¯«æ–‡å­—</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> AddPoint(pt) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    <span class="keyword">Set</span> AddPoint = mo.AddPointEntity(tranPoint(pt))</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    <span class="keyword">Set</span> AddPoint = mo.AddPoint(tranPoint(pt))</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddCircle(cpt, r) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddCircle = mo.AddCircle(tranPoint(cpt), r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddLine(spt, ept) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddLine = mo.AddLine(tranPoint(spt), tranPoint(ept))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddLineCO(X1, Y1, X2, Y2) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> spt(<span class="number">2</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"><span class="keyword">Dim</span> ept(<span class="number">2</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">spt(<span class="number">0</span>) = X1: spt(<span class="number">1</span>) = Y1</span><br><span class="line">ept(<span class="number">0</span>) = X2: ept(<span class="number">1</span>) = Y2</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddLineCO = AddLine(spt, ept)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddPolyLine(vertices) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddPolyLine = mo.AddPolyLine(tranPoints(vertices))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> Add3dPoly(vertices) <span class="comment">&#x27;20210604 new</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> Add3dPoly = mo.Add3dPoly(tranPoints(vertices))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddLWPolyLine(vertices) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddLWPolyLine = mo.AddLightWeightPolyline(tranPoints(vertices, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddArc(<span class="keyword">ByVal</span> Center, Radius <span class="keyword">As</span> <span class="type">Double</span>, StartAngle <span class="keyword">As</span> <span class="type">Double</span>, EndAngle <span class="keyword">As</span> <span class="type">Double</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddArc = mo.AddArc(tranPoint(Center), Radius, StartAngle, EndAngle)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddText(<span class="keyword">ByVal</span> myText <span class="keyword">As</span> <span class="type">String</span>, <span class="keyword">ByVal</span> txtpt, <span class="keyword">ByVal</span> txtheight <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">Optional</span> alignmode <span class="keyword">As</span> <span class="type">Byte</span> = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> mtextObj <span class="keyword">As</span> <span class="type">Object</span> <span class="comment">&#x27;IntelliCAD.Text</span></span><br><span class="line">    <span class="keyword">Dim</span> insPt</span><br><span class="line">    </span><br><span class="line">    insPt = txtpt</span><br><span class="line">    <span class="keyword">Set</span> txtobj = mo.AddText(myText, tranPoint(insPt), txtheight)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Select</span> <span class="keyword">Case</span> alignmode</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">            txtobj.HorizontalAlignment = <span class="number">0</span>  <span class="comment">&#x27; acAlignmentMiddleLeft</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">2</span></span><br><span class="line">            txtobj.HorizontalAlignment = <span class="number">4</span>  <span class="comment">&#x27; acAlignmentMiddleCenter</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">3</span></span><br><span class="line">            txtobj.HorizontalAlignment = <span class="number">2</span> <span class="comment">&#x27; acAlignmentMiddleRight</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Select</span> <span class="keyword">Case</span> alignmode</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">Case</span> <span class="number">1</span></span><br><span class="line">            txtobj.Alignment = <span class="number">9</span> <span class="comment">&#x27; acAlignmentMiddleLeft</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">2</span></span><br><span class="line">            txtobj.Alignment = <span class="number">10</span> <span class="comment">&#x27; acAlignmentMiddleCenter</span></span><br><span class="line">        <span class="keyword">Case</span> <span class="number">3</span></span><br><span class="line">            txtobj.Alignment = <span class="number">11</span> <span class="comment">&#x27; acAlignmentMiddleRight</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    txtobj.TextAlignmentPoint = tranPoint(insPt)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> AddText = txtobj</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h3 id="é€šç”¨é¡åˆ¥util">é€šç”¨é¡åˆ¥(Util)</h3>
<p>é€šç”¨é¡åˆ¥ç”¨æ–¼èˆ‡æ‡‰ç”¨ç¨‹å¼é–“çš„äº’å‹•å±…å¤šï¼ŒåŒ…å«å–å¾—é»ã€å–å¾—æ–‡å­—ã€‚ä¹ŸåŒ…å«CADç‰©ä»¶æœ¬èº«æ‰€æä¾›çš„ç„¡æ³•åˆ†é¡å±¬æ€§ï¼Œä¹Ÿæœƒæ”¾å…¥é€šç”¨é¡åˆ¥ã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetPoint(<span class="keyword">ByVal</span> prompt <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> o = IntelliCAD.ActiveDocument.Utility.GetPoint(, prompt)</span><br><span class="line">    GetPoint = tranIPoint(o)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    GetPoint = acadDoc.Utility.GetPoint(, prompt)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> GetString(<span class="keyword">ByVal</span> prompt <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line">GetString = acadDoc.Utility.GetString(<span class="literal">False</span>, prompt &amp; vbNewLine)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> GetBoundingBox(<span class="keyword">ByVal</span> entobj, MinX, MinY, MaxX, MaxY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> <span class="keyword">Call</span> GetBoundingBox_ICAD(entobj, MinX, MinY, MaxX, MaxY): <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> entobj.GetBoundingBox(Min, Max)</span><br><span class="line"></span><br><span class="line">MinX = Min(<span class="number">0</span>): MinY = Min(<span class="number">1</span>)</span><br><span class="line">MaxX = Max(<span class="number">0</span>): MaxY = Max(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> GetBoundingBox_ICAD(<span class="keyword">ByVal</span> entobj, MinX, MinY, MaxX, MaxY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> Min <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Dim</span> Max <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> entobj.GetBoundingBox(Min, Max)</span><br><span class="line"></span><br><span class="line">MinX = Min.X: MinY = Min.Y</span><br><span class="line">MaxX = Max.X: MaxY = Max.Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<h2 id="é–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ">ğŸé–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ</h2>
<p>å¡«å……ç·šä¹Ÿæ˜¯å¸¸ç”¨æ–¼æ¨™ç¤ºåœ–å½¢çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œé€™è£¡çš„AddHatchæˆ‘ä¸€ç›´è©¦ä¸å‡ºä¾†ï¼Œç•¶åˆçŒœæ¸¬å¯èƒ½æ˜¯å¸¸æ•¸çš„å•é¡Œ<strong>vicHatchPatternTypePreDefined</strong>ï¼Œçµæœé‚„æ˜¯ä¸€æ¨£...</p>
<p>ä¸åŒæ‡‰ç”¨ç¨‹å¼ä¹‹é–“æœ‰æ™‚å€™<strong>å¸¸æ•¸è¨­å®šæœƒæœ‰æ‰€ä¸åŒ</strong>ï¼ŒåŒ…å«<strong>æ’åºçš„æ–¹å¼</strong>ä¹Ÿå¯èƒ½æœƒä¸åŒï¼Œåƒæ˜¯åœ¨åšselectionset(é¸æ“‡é›†)çš„æ™‚å€™ï¼ŒAutoCADå¯ä»¥å¾ˆæ¸…æ¥šçŸ¥é“é †åºï¼Œä½†æ˜¯ProgeCADä¼¼ä¹æ²’æœ‰ä¸€å®šçš„è¦å‰‡å¯è¨€ã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> Hatch(<span class="keyword">ByVal</span> obj <span class="keyword">As</span> <span class="type">Object</span>, <span class="keyword">ByVal</span> Ratio <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> ptrName <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;usually use &quot;SOLID&quot;,&quot;ANSI32&quot;,&quot;AR-CONC&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> hatchobj <span class="keyword">As</span> <span class="type">Object</span> <span class="comment">&#x27;AcadHatch</span></span><br><span class="line"><span class="keyword">Dim</span> outerloop(<span class="number">0</span> <span class="keyword">To</span> <span class="number">0</span>) <span class="keyword">As</span> <span class="type">Object</span> <span class="comment">&#x27;AcadEntity</span></span><br><span class="line"></span><br><span class="line">PatternName = ptrName</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> hatchobj = mo.AddHatch(<span class="number">0</span>, PatternName, <span class="literal">True</span>)</span><br><span class="line"><span class="comment">&#x27;Set hatchobj = mo.AddHatch(vicHatchPatternTypePreDefined, PatternName, True)</span></span><br><span class="line"></span><br><span class="line">hatchobj.PatternScale = <span class="number">1</span> / Ratio * <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> outerloop(<span class="number">0</span>) = obj</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">hatchobj.AppendOuterLoop (outerloop)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddMixText(<span class="keyword">ByVal</span> s <span class="keyword">As</span> <span class="type">String</span>, <span class="keyword">ByVal</span> txtpt, <span class="keyword">ByVal</span> txtheight <span class="keyword">As</span> <span class="type">Double</span>, _</span><br><span class="line">                    <span class="keyword">Optional</span> alignmode <span class="keyword">As</span> <span class="type">Byte</span> = <span class="number">1</span>, <span class="keyword">Optional</span> dashmode <span class="keyword">As</span> <span class="type">Integer</span> = <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> txtobj <span class="keyword">As</span> <span class="type">Object</span> <span class="comment">&#x27;AcadText</span></span><br><span class="line"><span class="keyword">Dim</span> circleobj <span class="keyword">As</span> <span class="type">Object</span> <span class="comment">&#x27;AcadCircle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddMixText = AddText(s, txtpt, txtheight, alignmode)</span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> mo</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> vertices(<span class="number">5</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> dashmode = <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> GetBoundingBox(AddMixText, MinX, MinY, MaxX, MaxY)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> dashmode</span><br><span class="line">    </span><br><span class="line">        vertices(<span class="number">0</span>) = MinX</span><br><span class="line">        vertices(<span class="number">1</span>) = MinY - txtheight / <span class="number">2</span> - txtheight / <span class="number">2</span> * <span class="number">0.5</span> * i</span><br><span class="line">        </span><br><span class="line">        vertices(<span class="number">3</span>) = MaxX</span><br><span class="line">        vertices(<span class="number">4</span>) = vertices(<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">Set</span> plineobj = AddPolyLine(vertices)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27;******æ•´é«”å¯¬åº¦å°šæœªè§£æ±º******</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> plineobj.ConstantWidth = txtheight / <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> CreateSSET(<span class="keyword">Optional</span> <span class="keyword">ByVal</span> sname <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;SS1&quot;</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> ftypetmp <span class="keyword">As</span> Variant = <span class="string">&quot;&quot;</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> fdatatmp <span class="keyword">As</span> Variant = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;****PorgeCADä¸­ä¼¼ä¹æ²’è¾¦æ³•åšåˆ°éæ¿¾çš„æ¢ä»¶?*****</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;0:object type</span></span><br><span class="line"><span class="comment">&#x27;2:object name</span></span><br><span class="line"><span class="comment">&#x27;8:layer name</span></span><br><span class="line"><span class="comment">&#x27;62:color number(0 to 256)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> FilterType() <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> FilterData() <span class="keyword">As</span> Variant</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span>: acadDoc.SelectionSets(sname).Delete: <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> sset = acadDoc.SelectionSets.Add(sname)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> ftypetmp = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    sset.SelectOnScreen</span><br><span class="line">    </span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"></span><br><span class="line">    ft = Split(ftypetmp, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    fd = Split(fdatatmp, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">ReDim</span> FilterType(<span class="number">0</span> <span class="keyword">To</span> UBound(ft))</span><br><span class="line">    <span class="keyword">ReDim</span> FilterData(<span class="number">0</span> <span class="keyword">To</span> UBound(fd))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(ft)</span><br><span class="line">    </span><br><span class="line">        FilterType(i) = ft(i)</span><br><span class="line">        FilterData(i) = fd(i)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    sset.SelectOnScreen FilterType, FilterData</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> CreateSSET = sset</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> SetXdataToObj(<span class="keyword">ByVal</span> obj <span class="keyword">As</span> <span class="type">Object</span>, <span class="keyword">ByVal</span> xdata <span class="keyword">As</span> <span class="type">String</span>) <span class="comment">&#x27;æä¾›ç¶å…¥å­—ä¸²ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Sub</span>  <span class="comment">&#x27;ä¸­å¿ƒç·šæ¨ç„¡æ³•æä¾›</span></span><br><span class="line"><span class="comment">&#x27;*****ç”¨Handleè™•ç†?!***</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> DataType(<span class="number">0</span> <span class="keyword">To</span> <span class="number">1</span>) <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> Data(<span class="number">0</span> <span class="keyword">To</span> <span class="number">1</span>) <span class="keyword">As</span> Variant</span><br><span class="line"></span><br><span class="line">DataType(<span class="number">0</span>) = <span class="number">1001</span>: Data(<span class="number">0</span>) = xdata</span><br><span class="line">DataType(<span class="number">1</span>) = <span class="number">1000</span>: Data(<span class="number">1</span>) = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">obj.SetXData DataType, Data</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="å»ºè­°é–‹ç™¼æ–¹å‘">ğŸ‘‰å»ºè­°é–‹ç™¼æ–¹å‘</h2>
<p><strong>é€šç”¨æ‰æ˜¯ç‹é“</strong>ï¼Œä¸ç®¡ä½¿ç”¨å“ªç¨®æ‡‰ç”¨ç¨‹å¼ï¼Œåªè¦å¯ä»¥å½¼æ­¤åŒ¯å…¥ã€åŒ¯å‡ºï¼Œæœ€å¾Œéƒ½åªæ˜¯å·®åœ¨ä»‹é¢ä½¿ç”¨çš„ç¿’æ…£ä»¥åŠå„æ‡‰ç”¨ç¨‹å¼ç¨ç«‹æä¾›çš„åŠŸèƒ½è€Œå·²ã€‚</p>
<p>å¦‚åŒå‰è¨€æ‰€è¿°ï¼ŒCADç‰ˆæœ¬æœ‰éå¸¸å¤šç¨®é¡å‹ï¼Œåœ¨é ç®—ä¸Šè‹¥æœ‰æ‰€è€ƒé‡ï¼Œå…¶å¯¦ä¹Ÿæœ‰FreeCADã€LibreCAD...ç­‰ç­‰é–‹æºé¸é …ã€‚ä½†è‹¥ä»Šå¤©æŠŠå¤§å¤šæ•¸çš„é–‹ç™¼æ™‚é–“éƒ½æŠ•åœ¨<strong>æŸä¸€å€‹CADç‰ˆæœ¬</strong>èº«ä¸Šï¼Œæœªä¾†å¦‚æœå…¬å¸è¦æ›´æ›ç‰ˆæœ¬æ™‚ï¼Œè½‰æ›æˆæœ¬æœƒéš¨è‘—ä½ çš„é–‹ç™¼æ™‚é–“è€Œå‘ˆæŒ‡æ•¸ä¸Šå‡ï¼Œç¨‹å¼ç¢¼è¶Šè¤‡é›œå•é¡Œè¶Šé›£æŸ¥å‡ºä¾†ã€‚</p>
<p>ç•¶ä»Šå¤©é–‹ç™¼äººå“¡å·²ç¶“æ±ºå®šè¦æŠ•è³‡åœ¨CADçš„äºŒæ¬¡é–‹ç™¼ä¸Šï¼Œæˆ‘æœ‰å¹¾é»å»ºè­°</p>
<ol type="1">
<li>ç¢ºèªæ–‡ä»¶æ˜¯å¦è±å¯Œ</li>
<li>ç¤¾ç¾¤å¹³å°æ˜¯å¦æœ‰è‰¯å¥½çš„æ”¯æ´</li>
<li>åŸºåº•æ‡‰ç”¨ç¨‹å¼æ˜¯å¦æœ‰ç´°å¾®bug</li>
<li>ç”¢å‡ºå…§å®¹ç›¡é‡ä»¥dxfç‚ºä¸»</li>
</ol>
<p>æŒæ¡å¥½ä¸Šé¢å¹¾é»ï¼Œå°±å·®ä¸å¤šå¯ä»¥é–‹å§‹æŒ‘é¸CADçš„é¡Œç›®ï¼Œæ…¢æ…¢å˜—è©¦ï¼Œé‡åˆ°å•é¡Œå°±çœ‹æ–‡ä»¶ã€ä¸è¡Œå°±å•åˆ¥äººï¼Œåªè¦æ²’æœ‰æœ¬èº«çš„bugï¼ŒåŸºæœ¬ä¸ŠCADçš„é–‹ç™¼æ‡‰è©²å¯ä»¥å®Œæˆ80%çš„å·¥ä½œæµç¨‹ï¼Œæ­é…dxfçš„ç”¢å‡ºå…§å®¹ï¼Œæœªä¾†è½‰æ›ä¹Ÿæ˜¯æ²’æœ‰å•é¡Œçš„ã€‚</p>
<h2 id="pythonè¼¸å‡ºdxfé¡Œå¤–è©±">ğŸ’¡Pythonè¼¸å‡ºDXF(é¡Œå¤–è©±)</h2>
<p>pythonçš„ezdxfå¥—ä»¶æ˜¯æˆ‘æœ€è¿‘åœ¨ä½¿ç”¨streamlité–‹ç™¼æ™‚åœ¨ä½¿ç”¨ï¼Œæ–‡ä»¶ä¹Ÿç®—æ˜¯ç›¸ç•¶è©³ç´°ï¼Œé€™æ˜¯ä¸€å€‹<strong>å–®ç´”ç”¨pythonæ‰€è£½ä½œçš„CSVè½‰DXFå°ˆæ¡ˆ</strong>ï¼Œå°æ–¼é»è³‡æ–™è½‰æˆé»ç‰©ä»¶æ‡‰è©²æœ‰å¹«åŠ©ï¼Œä¸‹è¼‰DXFä¹‹å¾Œåªè¦åŒ¯å…¥è‡ªå·±çš„CADç‰ˆæœ¬å°±å¯ä»¥é€²è¡Œå¾ŒçºŒä½¿ç”¨äº†!</p>
<p><a href="https://csv2dxf.streamlit.app/">ğŸ”—CSVè½‰DXF-Streamlit</a></p>
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>AutoCAD VBA</tag>
        <tag>Streamlit</tag>
        <tag>ProgeCAD VBA</tag>
      </tags>
  </entry>
  <entry>
    <title>VBAè‡ªå­¸å¿ƒå¾—</title>
    <url>/posts/3619695554/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>å› ç‚ºå·¥ä½œçš„ç·£æ•…ï¼Œæ—¥å¸¸æœƒæ¥è§¸å¤§é‡çš„Excelæ“ä½œï¼Œéç¨‹ä¸å¤–ä¹éƒ½æ˜¯ä¸€äº›<strong>é‡è¤‡åˆç„¡è¶£</strong>çš„å‹•ä½œï¼Œä¹Ÿè®“æˆ‘èµ·å¿ƒå‹•å¿µè¦é€éç¨‹å¼ç¢¼çš„æ–¹æ³•ä¾†è§£æ±ºé€™äº›å•é¡Œï¼Œæˆ‘æ“ä½œçš„è»Ÿé«”æ˜¯Excelï¼Œé‚£ç›´æ¥æ¡ç”¨ExcelVBAçš„èªè¨€æœƒæ˜¯æœ€ä½³çš„ä¸€å€‹è·¯å¾‘ã€‚</p>
<p>ç¨‹å¼èªè¨€çµ‚ç©¶é‚„æ˜¯ä¸€ç¨®èˆ‡é›»è…¦æºé€šçš„å·¥å…·ï¼Œé‡é»æ˜¯ä½ æœ‰ä»€éº¼ç”Ÿæ´»ä¸­çš„å•é¡Œè¦é€²è¡Œå¯¦ä½œï¼Œèƒ½å¤ è§£æ±ºå•é¡Œçš„èªè¨€å°±æ˜¯å¥½èªè¨€ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘åœ¨è‡ªå­¸è·¯ä¸Šçš„ä¸€äº›å¿ƒå¾—ï¼Œèˆ‡å„ä½åšå€‹åˆ†äº«ã€‚</p>
<span id="more"></span>
<hr />
<h2 id="è‡ªå­¸å¿ƒæ…‹">ğŸ’­è‡ªå­¸å¿ƒæ…‹</h2>
<blockquote>
<p>è‡ªå­¸å¿…é ˆè¦æœ‰ç›®æ¨™ï¼Œé”æˆç›®æ¨™ä¹‹å¾Œæ‰æœƒæœ‰æˆå°±æ„Ÿã€‚</p>
</blockquote>
<p>æƒ³ç•¶åˆåœ¨å­¸éšæ®µï¼Œå­¸ç¿’æ–°çš„äº‹ç‰©å…¶å¯¦ä¸¦ä¸äº†è§£æ˜¯ç‚ºäº†ä»€éº¼ï¼Œåƒ…èªçŸ¥åˆ°æ˜¯ç‚ºäº†è€ƒè©¦è€Œè®€æ›¸ï¼Œä¹Ÿå› æ­¤å­¸å®Œçš„æ±è¥¿æ²’æœ‰è¢«<strong>æ‡‰ç”¨</strong>ï¼Œä¹…è€Œä¹…ä¹‹å°±é‚„çµ¦è€å¸«äº†ã€‚</p>
<p>å‡ºç¤¾æœƒçš„æ™‚å€™ï¼Œç”Ÿæ´»ä¸Šæœ‰å„å¼å„æ¨£çš„å•é¡Œç­‰å¾…è¢«è§£æ±ºï¼Œè€Œæ­¤æ™‚çš„ç›®æ¨™ä¾¿æ˜¯<strong>æ‰¾å‡ºè§£æ±ºå•é¡Œçš„ç­”æ¡ˆ</strong>ï¼Œç„¡è«–æ˜¯å¯¦é«”æ›¸ã€ç·šä¸Šèª²ç¨‹æˆ–ç¶²è·¯ä¸Šçš„è³‡æºï¼Œå­¸ç¿’è³‡æºä¸€ç›´éƒ½æœ‰ï¼Œæ­¤å¤–é‚„éœ€è¦å…·å‚™<strong>è¶³å¤ æ¢ç´¢çš„æ™‚é–“</strong>ï¼Œå¦å‰‡åœ¨äº¤å·æœŸç¨‹çš„å£“åŠ›ä¸‹ï¼Œä½ è‚¯å®šæœƒåœŸæ³•ç…‰é‹¼è¶•ç·Šäº¤å·®äº†äº‹ã€‚</p>
<ul>
<li>æ‰¾å‡ºç”Ÿæ´»ä¸­çš„æ‡‰ç”¨ç›®æ¨™</li>
<li>è¨­å®šè¶³å¤ æ‰¾ç­”æ¡ˆçš„æ™‚é–“</li>
</ul>
<h3 id="æ‰¾å°‹æ‡‰ç”¨ç›®æ¨™">æ‰¾å°‹æ‡‰ç”¨ç›®æ¨™</h3>
<p>å¯ä»¥å…ˆæœè‘—<strong>å¾ˆå¸¸ç¢°åˆ°</strong>ã€<strong>æ¯æ¬¡éƒ½èŠ±å¾ˆå¤šæ™‚é–“</strong>çš„æ–¹å‘å»æ‰¾é¡Œç›®ï¼ŒVBAçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯ç°¡åŒ–æµç¨‹ã€è™•ç†å¤§é‡çš„é‡è¤‡æ€§å•é¡Œï¼ŒåŒ…å«è³‡æ–™çš„å»ºæª”ã€åŒ¯å…¥ã€è¼¸å‡ºå ±è¡¨...ç­‰ï¼Œä¸€å€‹å°ˆæ¡ˆåªè¦å¯ä»¥éµå¾ª20/80æ³•å‰‡ï¼Œå…ˆè™•ç†80%çš„éº»ç…©äº‹ï¼Œå°æ–¼æ•´å€‹å°ˆæ¡ˆçš„åŸ·è¡Œå°±æœƒè¼•é¬†å¾ˆå¤šäº†!</p>
<hr />
<h2 id="åŸºæœ¬æŠ€å·§">ğŸ¯åŸºæœ¬æŠ€å·§</h2>
<p>ç¨‹å¼ç¢¼åªæ˜¯ä¸€ç¨®æºé€šèªè¨€ï¼Œä¸éœ€è¦æŠŠæ•´æœ¬å­—å…¸æ‹¿å‡ºä¾†ä¸€å­—ä¸€å¥å»èƒŒï¼Œåªéœ€è¦æŒ‘é¸å°ä½ æœ‰å¹«åŠ©çš„èªæ³•ä¾†çµ„æˆ<strong>å‰›å¥½</strong>å¯ä»¥è§£æ±ºä½ çš„å•é¡Œçš„å…§å®¹å°±å¥½ï¼Œå°æ–¼VBAä¾†èªªå¤§éƒ¨åˆ†çš„å…§å®¹ç¶²è·¯ä¸Šéƒ½æœƒæœ‰èªªæ˜ï¼Œä»¥ä¸‹æœƒå»ºè­°å­¸ç¿’é †åºèˆ‡åƒè€ƒè³‡æ–™</p>
<h3 id="è³‡æ–™åº«æ¦‚å¿µ">è³‡æ–™åº«æ¦‚å¿µ</h3>
<p>åœ¨æ­£çµ±è³‡æ–™åº«çš„è¨­è¨ˆä¸Šæœ‰æ‰€è¬‚<strong>æ­£è¦åŒ–</strong>çš„æ¦‚å¿µï¼Œç›®çš„æ˜¯å°‡è³‡æ–™åº«çš„å…§å®¹ä»¥æœ€å°å–®å…ƒçš„æ–¹å¼é€²è¡Œï¼Œé€šå¸¸æ˜¯è¨˜éŒ„æ–‡å­—å…§å®¹è€Œå·²ï¼Œå¦‚æœ‰åœ–ç‰‡æˆ–æª”æ¡ˆå‰‡ä»¥å¤–éƒ¨é€£çµé€²è¡Œæ›¿ä»£ã€‚</p>
<h4 id="excelçš„å–®å…ƒåˆ†é¡">Excelçš„å–®å…ƒåˆ†é¡</h4>
<ol type="1">
<li>å„²å­˜æ ¼(cell)</li>
<li>æ¬„(column)ã€åˆ—(row)</li>
<li>å·¥ä½œè¡¨(sheet)</li>
<li>æ´»é ç°¿(workbook)</li>
</ol>
<p>å„²å­˜æ ¼ä»¥æ¯æ ¼å­˜æ”¾ä¸€å€‹è³‡æ–™ç‚ºåŸå‰‡ï¼Œ<strong>é¿å…è·¨æ ¼åˆä½µ</strong>çš„æ–¹å¼é€²è¡Œè³‡æ–™å­˜æ”¾ã€‚</p>
<h3 id="é–‹ç™¼äººå“¡ç’°å¢ƒ">é–‹ç™¼äººå“¡ç’°å¢ƒ</h3>
<p>Excelé è¨­æœƒæŠŠé–‹ç™¼ç’°å¢ƒé—œèµ·ä¾†ï¼Œå…ˆæŠŠé–‹ç™¼ç’°å¢ƒé–‹èµ·ä¾†æ‰æœ‰åœ°æ–¹å¯«ç¨‹å¼ç¢¼ã€‚</p>
<p><a
href="https://blog.gtwang.org/windows/excel-vba-programming-hello-world/">VBAç’°å¢ƒè¨­å®š-GT
Wang</a></p>
<h3 id="é–‹ç™¼å–®å…ƒ">é–‹ç™¼å–®å…ƒ</h3>
<p>Subçš„æ¦‚å¿µå…¶å¯¦å°±æ˜¯è…³æœ¬åŸ·è¡Œçš„å–®å…ƒï¼Œå¯ä»¥é€éæŒ‰éˆ•æŒ‡å®šå·¨é›†åŸ·è¡Œï¼Œä¹Ÿå¯ä»¥é€éå…¶ä»–Subä¾†å‘¼å«(call)åŸ·è¡Œï¼Œæ­¤å¤–Functionä¹Ÿæ˜¯é¡ä¼¼çš„æ¦‚å¿µï¼Œä¸éå®ƒé‚„å¯ä»¥é¡å¤–å›å‚³çµæœã€‚</p>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-function-and-sub/">Sub
vs Function-GT Wang</a></p>
<h3 id="è³‡æ–™å‹æ…‹">è³‡æ–™å‹æ…‹</h3>
<p>é›–ç„¶VBAæœ¬èº«ä¸å¤ªè¦æ±‚æ­£ç¢ºçš„è³‡æ–™å‹æ…‹ï¼Œç®—æ˜¯æ¯”è¼ƒä¸åš´è¬¹çš„èªè¨€ï¼Œä½†äº†è§£ä¸€ä¸‹doubleã€stringã€integerã€dateã€objectä¹‹é–“çš„å·®ç•°æœƒæ¯”è¼ƒå¥½åœ¨ç¨‹å¼ç¢¼æœ€ä¸Šå±¤å¯«ä¸‹<strong>Option
Explicit</strong>ï¼Œæœƒä½¿æ’°å¯«éç¨‹å¿…é ˆè¦å®£å‘Šåƒæ•¸çš„è³‡æ–™å‹æ…‹ï¼Œæœ‰åŠ©æ–¼é”æˆè‰¯å¥½çš„ç¨‹å¼å¯«ä½œç¿’æ…£(æœªä¾†è½‰æ›åˆ°åˆ¥çš„èªè¨€æ¯”è¼ƒä¸æœƒé‚£éº¼ç—›è‹¦)ã€‚</p>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-programming-variable/">VBAè³‡æ–™å‹æ…‹-GT
Wang</a></p>
<h3 id="é‚è¼¯æ“ä½œ">é‚è¼¯æ“ä½œ</h3>
<p>è…³æœ¬åŸ·è¡Œéç¨‹é€šå¸¸æœƒæœ‰æ¢ä»¶åˆ¤æ–·è·Ÿè¿´åœˆå¾ªç’°ï¼Œæ ¹æ“šå¯¦éš›éœ€æ±‚æ¼”ç®—ï¼Œçœ‹ç¯„ä¾‹æ‰æœƒæ¸…æ¥šï¼Œä¸å¤–ä¹å°±æ˜¯
if elseã€for i=1 to nã€do loop ...
ç­‰ã€‚æ­¤å¤–é—œæ–¼å¦‚ä½•åŠ æ¸›ä¹˜é™¤ã€ç­‰æ–¼ä¸ç­‰æ–¼ä¹‹é¡çš„é‹ç®—å­ä¹Ÿæ˜¯æœƒè¢«åƒé›œåœ¨å…¶ä¸­ï¼Œé€™ä¹Ÿæ˜¯å¿…é ˆè¦çŸ¥é“çš„ã€‚</p>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-programming-operators/">VBAé‹ç®—å­-GT
Wang</a></p>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-programming-if-then-else-condition/">VBAæ¢ä»¶åˆ¤æ–·-GT
Wang</a></p>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-programming-loop/">VBAè¿´åœˆæ§åˆ¶-GT
Wang</a></p>
<h3 id="é™¤éŒ¯æŠ€å·§">é™¤éŒ¯æŠ€å·§</h3>
<p>ç¨‹å¼æ’°å¯«éç¨‹å¿…é ˆè¦çŸ¥é“æ‰€è¨­å®šçš„åƒæ•¸æ˜¯ä¸æ˜¯æœ‰å¦‚æƒ³åƒä¸­çš„åŸ·è¡Œï¼Œå› æ­¤å­¸æœƒåˆ©ç”¨debug.printåŠæŸ¥çœ‹å€åŸŸè®Šæ•¸è¦–çª—æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ï¼Œçˆ¾å¾Œå†å°å…¥å–®å…ƒæ¸¬è©¦çš„æ¦‚å¿µå³å¯ã€‚</p>
<p><a href="https://ithelp.ithome.com.tw/articles/10157214">Excel
VBAçš„çœ‰çœ‰è§’è§’-é™¤éŒ¯æŠ€å·§</a></p>
<h3 id="ä»‹é¢æ“ä½œ">ä»‹é¢æ“ä½œ</h3>
<p>å°æ–¼ä½¿ç”¨è€…è€Œè¨€ï¼Œé€éæŒ‰æŒ‰éˆ•ä¾†åŸ·è¡Œç¨‹å¼ç¢¼éå¸¸ç›´è§€ï¼Œç¶“éå¤šå¹´çš„ä½¿ç”¨ç¿’æ…£å¤§éƒ¨åˆ†çš„æ“ä½œä»‹é¢éƒ½æ˜¯å¦‚æ­¤ï¼Œè‹¥æ˜¯åœ¨æ¯”è¼ƒå¤è€çš„ç¨‹å¼ä¹Ÿè¨±æœƒä½¿ç”¨èœå–®é€²è¡Œã€‚</p>
<p>æŒ‰éˆ•å¯ä»¥å‡ºç¾åœ¨å·¥ä½œè¡¨ä¹Ÿå¯ä»¥åœ¨è¡¨å–®(Userform)ï¼Œå·¥ä½œè¡¨æœ¬èº«ä¹Ÿå¯ä»¥ç®—æ˜¯ä¸€å€‹ä»‹é¢ï¼Œå¾ˆå¤šäººä¹Ÿæœƒä½¿ç”¨é€™æ¨£çš„è¨­è¨ˆæ–¹æ³•ï¼Œåœ¨å·¥ä½œè¡¨ä¸Šé¢æŒ‰æŒ‰éˆ•å»åŸ·è¡Œç›¸å°æ‡‰æµç¨‹ï¼Œç„¶è€Œè¡¨å–®çš„ä½¿ç”¨æ¯”è¼ƒå¯ä»¥è®“ä½¿ç”¨è€…ç…§è‘—è‡ªå·±çš„æµç¨‹é€²è¡Œï¼Œä¸æœƒè·³ä¾†è·³å»</p>
<blockquote>
<p>è¡¨å–®å±¬æ–¼æ¯”è¼ƒé€²éšçš„éƒ¨åˆ†ï¼Œå…ˆè®“ç¨‹å¼å¯ä»¥æŒ‰æŒ‰éˆ•åŸ·è¡Œå°±å¥½</p>
</blockquote>
<p><a
href="https://blog.gtwang.org/programming/excel-vba-programming-create-button-and-macro/">VBAæŒ‰éˆ•åŸ·è¡Œ-GT
Wang</a></p>
<h3 id="ç™¼å¸ƒæ–¹å¼">ç™¼å¸ƒæ–¹å¼</h3>
<p>ç¨‹å¼å¯«å®Œä¹‹å¾Œï¼Œåœ¨æœ¬æ©Ÿå¯ä»¥ç›´æ¥é–‹å§‹ä½¿ç”¨é€šå¸¸æ²’æœ‰å•é¡Œï¼Œæ€•å°±æ˜¯æœƒé‡åˆ°<strong>å·¨é›†å°é–</strong>é€™é¡çš„å®‰å…¨æ€§ä¿è­·æ©Ÿåˆ¶ï¼Œå°æ–¼ä¸€èˆ¬ä½¿ç”¨è€…ä¾†èªªï¼Œçœ‹åˆ°é€™å€‹å°±æœƒå¿ƒç”Ÿç–‘æ…®ï¼Œå¦‚æœé–‹ç™¼è€…æ˜¯ä½ å¯ä¿¡ä»»çš„å°±å¯ä»¥è§£é™¤å°é–æˆ–è€…åŠ å…¥ç™½åå–®å°±å¥½ã€‚</p>
<p><a
href="https://vocus.cc/article/64429bebfd89780001e26a23">è§£é™¤å°é–å·¨é›†</a></p>
<p><a
href="https://answers.microsoft.com/zh-hant/msoffice/forum/all/%E9%A1%AF%E7%A4%BA%E5%B7%A8%E9%9B%86%E8%A2%AB/789b5b25-df73-48f8-b8ba-fb5c81faf9c9">åŠ å…¥ç™½åå–®</a></p>
<h2 id="æ‹†è§£å–®å…ƒ">âš™ï¸æ‹†è§£å–®å…ƒ</h2>
<p>è§£æ±ºå•é¡Œçš„æ–¹æ³•è‹¥èƒ½å¤ é€²è¡Œè‰¯å¥½çš„æ‹†è§£å°æ–¼ç¨‹å¼ç¢¼çš„æ’°å¯«éç¨‹æœƒæœ‰æ¥µå¤§çš„å¹«åŠ©ï¼Œä¹Ÿæœ‰åŠ©æ–¼é‡æ¸…æ€ç·’ä¸¦åœ¨æ¬¡å–®å…ƒçš„å®Œæˆéç¨‹ä¸­ç²å¾—æ»¿æ»¿çš„æˆå°±æ„Ÿï¼Œæ¯å€‹æ¡ˆå­éƒ½æœƒæœ‰è‡ªå·±çš„å¿ƒæ™ºåœ–ï¼Œæ¯ä¸€å€‹åˆ†æ”¯éƒ½æœ‰è‡ªå·±è¦å®Œæˆçš„äº‹ï¼Œå…‰ä¸€å€‹ç”¢ç”Ÿå ±è¡¨çš„è¡Œç‚ºï¼Œå°±èƒ½æ‹†è§£æˆ</p>
<ol type="1">
<li>å»å“ªè£¡æ‰¾è³‡æ–™</li>
<li>æ”¶åˆ°è³‡æ–™è¦å¦‚ä½•ç¯©é¸</li>
<li>ç¯©é¸è³‡æ–™è¦å¦‚ä½•æ’åº</li>
<li>æ’åºå®Œè¦æ”¾å…¥å ±è¡¨</li>
<li>å ±è¡¨ç”¢å‡ºæ˜¯ä»€éº¼æ ¼å¼</li>
</ol>
<blockquote>
<p>ç¨‹å¼ç¢¼å°±æ˜¯ä¸€é€£ä¸²çš„å°æµç¨‹ï¼Œä¸æ–·çš„å †ç–Šè€Œæˆçš„å°ˆæ¡ˆ</p>
</blockquote>
<p>ä¸è¦å¤ªè²ªå¿ƒä¸€æ¬¡æƒ³è¦å®Œæˆå…¨éƒ¨çš„åŠŸèƒ½ï¼Œé€ésubæˆ–è€…functionæŠŠæ¯å€‹éšæ®µè¦åšçš„äº‹æƒ…åšè‰¯å¥½çš„æ‹†è§£ä¸¦å®Œæˆï¼Œæ¯”è¼ƒä¸æœƒä¸­é€”æ”¾æ£„ï¼Œä¹‹å¾Œåœ¨åµéŒ¯éç¨‹æ¯”è¼ƒå¥½äº†è§£å“ªé‚Šæœ‰éŒ¯èª¤ã€‚</p>
<hr />
<h2 id="å°‹æ‰¾ç­”æ¡ˆ">ğŸ”å°‹æ‰¾ç­”æ¡ˆ</h2>
<blockquote>
<p>å°‹æ‰¾ç­”æ¡ˆæ™‚ï¼Œå¿…é ˆè¦äº†è§£å¦‚ä½•æ¸…æ¥šæè¿°å•é¡Œï¼Œæ²’æœ‰äººæœ‰è¾¦æ³•å›ç­”ä¸æ˜ç¢ºçš„å…§å®¹ã€‚</p>
</blockquote>
<h3 id="è²·æ›¸çš„å¿…è¦">è²·æ›¸çš„å¿…è¦?</h3>
<p>ç•¶åˆæˆ‘ç‚ºäº†å­¸ç¿’é€™é …èªè¨€è²·äº†ä¸ä¸‹10æœ¬å·¥å…·æ›¸ï¼Œç™¼ç¾å…¶å¯¦éƒ½å¤§åŒå°ç•°ï¼Œåˆå­¸è€…å¯ä»¥å»åœ–æ›¸é¤¨æ‰¾ä¸€æœ¬é †çœ¼çš„ä¾†çœ‹åŸºæœ¬èªæ³•ï¼Œæœ‰ç¯„ä¾‹çš„é‚£ç¨®æœ€å¥½ã€‚é€™ä¸€æ­¥æ˜¯ç‚ºäº†è¦è®“ä½ ç¢ºå®šä½ å–œä¸å–œæ­¡VBAï¼Œä¸å»ºè­°ä¸€é–‹å§‹å°±èŠ±éŒ¢ã€‚</p>
<p>è‹¥æ˜¯è¦ºå¾—è‡ªå·±çœŸçš„çœ‹å¾—æ‡‚çš„æ™‚å€™ï¼Œæˆ‘å»ºè­°è²·ä¸€æœ¬æ¯”è¼ƒæ–°çš„ä¾†ç•¶ä½œå·¥å…·æ›¸(ç•¢ç«Ÿæ›¸æ¯”è¼ƒä¾¿å®œ?)ï¼Œå·¥å…·æ›¸çš„æ„ç¾©å°±æ˜¯<strong>éœ€è¦</strong>çš„æ™‚å€™å†ä¾†æŸ¥ï¼ŒæŸ¥å€‹å¹¾æ¬¡åŸºæœ¬ä¸Šç†Ÿæ‚‰äº†ï¼Œæ­¤æ™‚ä¹Ÿæœƒæœ‰ä¸€äº›å¯¦ä½œç¨‹å¼ç¢¼ç¯„ä¾‹ç•™å­˜åœ¨é›»è…¦ä¸­ï¼Œç­‰ä¹‹å¾Œé‡åˆ°åŒæ¨£çš„å•é¡Œå°±æœƒçŸ¥é“å“ªé‚Šæœ‰å¯«éï¼Œç›´æ¥è¤‡è£½è²¼ä¸Š(?)ã€‚</p>
<h3 id="aiæ™‚ä»£ä¾†è‡¨">AIæ™‚ä»£ä¾†è‡¨</h3>
<p>AIæ™‚ä»£çš„é€²æ­¥è®“ä¸Šè¿°çš„æµç¨‹åˆèƒ½æ›´åŠ ç²¾ç°¡ï¼Œç•¶ç„¶ä¸Šç¶²googleæ‰¾ç­”æ¡ˆé‚„æ˜¯éœ€è¦çš„ï¼Œæœ‰æ™‚å•AIå•é¡Œè‹¥ä¸å¤ ç²¾ç¢ºæ™‚æœƒç”¢ç”Ÿå¹»è¦ºï¼Œè¤‡è£½è²¼ä¸Šçš„ç¨‹å¼ç¢¼å‹•ä¸èµ·ä¾†å°±æ˜¯å‹•ä¸èµ·ä¾†ï¼Œç•¢ç«Ÿ...ç¨‹å¼ç¢¼æœƒå¡ä½é‚£å°±æ˜¯ç„¡æ•ˆå…§å®¹ï¼Œç‚ºäº†è®“ä»–100%å¯ä»¥é‹ä½œæœ‰æ™‚å€™é‚„æ˜¯éœ€è¦äººå·¥ä»‹å…¥ã€‚</p>
<h3 id="å•å•é¡Œçš„æ–¹æ³•">å•å•é¡Œçš„æ–¹æ³•</h3>
<p>ç•¶ä½ ç‚ºäº†é€™é …å•é¡ŒåŠªåŠ›è©¦è‘—å»æ‰¾ç­”æ¡ˆæ™‚ç™¼ç¾çœŸçš„ç„¡æ³•è§£æ±ºï¼Œåªè¦é¡˜æ„æŠŠä½ çš„<strong>ç¯„ä¾‹</strong>ã€<strong>æ“ä½œæ­¥é©Ÿ</strong>ã€<strong>çˆ¬æ–‡å…§å®¹</strong>çµ¦æè¿°æ¸…æ¥šï¼Œç›¸ä¿¡é‚„æ˜¯æœ‰é¡˜æ„å¹«åŠ©ä½ çš„äºº(ç•¢ç«Ÿåœ¨ç¤¾æœƒä¸Šæ²’æœ‰äººæœ‰ç¾©å‹™å›ç­”ä½ çš„å•é¡Œï¼Œä¸€åˆ‡éƒ½æ˜¯è‰¯å¿ƒé©…ä½¿)ã€‚</p>
<h4 id="ç¯„ä¾‹">ç¯„ä¾‹</h4>
<p>å¯ä»¥æ˜¯æª”æ¡ˆã€æˆªåœ–ã€è¢å¹•éŒ„å½±</p>
<h4 id="æ“ä½œæ­¥é©Ÿ">æ“ä½œæ­¥é©Ÿ</h4>
<p>æè¿°å®Œæ•´çš„æ“ä½œéç¨‹ï¼Œæ¯ä¸€æ¬¡éç¨‹é æœŸæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Œä½†ç¾åœ¨ç™¼ç”Ÿä»€éº¼å•é¡Œ</p>
<h4 id="çˆ¬æ–‡å…§å®¹">çˆ¬æ–‡å…§å®¹</h4>
<p>æŠŠç›®å‰é‡åˆ°çš„å•é¡Œå•AIæˆ–Googleæœå°‹ï¼Œå˜—è©¦éå“ªäº›æ–¹æ³•?</p>
<h2 id="å¥½ç«™é€£çµ">å¥½ç«™é€£çµ</h2>
<p><a
href="https://www.youtube.com/watch?v=wg3R5LdQ56k&amp;list=PL7enJ2-v6SPm-EHMuRMCG7R7C-vXQugNM">ğŸ”—PAPAYAé›»è…¦æ•™å®¤-EXCELåŸºæœ¬æ•™å­¸</a></p>
<p><a
href="https://ithelp.ithome.com.tw/articles/10156346">ğŸ”—ITé‚¦å¹«å¿™-ExcelVBAçš„çœ‰çœ‰è§’è§’</a></p>
<p><a
href="https://blog.gtwang.org/programming/vba/">ğŸ”—VBAç¨‹å¼è¨­è¨ˆ-GT.Wang</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
      </tags>
  </entry>
  <entry>
    <title>Streamlitæ‰“é€ å·¥ç¨‹ä¼°ç®—ç³»çµ±</title>
    <url>/posts/2910899188/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<blockquote>
<p>å·¥ç¨‹ä¼°ç®—ç‚ºæå ±è¨ˆç•«å‰çš„å¿…è¦å…§å®¹ï¼Œæ‰€æå ±çš„æ¦‚ä¼°ç¶“è²»é—œä¹æ–¼è¨ˆç•«æ ¸å®šå¾Œæ˜¯å¦æœƒé€ æˆå¯¦éš›æ‰€éœ€ç¶“è²»æ˜¯å¦è¶³å¤ ã€åŸ·è¡Œç‡æœƒä¸æœƒæœ‰å•é¡Œã€‚</p>
</blockquote>
<p>å·¥ç¨‹ä¼°ç®—æ–¹æ³•æœ‰å…©ç¨®:ææ–™åŠé¡åˆ¥</p>
<ul>
<li>ææ–™æ˜¯å°‡å–®å…ƒæ‹†åˆ†ç‚ºé‹¼ç­‹ã€æ¨¡æ¿ã€æ··å‡åœŸ...ç­‰ç­‰å¯ä»¥å¾æ¨™æº–æ–·é¢è¨ˆç®—è€Œå¾—çš„å…§å®¹ã€‚</li>
<li>é¡åˆ¥æ˜¯å°‡å·¥ç¨‹æ‹†åˆ†ç‚ºæ¸ é“å·¥ç¨‹ã€é“è·¯å·¥ç¨‹ã€æ©‹æ¢å·¥ç¨‹...ç­‰å¯ä»¥æ˜ç¢ºåˆ†é¡çš„å…§å®¹ã€‚</li>
</ul>
<p>æœ¬ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¤ è—‰ç”±<strong>é›²ç«¯ä»‹é¢</strong>çš„æ“ä½œä¾†é”æˆä»¥ä¸‹å¹¾é»éœ€æ±‚</p>
<ol type="1">
<li>å·¥ç¨‹ä¼°ç®—æ–¹æ³•å°‡ä»¥å¾€çš„<strong>ææ–™</strong>å°å‘ç‚º<strong>é¡åˆ¥</strong>ã€‚</li>
<li>å„é¡åˆ¥å–®å…ƒå…§å®¹è¨ˆç®—ç”±ç¨‹å¼æ¥æ‰‹ï¼Œæ¸›å°‘äººåŠ›èª¿é…åƒæ•¸ã€‚</li>
<li>è¼¸å‡ºå ±è¡¨æ¡ç”¨æœ€æ–°ç‰ˆæœ¬è™Ÿï¼Œé¿å…å„åœ°ç‰ˆæœ¬ä¸ä¸€é€ æˆå›°æ“¾ã€‚</li>
<li>æ‰‹æ©Ÿä¹Ÿèƒ½åœ¨å·¥å€ç¾å ´ç²å¾—ç¶“è²»ä¼°ç®—æˆæœã€‚</li>
</ol>
<span id="more"></span>
<h2 id="å·¥ç¨‹ä¼°ç®—æ–¹æ³•">å·¥ç¨‹ä¼°ç®—æ–¹æ³•</h2>
<p>å·¥ç¨‹ä¼°ç®—æ–¹æ³•ä¸åŒæ˜¯ç›®å‰åœ¨è™•ç†è¨ˆç•«æå ±æ™‚å¸¸å¸¸é€ æˆæå ±ç¶“è²»èˆ‡å¯¦éš›ç¶“è²»æœ‰è½å·®çš„ä¸»å› ï¼Œç¶“æŸ¥ç™¼ç¾åŸä¾†æ˜¯å¤§å¤šæ•¸äººéƒ½ç”¨<strong>ææ–™</strong>ä½œç‚ºå“é …è€Œéç”¨<strong>å·¥ç¨‹é¡åˆ¥</strong>ä½œç‚ºå“é …ï¼Œå°è‡´åœ¨ä¼°ç®—éç¨‹å®¹æ˜“å¿½ç•¥é“è·¯é‹ªé¢ã€æ“‹åœŸè¨­æ–½é€™é¡å…§å®¹ã€‚</p>
<h3 id="ä¼°å¤ªå°‘">ä¼°å¤ªå°‘</h3>
<p>è¨­è¨ˆéç¨‹æœƒéœ€è¦æ±æ‰£è¥¿æ‰£ï¼Œç‚ºäº†ä¸»é«”å·¥ç¨‹èƒ½å¤ æ”¶å°¾å¿…é ˆè¦æ¨æ£„æ‰æŸäº›ä¹Ÿæ˜¯å¾ˆé‡è¦çš„é …ç›®ã€‚</p>
<h3 id="ä¼°å¤ªå¤š">ä¼°å¤ªå¤š</h3>
<p>æœƒè¢«æª¢è¨ç‚ºä»€éº¼ç•¶åˆé»‘ç™½ä¼°é€ æˆåŸ·è¡Œç‡ä¸é«˜ï¼Œå¾ˆå¤šäººéƒ½æ˜¯å› ç‚ºè¢«åˆé›£éç¶“è²»ä¸èƒ½è¶…éä¸Šé™ï¼Œæ‰€ä»¥å°±çµ¦ä»–ç”¨åŠ›ä¼°ä¸‹å»ï¼Œé€ æˆé€™æ¨£çš„çµæœã€‚</p>
<h2 id="é¡åˆ¥è¨ˆç®—å…§å®¹">é¡åˆ¥è¨ˆç®—å…§å®¹</h2>
<h3 id="æ¸ é“å·¥ç¨‹ç‰ˆæ©‹å·¥ç¨‹">æ¸ é“å·¥ç¨‹ã€ç‰ˆæ©‹å·¥ç¨‹</h3>
<ul>
<li>çµ¦å®šæ¸ é“é•·å¯¬åŠé•·åº¦ï¼Œå›æ¨ç‰†åšåŠæ‰€éœ€é‹¼ç­‹</li>
<li>çµ¦å®šç‰ˆæ©‹é•·å¯¬åŠåº§æ•¸ï¼Œå›æ¨ç‰ˆåšåŠæ‰€éœ€é‹¼ç­‹</li>
</ul>
<h3 id="æ“‹åœŸç‰†">æ“‹åœŸç‰†</h3>
<ul>
<li>æ‡¸è‡‚å¼æ“‹åœŸç‰†</li>
<li>é‡åŠ›å¼æ“‹åœŸç‰†</li>
</ul>
<h3 id="é“è·¯å·¥ç¨‹ç‰ˆæ¨å·¥ç¨‹">é“è·¯å·¥ç¨‹ã€ç‰ˆæ¨å·¥ç¨‹</h3>
<p>åˆ†ç‚ºACã€å†ç”ŸACã€ç¢çŸ³ç´šé…ã€CLSMçš„å„ç¨®æ’åˆ—çµ„åˆï¼Œé€éæ–°å¢çš„æ–¹å¼ä¾†é€è¡Œå¢åŠ ï¼Œä¹Ÿå¯ä»¥é€²è¡Œåˆªé™¤ã€‚</p>
<h3 id="é›œé …åŠå…¶ä»–">é›œé …åŠå…¶ä»–</h3>
<p>å°‡å‰è¿°å…§å®¹åŠ ç¸½å¾Œä¹˜ä¸Š<strong>é›œé …è²»ç”¨ä¿‚æ•¸(é è¨­ç‚º0.1)</strong></p>
<h3 id="é–“æ¥è²»ç”¨">é–“æ¥è²»ç”¨</h3>
<p>ç‚ºå‰å¹¾é …çš„åŠ ç¸½å¾Œä¹˜ä¸Š<strong>é–“æ¥è²»ç”¨ä¿‚æ•¸(é è¨­ç‚º0.3)</strong>ï¼Œé€™éƒ¨åˆ†åŒ…å«è·å®‰ã€ç’°ä¿ã€å» å•†åˆ©æ½¤ã€å·¥ç¨‹ç®¡ç†è²»ç­‰</p>
<h2 id="è¼¸å‡ºå ±è¡¨">è¼¸å‡ºå ±è¡¨</h2>
<p>å·¥ä½œæ™‚å¦‚æœ‰éœ€è¦è¼¸å‡ºå ±è¡¨çš„æ™‚å€™ï¼Œä¸å¤–ä¹æœƒæ¡ç”¨wordæˆ–è€…excelä¹‹é¡çš„å·¥å…·ï¼Œç•¶ç‰ˆæœ¬æœ‰æ›´æ–°çš„æ™‚å€™æœƒéœ€è¦è«‹åŒäº‹é‡æ–°ä¸‹è¼‰ä½¿ç”¨ï¼Œä¸¦åœ¨å ±è¡¨çš„æŸè™•å£“ä¸€å€‹<strong>ç‰ˆæœ¬è™Ÿ</strong>ä½œç‚ºè¾¨è­˜ï¼Œç„¶è€Œå¾€å¾€é ’å¸ƒé©ç”¨çš„æ™‚å€™ï¼Œé‚„æ˜¯æœƒæœ‰ä¸å°‘åŒäº‹ä»¥èˆŠçš„ç‰ˆæœ¬æé€å ±è¡¨ã€‚</p>
<p>ç‚ºè§£æ±ºä¸Šè¿°ç‰ˆæœ¬å·®ç•°å•é¡Œï¼Œé€™æ¬¡é¸æ“‡åˆ©ç”¨é›²ç«¯ç¶²é ä½œç‚ºå¯<strong>åŠæ™‚æ›´æ–°</strong>çš„å ±è¡¨è¼¸å‡ºåª’ä»‹ï¼Œä¸€æ—¦è¨ˆç®—è¦å‰‡æ”¹è®Šæˆ–å ±è¡¨æ ¼å¼è®ŠåŒ–å°±èƒ½å¤ åœ¨åŒäº‹è¼¸å…¥å®ŒåŸºæœ¬è³‡æ–™ä¹‹å¾Œï¼Œç¢ºä¿è¼¸å‡ºçš„å…§å®¹æœƒæ˜¯æ­£ç¢ºç‰ˆçš„ã€‚</p>
<h2 id="å¯¦ä½œæˆæœ">å¯¦ä½œæˆæœ</h2>
<figure>
<img src="1.JPG" alt="ç³»çµ±æ“ä½œæµç¨‹" />
<figcaption aria-hidden="true">ç³»çµ±æ“ä½œæµç¨‹</figcaption>
</figure>
<hr />
<figure>
<img src="2.JPG" alt="å·¥ç¨‹åŸºæœ¬è³‡æ–™" />
<figcaption aria-hidden="true">å·¥ç¨‹åŸºæœ¬è³‡æ–™</figcaption>
</figure>
<hr />
<figure>
<img src="3.JPG" alt="å·¥ç¨‹æ–½ä½œä½ç½®" />
<figcaption aria-hidden="true">å·¥ç¨‹æ–½ä½œä½ç½®</figcaption>
</figure>
<hr />
<figure>
<img src="4.JPG" alt="å·¥ç¨‹å…§å®¹æ¦‚è¦" />
<figcaption aria-hidden="true">å·¥ç¨‹å…§å®¹æ¦‚è¦</figcaption>
</figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆæˆæœ</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‰¹æ¬¡è½‰æ›docåˆ°pdf</title>
    <url>/posts/1066861632/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<ol type="1">
<li><p>äº¤é€šéƒ¨çš„éƒ¨é ’è¦ç¯„ä¸‹è¼‰ä¸‹ä¾†ä¹‹å¾Œæœƒè®Šæˆå¾ˆå¤šç´°ç¢çš„æª”æ¡ˆï¼ŒåŒ…å«PDFè·ŸDOCï¼Œåœ¨é€²è¡Œæª”æ¡ˆå…§å®¹æœå°‹çš„æ™‚å€™æ™‚å¸¸éœ€è¦è·¨æª”æ¡ˆæ¯”å°ï¼Œç„¡æ³•åœ¨<strong>åŒå€‹æª”æ¡ˆ</strong>ä¸­ä¸€æ¬¡åˆ°ä½ã€‚</p></li>
<li><p>æœ‰äº›è¦ç¯„æœ‰é€²è¡Œä¿®æ”¹çš„å…§å®¹éœ€è¦å…ˆä¿®æ”¹docå¾Œå†è¼¸å‡ºPDFï¼Œä¹¾è„†å°‡æ‰€æœ‰PDFéƒ½å…ˆé€²è¡Œåˆªé™¤ï¼Œå¾ŒçºŒå†é‡å°è³‡æ–™å¤¾æ‰¹æ¬¡è½‰æª”æˆPDFå¾Œå†åšåˆä½µã€‚</p></li>
</ol>
<div class="note info"><p>è§£æ±ºç›®æ¨™:å°‡docä¿®æ”¹å®Œç•¢å¾Œè¼¸å‡ºç‚ºpdfï¼Œä¸Ÿåˆ°pdf_mergeä¸­é€²è¡Œåˆä½µï¼Œé€™å¯¦åœ¨æ˜¯å¾ˆéº»ç…©ã€‚</p>
</div>
<p>æœ¬ç¯‡ä»‹ç´¹å¦‚ä½•æ’°å¯«ç¨‹å¼ç¢¼ä¾†ç°¡åŒ–è£½ä½œ<strong>å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„</strong>çš„æµç¨‹ï¼Œæœ‰èˆˆè¶£è«‹ç¹¼çºŒé–±è®€</p>
<span id="more"></span>
<hr />
<h3 id="æª”æ¡ˆä¾†æº">æª”æ¡ˆä¾†æº</h3>
<ul>
<li><p>åŸå§‹æª”æ¡ˆä¸‹è¼‰é€£çµ <img src="1.png"
alt="Fig1.è¦ç¯„ä¸‹è¼‰è™•" /></p></li>
<li><p>åŸå§‹æª”æ¡ˆä¸‹è¼‰å…§å®¹ <img src="2.png"
alt="Fig2.è¦ç¯„ä¸‹è¼‰å…§å®¹-PDFèˆ‡DOC" /></p></li>
<li><p>é å…ˆè™•ç†å…§å®¹ <img src="3.png"
alt="Fig3.é å…ˆåˆªé™¤æ‰€æœ‰PDF" /></p></li>
</ul>
<hr />
<h2 id="pythonçš„è§£æ±ºæ–¹æ¡ˆ">ğŸ‘‰Pythonçš„è§£æ±ºæ–¹æ¡ˆ</h2>
<h3
id="é è¨ˆä½¿ç”¨å·¥å…·ç‚ºdocx2pdfé€²è¡Œè½‰æª”">é è¨ˆä½¿ç”¨å·¥å…·ç‚ºdocx2pdfé€²è¡Œè½‰æª”</h3>
<p><a href="https://pypi.org/project/docx2pdf/">docx2pdf</a></p>
<p>ä½¿ç”¨æ™‚æ‰€è¼¸å‡ºçš„å…§å®¹ä¸€ç›´å‡ºç¾ç©ºç™½é ï¼Œè€Œä¸”å¯ä»¥æ¥å—çš„å…§å®¹ä¹Ÿåªæœ‰docx
å¯èƒ½æ˜¯æˆ‘é‚„æ²’ç ”ç©¶é€å¾¹...?</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> docx2pdf <span class="keyword">import</span> convert</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_docx_to_pdf</span>(<span class="params">input_folder, output_folder</span>):</span><br><span class="line">    <span class="comment"># ç¢ºä¿è¼¸å…¥æ–‡ä»¶å¤¾å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(input_folder):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;è¼¸å…¥æ–‡ä»¶å¤¾ä¸å­˜åœ¨ï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¢ºä¿è¼¸å‡ºæ–‡ä»¶å¤¾å­˜åœ¨</span></span><br><span class="line">    os.makedirs(output_folder, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éæ­·è¼¸å…¥æ–‡ä»¶å¤¾ä¸­çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(input_folder):</span><br><span class="line">        <span class="keyword">if</span> filename.endswith(<span class="string">&quot;.docx&quot;</span>) :<span class="comment">#or filename.endswith(&quot;.doc&quot;):</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;filename&#125;</span> found&quot;</span>)</span><br><span class="line"></span><br><span class="line">            input_path = os.path.join(input_folder, filename)</span><br><span class="line">            output_filename = filename.replace(<span class="string">&quot;.docx&quot;</span>, <span class="string">&quot;.pdf&quot;</span>)</span><br><span class="line">            output_path = os.path.join(output_folder, output_filename)</span><br><span class="line">            <span class="comment"># å°‡ Word æ–‡ä»¶è½‰æ›ç‚º PDF</span></span><br><span class="line">            </span><br><span class="line">            convert(input_path, output_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;filename&#125;</span> è½‰æ›å®Œæˆ&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_folder = <span class="string">r&quot;D:\GoogleDrive-åƒè€ƒæ‰‹å†Š\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot;</span>  <span class="comment"># è¼¸å…¥æ–‡ä»¶å¤¾çš„è·¯å¾‘</span></span><br><span class="line">    output_folder = <span class="string">r&quot;D:\Python\pdf_output&quot;</span>  <span class="comment"># è¼¸å‡ºæ–‡ä»¶å¤¾çš„è·¯å¾‘</span></span><br><span class="line">    convert_docx_to_pdf(input_folder, output_folder)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¾Œä¾†é‚„æ˜¯æƒ³åˆ¥çš„è¾¦æ³•å»è½‰æª”ã€‚</p>
<hr />
<h2 id="æœ€çµ‚é¸æ“‡">ğŸ‘æœ€çµ‚é¸æ“‡</h2>
<p>èº«ç‚ºå¿ è‡£çš„VBAç”¨æˆ¶ï¼Œå¦‚æœèƒ½å¤ ç”¨VBAè™•ç†æœƒæ˜¯æ¯”è¼ƒå¾—å¿ƒæ‡‰æ‰‹çš„ï¼Œçªç„¶æƒ³èµ·
Excel VBA æœ¬èº«å¯ä»¥å‘¼å« Word VBA åŸ·è¡ŒPDFè½‰æª”ã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&#x27;ä»¥ä¸‹å…§å®¹ä¾†è‡ªèˆ‡ChatGPTä¹‹é–“çš„å°è©±+æˆ‘è‡ªå·±ç¨å¾®ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> ConvertDocToPDF()</span><br><span class="line">    <span class="keyword">Dim</span> WordApp <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">    <span class="keyword">Dim</span> WordDoc <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">    <span class="keyword">Dim</span> FolderPath <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    <span class="keyword">Dim</span> FileName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    <span class="keyword">Dim</span> PDFFileName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ?ç½® Word ?ç”¨?è±¡</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">    <span class="keyword">Set</span> WordApp = GetObject(, <span class="string">&quot;Word.Application&quot;</span>)</span><br><span class="line">    <span class="keyword">If</span> WordApp <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line">        <span class="keyword">Set</span> WordApp = CreateObject(<span class="string">&quot;Word.Application&quot;</span>)</span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ?ç½® Word ?ç”¨?ä¸å¯?</span></span><br><span class="line">    WordApp.Visible = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ?ç½®æ–‡ä»¶?è·¯?</span></span><br><span class="line">    FolderPath = <span class="string">&quot;D:\GoogleDrive-åƒè€ƒæ‰‹å†Š\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot;</span> <span class="comment">&#x27; æ›´æ”¹?ä½ çš„æ–‡ä»¶?è·¯?</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; é?æ–‡ä»¶?ä¸­çš„æ‰€æœ‰ Word æ–‡ä»¶</span></span><br><span class="line">    FileName = Dir(FolderPath &amp; <span class="string">&quot;\*.doc*&quot;</span>)</span><br><span class="line">    <span class="keyword">Do</span> <span class="keyword">While</span> FileName &lt;&gt; <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="comment">&#x27; æ‰“? Word æ–‡?</span></span><br><span class="line">        <span class="keyword">Set</span> WordDoc = WordApp.Documents.Open(FolderPath &amp; <span class="string">&quot;\&quot;</span> &amp; FileName)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; æ„å»º PDF æ–‡ä»¶å</span></span><br><span class="line">        PDFFileName = Replace(FolderPath &amp; <span class="string">&quot;\&quot;</span> &amp; FileName, <span class="string">&quot;.doc&quot;</span>, <span class="string">&quot;.pdf&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; ä¿å­˜? PDF</span></span><br><span class="line">        WordDoc.ExportAsFixedFormat OutputFileName:=PDFFileName, ExportFormat:=<span class="number">17</span> <span class="comment">&#x27; 17 è¡¨ç¤º PDF æ ¼å¼</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; ?? Word æ–‡?</span></span><br><span class="line">        WordDoc.Close <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&#x27; ??ä¸‹ä¸€?æ–‡ä»¶</span></span><br><span class="line">        FileName = Dir</span><br><span class="line">    <span class="keyword">Loop</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ?? Word ?ç”¨</span></span><br><span class="line">    WordApp.Quit</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27; ?æ”¾?è±¡</span></span><br><span class="line">    <span class="keyword">Set</span> WordDoc = <span class="literal">Nothing</span></span><br><span class="line">    <span class="keyword">Set</span> WordApp = <span class="literal">Nothing</span></span><br><span class="line">    </span><br><span class="line">    MsgBox <span class="string">&quot;åˆ—å°å®Œæˆï¼&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr />
<h3 id="æš«æ™‚çµæœ">æš«æ™‚çµæœ</h3>
<p>ç¶“éè½‰æª”ä¹‹å¾Œï¼ŒåŸæœ¬æ˜¯docæˆ–docxçš„æª”æ¡ˆéƒ½æœƒä¾ç…§åŸæœ¬åç¨±è®Šæˆpdfçš„å‰¯æª”å</p>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯è¦é€²è¡Œ<strong>pdfåˆä½µäº†</strong>!!</p>
<figure>
<img src="4.png" alt="Fig4.æš«æ™‚ç”Ÿæˆçµæœ" />
<figcaption aria-hidden="true">Fig4.æš«æ™‚ç”Ÿæˆçµæœ</figcaption>
</figure>
<hr />
<h3 id="åˆ—å°é †åº">åˆ—å°é †åº</h3>
<p>å› ç‚ºPDFæ–‡ä»¶çš„åç¨±ä¸ä¸€å®šæ˜¯æˆ‘æ‰€éœ€è¦çš„é †åº</p>
<p>å¸Œæœ›èƒ½å¤ ä¾å¾ªä¸‹åˆ—æ­¥é©Ÿ</p>
<ol type="1">
<li>åˆ—å‡ºè©²æª”æ¡ˆå¤¾ä¸­çš„æª”æ¡ˆåç¨±é †åºæˆç‚ºCSVæª”æ¡ˆ</li>
<li>æ ¹æ“šæˆ‘æ‰€æŒ‡å®šçš„é †åºé€²è¡Œé¸å–åˆä½µ</li>
</ol>
<hr />
<h4 id="ç”Ÿæˆcsvé †åº">ç”ŸæˆCSVé †åº</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_pdf_files_to_csv</span>(<span class="params">input_folder, output_csv</span>):</span><br><span class="line">    <span class="comment"># æ‰“å¼€ CSV æ–‡ä»¶ä»¥å†™å…¥æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_csv, <span class="string">&quot;w&quot;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">        <span class="comment"># åˆ›å»º CSV writer å¯¹è±¡</span></span><br><span class="line">        csv_writer = csv.writer(csv_file)</span><br><span class="line">        csv_writer.writerow([<span class="string">&#x27;é †åº&#x27;</span>,<span class="string">&#x27;æª”æ¡ˆåç¨±&#x27;</span>,<span class="string">&#x27;æª”æ¡ˆè·¯å¾‘&#x27;</span>])</span><br><span class="line">        order=<span class="number">1</span></span><br><span class="line">        <span class="comment"># éå†è¾“å…¥æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(input_folder):</span><br><span class="line">            <span class="comment"># æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä»¥ &quot;.pdf&quot; ç»“å°¾</span></span><br><span class="line">            <span class="keyword">if</span> filename.lower().endswith(<span class="string">&quot;.pdf&quot;</span>):</span><br><span class="line">                <span class="comment"># å°†æ–‡ä»¶ä¿¡æ¯å†™å…¥ CSV æ–‡ä»¶</span></span><br><span class="line">                file_path = os.path.join(input_folder, filename)</span><br><span class="line">                csv_writer.writerow([order,filename, file_path])</span><br><span class="line">                <span class="comment"># æ›´æ–°é¡ºåºå·</span></span><br><span class="line">                order += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_folder =<span class="string">r&quot;D:\GoogleDrive-åƒè€ƒæ‰‹å†Š\å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„&quot;</span>  <span class="comment"># è¾“å…¥æ–‡ä»¶å¤¹çš„è·¯å¾„</span></span><br><span class="line">    output_csv = <span class="string">r&quot;D:\Python\pdf_doc\pdf_files.csv&quot;</span>  <span class="comment"># è¾“å‡º CSV æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">    list_pdf_files_to_csv(input_folder, output_csv)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆä¹‹å¾Œå¯ä»¥è—‰ç”±Excelçš„å¹«åŠ©é€²è¡Œé †åºæ’åºï¼Œå†å¦å­˜ç‚ºcsvæª”æ¡ˆçš„æ ¼å¼å°±å¯ä»¥å‚™ç”¨ã€‚</p>
<h4 id="æ ¹æ“šcsvé †åºé€²è¡Œåˆä½µ">æ ¹æ“šCSVé †åºé€²è¡Œåˆä½µ</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> PyPDF2 <span class="keyword">import</span> PdfMerger</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_csv_to_pdf_files</span>(<span class="params">csv_file</span>):</span><br><span class="line">    pdf_files = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å¼€ CSV æ–‡ä»¶å¹¶è¯»å–å†…å®¹</span></span><br><span class="line">    <span class="comment">#with open(csv_file, &quot;r&quot;, newline=&#x27;&#x27;,errors=&#x27;replace&#x27;) as file:#æœ‰å‡ºç¾å•é¡Œçš„è©±ç”¨é€™è¡Œ</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(csv_file, <span class="string">&quot;r&quot;</span>, newline=<span class="string">&#x27;&#x27;</span>,encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> file:<span class="comment">#å…¨æ–°è™›æ“¬ç’°å¢ƒç”¨é€™è¡Œ</span></span><br><span class="line">        reader = csv.reader(file)</span><br><span class="line">        <span class="built_in">next</span>(reader)  <span class="comment"># è·³è¿‡æ ‡é¢˜è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">            order = row[<span class="number">0</span>]<span class="comment">#ç¬¬ä¸€åˆ—æ˜¯é¡ºåº</span></span><br><span class="line">            filename = row[<span class="number">1</span>]  <span class="comment"># ç¬¬äºŒåˆ—æ˜¯æ–‡ä»¶å</span></span><br><span class="line">            pdf_path = row[<span class="number">2</span>]  <span class="comment"># ç¬¬ä¸‰åˆ—æ˜¯ PDF æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">            pdf_files.append((order, filename, pdf_path))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> pdf_files</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge_pdfs_directly</span>(<span class="params">pdf_files,output_folder</span>):</span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ª PdfMerger å¯¹è±¡</span></span><br><span class="line">    merger = PdfMerger()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  é€™å€‹ä¸èƒ½äº‚æ”¹æœƒå ±éŒ¯</span></span><br><span class="line">    <span class="keyword">for</span> order, filename,pdf_path <span class="keyword">in</span> pdf_files:</span><br><span class="line">        <span class="comment"># å°† PDF æ–‡ä»¶æ·»åŠ åˆ°åˆå¹¶å™¨ä¸­</span></span><br><span class="line">        merger.append(pdf_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¡®ä¿è¾“å‡ºæ–‡ä»¶å¤¹å­˜åœ¨</span></span><br><span class="line">    os.makedirs(output_folder, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†åˆå¹¶åçš„ PDF ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line">    output_path = os.path.join(output_folder, <span class="string">&quot;merged_pdf.pdf&quot;</span>)</span><br><span class="line">    merger.write(output_path)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å…³é—­åˆå¹¶å™¨</span></span><br><span class="line">    merger.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    csv_file = <span class="string">r&quot;D:\Python\pdf_doc\pdf_files.csv&quot;</span>  <span class="comment"># CSV æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">    pdf_files = read_csv_to_pdf_files(csv_file)</span><br><span class="line">    output_folder = <span class="string">r&quot;D:\Python\pdf_doc&quot;</span>  <span class="comment"># è¾“å‡ºæ–‡ä»¶å¤¹çš„è·¯å¾„</span></span><br><span class="line">    merge_pdfs_directly(pdf_files,output_folder)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="æœ€çµ‚æˆæœ">æœ€çµ‚æˆæœ</h4>
<div class="note success"><p>è—‰ç”±vbaçš„è½‰æª”åŠpythonçš„åˆä½µè™•ç†æˆçš„æª”æ¡ˆï¼Œç¸½å…±æœ‰432é çš„PDF <span
class="github-emoji" data-alias="link" style=""
data-fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f517.png?v8">ğŸ”—</span>
<a
href="https://1drv.ms/b/s!AvmbvZ-TA-bAgpsFgHAua545ujNtnw?e=57r41J">ğŸ”—å®Œæ•´ç‰ˆ-å…¬è·¯æ©‹æ¢è¨­è¨ˆè¦ç¯„æˆæœä¸‹è¼‰</a></p>
</div>
<hr />
<h2 id="é–‹ç™¼éç¨‹çš„å•é¡Œ">ğŸ‘»é–‹ç™¼éç¨‹çš„å•é¡Œ</h2>
<p>æ“ä½œCSVçš„éç¨‹æ›¾ç¶“å‡ºç¾ä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œè¨˜éŒ„ä¸€ä¸‹æ¯”è¼ƒä¸æœƒå¿˜è¨˜</p>
<h3
id="æª”æ¡ˆåç¨±ç‚ºä¸­æ–‡è¦æ”¶é›†åŒ¯å…¥csvæª”æ¡ˆçš„æ™‚æœƒè®Šæˆäº‚ç¢¼">æª”æ¡ˆåç¨±ç‚ºä¸­æ–‡ï¼Œè¦æ”¶é›†åŒ¯å…¥csvæª”æ¡ˆçš„æ™‚æœƒè®Šæˆäº‚ç¢¼</h3>
<p>éœ€è¦å°‡ç·¨ç¢¼ç”±<strong>utf-8</strong>æ”¹ç‚º<strong>utf-8-sig</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(output_csv, <span class="string">&quot;w&quot;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> csv_file: </span><br></pre></td></tr></table></figure>
<p><a
href="https://blog.csdn.net/weixin_46640900/article/details/110602702">CSDNåƒè€ƒ</a></p>
<h3
id="è¦å°‡csvçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾unicodedecodeerror">è¦å°‡CSVçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾'UnicodeDecodeError'</h3>
<p>å°‡åŸæœ¬çš„è®€å–å…§å®¹ä¸­çš„<strong>encoding</strong>æ›æˆ
<strong>errors='replace'</strong> å³å¯</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;some.csv&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">  reader = csv.reader(f)</span><br><span class="line">  <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">    <span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;some.csv&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">   reader = csv.reader(f)</span><br><span class="line">   <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">    <span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure>
<p><a
href="https://stackoverflow.com/questions/12752313/unicodedecodeerror-in-python-3-when-importing-a-csv-file">Stack
overflowåƒè€ƒè³‡æ–™</a></p>
<h3
id="é–‹å•Ÿä¸€å€‹å…¨æ–°çš„ç’°å¢ƒè¦å°‡csvçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾">é–‹å•Ÿä¸€å€‹å…¨æ–°çš„ç’°å¢ƒï¼Œè¦å°‡CSVçš„å…§å®¹åŒ¯å…¥åˆ°pythoné€²è¡Œå¾ŒçºŒé‹ç”¨æ™‚æœƒå‡ºç¾</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">FileNotFoundError: [Errno <span class="number">2</span>] No such file <span class="keyword">or</span> directory: <span class="string">&#x27;D:\\GoogleDrive-ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\\ï¿½ï¿½ç¥ˆæ¥ç’ˆï¿½ç’‡ï¿½é–®å‰›ï¿½ï¿½é–¬ï¿½ è­ï¿½\\èšç Œï¿½ï¿½è¡ï¿½ è®è³¢ï¿½ï¿½1090103.pdf</span></span><br></pre></td></tr></table></figure>
<p>åŸæœ¬ç¬¬äºŒé»å¯ä»¥è§£æ±ºç·¨è­¯å•é¡Œçš„ç¨‹å¼ç¢¼èª¿æ•´ errors='replace'
å·²ç¶“ç„¡æ³•ä½œç”¨ï¼Œæˆ‘æŠŠencoding='utf-8-sig'é‡æ–°åŠ ä¸Šå»ï¼Œç„¶å¾Œå°±å¥½äº†(?)</p>
<blockquote>
<p>çŒœæ¸¬æ˜¯æ–°çš„ç’°å¢ƒä¸­é‚„æ²’æœ‰é è¨­çš„encodingï¼Œæ‰€ä»¥ä¸­æ–‡é‚„æ²’æœ‰è¾¦æ³•è¢«çŸ¥é“è¦æ€éº¼ç·¨è­¯ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;some.csv&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">  reader = csv.reader(f)</span><br><span class="line">  <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">    <span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ExcelVBA</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-å¼•ç”¨ä¾†æº</title>
    <url>/posts/3212778286/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>å·¥ç¨‹åƒ¹æ ¼è³‡æ–™åº«ä½œæ¥­è¾¦æ³•æœ‰æ˜å®šï¼Œæ–°å°å¹£1000è¬å…ƒä»¥ä¸Šä¹‹<strong>å…¬å…±å·¥ç¨‹</strong>æ–¼æ±ºæ¨™æ—¥èµ·30æ—¥å…§å¿…é ˆå°‡è³‡æ–™å‚³è¼¸åˆ°ä¸»ç®¡æ©Ÿé—œï¼Œè³‡æ–™å…§å®¹:</p>
<ol type="1">
<li>å¾—æ¨™å» å•†ä¹‹å¥‘ç´„å–®åƒ¹</li>
<li>ç¶“æ©Ÿé—œæ ¸å®šä¹‹é ç®—å–®åƒ¹</li>
<li>å…¶ä»–ç¶“ä¸»ç®¡æ©Ÿé—œæŒ‡å®šè€…</li>
</ol>
<p>åŒ…å«è©³ç´°åƒ¹ç›®è¡¨ã€å–®åƒ¹åˆ†æè¡¨åŠè³‡æºçµ±è¨ˆè¡¨ã€‚</p>
<p>æœ€å®¹æ˜“é”æˆçš„æ–¹å¼ä¾¿æ˜¯é€éå…¬å…±å·¥ç¨‹ç¶“è²»é›»è…¦ä¼°åƒ¹ç³»çµ±(PCCES)é€²è¡Œé ç®—æ›¸èˆ‡å¥‘ç´„ç·¨åˆ¶ã€‚</p>
<p>å› ç‚ºå¤§å®¶éƒ½ä½¿ç”¨åŒä¸€å¥—ç³»çµ±ï¼Œé‚£éº¼è¼¸å‡ºæ ¼å¼å°±èƒ½å¤ é€šç”¨ï¼Œå¾ŒçºŒè¦å°‡å¥‘ç´„å…§å®¹å½™æ•´åˆ°å…¬å¸å…§éƒ¨æ‰€é–‹ç™¼çš„å ±è¡¨ç³»çµ±åªéœ€è¦åšä¸€æ¬¡å·¥å°±å¯ä»¥äº†ï¼Œç„¶è€Œéå…¬å…±å·¥ç¨‹çš„å…§å®¹æœƒå°±å› ç‚ºå€‹æ¡ˆä¸åŒè€Œéœ€è¦åšç´°å¾®èª¿æ•´ã€‚</p>
<span id="more"></span>
<h2 id="é ç®—æ›¸ç¯„ä¾‹">ğŸ“”é ç®—æ›¸ç¯„ä¾‹</h2>
<p>ä¸€èˆ¬åœ¨å…¬å…±å·¥ç¨‹è¨­è¨ˆéšæ®µï¼Œéœ€è¦è£½ä½œä»¥ä¸‹è¡¨æ ¼</p>
<ol type="1">
<li>é ç®—ç¸½è¡¨</li>
<li>é ç®—è©³ç´°è¡¨</li>
<li>é ç®—å–®åƒ¹åˆ†æè¡¨</li>
<li>é ç®—è³‡æºçµ±è¨ˆè¡¨(ä¸€å®šè¦æ¨¡æ‰è¦)</li>
</ol>
<p>æ‰¿æ”¬å» å•†å¾—æ¨™å¾Œï¼Œå¥‘ç´„é …ç›®ã€æ•¸é‡ã€å–®ä½åŸºæœ¬ä¸ŠæœƒæŒ‰ç…§è¨­è¨ˆéšæ®µå…§å®¹ï¼Œåƒ…å–®åƒ¹éƒ¨åˆ†æœƒä¾ç…§æ¨™æ¯”é€²è¡Œèª¿æ•´ã€‚</p>
<blockquote>
<p>æˆç«‹å¥‘ç´„å¾Œæ‰€å¾—åˆ°çš„å…§å®¹ä¾¿æ˜¯å¾ŒçºŒè¾¦ç†æ•¸é‡å¡«å¯«ã€è®Šæ›´è¨­è¨ˆã€ä¼°é©—è¨ˆåƒ¹ç­‰ç¨‹åºçš„ä¾æ“šã€‚</p>
</blockquote>
<h3 id="å…¬å…±å·¥ç¨‹">å…¬å…±å·¥ç¨‹</h3>
<p>å¤§å¤šéƒ½æ˜¯æ¡ç”¨å…¬å…±å·¥ç¨‹ç¶“è²»é›»è…¦ä¼°åƒ¹ç³»çµ±(PCCES)é€²è¡Œï¼Œä»¥ç·¨ç¢¼æ­£ç¢ºç‡40%ç‚ºæ¨å‹•ç›®æ¨™ä¸¦åŠ ä»¥åˆ—ç®¡ï¼Œè‹¥æ˜¯ç”¨å‰äººç•™ä¸‹ä¾†çš„Excelé€²è¡Œ<strong>æ¨¡ä»¿</strong>ï¼Œé€šå¸¸éƒ½æ¯”è¼ƒæœƒé›£ä»¥é”æˆæœ€ä½ç·¨ç¢¼æ­£ç¢ºç‡çš„è¦æ±‚ï¼Œå»ºè­°é‚„æ˜¯å­¸ç¿’PCCESå¦‚ä½•ä½¿ç”¨æ¯”è¼ƒå¥½ã€‚</p>
<p>åœ¨å°‡é …ç›®ç§»è½‰è‡³å…§éƒ¨å ±è¡¨çš„éç¨‹ï¼Œæœƒé‡åˆ°æ¬„ä½åç¨±æ¯”è¼ƒé•·çš„å‡ºç¾<strong>è·³åˆ—</strong>çš„æƒ…æ³ï¼Œæ­¤æ™‚è¦å°‡é …ç›®æ¬ç§»è‡³å…§éƒ¨å ±è¡¨ç³»çµ±æ™‚æœƒéœ€è¦åšå…ˆè¡Œè™•ç†ï¼Œå¦å‰‡æœƒæœ‰é …ç›®åç¨±ä¸å®Œæ•´çš„ç‹€æ³ï¼Œè€Œé€™é€šå¸¸æœƒåœ¨æ—¥å¾Œæœƒå‡ºç¾ä¸€äº›å•é¡Œï¼Œå…ˆè¡Œè™•ç†é›–ç„¶éº»ç…©ä½†é‚„æ˜¯ä¸å¯å…ã€‚</p>
<figure>
<img src="upload_33eb45717c5bc11304ad3865fbf5d446.png"
alt="Fig2.å¥‘ç´„é …ç›®è·³åˆ—" />
<figcaption aria-hidden="true">Fig2.å¥‘ç´„é …ç›®è·³åˆ—</figcaption>
</figure>
<h3 id="éå…¬å…±å·¥ç¨‹">éå…¬å…±å·¥ç¨‹</h3>
<p>éå…¬å…±å·¥ç¨‹é›–ç„¶æœªå¼·åˆ¶è¦æ±‚ç·¨ç¢¼æ­£ç¢ºç‡ï¼Œå› æ­¤æ‰€è¼¸å‡ºçš„é ç®—æ›¸æ ¼å¼æ¯”è¼ƒæœƒåƒå¥‡ç™¾æ€ªï¼Œä½†é€šå¸¸ä¹Ÿæ˜¯ä¸è„«é›¢å…¬å…±å·¥ç¨‹çš„åŸºæœ¬æ¦‚å¿µï¼Œæœ‰é—œå¥‘ç´„ç¸½è¡¨ã€å¥‘ç´„è©³ç´°è¡¨ã€å¥‘ç´„å–®åƒ¹åˆ†æè¡¨é€šå¸¸éƒ½æœƒå‡ºç¾ã€‚</p>
<p>åœ¨å°‡é …ç›®ç§»è½‰è‡³å…§éƒ¨å ±è¡¨çš„éç¨‹ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥ç”¨æ‰‹å‹•çš„æ–¹å¼æŠŠè³‡æ–™PASSåˆ°å…§éƒ¨å ±è¡¨ç³»çµ±ä¸Šé¢ï¼Œä½†è‹¥åƒæ˜¯å»ºç¯‰å·¥ç¨‹æœ‰å¹¾ç™¾å¹¾åƒé …çš„ï¼Œå»ºè­°é€éVBAé€²è¡Œè™•ç†æœƒæ¯”è¼ƒç†æƒ³ï¼Œåªè¦æ˜¯Excelæ‡‰è©²éƒ½æœ‰æ©Ÿæœƒæ‰¾å‡ºç·¨è£½çš„è„ˆçµ¡é€²è¡Œç¨‹å¼æ’°å¯«ï¼Œé€™å°±éœ€è¦çœ‹å€‹æ¡ˆè€Œå®šï¼Œæ‰¾å‡ºå¥‘ç´„ä¸Šçš„è¦å¾‹ï¼Œé€éè¿´åœˆã€åˆ¤åˆ¥å¼ä¸€ä¸€æ‰¾å‡ºè„ˆçµ¡ä¸¦é€²è¡Œé …ç›®èƒå–ã€‚</p>
<h2 id="å¥‘ç´„é …ç›®">å¥‘ç´„é …ç›®</h2>
<p>åœ¨ç›£é€ å ±è¡¨ä¸Šè¦åŸ·è¡Œæ•¸é‡è¨ˆç®—æ™‚ï¼Œç‚ºæ§åˆ¶å ±è¡¨é•·åº¦ï¼Œé€šå¸¸æœƒä»¥<strong>å¥‘ç´„è©³ç´°è¡¨</strong>ä¸­çš„å…§å®¹ç‚ºä¸»ï¼Œå…¶ä¸­æœƒæœ‰ä»¥ä¸‹å¹¾ç¨®å‹æ…‹</p>
<blockquote>
<p>å¯é‡åŒ–å‹æ…‹</p>
</blockquote>
<p>é‹¼ç­‹(Unit=T)ã€æ¨¡æ¿(Unit=m2)ã€æ··å‡åœŸ(Unit=m3)...ç­‰å…·å‚™æ˜ç¢ºå–®ä½ã€å¯è¢«é‡åŒ–ä¸”ç·¨åˆ—æ–¼è©³ç´°è¡¨ä¸Šçš„å…§å®¹</p>
<blockquote>
<p>ä¸€å¼å‹æ…‹</p>
</blockquote>
<p>å› ç‰¹å®šå·¥ç¨‹é …ç›®ä¹‹åƒ¹æ ¼æˆ–æ•¸é‡ç·¨åˆ—ä¸æ˜“ï¼Œç„¡æ³•ä»¥æ˜ç¢ºå–®ä½åŠ ä»¥è¨ˆé‡ï¼Œé›£ä»¥ä¼°è¨ˆçš„å…§å®¹æœƒä»¥æ¦‚ä¼°çš„æ–¹å¼çµ¦å®šä¸€å¼çš„è²»ç”¨ï¼Œä¾‹å¦‚æ“‹æŠ½æ’æ°´è²»</p>
<blockquote>
<p>ç™¾åˆ†æ¯”å‹æ…‹</p>
</blockquote>
<p>ç’°å¢ƒä¿è­·è²»ã€è·æ¥­å®‰å…¨è¡›ç”Ÿè²»ã€å“ç®¡ä½œæ¥­è²»ã€å» å•†ç®¡ç†è²»ã€ç‡Ÿæ¥­ç¨…...ç­‰ï¼Œä¾æ“šé ç®—ç·¨åˆ—å…§å®¹å¾Œç¶“æ›ç®—æ¯”ä¾‹è€Œå¾—åˆ°çš„è²»ç”¨ã€‚</p>
<h2 id="åŒ¯å…¥å…§å®¹">åŒ¯å…¥å…§å®¹</h2>
<h3 id="xml">XML</h3>
<p>PCCESå¯ä»¥è¼¸å‡ºXMLæˆ–XLS</p>
<p>XMLæ˜¯ä¸€ç¨®åŠçµæ§‹åŒ–è³‡æ–™ï¼Œä»¥&lt;...&gt;é–‹å§‹ã€&lt;/...&gt;çµæŸï¼Œä¸­é–“æ‰€å¤¾çš„å…§å®¹æœ‰å±¬æ€§(attribute)è·Ÿæ–‡å­—(text)ï¼Œå±¬æ€§ç‚ºä¸€å¥å€¼å°ï¼Œå¯é‡å°å±¬æ€§å€¼é€²è¡Œæ“ä½œï¼Œä¹Ÿå¯é‡å°æ–‡å­—é€²è¡Œä½¿ç”¨ã€‚</p>
<blockquote>
<p>ç¯€éŒ„è‡ªPCCESç”¢å‡ºçš„XMLæª”æ¡ˆ</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">PayItem</span> <span class="attr">itemKey</span>=<span class="string">&quot;7&quot;</span> <span class="attr">itemNo</span>=<span class="string">&quot;ä¸€&quot;</span> <span class="attr">refItemCode</span>=<span class="string">&quot;       &quot;</span> <span class="attr">itemKind</span>=<span class="string">&quot;mainItem&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Description</span> <span class="attr">language</span>=<span class="string">&quot;zh-TW&quot;</span>&gt;</span>ä¸»é«”å·¥ç¨‹<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Description</span> <span class="attr">language</span>=<span class="string">&quot;en&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Unit</span> <span class="attr">language</span>=<span class="string">&quot;zh-TW&quot;</span>&gt;</span>          <span class="tag">&lt;/<span class="name">Unit</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Unit</span> <span class="attr">language</span>=<span class="string">&quot;en&quot;</span>&gt;</span>          <span class="tag">&lt;/<span class="name">Unit</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Quantity</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Quantity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Price</span> <span class="attr">fixed</span>=<span class="string">&quot;false&quot;</span> <span class="attr">calculateDecimal</span>=<span class="string">&quot;0&quot;</span>&gt;</span>11824021<span class="tag">&lt;/<span class="name">Price</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Amount</span> <span class="attr">fixed</span>=<span class="string">&quot;true&quot;</span> <span class="attr">calculateDecimal</span>=<span class="string">&quot;0&quot;</span>&gt;</span>11824021<span class="tag">&lt;/<span class="name">Amount</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Remark</span>&gt;</span>[ç™¼åŒ…]<span class="tag">&lt;/<span class="name">Remark</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Percent</span>&gt;</span>0<span class="tag">&lt;/<span class="name">Percent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">PayItem</span> <span class="attr">itemKey</span>=<span class="string">&quot;15&quot;</span> <span class="attr">itemNo</span>=<span class="string">&quot;1&quot;</span> <span class="attr">refItemCode</span>=<span class="string">&quot;02300C00</span></span></span><br><span class="line"><span class="string"><span class="tag"></span></span></span><br></pre></td></tr></table></figure>
<h3 id="xls">XLS</h3>
<p>XLSå°±æ˜¯æŒ‡Excelçš„æ´»é ç°¿ï¼Œå¤§å®¶æ‡‰è©²å¾ˆå¸¸è¦‹ï¼Œä¸å¤šåšè§£é‡‹ã€‚</p>
<h3 id="pcceså¥‘ç´„é …ç›®å¾Œè™•ç†">PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†</h3>
<p>è·Ÿçœ¾å¤šç¶²å‹äº¤æµä¸‹ä¾†ï¼Œç™¼ç¾æœ€å¤šäººåœ¨ä½¿ç”¨ç›£é€ å ±è¡¨VBAæˆ–æ–½å·¥æ—¥èªŒVBAæ™‚éƒ½æ˜¯å¡åœ¨å¥‘ç´„é …ç›®çš„å»ºç«‹ï¼Œç•¶å¥‘ç´„é …ç›®ç„¡æ³•æ­£å¸¸å»ºç«‹æ™‚ï¼Œç¢ºå¯¦å°æ–¼æ•´å€‹å ±è¡¨å°±æœƒæ˜¯ä¸€å¤§é˜»ç¤™ï¼Œå› æ­¤æˆ‘é‡å°<strong>å…¬å…±å·¥ç¨‹</strong>çš„é ç®—æ›¸æœ‰åšäº†ä¸€å€‹å¾Œè™•ç†çš„è½‰æ›å·¥å…·(XMLåˆ°XLS)ï¼Œä¹‹å¾Œå†å°‡è½‰æ›æ‰€å¾—çš„è³‡æ–™è²¼åˆ°è‡ªè¨‚çš„VBAå·¥å…·å³å¯æ­£å¸¸ä½¿ç”¨ã€‚</p>
<p>è©³æƒ…è«‹åƒè€ƒ <a
href="https://hankvba.blogspot.com/2024/02/excel-vba-pcces.html">ExcelVBA@PCCESå¥‘ç´„é …ç›®å¾Œè™•ç†å·¥å…·</a></p>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>ç›£é€ å ±è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-æ•¸é‡å¡«å¯«</title>
    <url>/posts/2699779571/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>ç›£é€ å ±è¡¨çš„æ•¸é‡å¡«å¯«ç‚º<strong>æ–½å·¥ç´€éŒ„</strong>æ™‚æœ€é‡è¦çš„åŸºæœ¬åŠŸï¼Œå¡«å¯«æ–¹å¼å¯åˆ†ç‚ºä»¥å„²å­˜æ ¼å¡«å¯«ã€ä½¿ç”¨è€…è¡¨å–®å¡«å¯«ï¼Œå¦‚æœæŒç®¡å·¥åœ°ç¾å ´çš„å·¥åœ°ä¸»ä»»å°è³‡è¨Šæ¯”è¼ƒä¸äº†è§£çš„ï¼Œä¹Ÿå¾ˆæœ‰å¯èƒ½æœƒå°‡å…§å®¹å¯«åœ¨ç´™æœ¬æˆ–ç™½æ¿ä¸Šæ‹ç…§ä¸Šå‚³ç¾¤çµ„å›å ±ï¼Œå†ç”±å…§æ¥­å·¥ç¨‹äººå“¡é€²è¡Œè³‡æ–™ç™»æ‰“ï¼Œç„¡è«–å“ªç¨®æ–¹å¼ï¼Œå¡«å¯«å…§å®¹éƒ½é‚„æ˜¯ä»¥å¥‘ç´„é …ç›®ç‚ºä¾æ“šï¼Œåªåœ¨æ•¸é‡éƒ¨åˆ†åšç¢ç£¨è€Œå·²ã€‚</p>
<p>å¥‘ç´„é …ç›®ä»¥å¯é‡åŒ–å‹æ…‹ã€ä¸€å¼å‹æ…‹ã€ç™¾åˆ†æ¯”å‹æ…‹ç‚ºä¸»ï¼Œé€™éƒ¨åˆ†è«‹åƒè€ƒå‰æ–‡ï¼Œä¸å†å¦å¤–é—¡è¿°ï¼Œæœ¬ç¯‡å…§å®¹ä¸»è¦ä»‹ç´¹å¡«å¯«æ™‚é€é<strong>å–®å…ƒ</strong>çš„æ¦‚å¿µé€²è¡Œ<strong>çµ„åˆé …ç›®</strong>çš„éç¨‹ï¼Œç•¶å…§å®¹ä»¥å–®å…ƒé€²è¡Œæ™‚ï¼Œé™¤äº†å·¥åœ°ä¸»ä»»çš„å›å ±æœƒæ¯”è¼ƒæ˜ç¢ºï¼ŒåŒæ™‚ä¹Ÿå¯ä»¥é‡å°å–®å…ƒçš„é€²è¡Œè¼”ä»¥ç›¸å°çš„æª¢æ ¸æ©Ÿåˆ¶èˆ‡é˜²å‘†æ©Ÿåˆ¶ï¼Œæœƒçœä¸‹å¾ˆå¤šéº»ç…©ã€‚</p>
<span id="more"></span>
<h2 id="å¡«å¯«æ–¹å¼">âœ’ï¸å¡«å¯«æ–¹å¼</h2>
<h3 id="å„²å­˜æ ¼å¡«å¯«">å„²å­˜æ ¼å¡«å¯«</h3>
<p>å„²å­˜æ ¼å¯èƒ½æ˜¯æ–‡å­—ã€æ•¸å­—ã€æ—¥æœŸ...ç­‰ï¼Œé™¤éæœ‰å…ˆä¿®æ”¹å„²å­˜æ ¼æ ¼å¼ï¼Œå¦å‰‡ä»–æœƒæ ¹æ“šç•¶ä¸‹çš„ç‹€æ³è‡ªå‹•åˆ¤æ–·è¦ä»¥å“ªç¨®æ–¹å¼å­˜åœ¨ï¼Œé€™é€šå¸¸æœƒé€ æˆä¸€äº›å¥‡æ€ªçš„å•é¡Œï¼Œä¾‹å¦‚åŸæœ¬è¼¸å…¥æ—¥æœŸ2023/2/5é¡¯ç¤ºå»è®Šæˆ44962ï¼Œé‚„æœ‰è¼¸å…¥æ‰‹æ©Ÿè™Ÿç¢¼çš„æ™‚å€™ï¼Œæœ€å‰é¢çš„0æœƒè¢«å»æ‰ï¼Œæ­¤æ™‚å°±éœ€è¦å°‡æ•¸å­—è®Šæˆå­—ä¸²(åœ¨æ‰‹æ©Ÿè™Ÿç¢¼æœ€å‰é¢æ‰“ä¸Š')æ‰èƒ½æ­£ç¢ºé¡¯ç¤ºã€‚</p>
<p>å³ä¾¿å¯ä»¥å°‡å„²å­˜æ ¼çš„æ ¼å¼å•é¡Œæ’é™¤ï¼Œå»ºè­°è¤‡é›œè³‡æ–™é‚„æ˜¯<strong>ä¸è¦è®“ä½¿ç”¨è€…ç›´æ¥ç”¨å„²å­˜æ ¼é€²è¡Œå¡«å¯«</strong>ï¼Œä½ æ°¸é ä¸çŸ¥é“ä½¿ç”¨è€…ä»–å€‘æœƒæ€éº¼äº‚çµ¦è³‡æ–™ï¼Œå¾ŒçºŒçš„è³‡æ–™å†åˆ©ç”¨æœƒæœ‰å¾ˆå¤šé™åˆ¶ã€‚</p>
<h3 id="ä½¿ç”¨è€…è¡¨å–®å¡«å¯«">ä½¿ç”¨è€…è¡¨å–®å¡«å¯«</h3>
<p>ä½¿ç”¨è€…è¡¨å–®ç‚ºVBAæ‰€æä¾›çš„ä»‹é¢ï¼Œé€éæ‹–æ›³çš„æ–¹å¼å°‡æ§åˆ¶é …æ”¾å…¥è¡¨å–®ç•«é¢ï¼Œä¸¦ä¸”é‡å°å„æ§åˆ¶é …çš„äº‹ä»¶é€²è¡Œé‚è¼¯åˆ¤æ–·èˆ‡å¾ŒçºŒè™•ç†ï¼Œéœ€è¦ä¸€é»VBAçš„åŸºæœ¬åŠŸæ‰æœ‰è¾¦æ³•æŒæ¡ï¼Œä»¥ä¸‹ä»‹ç´¹ç”¨çš„åˆ°çš„æ§åˆ¶é …ã€äº‹ä»¶åç¨±ã€ç”¨é€”èªªæ˜ï¼Œé—œæ–¼ä½¿ç”¨è€…è¡¨å–®çš„æ•™å­¸å†å¦é–‹ä¸€ç¯‡å°ˆæ–‡èªªæ˜ã€‚</p>
<table>
<thead>
<tr class="header">
<th>æ§åˆ¶é …ç›®</th>
<th>ç”¨é€”èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lable</td>
<td>é¡¯ç¤ºå…§å®¹</td>
</tr>
<tr class="even">
<td>TextBox</td>
<td>æä¾›ä½¿ç”¨è€…å¡«å¯«å…§å®¹</td>
</tr>
<tr class="odd">
<td>ComboBox</td>
<td>æä¾›æ—¢æœ‰å…§å®¹è®“ä½¿ç”¨è€…é¸æ“‡</td>
</tr>
<tr class="even">
<td>CheckBox</td>
<td>è¨»è¨˜åŠŸèƒ½æ˜¯å¦é€²è¡Œ</td>
</tr>
<tr class="odd">
<td>CommandButton</td>
<td>åŸ·è¡ŒåŠŸèƒ½</td>
</tr>
</tbody>
</table>
<p>å¥½è™•æ˜¯å¯ä»¥æœ‰æ•ˆæ§åˆ¶ä½¿ç”¨è€…å¡«å¯«å…§å®¹çš„æ­£ç¢ºæ€§ï¼Œå¾ŒçºŒè³‡æ–™å†åˆ©ç”¨æ™‚æ¯”è¼ƒä¸æœƒæœ‰å›°æ“¾ï¼Œç›¡å¯èƒ½åœ¨æ”¶é›†è¤‡é›œè³‡æ–™çš„éç¨‹éƒ½æ¡ç”¨é€™ç¨®æ–¹å¼ï¼Œ<strong>ç°¡å–®è³‡æ–™</strong>é‚„æ˜¯å¯ä»¥é€éç›´æ¥å¡«å¯«å„²å­˜æ ¼å®Œæˆæ²’æœ‰é—œä¿‚ã€‚</p>
<figure>
<img src="2.png" alt="Fig1. å¡«å¯«æ–½ä½œè³‡æ–™ä»‹é¢" />
<figcaption aria-hidden="true">Fig1. å¡«å¯«æ–½ä½œè³‡æ–™ä»‹é¢</figcaption>
</figure>
<h3 id="ç´™æœ¬å¡«å¯«">ç´™æœ¬å¡«å¯«</h3>
<p>ç•¶å·¥ç¨‹è³‡æ–™å¤§å¤šéƒ½ä»¥ç´™æœ¬é€²è¡Œæ™‚ï¼Œå¦‚æœè¦é€²è¡Œçµ±è¨ˆåˆ†ææ™‚æœƒæ¶ˆè€—å¾ˆå¤šäººåŠ›ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼EXCELé€™é¡çš„è©¦ç®—è¡¨æœƒè¢«ç™¼å±•å‡ºä¾†çš„åŸå› ï¼Œä¹Ÿå› æ­¤ç´™æœ¬è³‡æ–™è½‰æ›å°æ–¼è³‡æ–™é›»è…¦åŒ–æœƒæ˜¯ä¸€ä»¶å¾ˆç—›è‹¦çš„äº‹æƒ…ï¼Œæ¯æ¬¡çš„è³‡æ–™æ¬é·éƒ½å¯èƒ½æœƒæœ‰è³‡æ–™ä¸Ÿå¤±è·Ÿè³‡æ–™èª¤ç¹•çš„å¯èƒ½ï¼Œä½†ç‡Ÿå»ºç”¢æ¥­é€™æ¨£çš„æƒ…æ³å¯èªªæ˜¯å¾ˆå¸¸è¦‹ã€‚</p>
<p>å°æ–¼ä¸å¤ªæœƒä½¿ç”¨é›»è…¦çš„å·¥åœ°äººå“¡è€Œè¨€ï¼Œäººäººæœ‰ä¸€éš»æœ‰ç¶²è·¯çš„æ‰‹æ©Ÿï¼Œä¹Ÿæ˜¯æ»¿åˆæƒ…åˆç†çš„ï¼Œåªè¦æœ‰ç¶²è·¯å°±å¯ä»¥<strong>å°‡æ‰‹æ©Ÿä½œç‚ºè¡¨å–®çš„å¡«å¯«åª’ä»‹</strong>å…ˆé€åˆ°é›²ç«¯ä¸Šé¢ï¼Œå†ç”±å…§æ¥­äººå“¡å°‡è³‡æ–™å½™æ•´å‡ºä¾†ï¼Œå­—å¤ªå°å¯ä»¥ç”¨å¹³æ¿é›»è…¦å…‹æœï¼Œç”šè‡³ç”¨éŸ¿æ‡‰å¼ç¶²ç«™çš„æ–¹å¼é€²è¡Œèª¿æ•´ï¼Œè³‡æ–™èƒ½å¤ æ¸›å°‘ä¸€æ¬¡æ¬é·å°æ–¼å¾ŒçºŒéƒ½æœƒæ˜¯ä¸€ä»¶å¥½äº‹ã€‚</p>
<figure>
<img src="3.png" alt="Fig2. Googleè¡¨å–®+Sheets" />
<figcaption aria-hidden="true">Fig2. Googleè¡¨å–®+Sheets</figcaption>
</figure>
<h2 id="å¥‘ç´„é …ç›®">ğŸ“”å¥‘ç´„é …ç›®</h2>
<h3 id="ä¸€èˆ¬é …ç›®">ä¸€èˆ¬é …ç›®</h3>
<p>é€éç›´æ¥æ¡ç”¨å¥‘ç´„é …ç›®ä¹‹å¯é‡åŒ–å‹æ…‹ã€ä¸€å¼å‹æ…‹é€²è¡Œå¡«å¯«ï¼Œç™¾åˆ†æ¯”å‹æ…‹å‰‡å¾ŒçºŒå ±è¡¨ç”¢è£½æ™‚æ ¹æ“šæ¯”ä¾‹é€²è¡Œæ›ç®—ã€‚</p>
<p><a
href="https://www.hanksvba.com/posts/3212778286/">ç›£é€ å ±è¡¨-æ•¸é‡è¨ˆç®—-å¼•ç”¨ä¾†æº</a></p>
<h3 id="çµ„åˆé …ç›®">çµ„åˆé …ç›®</h3>
<p>åœ¨é€²è¡Œç¶“è²»ä¼°ç®—æ™‚ï¼Œæ•¸é‡è¨ˆç®—è¡¨çš„ç”¢è£½ç‚ºé™ä½éŒ¯èª¤ï¼Œé€šå¸¸æœƒçµ¦åœ–èªªä¸Šå‡ºç¾çš„çµ„åˆæ§‹ä»¶é€²è¡Œç·¨è™Ÿï¼Œå°æ–¼å¸¶ç‹€å·¥ç¨‹å‰‡æœƒæœ‰æ¯é€²è¡Œç±³çš„æ¦‚å¿µï¼Œå› ç‚ºä¸ç®¡åœ¨å“ªå€‹æ¨è™Ÿå…¶å¯¦éƒ½é•·å¾—å·®ä¸å¤šï¼Œåªè¦ç®—å‡ºæ¯é€²è¡Œç±³æœ‰å¤šå°‘ææ–™ï¼Œè¨ˆç®—æ™‚ä¹˜ä¸Šç¸½é•·åº¦å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p>
<blockquote>
<p>å–®å…ƒæ§‹ä»¶</p>
</blockquote>
<p>å»ºç¯‰å·¥ç¨‹å¸¸è¦‹çš„æ§‹ä»¶æ˜¯æŸ±æ¢æ¿ç‰†ï¼Œæ©‹æ¢å·¥ç¨‹å¸¸è¦‹çš„æ§‹ä»¶æ˜¯å¢©æŸ±ã€ç¯€å¡Šï¼Œ<strong>å–®å…ƒ</strong>å¯ä»¥è‡ªè¡Œå®šç¾©ï¼Œä¸»è¦æ˜¯ç‚ºäº†æ–¹ä¾¿æ’¿æ–™åŠå·¥ç­èªªæ˜è€Œå·²ã€‚</p>
<blockquote>
<p>æ¯é€²è¡Œç±³</p>
</blockquote>
<p>çŒæº‰æ’æ°´å·¥ç¨‹æœƒä»¥çŸ©å‹æºä½œç‚ºæ¯é€²è¡Œç±³çš„æ’¿æ–™æ¨™æº–ï¼Œé“è·¯å·¥ç¨‹å‰‡æœƒä»¥é‹ªé¢å‰–é¢æˆ–æ“‹åœŸæ§‹é€ ç‰©(é‡åŠ›å¼æ“‹åœŸç‰†ã€æ‡¸è‡‚å¼æ“‹åœŸç‰†...ç­‰)ç‚ºæ¯é€²è¡Œç±³çš„æ’¿æ–™æ¨™æº–ï¼Œæ•´é«”æœƒè€ƒæ…®æ¼¸è®Šæ®µï¼Œæ¡ç”¨å¹³å‡å€¼è¨ˆç®—ï¼Œå·¥ç¨‹ç´°ç¯€å¦‚è¦å†é€²è¡Œæ‹†åˆ†ï¼Œå‰‡åˆæœƒåˆ†æˆè¥¯åº•ã€æ¸ åº•ã€é‹¼ç­‹çµ„ç«‹ã€å·¦å³ç‰†èº«...ç­‰é€²è¡Œæ¯é€²è¡Œç±³çš„å¡«å¯«ä¾æ“šã€‚</p>
<h2 id="æª¢æ ¸æ©Ÿåˆ¶">â˜‘ï¸æª¢æ ¸æ©Ÿåˆ¶</h2>
<p>å°‡åœ–é¢å…§å®¹è½‰ç‚ºå–®å…ƒå»é€²è¡Œåˆ†æï¼Œæœ€å¤§çš„å¥½è™•å°±æ˜¯å¯ä»¥é€²è¡Œå–®å…ƒçµ±è¨ˆäº†è§£èˆ‡æ•¸é‡è¨ˆç®—è¡¨ä¹‹é–“çš„å·®ç•°ã€é€éè¨ˆç®—æ¨è™Ÿå€æ®µç¹ªè£½æ¢ç‹€åœ–ç†è§£ç›®å‰æ–½å·¥å·¥åºåŠé æ¸¬ä¸‹éšæ®µæ–½ä½œæ¨è™Ÿã€é”æˆæ¨è™Ÿé‡è¦†å¡«å¯«çš„é˜²å‘†ï¼Œæ›´é‡è¦çš„æ˜¯è—‰ç”±å·¥é …æ›´æ­£å¯ä»¥æ‰¹æ¬¡èª¿æ•´å·²ç¶“ç´€éŒ„çš„å…§å®¹ï¼Œå³æ™‚ä¿®æ­£å–®å…ƒçš„æ•¸é‡è¨ˆç®—ã€‚</p>
<h3 id="å–®å…ƒçµ±è¨ˆ">å–®å…ƒçµ±è¨ˆ</h3>
<p>ç•¶ç™¼ç”Ÿå–®å…ƒå¡«å¯«å®Œç•¢å»èˆ‡å¥‘ç´„æ•¸é‡ä¸ç¬¦æ™‚ï¼Œå¯ä»¥ä½¿ç”¨å–®å…ƒçµ±è¨ˆï¼Œå…ˆå°‡æ‰€æœ‰å–®å…ƒåç¨±ææ–™é€²è¡Œ<strong>ç¸½è¨ˆ</strong>ï¼Œç¢ºèªå¥‘ç´„æ•¸é‡èˆ‡å–®å…ƒçµ±è¨ˆç¸½è¨ˆæ‰€å¾—ä¹‹ç¸½æ•¸é‡æ˜¯å¦ç›¸ç¬¦ï¼Œå¦‚æœä¸ç›¸ç¬¦å‰‡æ˜¯ç•¶åˆåœ¨åˆ‡åˆ†å–®å…ƒçš„æ™‚å€™å°±å·²ç¶“å­˜åœ¨éŒ¯èª¤ã€‚</p>
<p>ç¢ºå®šæ˜¯åˆ‡åˆ†å–®å…ƒçš„æ™‚å€™çš„éŒ¯èª¤å¾Œï¼Œå¯ä»¥æ ¹æ“šä¸åŒå–®å…ƒåç¨±ä½œç‚ºåˆ†é¡ï¼Œå°‡è©²<strong>åˆè¨ˆ</strong>å…§å®¹ç¸½æ•¸é‡èˆ‡æ•¸é‡è¨ˆç®—è¡¨çš„ç›¸é—œå·¥é …åç¨±<strong>é€è¡Œåˆ—è¡¨</strong>é€²è¡Œæ¯”å°ï¼Œå¾æœ€å°å–®å…ƒé€²è¡ŒéŒ¯èª¤æŸ¥æ‰¾ï¼Œé€šå¸¸éƒ½æœƒæŠ“åˆ°ä¸€äº›å•é¡Œï¼Œå¯ä»¥é€²è¡Œå¾ŒçºŒçš„å·¥é …æ›´æ­£ã€‚</p>
<figure>
<img src="4.png" alt="Fig3. å–®å…ƒçµ±è¨ˆç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig3. å–®å…ƒçµ±è¨ˆç¯„ä¾‹</figcaption>
</figure>
<h3 id="å·¥é …æ›´æ­£">å·¥é …æ›´æ­£</h3>
<p>å·¥é …æ›´æ­£å‰‡æ˜¯åˆ©ç”¨å–®å…ƒåç¨±æ–¼æ–½å·¥ç´€éŒ„è¡¨ä¸Šçš„è¨»è¨˜ï¼Œå°‡æ­£ç¢ºçš„å–®å…ƒææ–™å›æ¨è‡³æ–½å·¥ç´€éŒ„è¡¨ä¸Šçš„æ•¸é‡ï¼Œè—‰æ­¤æ›´æ–°è³‡è¨Šä¸¦æç¤ºä½¿ç”¨è€…æ›´æ­£æ˜ç´°ã€‚</p>
<p>æœ‰äº›å…§æ¥­äººå“¡æœƒæ“”å¿ƒå·¥é …æ›´æ­£å¾Œæœƒå½±éŸ¿å·²ç¶“è£½ä½œçš„æ—¥å ±å…§å®¹ï¼Œå¸Œæœ›å¯ä»¥é€ééŒ¯èª¤æš«å­˜çš„æ–¹å¼ï¼Œåœ¨æœªä¾†å¡«å¯«æ–°çš„æ—¥å ±æ™‚åšäº›å¾®çš„å¢åˆªä¾†èª¿æ•´ï¼Œè¦é»é¸é€™é¡†æŒ‰éˆ•æ™‚è¦æ…æ€ï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥åœ¨å·¥ç¨‹å‰›é–‹å§‹å°±å…ˆå…¨éƒ¨ç´€éŒ„ä¸Šå»è©¦è©¦ï¼Œæœ‰ç™¼ç¾èˆ‡å¥‘ç´„æ•¸é‡ä¸ç¬¦æ™‚é¦¬ä¸Šæ›´æ­£ï¼Œä½†è‹¥æ˜¯é‡åˆ°è®Šæ›´è¨­è¨ˆå°±æ²’è½ï¼Œè®Šæ›´è¨­è¨ˆé‚„æ˜¯æœ‰å¯èƒ½æœƒæ›´æ”¹åˆ°å–®å…ƒææ–™ã€‚</p>
<figure>
<img src="8.jpg" alt="Fig4. å·¥é …æ›´æ­£ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig4. å·¥é …æ›´æ­£ç¯„ä¾‹</figcaption>
</figure>
<h3 id="æ¢ç‹€åœ–æŸ¥çœ‹">æ¢ç‹€åœ–æŸ¥çœ‹</h3>
<p>é€éæ–½å·¥é€²ç¨‹çš„æ‹†åˆ†ã€é€²è¡Œæ¨è™Ÿå€é–“çš„ç¹ªè£½ï¼Œæ­é…æ¨è™Ÿé˜²å‘†æ©Ÿåˆ¶ï¼Œèƒ½å¤ æœ‰æ•ˆæª¢æ ¸æ–½å·¥é€²ç¨‹çš„åˆç†æ€§ï¼Œé€šå¸¸ä»¥çŒæº‰æ’æ°´å·¥ç¨‹ç‚ºä¾‹ï¼Œå·¥åºç‚ºè¥¯åº•&gt;é‹¼ç­‹çµ„ç«‹&gt;å¤§åº•&gt;å·¦å³ç‰†èº«ï¼Œæ­¤å¤–å› æ‡‰æ–½å·¥è¦ç¯„è¦æ±‚éœ€è¦ä»¥éš”æ®µæ–½å·¥é€²è¡Œï¼Œä¸¦é ç•™æ¨¡æ¿æ‹†é™¤æ™‚é–“ï¼Œå¾æ–½å·¥é€²åº¦æ¢ç‹€åœ–ä¸Šæ‰€ç™»è¼‰çš„æ—¥æœŸèˆ‡å–®å…ƒåç¨±ä¾¿å¯æŒæ¡æ•´é«”æ–½å·¥é †åºã€‚</p>
<figure>
<img src="6.png" alt="Fig5. æ¢ç‹€åœ–ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig5. æ¢ç‹€åœ–ç¯„ä¾‹</figcaption>
</figure>
<h3 id="æ¨è™Ÿé˜²å‘†">æ¨è™Ÿé˜²å‘†</h3>
<p>å¸¶ç‹€å·¥ç¨‹æœ€å®¹æ˜“å‡ºç¾çš„å•é¡Œå°±æ˜¯é‡è¤‡ç´€éŒ„æ¨è™Ÿå€é–“ï¼Œåœ¨å–®å…ƒçµ±è¨ˆçš„æ™‚åªèƒ½çŸ¥é“ç›®å‰ç¸½é•·åº¦ç‚ºå¤šå°‘ï¼Œä½†å»ç„¡æ³•çŸ¥é“å€é–“æ˜¯å¦é‡ç–Šï¼Œå°¤å…¶ç•¶å·¥åºç›¸ç•¶è¤‡é›œæ™‚ï¼Œæ²’æœ‰å°‡å€é–“é€²è¡Œå¯è¦–åŒ–æ›´æ˜¯é›£ä»¥åˆ¤åˆ¥ï¼Œå› æ­¤æœ€æ–¹ä¾¿çš„æ–¹å¼ä¾¿æ˜¯åœ¨<strong>å¡«å¯«æ¨è™Ÿ</strong>æ™‚å°±å…ˆåˆ¤å®šæ˜¯å¦æœ‰é‡è¤‡ï¼Œé‡è¤‡çš„åŸå› å¯èƒ½æ˜¯èµ·å§‹æ¨è™Ÿä½æ–¼æ—¢è¨­æ¨è™Ÿå€é–“(A)ã€çµæŸæ¨è™Ÿä½æ–¼æ—¢è¨­æ¨è™Ÿå€é–“(B)ã€èµ·è¨–æ¨è™ŸåŒ…å«æ—¢è¨­æ¨è™Ÿå€é–“(C)ã€‚</p>
<figure>
<img src="7.jpg" alt="Fig6. æ¨è™Ÿå€é–“è¡çªæƒ…å¢ƒ" />
<figcaption aria-hidden="true">Fig6. æ¨è™Ÿå€é–“è¡çªæƒ…å¢ƒ</figcaption>
</figure>
<blockquote>
<p>ç¨‹å¼ç¢¼é‹ä½œä¸Šæœƒå…ˆæŠŠæ¨è™Ÿè½‰æˆæ•¸å­—å†é€²è¡Œå€é–“åˆ¤æ–·ï¼Œç¯€éŒ„è‡ªæˆ‘çš„Github</p>
</blockquote>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Function</span> TranLoc(<span class="keyword">ByVal</span> Data <span class="keyword">As</span> <span class="type">String</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;æ¨è™Ÿå‹æ…‹è½‰æˆå¯è¨ˆç®—ä¹‹æ¨è™Ÿ</span></span><br><span class="line"></span><br><span class="line">tmp = split(Data, <span class="string">&quot;+&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> UBound(tmp) = -<span class="number">1</span> <span class="built_in">Or</span> Data = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Function</span> <span class="comment">&#x27; TranLoc = CDbl(Data): Exit Function</span></span><br><span class="line"></span><br><span class="line">tloc = tmp(<span class="number">0</span>) <span class="comment">&#x27;åƒä½æ•¸</span></span><br><span class="line">dloc = tmp(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> dloc <span class="built_in">Like</span> <span class="string">&quot;*(*&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    tmp2 = split(dloc, <span class="string">&quot;(&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> tmp2(<span class="number">0</span>) <span class="built_in">Like</span> <span class="string">&quot;*.*&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">        tmp3 = split(tmp2(<span class="number">0</span>), <span class="string">&quot;.&quot;</span>)</span><br><span class="line">        dloc = tmp3(<span class="number">0</span>) + tmp3(<span class="number">1</span>) / <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">    </span><br><span class="line">        dloc = tmp2(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> dloc &gt; <span class="number">1000</span> <span class="keyword">Then</span> <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> Len(tloc)</span><br><span class="line"></span><br><span class="line">    loc_ch = <span class="keyword">mid</span>(tloc, i, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">If</span> IsNumeric(loc_ch) <span class="keyword">Then</span> ref = ref &amp; loc_ch</span><br><span class="line"></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line">TranLoc = <span class="built_in">CDbl</span>(ref) * <span class="number">1000</span> + <span class="built_in">CDbl</span>(dloc)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> IsRecLocPass(<span class="keyword">ByVal</span> rec_loc <span class="keyword">As</span> <span class="type">String</span>, <span class="keyword">ByVal</span> item_loc <span class="keyword">As</span> <span class="type">String</span>) <span class="comment">&#x27;, ByVal r As Integer)</span></span><br><span class="line"></span><br><span class="line">IsRecLocPass = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> myfunc <span class="keyword">As</span> <span class="built_in">New</span> clsMyfunction</span><br><span class="line"></span><br><span class="line">tmp = split(rec_loc, <span class="string">&quot;~&quot;</span>)</span><br><span class="line"></span><br><span class="line">rec_sloc = myfunc.TranLoc(tmp(<span class="number">0</span>))</span><br><span class="line">rec_eloc = myfunc.TranLoc(tmp(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">tmp2 = split(item_loc, <span class="string">&quot;~&quot;</span>)</span><br><span class="line"></span><br><span class="line">item_sloc = myfunc.TranLoc(tmp2(<span class="number">0</span>))</span><br><span class="line">item_eloc = myfunc.TranLoc(tmp2(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> item_sloc &gt;= rec_sloc <span class="built_in">And</span> item_sloc &lt; rec_eloc <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    err_prompt = <span class="string">&quot;ç¬¬&quot;</span> &amp; r &amp; <span class="string">&quot;åˆ—è¡çª=&gt;ç´€éŒ„èµ·é»ã€&quot;</span> &amp; tmp2(<span class="number">0</span>) &amp; <span class="string">&quot;ã€‘å·²åŒ…å«æ–¼æœ¬æ¬¡å¡«å ±ã€&quot;</span> &amp; rec_loc &amp; <span class="string">&quot;ã€‘&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> err_prompt &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> p = p &amp; err_prompt &amp; vbNewLine</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> item_eloc &gt; rec_sloc <span class="built_in">And</span> item_eloc &lt;= rec_eloc <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    err_prompt = <span class="string">&quot;ç¬¬&quot;</span> &amp; r &amp; <span class="string">&quot;åˆ—è¡çª=&gt;ç´€éŒ„çµ‚é»ã€&quot;</span> &amp; tmp2(<span class="number">1</span>) &amp; <span class="string">&quot;ã€‘å·²åŒ…å«æ–¼æœ¬æ¬¡å¡«å ±ã€&quot;</span> &amp; rec_loc &amp; <span class="string">&quot;ã€‘&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> err_prompt &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> p = p &amp; err_prompt &amp; vbNewLine</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> rec_sloc &gt;= item_sloc <span class="built_in">And</span> rec_sloc &lt; item_eloc <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    err_prompt = <span class="string">&quot;ç¬¬&quot;</span> &amp; r &amp; <span class="string">&quot;åˆ—è¡çª=&gt;å¡«å ±èµ·é»ã€&quot;</span> &amp; tmp(<span class="number">0</span>) &amp; <span class="string">&quot;ã€‘å·²åŒ…å«æ–¼èˆŠæœ‰ç´€éŒ„ã€&quot;</span> &amp; item_loc &amp; <span class="string">&quot;ã€‘&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> err_prompt &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> p = p &amp; err_prompt &amp; vbNewLine</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> rec_eloc &gt; item_sloc <span class="built_in">And</span> rec_eloc &lt;= item_eloc <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    err_prompt = <span class="string">&quot;ç¬¬&quot;</span> &amp; r &amp; <span class="string">&quot;åˆ—è¡çª=&gt;å¡«å ±çµ‚é»ã€&quot;</span> &amp; tmp(<span class="number">1</span>) &amp; <span class="string">&quot;ã€‘å·²åŒ…å«æ–¼èˆŠæœ‰ç´€éŒ„ã€&quot;</span> &amp; item_loc &amp; <span class="string">&quot;ã€‘&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">If</span> err_prompt &lt;&gt; <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> p = p &amp; err_prompt &amp; vbNewLine</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> p = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span> IsRecLocPass = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>ç›£é€ å ±è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¸±æ–·é¢æ’æ——æ–‡å­—é‡ç–Šå•é¡Œ</title>
    <url>/posts/2767553795/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<h3 id="ç¸±æ–·é¢ç™¼å±•ä¾†æº">ğŸ‘‰ç¸±æ–·é¢ç™¼å±•ä¾†æº</h3>
<p><a
href="https://hankvba.blogspot.com/2018/03/autocad-vba.html">AutoCAD VBA
ç¸±æ–·é¢ç¹ªè£½è‡ªå‹•åŒ–</a></p>
<h3 id="é–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ">ğŸé–‹ç™¼éç¨‹ä¸­çš„å°å•é¡Œ</h3>
<p>ç¸±æ–·é¢ç¹ªè£½æ™‚æœƒé‡å°éœ€è¦æ–‡å­—èªªæ˜çš„æ¨è™Ÿé€²è¡Œæ’æ——ç¹ªè£½ï¼Œå¯èƒ½æœƒé€ æˆæ’æ——æ–‡å­—å‡ºç¾é‡ç–Šçš„åŸå› æœ‰å…©å€‹</p>
<ol type="1">
<li>æ’æ——èªªæ˜æ¨è™Ÿè·é›¢å¤ªè¿‘(0+200ã€0+205)</li>
<li>ç¹ªè£½Xè»¸æ¯”ä¾‹å¤ªå°(1:1000 vs 1:5000)</li>
</ol>
<p>ç¹ªè£½éç¨‹æœƒè€ƒé‡åœ–ç´™è¼¸å‡ºçš„èˆ’é©åº¦ï¼Œæœ€å°å­—é«˜é€šå¸¸æœƒä»¥<strong>3.4.5</strong>ç‚ºåŸå‰‡ï¼Œæ–‡å­—èªªæ˜æœƒå›ºå®šä»¥30åº¦å‘ˆç¾</p>
<blockquote>
<p>ç•¶è·é›¢å¤ªè¿‘æ™‚å¯ä»¥é€éèª¿æ•´Xè»¸æ¯”ä¾‹è®“é–“è·æ‹‰é–‹ï¼Œæ©«å‘æœƒé‡ç–Šçš„æ™‚å€™å°±é€²è¡Œä¸Šä¸‹ä½ç§»ï¼Œæ–¹ä¾¿è®€è€…è§€çœ‹ã€‚</p>
</blockquote>
<p>å› æ­¤æœ¬ç¯‡å°±æ˜¯è¦é€éVBAæŠ“å–èªªæ˜æ–‡å­—çš„å¤–æ¡†åŠä¸‹ç·šï¼Œè‡ªå‹•èª¿æ•´æ–‡å­—é‡ç–Šå…§å®¹ï¼Œä»¥ä¸‹é€²è¡Œèªªæ˜:</p>
<span id="more"></span>
<hr />
<h2 id="ç¯„ä¾‹èªªæ˜">ğŸ“Œç¯„ä¾‹èªªæ˜</h2>
<figure>
<img src="image.png" alt="Fig1. æ’æ——æ–‡å­—èªªæ˜" />
<figcaption aria-hidden="true">Fig1. æ’æ——æ–‡å­—èªªæ˜</figcaption>
</figure>
<h2 id="æµç¨‹è§£èªª">ğŸ”·æµç¨‹è§£èªª</h2>
<p>ä¸€èˆ¬æ’æ——æ–‡å­—éƒ½æ˜¯å±¬æ–¼æ—‹è½‰è‡³ç¬¬ä¸€è±¡é™çš„å…§å®¹(0åº¦~90åº¦)</p>
<ol type="1">
<li>é€éCAD VBAå…§å»ºæŒ‡ä»¤GetBoundingBoxæ‰¾åˆ°é‚Šç•Œé»ã€‚</li>
<li>é€éå¹¾ä½•åœ–å½¢å­¸åŠä¸‰è§’å‡½æ•¸é—œä¿‚é€²è¡Œåˆ—å¼ã€‚</li>
<li>ç”¨ä¸€å…ƒäºŒæ¬¡è¯ç«‹æ–¹ç¨‹å¼è§£æåƒæ•¸ã€‚</li>
<li>ä»£å›åŸæœ¬ç¬¬ä¸€è±¡é™çš„æ­£ç¢ºé»ä½ã€‚</li>
<li>å¼•å…¥clsACADé€²è¡ŒLINEç‰©ä»¶ç¹ªè£½ã€‚</li>
</ol>
<hr />
<h2 id="å¹¾ä½•é—œä¿‚">ğŸŒŸå¹¾ä½•é—œä¿‚</h2>
<p><span class="math display">\[ Hcos\theta+Lsin\theta=Y_1-Y_0=const.
\]</span> <span class="math display">\[
Hsin\theta+Lcos\theta=X_1-X_0=const. \]</span></p>
<p>æ­£ç¢ºè§’é»:</p>
<table>
<thead>
<tr class="header">
<th>é»å</th>
<th>Xåº§æ¨™</th>
<th>Yåº§æ¨™</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>å·¦ä¸‹</td>
<td><span class="math display">\[ X_0+Hsin\theta \]</span></td>
<td><span class="math display">\[ Y_0 \]</span></td>
</tr>
<tr class="even">
<td>å³ä¸‹</td>
<td><span class="math display">\[ X_1 \]</span></td>
<td><span class="math display">\[ Y_1-Hcos\theta \]</span></td>
</tr>
<tr class="odd">
<td>å·¦ä¸Š</td>
<td><span class="math display">\[ X_0 \]</span></td>
<td><span class="math display">\[ Y_0+Hcos\theta \]</span></td>
</tr>
<tr class="even">
<td>å³ä¸Š</td>
<td><span class="math display">\[ X_1-Hsin\theta \]</span></td>
<td><span class="math display">\[ Y_1 \]</span></td>
</tr>
</tbody>
</table>
<figure>
<img src="SAMPLE.JPG" alt="Fig2. æ–‡å­—å¤–æ¡†ã€é»ä½å¹¾ä½•é—œä¿‚" />
<figcaption aria-hidden="true">Fig2. æ–‡å­—å¤–æ¡†ã€é»ä½å¹¾ä½•é—œä¿‚</figcaption>
</figure>
<hr />
<figure>
<img src="SAMPLE2.JPG" alt="Fig3. ä¸Šä¸‹åº•ç·šç¹ªè£½æˆæœ" />
<figcaption aria-hidden="true">Fig3. ä¸Šä¸‹åº•ç·šç¹ªè£½æˆæœ</figcaption>
</figure>
<h2 id="ç¨‹å¼ç¢¼">âš¡ç¨‹å¼ç¢¼</h2>
<h3 id="æ¨¡çµ„module">æ¨¡çµ„(module)</h3>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Sub</span> test_getBoundingBox()</span><br><span class="line"></span><br><span class="line">    <span class="comment">&#x27;é©ç”¨æ–¼ç¬¬ä¸€è±¡é™</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Dim</span> CAD <span class="keyword">As</span> <span class="built_in">New</span> clsACAD</span><br><span class="line">    <span class="keyword">Dim</span> L <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    <span class="keyword">Dim</span> H <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">Set</span> sset2 = CAD.CreateSSET()</span><br><span class="line">    <span class="keyword">Set</span> entobj = sset2(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    rotate_degree = entobj.Rotation * <span class="number">180</span> / <span class="number">3.14</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> entobj.GetBoundingBox(Min, Max)</span><br><span class="line">    </span><br><span class="line">    X0 = Min(<span class="number">0</span>)</span><br><span class="line">    Y0 = Min(<span class="number">1</span>)</span><br><span class="line">    X1 = Max(<span class="number">0</span>)</span><br><span class="line">    Y1 = Max(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> CAD.AddPoint(Min)</span><br><span class="line">    <span class="keyword">Call</span> CAD.AddPoint(Max)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;---ä¸€å…ƒäºŒæ¬¡è¯ç«‹æ–¹ç¨‹å¼---</span></span><br><span class="line">    </span><br><span class="line">    a1 = Sin(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    b1 = Cos(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    c1 = Y1 - Y0</span><br><span class="line">    </span><br><span class="line">    a2 = Cos(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    b2 = Sin(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    c2 = X1 - X0</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> SolveLinearEquations(a1, b1, c1, a2, b2, c2, L, H)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;------åº•ç·š------</span></span><br><span class="line">    </span><br><span class="line">    Xpt_LD = X0 + H * Sin(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    Ypt_LD = Y0</span><br><span class="line">    </span><br><span class="line">    Xpt_RD = X1</span><br><span class="line">    Ypt_RD = Y1 - H * Cos(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> CAD.AddLineCO(Xpt_LD, Ypt_LD, Xpt_RD, Ypt_RD)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&#x27;-------é ‚ç·š------</span></span><br><span class="line">    </span><br><span class="line">    Xpt_LU = X0</span><br><span class="line">    Ypt_LU = Y0 + H * Cos(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    </span><br><span class="line">    Xpt_RU = X1 - H * Sin(rotate_degree / <span class="number">180</span> * <span class="number">3.14</span>)</span><br><span class="line">    Ypt_RU = Y1</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">Call</span> CAD.AddLineCO(Xpt_LU, Ypt_LU, Xpt_RU, Ypt_RU)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> SolveLinearEquations(<span class="keyword">ByVal</span> a1 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> b1 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> c1 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> a2 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> b2 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByVal</span> c2 <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByRef</span> x <span class="keyword">As</span> <span class="type">Double</span>, <span class="keyword">ByRef</span> y <span class="keyword">As</span> <span class="type">Double</span>) <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line">    <span class="keyword">Dim</span> determinant <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">    </span><br><span class="line">    determinant = a1 * b2 - a2 * b1</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">If</span> determinant = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">        SolveLinearEquations = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">Else</span></span><br><span class="line">        x = (c1 * b2 - c2 * b1) / determinant</span><br><span class="line">        y = (a1 * c2 - a2 * c1) / determinant</span><br><span class="line">        SolveLinearEquations = <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ç‰©ä»¶é¡åˆ¥æ¨¡çµ„clsacad">ç‰©ä»¶é¡åˆ¥æ¨¡çµ„(clsACAD)</h3>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Private</span> mo <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Private</span> pa <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Public</span> acadDoc <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"><span class="keyword">Public</span> CADVer <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Class_Initialize()</span><br><span class="line"></span><br><span class="line">strCAD = <span class="string">&quot;AutoCAD.application&quot;</span></span><br><span class="line">CADVer = <span class="string">&quot;AUTOCAD&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Call</span> CADInit(strCAD)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CADInit(<span class="keyword">ByVal</span> strCAD <span class="keyword">As</span> <span class="type">String</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> acadApp = GetObject(, strCAD) <span class="comment">&#x27;æŸ¥çœ‹å®‰è£</span></span><br><span class="line"><span class="keyword">If</span> Err &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span> <span class="keyword">Set</span> acadApp = CreateObject(strCAD)</span><br><span class="line">acadApp.Visible = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> mo = acadApp.ActiveDocument.ModelSpace</span><br><span class="line"><span class="keyword">Set</span> pa = acadApp.ActiveDocument.PaperSpace</span><br><span class="line"><span class="keyword">Set</span> acadDoc = acadApp.ActiveDocument</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> CreateSSET(<span class="keyword">Optional</span> <span class="keyword">ByVal</span> sname <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;SS1&quot;</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> ftypetmp <span class="keyword">As</span> Variant = <span class="string">&quot;&quot;</span>, <span class="keyword">Optional</span> <span class="keyword">ByVal</span> fdatatmp <span class="keyword">As</span> Variant = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;****PorgeCADä¸­ä¼¼ä¹æ²’è¾¦æ³•åšåˆ°éæ¿¾çš„æ¢ä»¶?*****</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;0:object type</span></span><br><span class="line"><span class="comment">&#x27;2:object name</span></span><br><span class="line"><span class="comment">&#x27;8:layer name</span></span><br><span class="line"><span class="comment">&#x27;62:color number(0 to 256)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> FilterType() <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> FilterData() <span class="keyword">As</span> Variant</span><br><span class="line"></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span>: acadDoc.SelectionSets(sname).Delete: <span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> sset = acadDoc.SelectionSets.Add(sname)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> ftypetmp = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line"></span><br><span class="line">    sset.SelectOnScreen</span><br><span class="line">    </span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"></span><br><span class="line">    ft = Split(ftypetmp, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    fd = Split(fdatatmp, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">ReDim</span> FilterType(<span class="number">0</span> <span class="keyword">To</span> UBound(ft))</span><br><span class="line">    <span class="keyword">ReDim</span> FilterData(<span class="number">0</span> <span class="keyword">To</span> UBound(fd))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(ft)</span><br><span class="line">    </span><br><span class="line">        FilterType(i) = ft(i)</span><br><span class="line">        FilterData(i) = fd(i)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">Next</span></span><br><span class="line">    </span><br><span class="line">    sset.SelectOnScreen FilterType, FilterData</span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> CreateSSET = sset</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddPoint(pt) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer = <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span></span><br><span class="line">    <span class="keyword">Set</span> AddPoint = mo.AddPointEntity(tranPoint(pt))</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line">    <span class="keyword">Set</span> AddPoint = mo.AddPoint(tranPoint(pt))</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddLineCO(X1, Y1, X2, Y2) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> spt(<span class="number">2</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line"><span class="keyword">Dim</span> ept(<span class="number">2</span>) <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">spt(<span class="number">0</span>) = X1: spt(<span class="number">1</span>) = Y1</span><br><span class="line">ept(<span class="number">0</span>) = X2: ept(<span class="number">1</span>) = Y2</span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddLineCO = AddLine(spt, ept)</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> AddLine(spt, ept) <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> AddLine = mo.AddLine(tranPoint(spt), tranPoint(ept))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;=============transform ICAD about point and points======================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Function</span> tranPoint(<span class="keyword">ByVal</span> CADpt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> CADVer &lt;&gt; <span class="string">&quot;ICAD&quot;</span> <span class="keyword">Then</span> tranPoint = CADpt: <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Set</span> tranPoint = Library.CreatePoint(CADpt(<span class="number">0</span>), CADpt(<span class="number">1</span>), CADpt(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="å¾ŒçºŒåˆ©ç”¨">ğŸ‘‰å¾ŒçºŒåˆ©ç”¨</h2>
<p>ç¢ºèª<strong>ä¸‹ä¸€æ–‡å­—å¤–æ¡†é»</strong>æ˜¯å¦ä½æ–¼é€™æ¬¡æ–‡å­—æ¡†ä¸­ï¼Œé€²è¡Œé‡ç–Šæ–‡å­—åˆ¤è­˜ï¼Œå¦‚ä¸ç¬¦åˆå‰‡å†ä¸Šä¸‹ä½ç§»å³å¯ã€‚</p>
<figure class="highlight vb"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Function</span> checkPtFromBorders(midX,midY,BorderPTs) <span class="keyword">as</span> <span class="type">boolean</span></span><br><span class="line"></span><br><span class="line">Border_minX = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">0</span>))</span><br><span class="line">Border_minY = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">1</span>))</span><br><span class="line">Border_maxX = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">2</span>))</span><br><span class="line">Border_maxY = <span class="built_in">CDbl</span>(BorderPTs(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> midX &gt;= Border_minX <span class="built_in">And</span> midX &lt;= Border_maxX <span class="built_in">And</span> midY &gt;= Border_minY <span class="built_in">And</span> midY &lt;= Border_maxY <span class="keyword">Then</span></span><br><span class="line">    </span><br><span class="line">    checkPtFromBorders = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>AutoCAD VBA</tag>
        <tag>ProgeCAD VBA</tag>
      </tags>
  </entry>
  <entry>
    <title>æ˜æ¸ æ°´ç†è¨ˆç®—</title>
    <url>/posts/3021870975/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>æ˜æ¸ è¼¸æ°´æ¸ é“çš„è¨­è¨ˆé‡é»å¤§æ¦‚ç¾…åˆ—å¦‚ä¸‹å¹¾é»:</p>
<ol type="1">
<li>æ’æ°´æ¸ é“è¦æ³¨æ„æµé‡æ˜¯å¦å¯ä»¥æä¾›è¾²ç”°æ’æ°´10å¹´é‡ç¾æœŸè·1æ—¥æ’å‡ºã€‚</li>
<li>çŒæº‰æ¸ é“è¦ç¢ºèªçŒæº‰è¨ˆç•«æ‰€éœ€è¨ˆç•«æµé‡ã€‚</li>
<li>è¨­è¨ˆçš„æœ€å°å®¹è¨±æµé€Ÿä¸èƒ½ä½æ–¼æ°´è‰ç”Ÿé•·é€Ÿåº¦æˆ–æ·¤æ²™é€Ÿåº¦ã€‚</li>
<li>è¨­è¨ˆçš„æœ€å¤§å®¹è¨±æµé€Ÿä¸èƒ½é«˜æ–¼è¦ç¯„æ‰€é™åˆ¶çš„é€Ÿåº¦ã€‚</li>
<li>è¨­è¨ˆæ™‚éœ€æ³¨æ„ä¸èƒ½å¤ªæ¥è¿‘è‡¨ç•Œæµæ³ï¼Œå‹•æ°´å£“åŠ›å°æ§‹é€ ç‰©è¼ƒå®¹æ˜“ä¸ç©©å®šã€‚</li>
<li>æŒ‘é¸åˆå®œçš„å‡ºæ°´é«˜åº¦æé«˜å…¶ä»–å› ç´ æ‰€è‡´ä¹‹é¡å¤–æµé‡ã€‚</li>
<li>æª¢è¨å„ç”°å€æ‰€éœ€çŒæº‰æ°´é ­æ˜¯å¦è¶³å¤ ï¼Œç›¡é‡æ¸›å°‘åˆ¶æ°´æ±´ç‰ˆçš„ä½¿ç”¨ã€‚</li>
</ol>
<p>æœ‰é—œè¾²ç”°æ’æ°´çš„æµé‡å¯ä»¥åƒè€ƒ<strong>è¾²ç”°æ’æ°´å·¥ç¨‹è¦åŠƒè¨­è¨ˆåŸå‰‡åƒè€ƒæ‰‹å†Š(108ç‰ˆ)</strong>é€²è¡Œæ¨ç®—</p>
<blockquote>
<p>æ¼”ç®—æµç¨‹å¯ä»¥åˆ©ç”¨Pythonä¸­çš„Streamlitå¥—ä»¶é€²è¡Œï¼Œå¾<strong>åƒæ•¸è¨­å®š&gt;æª¢æ ¸æµç¨‹&gt;å ±è¡¨ç”¢è£½</strong>éƒ½äº¤çµ¦é›»è…¦</p>
</blockquote>
<span id="more"></span>
<h2 id="ä¸»è¦æ“ä½œç•«é¢">ä¸»è¦æ“ä½œç•«é¢</h2>
<figure>
<img src="Streamlit.JPG" alt="åœ–1.Streamlit æ“ä½œä»‹é¢" />
<figcaption aria-hidden="true">åœ–1.Streamlit æ“ä½œä»‹é¢</figcaption>
</figure>
<h2 id="è¨ˆç®—ä¾æ“š">è¨ˆç®—ä¾æ“š</h2>
<ol type="1">
<li>ä¸­åœ‹è¾²æ¥­å·¥ç¨‹æ‰‹å†Š-è¾²æ¥­æ°´åˆ©ä¹‹éƒ¨(ä¸‹ç¨±è¾²å·¥æ‰‹å†Š)</li>
<li>è¾²ç”°æ°´åˆ©æœƒæŠ€è¡“äººå“¡è¨“ç·´æ•™æçŒæº‰æ’æ°´å·¥ç¨‹é¡åˆè¨‚æœ¬(ä¸‹ç¨±åˆè¨‚æœ¬)</li>
</ol>
<hr />
<h2 id="åŸºæœ¬åƒæ•¸">åŸºæœ¬åƒæ•¸</h2>
<table>
<thead>
<tr class="header">
<th>åè©</th>
<th>ä»£è™Ÿ</th>
<th>æ•¸å€¼</th>
<th>å–®ä½</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è¨ˆç•«æµé‡</td>
<td>q</td>
<td>{q}</td>
<td>cms</td>
</tr>
<tr class="even">
<td>æ›¼å¯§ä¿‚æ•¸</td>
<td>n</td>
<td>{n}</td>
<td></td>
</tr>
<tr class="odd">
<td>æ¸ å¯¬</td>
<td>b</td>
<td>{B}</td>
<td>m</td>
</tr>
<tr class="even">
<td>å¡«è§’</td>
<td>F</td>
<td>{F}</td>
<td>m</td>
</tr>
<tr class="odd">
<td>å¡åº¦</td>
<td>s</td>
<td>1/{s}</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="è¨ˆç®—éç¨‹">è¨ˆç®—éç¨‹</h2>
<p>ç›¸é—œè¨ˆç®—å…¬å¼å¦‚ä¸‹:</p>
<p><span class="math display">\[ P = (b - 2 \cdot F) + 2
\sqrt2 \cdot F + 2 \cdot (y - F) \]</span></p>
<p><span class="math display">\[ A = b \cdot y -  F ^2 \]</span></p>
<p><span class="math display">\[ R = \frac{A}{P} \]</span></p>
<p><span class="math display">\[ V = \frac{1}{n} \cdot R^\frac{2}{3}
\cdot s ^ \frac{1}{2} \]</span></p>
<p><span class="math display">\[ Q = A \cdot V \]</span></p>
<p><span class="math display">\[ Fr^2 = \frac{Q^2T}{gA^3} \]</span></p>
<table>
<thead>
<tr class="header">
<th>åè©</th>
<th>ä»£è™Ÿ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ½¤å‘¨</td>
<td>P</td>
</tr>
<tr class="even">
<td>é€šæ°´é¢ç©</td>
<td>A</td>
</tr>
<tr class="odd">
<td>æ°´åŠ›åŠå¾‘</td>
<td>R</td>
</tr>
<tr class="even">
<td>æµé€Ÿ</td>
<td>V</td>
</tr>
<tr class="odd">
<td>æµé‡</td>
<td>Q</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="è¨ˆç®—çµæœ">è¨ˆç®—çµæœ</h2>
<h3 id="æª¢ç®—ç­‰é€Ÿæµæ³"><strong>æª¢ç®—ç­‰é€Ÿæµæ³</strong></h3>
<blockquote>
<p>è¨­è¨ˆæµé‡Qéœ€å¤§æ–¼è¨ˆç•«æµé‡q</p>
</blockquote>
<p>ç¶“è©¦èª¤æ³•å¾Œå¾—åˆ°</p>
<table>
<thead>
<tr class="header">
<th>åè©</th>
<th>ä»£è™Ÿ</th>
<th>æ•¸å€¼</th>
<th>å–®ä½</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ°´æ·±</td>
<td>y</td>
<td>{y}</td>
<td>m</td>
</tr>
<tr class="even">
<td>è¨­è¨ˆæµé‡</td>
<td>Q</td>
<td>{Q}</td>
<td>cms</td>
</tr>
<tr class="odd">
<td>æµé€Ÿ</td>
<td>V</td>
<td>{V}</td>
<td>m/s</td>
</tr>
<tr class="even">
<td>ç¦ç¥¿æ•¸</td>
<td>Fr</td>
<td>{Fr}</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="æª¢ç®—è‡¨ç•Œæµæ³"><strong>æª¢ç®—è‡¨ç•Œæµæ³</strong></h3>
<blockquote>
<p>è¨­å®šæ¢ä»¶ç‚º Fr=1</p>
</blockquote>
<p>ç¶“è©¦èª¤æ³•å¾Œå¾—åˆ°</p>
<table>
<thead>
<tr class="header">
<th>åè©</th>
<th>ä»£è™Ÿ</th>
<th>æ•¸å€¼</th>
<th>å–®ä½</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è‡¨ç•Œæ°´æ·±</td>
<td>yc</td>
<td>{yc}</td>
<td>m</td>
</tr>
<tr class="even">
<td>è‡¨ç•Œæµé€Ÿ</td>
<td>Vc</td>
<td>{Vc}</td>
<td>m/s</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="æ°´ç†ç‰¹æ€§æª¢è¨">æ°´ç†ç‰¹æ€§æª¢è¨</h2>
<h3 id="æœ€å°å®¹è¨±æµé€Ÿ"><strong>æœ€å°å®¹è¨±æµé€Ÿ</strong></h3>
<ul>
<li>æ°´è‰ç”Ÿé•·é€Ÿåº¦ 0.7 m/s</li>
<li>æ³¥æ²™æ·¤ç©é€Ÿåº¦</li>
</ul>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>æœ€å°å®¹è¨±æµé€Ÿ(m/s)</th>
<th>0.19</th>
<th>0.30</th>
<th>0.38</th>
<th>0.45</th>
<th>0.56</th>
<th>0.65</th>
<th>0.69</th>
<th>0.70</th>
<th>0.77</th>
<th>0.82</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ°´æ·±</td>
<td>0.3</td>
<td>0.6</td>
<td>0.9</td>
<td>1.2</td>
<td>1.5</td>
<td>1.8</td>
<td>2.1</td>
<td>2.4</td>
<td>2.7</td>
<td>3.0</td>
</tr>
</tbody>
</table>
<h3 id="æœ€å¤§å®¹è¨±æµé€Ÿ"><strong>æœ€å¤§å®¹è¨±æµé€Ÿ</strong></h3>
<ul>
<li>è¾²å·¥æ‰‹å†Šå»ºè­°</li>
</ul>
<table>
<thead>
<tr class="header">
<th>æè³ª</th>
<th style="text-align: center;">æœ€å¤§å®¹è¨±æµé€Ÿ(m/s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>åšæ··å‡åœŸ(&gt;18cm)</td>
<td style="text-align: center;">3.00</td>
</tr>
<tr class="even">
<td>è–„æ··å‡åœŸ(&lt;10cm)</td>
<td style="text-align: center;">1.50</td>
</tr>
</tbody>
</table>
<blockquote>
<p>æ’æ°´è·¯ã€é€€æ°´è·¯ã€å´æº¢é“ å¯ä»¥ä¹˜<strong>1.5</strong>å€é€²è¡Œåˆ†æ</p>
</blockquote>
<ul>
<li>åˆè¨‚æœ¬å»ºè­°</li>
</ul>
<table>
<thead>
<tr class="header">
<th>æè³ª</th>
<th style="text-align: center;">æœ€å¤§å®¹è¨±æµé€Ÿ(m/s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>æ··å‡åœŸ</td>
<td style="text-align: center;">4.00</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="è€ƒé‡å‹•æ°´å£“åŠ›"><strong>è€ƒé‡å‹•æ°´å£“åŠ›</strong></h3>
<p>æ‡‰é¿å…æ¥è¿‘è‡¨ç•Œæµé€Ÿ(æ°´é¢æ˜“èµ·æ¿€ç›ª)</p>
<p>è¾²å·¥æ‰‹å†Šå»ºè­°:</p>
<p><span class="math display">\[ V_\text &lt;
\frac23 V_c \]</span></p>
<p>åˆè¨‚æœ¬è¨ˆç®—ä¾‹(P.450)å»ºè­°:</p>
<p><span class="math display">\[ V_\text &lt; 0.8
\cdot V_c \]</span></p>
<hr />
<h3 id="å‡ºæ°´é«˜åº¦æª¢æ ¸"><strong>å‡ºæ°´é«˜åº¦æª¢æ ¸</strong></h3>
<p>ç‚ºè€ƒé‡ä»¥ä¸‹æƒ…æ³äºˆä»¥èª¿æ•´</p>
<ol type="1">
<li>æ¸ é“ç³™ç‡ä¿‚æ•¸ä¹‹è®Šå‹•</li>
<li>æµé€Ÿæ°´é ­è®Šæ›ç‚ºéœæ°´é ­æ°´é¢ä¹‹ä¸Šå‡</li>
<li>å°æ°´é¢æ³¢å‹•ç­‰æ‰€éœ€å¢åŠ ä¹‹é«˜åº¦</li>
</ol>
<p><strong>åˆè¨‚æœ¬å»ºè­°:</strong></p>
<ol type="1">
<li><p>è¨ˆç•«æœ€é«˜æ°´æ·±ä¹‹1/3(ä½†ä¸èƒ½å°‘æ–¼15cm)</p></li>
<li><p>é‡è¦æ¸ é“å¯å¢è‡³æœ€å¤§æ°´æ·±ä¹‹1/2</p></li>
<li><p>å½æ›²è™•éœ€è€ƒé‡æ°´é¢è¶…é«˜</p>
<p><span class="math display">\[ F_b = \frac{B \cdot V^2}{g \cdot r}
\]</span></p>
<ul>
<li><p>B=æ°´é¢å¯¬åº¦(m)</p></li>
<li><p>r=å½æ›²åŠå¾‘(m)</p></li>
<li><p>g=9.81</p></li>
</ul></li>
</ol>
<p><strong>è¾²å·¥æ‰‹å†Šå»ºè­°:</strong></p>
<ul>
<li><p>ç´”æŒ–æ¸ é“æˆ–å…§é¢å·¥æ¸ é“</p>
<p>Fb=0.05d+hv+(0.05~0.15)</p></li>
<li><p>åº§æ§½æˆ–æ¸¡æ§½</p>
<p>Fb=0.07d+hv+(0.05~0.15)</p>
<p>æœ‰æ´ªæ°´æµå…¥æ™‚ æœ€å°Fb=0.1</p></li>
<li><p>æš—æ¸ åŠéš§é“ A,Bå–å¤§å€¼ (A)æŒ‰è¨ˆç•«æµé‡ä¼°ç®—
d/D=0.80~0.83(ä½†è‡³å°‘ç‚º0.30m)</p>
<p>(B)æœ‰æ´ªæ°´æµå…¥æ™‚ d/D=0.90~0.93</p>
<ul>
<li>d=æ°´æ·±=y</li>
<li>D=æš—æ¸ é«˜åº¦æˆ–éš§é“ç›´å¾‘</li>
</ul></li>
</ul>
<hr />
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>Streamlit</tag>
        <tag>Python</tag>
        <tag>æ˜æ¸ è¨ˆç®—</tag>
      </tags>
  </entry>
  <entry>
    <title>è·¨ç³»çµ±ç¶²é è‡ªå‹•åŒ–å¡«å¯«åšæ³•</title>
    <url>/posts/706100979/</url>
    <content><![CDATA[<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>ä¸Šç´šå–®ä½éœ€è¦ç®¡è€ƒç›®å‰ç®¡ç†è™•åŸ·è¡Œä¸­çš„å·¥ç¨‹æ¡ˆä»¶ï¼Œå»ºç«‹<strong>è¾²ç”°æ°´åˆ©è¨­æ–½å·¥ç¨‹ç®¡è€ƒç³»çµ±</strong>(ä»¥ä¸‹ç¨±å¤–éƒ¨ç³»çµ±)ä¾›å„ç®¡ç†è™•é€²è¡Œå¡«å ±ï¼Œç„¶è€Œç®¡ç†è™•æ–¼å‰æœŸä¾¿å·²å»ºç«‹<strong>å·¥ç¨‹ç®¡è€ƒEåŒ–ç³»çµ±</strong>(ä»¥ä¸‹ç¨±å…§éƒ¨ç³»çµ±)åšç‚ºå…§éƒ¨è³‡æ–™çš„æ”¶é›†ï¼Œç›£é€ å–®ä½éœ€è¦åœ¨å…§éƒ¨ç³»çµ±å…ˆé€²è¡Œå¡«å¯«å¾Œï¼Œå†ç”±ç®¡ç†å–®ä½é€²å…¥å¤–éƒ¨ç³»çµ±å°‡å…§éƒ¨ç³»çµ±è³‡æ–™å†é‡æ–°è¬„æ‰“ä¸€æ¬¡ã€‚</p>
<p>ç‚ºé€²è¡Œå¤–éƒ¨ç³»çµ±è³‡æ–™å¡«å ±ï¼Œæœ€ç†æƒ³çš„ç‹€æ³ç•¶ç„¶æ˜¯èƒ½é€éå…§éƒ¨ç³»çµ±è‡ªèº«è§¸ç™¼å™¨(Trigger)åŸ·è¡Œå¤–éƒ¨ç³»çµ±APIç™¼é€ï¼Œå…§éƒ¨ç³»çµ±è³‡æ–™åº«ç•°å‹•æ™‚ä¹Ÿèƒ½ä¸€ä½µä¿®æ”¹åˆ°å¤–éƒ¨ç³»çµ±çš„å…§å®¹ã€‚</p>
<p>ç„¶è€Œä»Šæ—¥<strong>æ²’æœ‰å¤–éƒ¨ç³»çµ±APIä½¿ç”¨</strong>ï¼Œéœ€è¦å¦å¤–æƒ³è¾¦æ³•å¾åŸæœ¬çš„è³‡æ–™åº«æ’ˆå–è³‡æ–™é€²è¡Œ<strong>ç¶²é è‡ªå‹•åŒ–å¡«å ±</strong>æ‰èƒ½çœäº‹ï¼Œé¦–å…ˆè¦ç¢ºèªå…§éƒ¨ç³»çµ±çš„è³‡æ–™åº«æ¬„ä½æ˜¯å¦èƒ½é€²è¡Œè³‡æ–™æ¢³ç†ï¼Œå†è€…ç¢ºèªç¶²é è‡ªå‹•åŒ–å¡«å ±åšæ³•ç‚ºä½•ã€‚</p>
<span id="more"></span>
<hr />
<h3 id="å¤–éƒ¨ç³»çµ±æ“ä½œç•«é¢">å¤–éƒ¨ç³»çµ±æ“ä½œç•«é¢</h3>
<figure>
<img src="1.JPG" alt="Fig1. æ–°å¢è¨ˆç•«å·¥ç¨‹" />
<figcaption aria-hidden="true">Fig1. æ–°å¢è¨ˆç•«å·¥ç¨‹</figcaption>
</figure>
<hr />
<figure>
<img src="2.JPG" alt="Fig2. è¨ˆç•«å·¥ç¨‹æˆæœ" />
<figcaption aria-hidden="true">Fig2. è¨ˆç•«å·¥ç¨‹æˆæœ</figcaption>
</figure>
<hr />
<figure>
<img src="3.JPG" alt="Fig3. æ–°å¢åˆ†é …å·¥ç¨‹" />
<figcaption aria-hidden="true">Fig3. æ–°å¢åˆ†é …å·¥ç¨‹</figcaption>
</figure>
<hr />
<figure>
<img src="4.JPG" alt="Fig4. åˆ†é …å·¥ç¨‹æˆæœ" />
<figcaption aria-hidden="true">Fig4. åˆ†é …å·¥ç¨‹æˆæœ</figcaption>
</figure>
<hr />
<figure>
<img src="5.JPG" alt="Fig5. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(ä¸€)" />
<figcaption aria-hidden="true">Fig5. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(ä¸€)</figcaption>
</figure>
<hr />
<figure>
<img src="6.JPG" alt="Fig6. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(äºŒ)" />
<figcaption aria-hidden="true">Fig6. å·¥ç¨‹æ¦‚è¦è¡¨å¡«å¯«æ¬„ä½(äºŒ)</figcaption>
</figure>
<h3 id="å…§éƒ¨ç³»çµ±è³‡æ–™åº«">å…§éƒ¨ç³»çµ±è³‡æ–™åº«</h3>
<p>ç¶“æŸ¥å¤–éƒ¨ç³»çµ±ç›¸é—œè³‡æ–™æ¬„ä½åˆ†æ•£æ–¼å…§éƒ¨ç³»çµ±è³‡æ–™åº«(SQLserver)å„å€‹ä¸åŒè³‡æ–™è¡¨ï¼Œé›–ç„¶é€éJOINçš„æ–¹å¼ä¹Ÿå¯ä»¥ç”¢å‡ºä¸€å€‹æ»¿æ¥è¿‘å¯ä»¥ç›´æ¥è¼¸å…¥çš„æˆæœï¼Œä½†ç­†è€…å°æ–¼è³‡æ–™åº«çš„æ“ä½œç¶“é©—å°šé¡¯ä¸è¶³ï¼ŒæœŸç¨‹è¿«åœ¨çœ‰ç«ï¼Œåªå¥½å…ˆå°‡å…§éƒ¨ç³»çµ±ç›¸é—œå„è¡¨å…ˆåŒ¯å‡ºæˆexcelï¼Œå†é€éç†Ÿæ‚‰çš„VBAé€²è¡Œè³‡æ–™æ¢³ç†ï¼Œæ•´ç†æˆæœªä¾†ç¶²é è‡ªå‹•åŒ–å¡«å ±å¾…è¼‰å…¥çš„å…§å®¹ã€‚</p>
<p>ç‚ºä¸å½±éŸ¿æ—¢æœ‰è³‡æ–™åº«é‹ä½œï¼Œå…ˆè«‹å„åŒä»å°‡æ¬²å¡«å ±è³‡æ–™å…§å®¹å¡«å¯«å®Œå¾Œé€²è¡Œè³‡æ–™åº«å‚™ä»½ï¼Œæ–¼æœ¬åœ°ç«¯é‡å•Ÿä¸€å€‹è³‡æ–™åº«æœå‹™ä¸¦å°å…¥å‚™ä»½å…§å®¹é€²è¡Œå¾ŒçºŒæ“ä½œã€‚</p>
<h4 id="è³‡æ–™æ¢³ç†ç´°ç¯€">è³‡æ–™æ¢³ç†ç´°ç¯€</h4>
<table>
<thead>
<tr class="header">
<th>å¤–éƒ¨ç³»çµ±é é¢</th>
<th>æ¬„ä½åç¨±</th>
<th>å…§éƒ¨ç³»çµ±è³‡æ–™è¡¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>å·¥ç¨‹ç ”æ</td>
<td>å·¥ç¨‹ç·¨è™Ÿ(è‡ªè¨‚)</td>
<td>APMFORM</td>
</tr>
<tr class="even">
<td></td>
<td>å·¥ç¨‹åç¨±</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>é„‰é®å¸‚</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>æ°´è·¯åç¨±åˆ—è¡¨(è‡ªè¨‚)</td>
<td></td>
</tr>
<tr class="odd">
<td>åˆ†é …å·¥ç¨‹</td>
<td>æ°´è·¯åç¨±</td>
<td>MONFORM</td>
</tr>
<tr class="even">
<td>å·¥ç¨‹æ¦‚è¦è¡¨</td>
<td>å—ç›Šé¢ç©</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>æ”¹å–„é¡åˆ¥</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>æ”¹å–„æ•ˆç›Š</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>ç”¨åœ°æƒ…å½¢</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>è¦åŠƒæƒ…å½¢</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>ç›¸é—œæƒ…å½¢</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>è¾²æ°‘æ„é¡˜</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>æ°´æºæƒ…å½¢</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>æ°´æ¬Šæƒ…å½¢</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>æ˜¯å¦éœ€é…åˆæ–·æ°´æœŸæ–½å·¥</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>å·¥ç¨‹é‡è¦æ€§</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>ç¶“è²»æ¦‚ä¼°é …ç›®</td>
<td>MONFUND</td>
</tr>
<tr class="even">
<td></td>
<td>ç¾æ³ç…§ç‰‡åŠè¨­è¨ˆç°¡åœ–</td>
<td>MONFPIC</td>
</tr>
</tbody>
</table>
<h4 id="ç…§ç‰‡è™•ç†">ç…§ç‰‡è™•ç†</h4>
<p>åœ¨è™•ç†ç…§ç‰‡å°æ˜ æ™‚ï¼Œç™¼ç¾è³‡æ–™åº«ä¸­çš„ç…§ç‰‡å­˜æˆäºŒé€²ä½ï¼Œéœ€å…ˆæŠŠäºŒé€²ä½è½‰æˆåœ–ç‰‡æ‰æœ‰è¾¦æ³•é€²è¡Œå¾ŒçºŒè™•ç†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_photos</span>():</span><br><span class="line">    conn = get_db_connection()</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line">    query=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    SELECT  </span></span><br><span class="line"><span class="string">        mf.[MN_ID],</span></span><br><span class="line"><span class="string">        mf.[WRD_NAME],</span></span><br><span class="line"><span class="string">        mp.[PIC_FILE],  -- å‡è¨­ä½ æƒ³è¦é¸æ“‡åœ–ç‰‡æ¬„ä½</span></span><br><span class="line"><span class="string">        mp.[PIC_PATH]</span></span><br><span class="line"><span class="string">    FROM </span></span><br><span class="line"><span class="string">        [CMPSGS].[dbo].[MONFORM] mf</span></span><br><span class="line"><span class="string">    JOIN </span></span><br><span class="line"><span class="string">        [CMPSGS].[dbo].[MONFPIC] mp</span></span><br><span class="line"><span class="string">        ON mf.[MN_ID] = mp.[MN_ID]</span></span><br><span class="line"><span class="string">    WHERE </span></span><br><span class="line"><span class="string">        mf.[ADD_DT] &gt; &#x27;2024-11-01&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ORDER BY</span></span><br><span class="line"><span class="string">        mf.[MN_ID]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    cursor.execute(query)</span><br><span class="line">    <span class="comment"># ç²å–åˆ—å</span></span><br><span class="line">    columns = [column[<span class="number">0</span>] <span class="keyword">for</span> column <span class="keyword">in</span> cursor.description]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°‡çµæœè½‰æ›ç‚ºå­—å…¸åˆ—è¡¨</span></span><br><span class="line">    results = [<span class="built_in">dict</span>(<span class="built_in">zip</span>(columns, row)) <span class="keyword">for</span> row <span class="keyword">in</span> cursor.fetchall()]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print(&quot;Results:&quot;, results)  # æ–°å¢é€™ä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°‡çµæœè½‰æ›ç‚º DataFrame</span></span><br><span class="line">    df = pd.DataFrame(results)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> index %<span class="number">3</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(row[<span class="string">&quot;WRD_NAME&quot;</span>])</span><br><span class="line">            folder_name=row[<span class="string">&quot;WRD_NAME&quot;</span>]</span><br><span class="line">            os.makedirs(<span class="string">&quot;./data/&quot;</span>+folder_name, exist_ok=<span class="literal">True</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./data/&quot;</span>+folder_name+<span class="string">&quot;/&quot;</span>+row[<span class="string">&quot;WRD_NAME&quot;</span>]+<span class="string">&quot;-&quot;</span>+row[<span class="string">&quot;PIC_PATH&quot;</span>], <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> image_file:</span><br><span class="line">            image_file.write(row[<span class="string">&quot;PIC_FILE&quot;</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">str</span>(index)+<span class="string">&quot;...OK!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    cursor.close()</span><br><span class="line">    conn.close()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="2.png" alt="Fig7. è³‡æ–™å¤¾å®‰æ’(ä»¥æ¸ é“åç¨±ç‚ºåˆ†é¡)" /> <img
src="3.png" alt="Fig8. è³‡æ–™å¤¾å…§å®¹(æª”æ¡ˆåç¨±å–ç‚ºæ•¸å­—æ–¹ä¾¿æ’åºé€²è¡Œ)" /></p>
<hr />
<h3 id="ç¶²é è‡ªå‹•åŒ–å¡«å ±">ç¶²é è‡ªå‹•åŒ–å¡«å ±</h3>
<p>åŸæœ¬æƒ³åƒä¸­çš„Seleniumæœƒéœ€è¦<strong>å¾ç„¡åˆ°æœ‰</strong>é–‹å•Ÿä¸€å€‹ç¶²ç«™å¾Œé–‹å§‹é€²è¡Œè³‡æ–™å¡«å¯«ï¼Œå¤§å¤šæ•¸çš„ç¶²ç«™éƒ½æœƒæœ‰å¸³è™Ÿå¯†ç¢¼é©—è­‰æ©Ÿåˆ¶ï¼Œç”šè‡³ç¥­å‡ºé©—è­‰ç¢¼ã€é¸æ“‡æ±½è»Šåœ–ç‰‡ã€ç§»å‹•æ»‘é¼ åˆ°æŒ‡å®šä½ç½®...ç­‰åçˆ¬èŸ²æ©Ÿåˆ¶ä¾†ç¢ºèªæ˜¯å¦ç‚ºæ©Ÿå™¨äººï¼Œä½†è‹¥ç¶²é å¯ä»¥è¢«<strong>æ¥ç®¡</strong>ç¹é–‹é€™äº›æ©Ÿåˆ¶çš„è©±ï¼Œé‚£æ•´å€‹è³‡æ–™å¡«å ±ä½œæ¥­å°±æœƒå¾ˆæœ‰æ©Ÿæœƒè®“é›»è…¦ä»£å‹ï¼Œé€™å°±æ˜¯å¯«ç¨‹å¼çš„è¶£å‘³ä¾†æºï¼Œç•¶ç„¶é‚„æ˜¯è¦å°å¿ƒä¸èƒ½é»å¤ªå¿«ï¼Œå¦å‰‡ç¶²ç«™å¯èƒ½æœƒè² è·ä¸éä¾†ã€‚</p>
<h4 id="chrome">Chrome</h4>
<p>ç¶²é ç€è¦½å™¨ï¼Œé€éä»¥ä¸‹æŒ‡ä»¤å³å¯é€²è¡Œç¶²ç«™æ“ä½œæ¥ç®¡ï¼Œéœ€è¦æ ¹æ“šè‡ªèº«é›»è…¦çš„chromeå®‰è£è·¯å¾‘åŸ·è¡Œï¼Œå»ºè­°å°‡åŸæœ¬æ‰€é–‹å•Ÿä¸­çš„chromeç•«é¢é€šé€šé—œé–‰å¾Œå†åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚</p>
<ul>
<li>WIN10</li>
</ul>
<p><code>"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" â€“remote-debugging-port=9222</code></p>
<ul>
<li>WIN11</li>
</ul>
<p><code>"C:\Program Files\Google\Chrome\Application\chrome.exe" â€“remote-debugging-port=9222</code></p>
<p>NOTE:å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ç€è¦½å™¨çš„åŸ·è¡Œè·¯å¾‘ï¼Œå¯ä»¥åœ¨åŸæœ¬æ¡Œé¢ç€è¦½å™¨æ·å¾‘æ‰¾å°‹å…§å®¹</p>
<figure>
<img src="1.png" alt="Fig9. ç€è¦½å™¨ç•«é¢" />
<figcaption aria-hidden="true">Fig9. ç€è¦½å™¨ç•«é¢</figcaption>
</figure>
<hr />
<p><a
href="https://www.hanksvba.com/posts/391727536/#more">æ›´å¤šç´°ç¯€è«‹åƒè€ƒ.Seleniumè©³ç´°æ“ä½œæ­¥é©Ÿ</a></p>
<h2 id="æ“ä½œdemo">æ“ä½œDEMO</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/i5GgfOp73Ns?si=teimgdo9aPiJLhaP" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
</iframe>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>SQL</tag>
        <tag>Selenium</tag>
      </tags>
  </entry>
  <entry>
    <title>Seleniumæ“ä½œç´°ç¯€</title>
    <url>/posts/391727536/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>åŸæœ¬æƒ³åƒä¸­çš„Seleniumæœƒéœ€è¦<strong>å¾ç„¡åˆ°æœ‰</strong>é–‹å•Ÿä¸€å€‹ç¶²ç«™å¾Œé–‹å§‹é€²è¡Œè³‡æ–™å¡«å¯«ï¼Œå¤§å¤šæ•¸çš„ç¶²ç«™éƒ½æœƒæœ‰å¸³è™Ÿå¯†ç¢¼é©—è­‰æ©Ÿåˆ¶ï¼Œç”šè‡³ç¥­å‡ºé©—è­‰ç¢¼ã€é¸æ“‡æ±½è»Šåœ–ç‰‡ã€ç§»å‹•æ»‘é¼ åˆ°æŒ‡å®šä½ç½®...ç­‰åçˆ¬èŸ²æ©Ÿåˆ¶ä¾†ç¢ºèªæ˜¯å¦ç‚ºæ©Ÿå™¨äººï¼Œä½†è‹¥ç¶²é å¯ä»¥è¢«<strong>æ¥ç®¡</strong>ç¹é–‹é€™äº›æ©Ÿåˆ¶çš„è©±ï¼Œé‚£æ•´å€‹è³‡æ–™å¡«å ±ä½œæ¥­å°±æœƒå¾ˆæœ‰æ©Ÿæœƒè®“é›»è…¦ä»£å‹ï¼Œé€™å°±æ˜¯å¯«ç¨‹å¼çš„è¶£å‘³ä¾†æºï¼Œç•¶ç„¶é‚„æ˜¯è¦å°å¿ƒä¸èƒ½é»å¤ªå¿«ï¼Œå¦å‰‡ç¶²ç«™å¯èƒ½æœƒè² è·ä¸éä¾†ã€‚</p>
<span id="more"></span>
<h2 id="ä½¿ç”¨å·¥å…·">ä½¿ç”¨å·¥å…·</h2>
<h3 id="chrome">Chrome</h3>
<p>ç¶²é ç€è¦½å™¨ï¼Œé€éä»¥ä¸‹æŒ‡ä»¤å³å¯é€²è¡Œç¶²ç«™æ“ä½œæ¥ç®¡ï¼Œéœ€è¦æ ¹æ“šè‡ªèº«é›»è…¦çš„chromeå®‰è£è·¯å¾‘åŸ·è¡Œï¼Œå»ºè­°å°‡åŸæœ¬æ‰€é–‹å•Ÿä¸­çš„chromeç•«é¢é€šé€šé—œé–‰å¾Œå†åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚</p>
<h4 id="win10">WIN10</h4>
<p><code>"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" â€“remote-debugging-port=9222</code></p>
<h4 id="win11">WIN11</h4>
<p><code>"C:\Program Files\Google\Chrome\Application\chrome.exe" â€“remote-debugging-port=9222</code></p>
<p>NOTE:å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ç€è¦½å™¨çš„åŸ·è¡Œè·¯å¾‘ï¼Œå¯ä»¥åœ¨åŸæœ¬æ¡Œé¢ç€è¦½å™¨æ·å¾‘æ‰¾å°‹å…§å®¹</p>
<figure>
<img src="1.png" alt="Fig1. ç€è¦½å™¨ç•«é¢" />
<figcaption aria-hidden="true">Fig1. ç€è¦½å™¨ç•«é¢</figcaption>
</figure>
<h3 id="selenium">Selenium</h3>
<p>ç›®å‰ä½¿ç”¨ç‚ºSelenium4çš„èªæ³•ï¼Œé€éåˆ†æç¶²ç«™çš„å…ƒç´ ä¾†é€²è¡Œæ–‡å­—è¼¸å…¥ã€æ–‡å­—èƒå–ã€é»æ“Šé€£çµã€å¾ªç’°è¡¨æ ¼å–å¾—ç›®æ¨™æ¬„ä½...ç­‰ã€‚</p>
<h2 id="ç¶²ç«™æ¥ç®¡æ­¥é©Ÿ">ç¶²ç«™æ¥ç®¡æ­¥é©Ÿ</h2>
<ol type="1">
<li>æ‰“é–‹çµ‚ç«¯æ©Ÿ
<ul>
<li>æœå°‹&gt;è¼¸å…¥<strong>cmd</strong></li>
</ul></li>
<li>è¼¸å…¥æŒ‡ä»¤
<ul>
<li><code>"C:\Program Files\Google\Chrome\Application\chrome.exe" â€“remote-debugging-port=9222</code></li>
</ul></li>
<li>é–‹å•Ÿç¶²ç«™ï¼Œ<strong>è¼¸å…¥å¸³è™Ÿå¯†ç¢¼é©—è­‰ç¢¼</strong>å¾Œåˆ°å¯å¡«å¯«ç•«é¢</li>
<li>äº¤çµ¦Seleniumä¾†é€²è¡Œç¶²ç«™è‡ªå‹•å¡«å ±ä½œæ¥­ã€‚</li>
</ol>
<h2 id="python">Python</h2>
<h3 id="requirements.txt">requirements.txt</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">selenium</span><br><span class="line">pandas</span><br><span class="line">openpyxl</span><br></pre></td></tr></table></figure>
<h3 id="main.py">main.py</h3>
<h4 id="æ¥ç®¡ç€è¦½å™¨">æ¥ç®¡ç€è¦½å™¨</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_driver</span>():</span><br><span class="line">    chrome_options = Options()</span><br><span class="line">    chrome_options.add_experimental_option(<span class="string">&quot;debuggerAddress&quot;</span>, <span class="string">&quot;127.0.0.1:9222&quot;</span>)</span><br><span class="line"></span><br><span class="line">    driver = webdriver.Chrome(options=chrome_options)</span><br><span class="line">    <span class="keyword">return</span> driver</span><br><span class="line">    </span><br><span class="line"><span class="comment">#======ä¸»è¦ä»‹é¢é–‹å§‹======</span></span><br><span class="line"></span><br><span class="line">driver=init_driver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç²å–ç•¶å‰ç¶²å€</span></span><br><span class="line">current_url = driver.current_url</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç•¶å‰ç¶²å€:&quot;</span>, current_url)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="å–å¾—ç¶²é å…ƒç´ ">å–å¾—ç¶²é å…ƒç´ </h4>
<table>
<thead>
<tr class="header">
<th>æ–¹æ³•</th>
<th>é©ç”¨æƒ…æ³</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ID</strong></td>
<td>ç”¨æ–¼å®šä½å…·æœ‰å”¯ä¸€æ¨™è­˜ç¬¦çš„å…ƒç´ </td>
</tr>
<tr class="even">
<td><strong>XPATH</strong></td>
<td>ç•¶å…ƒç´ ä½ç½®ä¸ç¢ºå®šæˆ–ç„¡æ³•ä½¿ç”¨å…¶ä»–æ–¹å¼å®šä½æ™‚ä½¿ç”¨</td>
</tr>
<tr class="odd">
<td><strong>LINK_TEXT</strong></td>
<td>ç”¨æ–¼å®šä½é é¢ä¸Šå¯é»æ“Šçš„è¶…é€£çµæ–‡å­—</td>
</tr>
<tr class="even">
<td><strong>CSS_SELECTOR</strong></td>
<td>ç•¶å…ƒç´ çš„çµæ§‹è¼ƒç‚ºè¤‡é›œæˆ–ç„¡æ³•ä½¿ç”¨IDæ™‚ä½¿ç”¨</td>
</tr>
</tbody>
</table>
<h4 id="åŸ·è¡Œç¶²é å‹•ä½œ">åŸ·è¡Œç¶²é å‹•ä½œ</h4>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 32%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th>æ“ä½œé¡å‹</th>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>æ–‡å­—æ¬„ä½æ“ä½œ</strong></td>
<td><strong>clear</strong></td>
<td>æ¸…ç©ºæ–‡å­—æ¬„ä½çš„å…§å®¹</td>
</tr>
<tr class="even">
<td></td>
<td><strong>sendkey</strong></td>
<td>åœ¨æ–‡å­—æ¬„ä½ä¸­è¼¸å…¥æ–‡å­—</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>click</strong></td>
<td>é»æ“Šæ–‡å­—æ¬„ä½ï¼ˆè‹¥ç‚ºå¯é»æ“Šçš„å…ƒç´ ï¼‰</td>
</tr>
<tr class="even">
<td><strong>é¸æ“‡æ¬„ä½æ“ä½œ</strong></td>
<td><strong>select_by_value</strong></td>
<td>æ ¹æ“šé¸é …çš„å€¼ä¾†é¸æ“‡</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>select_by_visible_value</strong></td>
<td>æ ¹æ“šé¸é …çš„å¯è¦‹æ–‡å­—ä¾†é¸æ“‡</td>
</tr>
</tbody>
</table>
<h4 id="ç¶²é è¡¨æ ¼æ“ä½œ">ç¶²é è¡¨æ ¼æ“ä½œ</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">edit_case</span>(<span class="params">driver,targetID</span>): </span><br><span class="line"></span><br><span class="line">    select_element  = driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;DataTables_Table_0_length&quot;]/label/select&#x27;</span>)</span><br><span class="line">    select = Select(select_element)</span><br><span class="line">    select.select_by_value(<span class="string">&quot;100&quot;</span>)</span><br><span class="line">    table = driver.find_element(By.ID, <span class="string">&quot;DataTables_Table_0&quot;</span>)</span><br><span class="line"></span><br><span class="line">    rows = table.find_elements(By.CSS_SELECTOR, <span class="string">&quot;tbody tr&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line"></span><br><span class="line">        cells = row.find_elements(By.CSS_SELECTOR, <span class="string">&quot;td&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># print(cells[0].text)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> cells[<span class="number">0</span>].text==targetID:</span><br><span class="line">            <span class="built_in">print</span>(cells[<span class="number">0</span>].text)</span><br><span class="line"></span><br><span class="line">            edit_button = cells[<span class="number">3</span>].find_element(By.CSS_SELECTOR, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">            edit_button.click()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h4 id="åˆªé™¤æ™‚ä¹‹è­¦å‘Šè¦–çª—">åˆªé™¤æ™‚ä¹‹è­¦å‘Šè¦–çª—</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check_item_by_chname</span>(<span class="params">driver,ch_name,is_rebuild</span>):</span><br><span class="line"></span><br><span class="line">    table = driver.find_element(By.ID, <span class="string">&quot;DataTables_Table_0&quot;</span>)</span><br><span class="line">    rows = table.find_elements(By.CSS_SELECTOR, <span class="string">&quot;tbody tr&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line"></span><br><span class="line">        cells = row.find_elements(By.CSS_SELECTOR, <span class="string">&quot;td&quot;</span>)</span><br><span class="line">        del_button=cells[<span class="number">3</span>].find_element(By.CSS_SELECTOR, <span class="string">&#x27;a[onclick^=&quot;delConfirm&quot;]&#x27;</span>)</span><br><span class="line">        del_button.click()</span><br><span class="line"></span><br><span class="line">        alert = Alert(driver)</span><br><span class="line">        alert.accept()  <span class="comment"># é»æ“Šç¢ºèª</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å·²ç¶“å¼·åˆ¶åˆªé™¤&quot;</span>)</span><br><span class="line">        </span><br></pre></td></tr></table></figure>
<h4 id="åœ–ç‰‡ç½®æ›è™•ç†">åœ–ç‰‡ç½®æ›è™•ç†</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_photo_path</span>(<span class="params">ch_name</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;./data/&#x27;</span>+ch_name):</span><br><span class="line"></span><br><span class="line">        photo_list=[]</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(<span class="string">&#x27;D:/Python/st_selenium/data/&#x27;</span>+ch_name):</span><br><span class="line">            <span class="built_in">print</span>(file)</span><br><span class="line">            photo_list.append(<span class="string">&#x27;D:/Python/st_selenium/data/&#x27;</span>+ch_name+<span class="string">&quot;/&quot;</span>+file)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> photo_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">paste_photo</span>(<span class="params">driver,photo_list</span>):</span><br><span class="line">    <span class="comment"># å®šä½æ–‡ä»¶ä¸Šå‚³çš„ input å…ƒç´ </span></span><br><span class="line">    file_input = driver.find_element(By.ID, <span class="string">&quot;userfile1&quot;</span>)</span><br><span class="line">    file_path =photo_list[<span class="number">0</span>] <span class="comment"># è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘</span></span><br><span class="line">    file_input.send_keys(file_path)</span><br><span class="line"></span><br><span class="line">    file_input = driver.find_element(By.ID, <span class="string">&quot;userfile2&quot;</span>)</span><br><span class="line">    file_path =photo_list[<span class="number">1</span>] <span class="comment"># è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘</span></span><br><span class="line">    file_input.send_keys(file_path)</span><br><span class="line"></span><br><span class="line">    file_input = driver.find_element(By.ID, <span class="string">&quot;userfile3&quot;</span>)</span><br><span class="line">    file_path =photo_list[<span class="number">2</span>] <span class="comment"># è«‹æ›¿æ›æˆä½ åœ–ç‰‡çš„çµ•å°è·¯å¾‘</span></span><br><span class="line">    file_input.send_keys(file_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===ä¸»è¦æ“ä½œå…§å®¹===</span></span><br><span class="line">    </span><br><span class="line">photo_list=get_photo_path(ch)</span><br><span class="line">paste_photo(driver,photo_list)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<blockquote>
<p>è³‡æ–™å¤¾å®‰æ’</p>
</blockquote>
<figure>
<img src="2.png" alt="Fig2. è³‡æ–™å¤¾å®‰æ’(ä»¥æ¸ é“åç¨±ç‚ºåˆ†é¡)" />
<figcaption aria-hidden="true">Fig2.
è³‡æ–™å¤¾å®‰æ’(ä»¥æ¸ é“åç¨±ç‚ºåˆ†é¡)</figcaption>
</figure>
<blockquote>
<p>è³‡æ–™å¤¾å…§å®¹</p>
</blockquote>
<figure>
<img src="3.png" alt="Fig1. è³‡æ–™å¤¾å…§å®¹(æª”æ¡ˆåç¨±å–ç‚ºæ•¸å­—æ–¹ä¾¿æ’åºé€²è¡Œ)" />
<figcaption aria-hidden="true">Fig1.
è³‡æ–™å¤¾å…§å®¹(æª”æ¡ˆåç¨±å–ç‚ºæ•¸å­—æ–¹ä¾¿æ’åºé€²è¡Œ)</figcaption>
</figure>
<h2 id="éŒ¯èª¤ç´€éŒ„">éŒ¯èª¤ç´€éŒ„</h2>
<ul>
<li>å¦‚æœå–å¾—è¡¨æ ¼ä¹‹å¾Œå°±è¦ç›´æ¥é€²è¡Œå„é …åŠŸèƒ½æ“ä½œï¼Œæœƒå‡ºç¾ä¸­æ­¢ç‹€æ³ï¼Œéœ€è¦å…ˆæŠŠæ¯å€‹åˆ—çš„è³‡æ–™å…ˆå„²å­˜æˆlistï¼Œæ‰èƒ½æ ¹æ“šæ¯å€‹listä¸­çš„å…§å®¹é€²è¡Œå¾ŒçºŒå¡«å¯«ã€ä¿®æ”¹ã€å„²å­˜ç­‰åŠŸèƒ½ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">166</span>,<span class="number">167</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print(&quot;OO113T&quot;+str(i))</span></span><br><span class="line"></span><br><span class="line">    edit_case(driver,<span class="string">&quot;OO113T&quot;</span>+<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line">    table = driver.find_element(By.ID, <span class="string">&quot;DataTables_Table_0&quot;</span>)</span><br><span class="line">    rows = table.find_elements(By.CSS_SELECTOR, <span class="string">&quot;tbody tr&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">### å…ˆæŠŠè³‡æ–™å„²å­˜èµ·ä¾†</span></span><br><span class="line">    </span><br><span class="line">    ch_list=[]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> rows:</span><br><span class="line">        cells = row.find_elements(By.CSS_SELECTOR, <span class="string">&quot;td&quot;</span>)</span><br><span class="line">        ch=cells[<span class="number">1</span>].text</span><br><span class="line">        ch_list.append(ch)</span><br><span class="line"></span><br><span class="line">    <span class="comment">### å¾ªç’°æ¯å€‹LISTä¸­çš„å…§å®¹é€²è¡Œå¾ŒçºŒè™•ç†</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> ch_list:</span><br><span class="line"></span><br><span class="line">        <span class="comment">#do something~</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºæœ¬åŸç†</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Selenium</tag>
      </tags>
  </entry>
  <entry>
    <title>é›²ç«¯ç©ºé–“Synology-C2-Object</title>
    <url>/posts/1168852487/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ä¸€æåˆ°é›²ç«¯ç©ºé–“ï¼Œå»£ç‚ºäººçŸ¥çš„ä¸å¤–ä¹æ˜¯Google
Driveã€DropBoxã€OneDriveç­‰ç­‰çŸ¥åå¤§å» çš„ç”¢å“ï¼ŒNAS(åœ°ç«¯å„²å­˜ä¼ºæœå™¨)å‰‡å¤§å¤šå¸¸è¦‹ç‚ºSynologyç¾¤æš‰æ‰€ä¸»å°ï¼Œè€Œæœ¬ç¯‡è¦ä»‹ç´¹çš„Synology
C2 Objectå‰‡æ˜¯ç¾¤æš‰æ‰€æä¾›çš„æœå‹™ä¹‹ä¸€ã€‚</p>
<p>åœ¨ç¶²è·¯ä¸Šæœ‰è¨±å¤šæœå‹™ç¶“éä½¿ç”¨è€…å°<strong>ç¶²é </strong>é€²è¡Œäº’å‹•ï¼Œä¼ºæœå™¨èƒŒå¾Œé€šå¸¸éƒ½æœƒæœ‰ä¸€å€‹ä»¥ä¸Šçš„è³‡æ–™åº«åŠæª”æ¡ˆç©ºé–“é€²è¡Œå„²å­˜ï¼Œè€Œæœ¬ç¯‡
Synology C2 Object
å°±æ˜¯æŒ‡æª”æ¡ˆå­˜å­˜æ”¾ç©ºé–“ï¼Œåªå› ç‚ºå®ƒå±¬æ–¼é›²ç«¯æ‰€æä¾›çš„æœå‹™ï¼Œå› æ­¤å«åšé›²ç«¯ç©ºé–“ã€‚</p>
<p>æœªä¾†åªè¦æœ‰å»ºç«‹å¥½é€£æ¥çš„åƒæ•¸ï¼Œå°±å¯ä»¥é€éAPIé€²è¡Œå‘¼å«å­˜æ”¾ã€å–ç”¨ï¼Œæœ‰é—œæª”æ¡ˆç©ºé–“ç”³è«‹ä¸»è¦ç›®çš„ç‚ºå–å¾—ä¸‹åˆ—é‡è¦åƒæ•¸ï¼Œä»¥å‚™æœªä¾†é€²è¡Œæª”æ¡ˆç©ºé–“ä¸²æ¥ã€‚</p>
<ul>
<li>BUCKET_NAME</li>
<li>endpoint_url</li>
<li>aws_access_key_id</li>
<li>aws_secret_access_key</li>
</ul>
<span id="more"></span>
<hr />
<h2 id="ç”³è«‹æµç¨‹">ç”³è«‹æµç¨‹</h2>
<h3 id="é»æ“Šç™»å…¥">é»æ“Šç™»å…¥</h3>
<p>å¯ä»¥ç¶å®šGoogleæˆ–è€…è‡ªè¡Œç”³è«‹ä¸€çµ„å¸³è™Ÿå¯†ç¢¼</p>
<figure>
<img src="1.png" alt="Fig1.å¤šç¨®ç™»å…¥æ–¹å¼" />
<figcaption aria-hidden="true">Fig1.å¤šç¨®ç™»å…¥æ–¹å¼</figcaption>
</figure>
<h3 id="ç™»å…¥ç•«é¢">ç™»å…¥ç•«é¢</h3>
<figure>
<img src="2.png" alt="Fig2.å…¥å£ç•«é¢" />
<figcaption aria-hidden="true">Fig2.å…¥å£ç•«é¢</figcaption>
</figure>
<h3 id="é¸å–c2-object-storage">é¸å–C2 Object Storage</h3>
<figure>
<img src="3.png" alt="Fig3.é¸æ“‡C2 Object Storageæœå‹™" />
<figcaption aria-hidden="true">Fig3.é¸æ“‡C2 Object
Storageæœå‹™</figcaption>
</figure>
<h3 id="é»é¸é–‹å§‹ä½¿ç”¨15gbå…è²»ç©ºé–“">é»é¸é–‹å§‹ä½¿ç”¨15GBå…è²»ç©ºé–“</h3>
<figure>
<img src="4.png" alt="Fig4.é–‹å§‹ä½¿ç”¨" />
<figcaption aria-hidden="true">Fig4.é–‹å§‹ä½¿ç”¨</figcaption>
</figure>
<h3 id="é»é¸æœå‹™æ¢æ¬¾">é»é¸æœå‹™æ¢æ¬¾</h3>
<figure>
<img src="5.png" alt="Fig5.æœå‹™æ¢æ¬¾" />
<figcaption aria-hidden="true">Fig5.æœå‹™æ¢æ¬¾</figcaption>
</figure>
<h3 id="å»ºç«‹å„²å­˜é«”">å»ºç«‹å„²å­˜é«”</h3>
<figure>
<img src="6.png" alt="Fig6.å»ºç«‹å„²å­˜é«”" />
<figcaption aria-hidden="true">Fig6.å»ºç«‹å„²å­˜é«”</figcaption>
</figure>
<figure>
<img src="7.png" alt="Fig7.å»ºç«‹å­˜å–é‡‘é‘°" />
<figcaption aria-hidden="true">Fig7.å»ºç«‹å­˜å–é‡‘é‘°</figcaption>
</figure>
<figure>
<img src="8.png" alt="Fig8.é è¨­å°±å¥½" />
<figcaption aria-hidden="true">Fig8.é è¨­å°±å¥½</figcaption>
</figure>
<h3 id="å–å¾—é‡‘é‘°idèˆ‡ç§å¯†é‡‘é‘°">å–å¾—é‡‘é‘°IDèˆ‡ç§å¯†é‡‘é‘°</h3>
<figure>
<img src="9.png" alt="Fig9.å­˜å–é‡‘é‘°èˆ‡ç§å¯†é‡‘é‘°" />
<figcaption aria-hidden="true">Fig9.å­˜å–é‡‘é‘°èˆ‡ç§å¯†é‡‘é‘°</figcaption>
</figure>
<ul>
<li>aws_access_key_id</li>
<li>aws_secret_access_key</li>
</ul>
<h3 id="ç¢ºèªå„²å­˜é«”åç¨±åŠç«¯é»">ç¢ºèªå„²å­˜é«”åç¨±åŠç«¯é»</h3>
<figure>
<img src="10.png" alt="Fig9.å„²å­˜é«”åç¨±åŠç«¯é»" />
<figcaption aria-hidden="true">Fig9.å„²å­˜é«”åç¨±åŠç«¯é»</figcaption>
</figure>
<ul>
<li>BUCKET_NAME</li>
<li>endpoint_url</li>
</ul>
<h2 id="çµè«–">çµè«–</h2>
<p>ç”³è«‹å®Œç•¢ä¹‹å¾Œå°±å¯ä»¥ç”¨Pythonä¸­Boto3çš„å¥—ä»¶é€²è¡Œæª”æ¡ˆç©ºé–“çš„å„²å­˜ã€ä¸‹è¼‰äº†ï¼Œæœªä¾†è¦é–‹ç™¼ç›¸é—œç¶²ç«™çš„æ™‚å€™ä¹Ÿå¤šäº†ä¸€å€‹åœ°æ–¹å¯ä»¥æ”¾ç½®æª”æ¡ˆã€‚</p>
<h3 id="é–‹ç™¼ç¯„ä¾‹">é–‹ç™¼ç¯„ä¾‹</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> boto3</span><br><span class="line"><span class="keyword">from</span> botocore.exceptions <span class="keyword">import</span> NoCredentialsError, PartialCredentialsError</span><br><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># è«‹å¡«å…¥ä½ çš„ bucket åç¨±</span></span><br><span class="line">BUCKET_NAME = <span class="string">&#x27;hankbucket&#x27;</span></span><br><span class="line"><span class="comment"># è¨­å®š S3 å®¢æˆ¶ç«¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_s3_client</span>():</span><br><span class="line">    <span class="keyword">return</span> boto3.client(</span><br><span class="line">        <span class="string">&#x27;s3&#x27;</span>,</span><br><span class="line">        endpoint_url=<span class="string">&#x27;https://OOOOO.OO.synologyc2.net&#x27;</span>,</span><br><span class="line">        aws_access_key_id=<span class="string">&#x27;twmOPTcq8MAxXaNVMOOOOOOOOO&#x27;</span>,</span><br><span class="line">        aws_secret_access_key=<span class="string">&#x27;n7O1Pys3nyp15T5OGOOOOOOO&#x27;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_files</span>(<span class="params">bucket_name</span>):</span><br><span class="line">    s3 = get_s3_client()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = s3.list_objects_v2(Bucket=bucket_name)</span><br><span class="line">        files = response.get(<span class="string">&#x27;Contents&#x27;</span>, [])</span><br><span class="line">        <span class="comment"># print(files)</span></span><br><span class="line">        file_list = []</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            file_info = &#123;</span><br><span class="line">                <span class="string">&quot;File Name&quot;</span>: file[<span class="string">&#x27;Key&#x27;</span>],</span><br><span class="line">                <span class="string">&quot;Size (bytes)&quot;</span>: file[<span class="string">&#x27;Size&#x27;</span>],</span><br><span class="line">                <span class="string">&quot;Last Modified&quot;</span>: file[<span class="string">&#x27;LastModified&#x27;</span>],</span><br><span class="line">                <span class="string">&quot;ETag&quot;</span>: file[<span class="string">&#x27;ETag&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">            file_list.append(file_info)</span><br><span class="line">        <span class="keyword">return</span> file_list</span><br><span class="line">    <span class="keyword">except</span> (NoCredentialsError, PartialCredentialsError) <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"><span class="comment"># ä¸Šå‚³æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>(<span class="params">bucket_name, file_path, object_name</span>):</span><br><span class="line">    s3 = get_s3_client()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            s3.upload_fileobj(f, bucket_name, object_name)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Uploaded <span class="subst">&#123;object_name&#125;</span> to <span class="subst">&#123;bucket_name&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"><span class="comment"># ä¸Šå‚³æª”æ¡ˆä¸¦ç²å–å”¯ä¸€ç¢¼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file_and_get_etag</span>(<span class="params">bucket_name, file_path, object_name</span>):</span><br><span class="line">    s3 = get_s3_client()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            response = s3.upload_fileobj(f, bucket_name, object_name)</span><br><span class="line">        <span class="keyword">return</span> response[<span class="string">&#x27;ETag&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"><span class="comment"># ä¸Šå‚³æª”æ¡ˆä¸¦é¡¯ç¤ºå”¯ä¸€ç¢¼</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_new_file</span>():</span><br><span class="line">    uploaded_file = st.file_uploader(<span class="string">&quot;Choose a file&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> uploaded_file <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(uploaded_file.name, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(uploaded_file.getbuffer())</span><br><span class="line">        etag = upload_file_and_get_etag(BUCKET_NAME, uploaded_file.name, uploaded_file.name)</span><br><span class="line">        st.write(<span class="string">f&quot;Uploaded <span class="subst">&#123;uploaded_file.name&#125;</span> with ETag: <span class="subst">&#123;etag&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># åˆªé™¤æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_file</span>(<span class="params">bucket_name, object_name</span>):</span><br><span class="line">    s3 = get_s3_client()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s3.delete_object(Bucket=bucket_name, Key=object_name)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Deleted <span class="subst">&#123;object_name&#125;</span> from <span class="subst">&#123;bucket_name&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_all_files</span>():</span><br><span class="line">    files = list_files(BUCKET_NAME)</span><br><span class="line">    <span class="keyword">if</span> files:</span><br><span class="line">        <span class="comment"># print(files)</span></span><br><span class="line">        file_list = [&#123;<span class="string">&quot;File Name&quot;</span>: file[<span class="string">&#x27;File Name&#x27;</span>],</span><br><span class="line">                       <span class="string">&quot;Etag&quot;</span>: file[<span class="string">&#x27;ETag&#x27;</span>],</span><br><span class="line">                       <span class="string">&quot;Size (bytes)&quot;</span>: file[<span class="string">&#x27;Size (bytes)&#x27;</span>], <span class="string">&quot;Last Modified&quot;</span>: file[<span class="string">&#x27;Last Modified&#x27;</span>]&#125;</span><br><span class="line">                         <span class="keyword">for</span> file <span class="keyword">in</span> files]</span><br><span class="line">        df = pd.DataFrame(file_list)</span><br><span class="line">        <span class="keyword">return</span> df</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> pd.DataFrame(columns=[<span class="string">&quot;File Name&quot;</span>, <span class="string">&quot;ETag&quot;</span>])</span><br><span class="line"><span class="comment"># ä¸‹è¼‰æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_file</span>(<span class="params">bucket_name, object_name</span>):</span><br><span class="line">    s3 = get_s3_client()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(object_name, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            s3.download_fileobj(bucket_name, object_name, f)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Downloaded <span class="subst">&#123;object_name&#125;</span> from <span class="subst">&#123;bucket_name&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(e)</span><br><span class="line"><span class="comment"># ä¸‹è¼‰æª”æ¡ˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_selected_file</span>(<span class="params">selected_file</span>):</span><br><span class="line">    response = download_file(BUCKET_NAME, selected_file)</span><br><span class="line">    st.write(response)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Streamlit app layout</span></span><br><span class="line">st.title(<span class="string">&quot;Synology C2 Storage Management with S3 API&quot;</span>)</span><br><span class="line"></span><br><span class="line">st.header(<span class="string">&quot;List and Download Files&quot;</span>)</span><br><span class="line">files_df = list_all_files()</span><br><span class="line">st.dataframe(files_df)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> files_df.empty:</span><br><span class="line">    selected_file = st.selectbox(<span class="string">&quot;Select a file to download&quot;</span>, files_df[<span class="string">&quot;File Name&quot;</span>].tolist())</span><br><span class="line">    <span class="keyword">if</span> st.button(<span class="string">&quot;Download File&quot;</span>):</span><br><span class="line">        download_selected_file(selected_file)</span><br><span class="line"></span><br><span class="line">st.header(<span class="string">&quot;Upload a New File and Get Unique ETag&quot;</span>)</span><br><span class="line">upload_new_file()</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>API</tag>
      </tags>
  </entry>
  <entry>
    <title>Clever cloud postgreSQLç”³è«‹æµç¨‹</title>
    <url>/posts/3965020317/</url>
    <content><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2>
<h3 id="è³‡æ–™åº«ä»‹ç´¹">è³‡æ–™åº«ä»‹ç´¹</h3>
<p>è³‡æ–™åº«(æ­¤ç‚ºé—œè¯å¼è³‡æ–™åº«)çš„ä¸»è¦ç”¨é€”æ˜¯ç‚ºè³‡æ–™æä¾›ä¸€å€‹å„²å­˜ç©ºé–“ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é€²è¡Œè®€å–ã€å¯«å…¥ã€ä¿®æ”¹ã€åˆªé™¤ç­‰åŠŸèƒ½ã€‚</p>
<p>é—œè¯å¼è³‡æ–™åº«å¸¸è¦‹å¦‚ä¸‹:</p>
<ul>
<li>MySQL å’Œ PostgreSQL æ˜¯é–‹æºä¸”å»£æ³›ä½¿ç”¨çš„é¸æ“‡ï¼Œé©åˆä¸­å°å‹æ‡‰ç”¨ç¨‹å¼</li>
<li>Microsoft SQL Server é€šå¸¸ç”¨æ–¼å¤§å‹ä¼æ¥­è§£æ±ºæ–¹æ¡ˆ</li>
<li>SQLite å‰‡æ˜¯ä¸€å€‹è¼•é‡ç´šçš„è³‡æ–™åº«ï¼Œé©åˆç”¨æ–¼åµŒå…¥å¼æ‡‰ç”¨æˆ–å–®æ©Ÿæ‡‰ç”¨ã€‚</li>
</ul>
<h3 id="ç”³è«‹é›²ç«¯æœå‹™">ç”³è«‹é›²ç«¯æœå‹™</h3>
<p>æœ¬ç¯‡æ–‡ç« ä»‹ç´¹çš„éƒ¨åˆ†ç‚ºClever Cloud æ‰€æä¾›ç„¡æ–™çš„ 256MB PostgreSQL
æœå‹™ï¼Œé©åˆéœ€è¦åŸºæœ¬è³‡æ–™åº«åŠŸèƒ½çš„å°å‹æ‡‰ç”¨ç¨‹å¼ã€‚</p>
<h3 id="é‡è¦åƒæ•¸">é‡è¦åƒæ•¸</h3>
<p>ç•¶æ‚¨æˆåŠŸè¨»å†Šä¸¦å•Ÿç”¨ PostgreSQL æœå‹™å¾Œï¼Œåªéœ€è¦å–å¾—ä¸€é …é‡è¦åƒæ•¸
<code>CONNECTION_URI</code>å³å¯é–‹å§‹ä½¿ç”¨é›²ç«¯è³‡æ–™åº«ã€‚</p>
<span id="more"></span>
<h2 id="é€²å…¥ç¶²ç«™">é€²å…¥ç¶²ç«™</h2>
<p><a href="https://www.clever-cloud.com/">Clever-Coud</a></p>
<h2 id="è¨»å†Š">è¨»å†Š</h2>
<figure>
<img src="1.png" alt="Fig1. ç™»å…¥é é¢" />
<figcaption aria-hidden="true">Fig1. ç™»å…¥é é¢</figcaption>
</figure>
<p>è¨»å†Šæ–¹å¼:</p>
<ol type="1">
<li>email</li>
<li>Github</li>
</ol>
<figure>
<img src="2.png" alt="Fig2. ç™»å…¥é é¢2" />
<figcaption aria-hidden="true">Fig2. ç™»å…¥é é¢2</figcaption>
</figure>
<h2 id="å…¥å£ç•«é¢">å…¥å£ç•«é¢</h2>
<figure>
<img src="3.png" alt="Fig3. å…¥å£ç•«é¢" />
<figcaption aria-hidden="true">Fig3. å…¥å£ç•«é¢</figcaption>
</figure>
<h3
id="éœ€è¦å…ˆå»é©—è­‰ä½ çš„emailæ˜¯å¦æ­£ç¢º">éœ€è¦å…ˆå»é©—è­‰ä½ çš„emailæ˜¯å¦æ­£ç¢º</h3>
<figure>
<img src="4.png" alt="Fig4. é©—è­‰ä¿¡å…§å®¹" />
<figcaption aria-hidden="true">Fig4. é©—è­‰ä¿¡å…§å®¹</figcaption>
</figure>
<h2 id="æ–°å¢ä¸€å€‹addon">æ–°å¢ä¸€å€‹addon</h2>
<figure>
<img src="5.png" alt="Fig5. æ–°å»ºæŒ‰éˆ•" />
<figcaption aria-hidden="true">Fig5. æ–°å»ºæŒ‰éˆ•</figcaption>
</figure>
<h2 id="é¸å–postgresql">é¸å–PostgreSQL</h2>
<figure>
<img src="6.png" alt="Fig6. è³‡æ–™åº«æœå‹™" />
<figcaption aria-hidden="true">Fig6. è³‡æ–™åº«æœå‹™</figcaption>
</figure>
<h2
id="æŒ‡å®šè¨ˆç•«åç¨±ç‚ºdevæœ€å³ä¸‹è§’æœ‰ä¸€å€‹next">æŒ‡å®šè¨ˆç•«åç¨±ç‚ºDEVï¼Œæœ€å³ä¸‹è§’æœ‰ä¸€å€‹next</h2>
<figure>
<img src="7.png" alt="Fig7. é¸æ“‡å…§å®¹DEV" />
<figcaption aria-hidden="true">Fig7. é¸æ“‡å…§å®¹DEV</figcaption>
</figure>
<h2 id="å¡«å¯«åç¨±">å¡«å¯«åç¨±</h2>
<figure>
<img src="8.png" alt="Fig8. æœå‹™åç¨±" />
<figcaption aria-hidden="true">Fig8. æœå‹™åç¨±</figcaption>
</figure>
<h2 id="æœå‹™æˆåŠŸå»ºç«‹">æœå‹™æˆåŠŸå»ºç«‹</h2>
<figure>
<img src="9.png" alt="Fig9. è³‡æ–™åº«ç®¡ç†ä»‹é¢" />
<figcaption aria-hidden="true">Fig9. è³‡æ–™åº«ç®¡ç†ä»‹é¢</figcaption>
</figure>
<hr />
<h2 id="çµè«–">çµè«–</h2>
<p>ä¸Šè¿°çµè«–å°±å¯ä»¥å¾—åˆ°ä¸€çµ„ <strong>Connection
URI</strong>ï¼Œé€™å°±å¯ä»¥æ‹¿ä¾†ç•¶ä½œå…¶ä»–ç¶²ç«™çš„<strong>è³‡æ–™åº«</strong>ä½¿ç”¨äº†!!</p>
<blockquote>
<p>256MBé›–ç„¶æ²’æœ‰å¾ˆå¤§ï¼Œä½†æ˜¯å¯ä»¥å¡å¤§æ¦‚58è¬æ¢ç´”æ–‡å­—ç´€éŒ„ï¼Œä¸€èˆ¬é–‹ç™¼ä¸Šä¾†èªªæ»¿å¤ çš„ã€‚</p>
</blockquote>
<h2 id="ä¸²æ¥ç¯„ä¾‹">ä¸²æ¥ç¯„ä¾‹</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine, Column, Integer, String, DateTime, JSON, UniqueConstraint, ForeignKey</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker,declarative_base, relationship</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> Session</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> select,text</span><br><span class="line"><span class="keyword">import</span> pytz</span><br><span class="line"></span><br><span class="line"><span class="comment"># PostgreSQL é…ç½®(æ”¹æˆä½ çš„)</span></span><br><span class="line">DATABASE_URL=<span class="string">&quot;postgresql://uizbhnmkOOOOOO:K0r18XtU1Nb2yGwC1SfwoOOOOOOO@bngbuvea6wkwlOOOg-postgresql.services.clever-cloud.com:50OOO/bngbuvea6wOOOOOOhzig&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">engine = create_engine(DATABASE_URL)</span><br><span class="line">SessionLocal = sessionmaker(autocommit=<span class="literal">False</span>, autoflush=<span class="literal">False</span>, bind=engine)</span><br><span class="line"></span><br><span class="line"><span class="comment"># DATABASE_URL2=&quot;sqlite:///members.db&quot;</span></span><br><span class="line"><span class="comment"># engine2 = create_engine(DATABASE_URL2)</span></span><br><span class="line"><span class="comment"># SessionLocal2 = sessionmaker(autocommit=False, autoflush=False, bind=engine2)</span></span><br><span class="line">    </span><br><span class="line">Base = declarative_base()</span><br><span class="line"><span class="comment"># å®šç¾©æ•¸æ“šåº«æ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Photo</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&#x27;photos_backup&#x27;</span></span><br><span class="line">    <span class="built_in">id</span> = Column(Integer, primary_key=<span class="literal">True</span>, index=<span class="literal">True</span>)</span><br><span class="line">    user_id = Column(String(<span class="number">255</span>))</span><br><span class="line">    group_id = Column(String(<span class="number">255</span>))</span><br><span class="line">    photo_name = Column(String(<span class="number">255</span>))</span><br><span class="line">    photo_url = Column(String(<span class="number">255</span>))</span><br><span class="line">    photo_thumbnail_url = Column(String(<span class="number">255</span>))</span><br><span class="line">    place_tmp=  Column(String(<span class="number">50</span>))</span><br><span class="line">    created_time = Column(DateTime, default=<span class="keyword">lambda</span>: datetime.now(pytz.timezone(<span class="string">&#x27;Asia/Taipei&#x27;</span>)))</span><br><span class="line">    photo_properties = Column(JSON)</span><br><span class="line">    photo_image_hash = Column(String(<span class="number">255</span>))<span class="comment">#, unique=True, nullable=False)</span></span><br><span class="line"></span><br><span class="line">Base.metadata.create_all(bind=engine)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_photo</span>(<span class="params">user_id, group_id, photo_name, photo_url, photo_thumbnail_url, place_tmp, photo_properties, photo_image_hash</span>):</span><br><span class="line">    <span class="comment"># å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±</span></span><br><span class="line">    db: Session = SessionLocal()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># å‰µå»º Photo å¯¦ä¾‹</span></span><br><span class="line">        new_photo = Photo(</span><br><span class="line">            user_id=user_id,</span><br><span class="line">            group_id=group_id,</span><br><span class="line">            photo_name=photo_name,</span><br><span class="line">            photo_url=photo_url,</span><br><span class="line">            photo_thumbnail_url=photo_thumbnail_url,</span><br><span class="line">            place_tmp=place_tmp,</span><br><span class="line">            photo_properties=photo_properties,</span><br><span class="line">            photo_image_hash=photo_image_hash</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å°‡æ–°å¯¦ä¾‹æ·»åŠ åˆ°æœƒè©±ä¸­</span></span><br><span class="line">        db.add(new_photo)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æäº¤æœƒè©±ä»¥ä¿å­˜æ›´æ”¹</span></span><br><span class="line">        db.commit()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ·æ–°æœƒè©±ä»¥ç²å–æ–°è³‡æ–™çš„ ID</span></span><br><span class="line">        db.refresh(new_photo)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ–°å¢ç…§ç‰‡è³‡æ–™æˆåŠŸï¼ŒID: <span class="subst">&#123;new_photo.<span class="built_in">id</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™</span></span><br><span class="line">        db.rollback()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ–°å¢ç…§ç‰‡è³‡æ–™å¤±æ•—: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># é—œé–‰æœƒè©±</span></span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_all_photos</span>():</span><br><span class="line">    <span class="comment"># å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±</span></span><br><span class="line">    db: Session = SessionLocal()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># ç²å–æ‰€æœ‰ç…§ç‰‡è³‡æ–™</span></span><br><span class="line">        photos = db.query(Photo).<span class="built_in">all</span>()</span><br><span class="line">        <span class="keyword">return</span> photos</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™</span></span><br><span class="line">        db.rollback()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç²å–ç…§ç‰‡è³‡æ–™å¤±æ•—: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># é—œé–‰æœƒè©±</span></span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_photo_by_id</span>(<span class="params">photo_id</span>):</span><br><span class="line">    <span class="comment"># å‰µå»ºä¸€å€‹æ–°çš„æ•¸æ“šåº«æœƒè©±</span></span><br><span class="line">    db: Session = SessionLocal()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># é€é ID åˆªé™¤ç…§ç‰‡è³‡æ–™</span></span><br><span class="line">        db.query(Photo).<span class="built_in">filter</span>(Photo.<span class="built_in">id</span> == photo_id).delete()</span><br><span class="line">        db.commit()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åˆªé™¤ç…§ç‰‡è³‡æ–™æˆåŠŸï¼ŒID: <span class="subst">&#123;photo_id&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># å¦‚æœç™¼ç”ŸéŒ¯èª¤ï¼Œå›æ»¾äº‹å‹™</span></span><br><span class="line">        db.rollback()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åˆªé™¤ç…§ç‰‡è³‡æ–™å¤±æ•—: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># é—œé–‰æœƒè©±</span></span><br><span class="line">        db.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¯„ä¾‹</span></span><br><span class="line">add_photo(</span><br><span class="line">    user_id=<span class="string">&quot;user_123&quot;</span>,</span><br><span class="line">    group_id=<span class="string">&quot;group_456&quot;</span>,</span><br><span class="line">    photo_name=<span class="string">&quot;example_photo.jpg&quot;</span>,</span><br><span class="line">    photo_url=<span class="string">&quot;http://example.com/photo.jpg&quot;</span>,</span><br><span class="line">    photo_thumbnail_url=<span class="string">&quot;http://example.com/photo_thumb.jpg&quot;</span>,</span><br><span class="line">    place_tmp=<span class="string">&quot;Taipei&quot;</span>,</span><br><span class="line">    photo_properties=&#123;<span class="string">&quot;description&quot;</span>: <span class="string">&quot;A beautiful sunset.&quot;</span>&#125;,</span><br><span class="line">    photo_image_hash=<span class="string">&quot;hash_value_example&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">photos = get_all_photos()</span><br><span class="line"><span class="built_in">print</span>(photos)</span><br><span class="line"></span><br><span class="line">delete_photo_by_id(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">session = SessionLocal()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># ä½¿ç”¨åŸç”Ÿ SQL åŸ·è¡Œ ALTER TABLEï¼Œä¸¦ä½¿ç”¨ text() åŒ…è£ SQL èªå¥</span></span><br><span class="line">    <span class="comment"># session.execute(text(&quot;ALTER TABLE photos_backup ADD COLUMN description TEXT&quot;))</span></span><br><span class="line">    session.execute(text(<span class="string">&quot;DROP TABLE IF EXISTS photos_backup&quot;</span>))</span><br><span class="line">    session.commit()</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å‡ºéŒ¯äº†: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    session.rollback()</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    session.close()</span><br></pre></td></tr></table></figure>
<h2 id="é­é‡å•é¡Œç´€éŒ„">é­é‡å•é¡Œç´€éŒ„</h2>
<p>ç•¶ä»‹é¢çš„PG
Studioç„¡æ³•ç™»å…¥æ™‚ï¼Œæœƒç„¡æ³•æ“ä½œè³‡æ–™åº«ä¸­çš„æ‰€æœ‰å…§å®¹ï¼Œå„˜ç®¡ç”¨pgadminä¾†é€²è¡Œä¹Ÿæœƒå‡ºç¾'ServerManager'æ²’æœ‰å­˜åœ¨user_infoä¹‹é¡çš„éŒ¯èª¤è¨Šæ¯ã€‚</p>
<p>æˆ‘ç”¨streamlitå»ºç«‹ä¸€å€‹ä»‹é¢å»é€²è¡Œæ“ä½œä¹Ÿç„¡æ³•æˆåŠŸ(å¾Œä¾†æ“ä½œæˆåŠŸäº†!?)</p>
<p>VScodeé€²è¡Œé€£æ¥æ™‚æœƒå‡ºç¾pg_tableç„¡æ³•é¡¯ç¤º</p>
<p>ç¸½è¨€ä¹‹å°±æ˜¯ä¸€å€‹å¾ˆç„¡è§£çš„éç¨‹ï¼Œ<del>çœ‹ä¾†é›²ç«¯æœå‹™ä¹Ÿä¸ä¸€å®šæ˜¯å¥½çš„æ–¹æ¡ˆ</del>ï¼Œèƒ½å¤ å®Œæ•´æŒæ¡æœƒæ¯”è¼ƒå®‰å…¨</p>
]]></content>
      <categories>
        <category>åŸºæœ¬æ¦‚å¿µ</category>
      </categories>
      <tags>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›£é€ å ±è¡¨è¦åŠƒ-æ•¸é‡è¨ˆç®—</title>
    <url>/posts/1952534825/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<p>å¥‘ç´„é …ç›®ã€å–®åƒ¹ã€æ•¸é‡ã€å–®ä½æ˜¯æ•´å€‹å·¥ç¨‹é€²è¡Œä¸­çš„<strong>æ•¸é‡è¨ˆç®—</strong>æ ¸å¿ƒã€‚</p>
<p>å¥‘ç´„é …ç›®çš„èµ·æºæ–¼è¨­è¨ˆéšæ®µæœƒæˆç«‹é ç®—æ›¸ä¾¿é–‹å§‹ï¼Œæ‹›æ¨™éšæ®µæœƒä»¥æ¨™å–®çš„å½¢å¼è®“å» å•†é€²è¡Œå¡«åˆ—æŠ•æ¨™ï¼Œæ±ºæ¨™æ™‚å†ä»¥æ¨™æ¯”èª¿æ•´å¥‘ç´„å–®åƒ¹ï¼Œçˆ¾å¾Œæˆç«‹å¥‘ç´„å¾Œä¾¿ä»¥æ­¤ç•¶è¨ˆåƒ¹ä¾æ“šã€‚</p>
<p>å·¥ç¨‹é€²è¡Œè¦åšåˆ°å®Œå…¨ä¸è®Šæ›´è¨­è¨ˆå¯¦åœ¨ç›¸ç•¶å›°é›£ï¼Œå› ç‚ºç¾å ´æ¢ä»¶æ”¹è®Šã€å±…æ°‘ç‰¹æ®Šéœ€æ±‚ã€ç”šè‡³ç·¨åˆ¶é ç®—æ›¸çš„éŒ¯èª¤æœªè¢«ç™¼ç¾éƒ½å¯èƒ½å°è‡´<strong>è®Šæ›´è¨­è¨ˆ</strong>çš„ç™¼ç”Ÿï¼Œæ­¤æ™‚è®Šæ›´è¨­è¨ˆéœ€æ±‚é …ç›®æ²’æœ‰åˆ—æ–¼å¥‘ç´„é …ç›®ï¼Œå‰‡æœƒä¼´éš¨<strong>æ–°å¢é …ç›®æ–°å¢å–®åƒ¹</strong>ç¨‹åºåŒæ­¥é€²è¡Œã€‚</p>
<p>å·¥ç¨‹åŸ·è¡Œä¸€å®šæ¯”ä¾‹å¾Œï¼Œå» å•†å¯æå‡ºä¼°é©—è¨ˆåƒ¹ï¼Œæ­¤æ™‚ä¹Ÿæ˜¯ä»¥ç•¶æœŸå¥‘ç´„é …ç›®ã€å–®åƒ¹ã€å¯¦éš›æ•¸é‡ä½œç‚ºä»˜æ¬¾ä¾æ“šï¼Œé…åˆç´¯ç©é€²åº¦ç›¸äº’å‹¾ç¨½ï¼Œé¿å…è¶…ä¼°ç™¼ç”Ÿã€‚</p>
<span id="more"></span>
<h2 id="å¼•ç”¨ä¾†æº">ğŸ“”å¼•ç”¨ä¾†æº</h2>
<p>å…¬å…±å·¥ç¨‹æ‰€ä½¿ç”¨çš„PCCESå¯ä»¥ç”ŸæˆXMLæˆ–XLSï¼Œå¯ä»¥é€éVBAçš„æ–¹å¼åŒ¯å…¥æˆç›£é€ å ±è¡¨çš„å¥‘ç´„é …ç›®ï¼Œåœ¨å¼•å…¥éç¨‹ä¸­ï¼Œå°æ–¼ç›£é€ å ±è¡¨ä¸­çš„å¥‘ç´„é …ç›®æ¬„ä½è¦åŠƒï¼Œéœ€è¦ç‰¹åˆ¥æ³¨æ„<strong>çµæ§‹æ€§</strong>èˆ‡<strong>æ“´å……æ€§</strong>æ‰æœƒæ–¹ä¾¿ä½œæ¥­ã€‚</p>
<h3 id="å¥‘ç´„é …ç›®æ¬„ä½è¦åŠƒ">å¥‘ç´„é …ç›®æ¬„ä½è¦åŠƒ</h3>
<blockquote>
<p>çµæ§‹æ€§</p>
</blockquote>
<p>åœ¨è³‡æ–™åº«çš„è¨­è¨ˆä¸Šæœ‰æ‰€è¬‚<strong>æ­£è¦åŒ–</strong>çš„æ¦‚å¿µï¼Œå„²å­˜æ ¼ä»¥æ¯æ ¼å­˜æ”¾ä¸€å€‹è³‡æ–™ç‚ºåŸå‰‡ï¼Œ<strong>é¿å…è·¨æ ¼åˆä½µ</strong>çš„æ–¹å¼é€²è¡Œè³‡æ–™å­˜æ”¾ï¼Œé€šå¸¸è³‡æ–™åº«åªç´€éŒ„æ–‡å­—å…§å®¹è€Œå·²ï¼Œåœ–ç‰‡æˆ–æª”æ¡ˆå‰‡ç´€éŒ„<strong>å¤–éƒ¨é€£çµè·¯å¾‘</strong>æ›¿ä»£ã€‚</p>
<blockquote>
<p>æ“´å……æ€§</p>
</blockquote>
<p>å·¥ä½œè¡¨å‰‡æ˜¯ä»¥ä¸åŒé¡åˆ¥åšæ‹†åˆ†ï¼Œä¾‹å¦‚:å¥‘ç´„é …ç›®ã€æ–½ä½œæ•¸é‡ã€è©¦é©—çµ±è¨ˆã€åŸºæœ¬è³‡æ–™æ”¾æ–¼ä¸åŒå·¥ä½œè¡¨ï¼Œå„å·¥ä½œè¡¨ç”±ä¸Šè€Œä¸‹ç™¼å±•ï¼Œä»¥ç¬¬ä¸€åˆ—ç‚ºè¡¨é ­é€²è¡Œè¨˜éŒ„ã€‚(å¦‚æœè¦æ”¾ç½®æŒ‰éˆ•å‰‡å¦ç•¶åˆ¥è«–)</p>
<figure>
<img src="upload_6e802f62772646653c59aa4bfdfb83db.png"
alt="Fig1.é ç®—è©³ç´°è¡¨ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig1.é ç®—è©³ç´°è¡¨ç¯„ä¾‹</figcaption>
</figure>
<h2 id="é€²åº¦ä¾æ“š">ğŸš¸é€²åº¦ä¾æ“š</h2>
<p>å·¥åœ°ç¾å ´æœƒæœ‰ç•¶æ—¥æ–½ä½œé …ç›®ï¼Œæ–½å·¥å» å•†æœƒå¦è£½ä½œä¸€ä»½æ–½å·¥æ—¥èªŒåŠè‡ªä¸»æª¢æŸ¥è¡¨ï¼Œé”æŠ½æŸ¥é »ç‡æ™‚æœƒæå‡ºæª¢é©—åœç•™é»ç”³è«‹å–®æœƒåŒç›£é€ å‰å¾€æŠ½æŸ¥ï¼Œä¸¦å°‡å·²æŠ½æŸ¥å®Œæˆçš„æ•¸é‡å¡«å ±ä¸Šå»ç›£é€ æ—¥å ±ä½œç‚ºæ–½ä½œæ•¸é‡ï¼Œæ­¤æ™‚çš„æ•¸é‡å‰‡ç‚ºæ›ç®—å¯¦éš›é€²åº¦çš„ä¾æ“šã€‚</p>
<p>ç•¶åˆåœ¨é ç®—æ›¸éšæ®µæ™‚ä»¥æ¯”ä¾‹è¨ˆç®—ä¹‹é …ç›®å‰‡æ­¸é¡ç‚ºç™¾åˆ†æ¯”é …ç›®(è·æ¥­å®‰å…¨ã€ç’°å¢ƒä¿è­·ã€å“ç®¡ä½œæ¥­è²»ã€å» å•†åˆ©æ½¤ã€ç‡Ÿæ¥­ç¨…)ï¼Œæœƒä¾ç…§ç•¶åˆåœ¨æ›ç®—æ¯”ä¾‹æ™‚çš„å¥‘ç´„é …ç›®ä¹‹å¯¦ä½œæ•¸é‡å å¥‘ç´„æ•¸é‡ä¹‹é‡‘é¡æ¯”ä¾‹å¡«å¯«ã€‚</p>
<blockquote>
<p>EX:ç’°å¢ƒä¿è­·è²»ç”¨æœƒä¾(ä¸»é«”å·¥ç¨‹+é›œé …å·¥ç¨‹)ä¹‹å¯¦ä½œé‡‘é¡/(ä¸»é«”å·¥ç¨‹+é›œé …å·¥ç¨‹)ä¹‹å¥‘ç´„é‡‘é¡å¡«åˆ—</p>
</blockquote>
<figure>
<img src="fig.JPG" alt="Fig2.ç™¾åˆ†æ¯”é …ç›®ç¯„ä¾‹" />
<figcaption aria-hidden="true">Fig2.ç™¾åˆ†æ¯”é …ç›®ç¯„ä¾‹</figcaption>
</figure>
<h2 id="è®Šæ›´è¨­è¨ˆ">âœ‚ï¸è®Šæ›´è¨­è¨ˆ</h2>
<p>ç•¶å·¥ç¨‹éœ€è¦æ”¹å‹•å¥‘ç´„é …ç›®æˆ–æä¾›æ–°çš„å¥‘ç´„é …ç›®æ™‚ï¼Œæœƒè¾¦ç†è®Šæ›´è¨­è¨ˆæˆ–æ–°å¢é …ç›®æ–°å¢å–®åƒ¹ï¼Œæå ±æ¦‚ä¼°è¡¨åŠè®Šæ›´è¨­è¨ˆé ç®—æ›¸ä¾†å®Œæˆè®Šæ›´è¨­è¨ˆæµç¨‹ï¼Œå¦‚æœ‰æ–°å¢å¥‘ç´„é …ç›®æ™‚å‰‡é ˆå…ˆè¡Œè¾¦ç†æ–°å¢é …ç›®æ–°å–®åƒ¹ã€‚</p>
<p>è‹¥é ç®—æ›¸éšæ®µæœ‰å…ˆæ•˜æ˜ï¼Œå¯¦ä½œæ•¸é‡è¨ˆåƒ¹å‰‡æœƒåœ¨å·¥ç¨‹å®Œå·¥å‰è¾¦ç†ä¸€æ¬¡<strong>ä¿®æ­£é ç®—</strong>ï¼Œä¾ç…§å¥‘ç´„é …ç›®å¡«åˆ—å¯¦ä½œæ•¸é‡ç­‰å€™ç«£å·¥çµç®—ï¼Œè‹¥å·²ç¶“æœ‰ç™¼ç”Ÿè®Šæ›´è¨­è¨ˆï¼Œå‰‡å¾ŒçºŒçš†å·²è®Šæ›´è¨­è¨ˆç¨‹åºé€²è¡Œï¼Œä¸å†ä»¥ä¿®æ­£é ç®—ç¨‹åºè¾¦ç†ã€‚</p>
<p>åŒæ™‚æœƒéœ€è¦ä¾ç…§è®Šæ›´å‰å¾Œçš„æ•¸é‡å·®ç•°ã€é‡‘é¡å·®ç•°å¦è£½æˆ<strong>è®Šæ›´è¨­è¨ˆç¸½è¡¨ã€è®Šæ›´è¨­è¨ˆæ˜ç´°è¡¨</strong>ï¼Œé€™äº›å ±è¡¨å…§å®¹éƒ½æ˜¯èˆ‡å¥‘ç´„é …ç›®ã€å–®åƒ¹æœ‰å¾ˆé«˜çš„é—œè¯æ€§ã€‚</p>
<figure>
<img src="change.JPG" alt="Fig3.è®Šæ›´è¨­è¨ˆä»‹é¢" />
<figcaption aria-hidden="true">Fig3.è®Šæ›´è¨­è¨ˆä»‹é¢</figcaption>
</figure>
<h2 id="ä¼°é©—è¨ˆåƒ¹">ğŸ’°ä¼°é©—è¨ˆåƒ¹</h2>
<p>å·¥ç¨‹åŸ·è¡Œä¸€å®šæ¯”ä¾‹å¾Œï¼Œå» å•†å¯ä»¥æå‡ºä¼°é©—è¨ˆåƒ¹ä¾†æ”¯ä»˜å·¥ç¨‹æ¬¾ï¼Œç›£é€ æ­¤æ™‚éœ€è¦å°ç…§å¥‘ç´„é …ç›®ã€æ•¸é‡ã€å–®åƒ¹ï¼Œä¼°é©—æ•¸é‡ä¸å¾—è¶…éæ—¥å ±æ–½ä½œæ•¸é‡ï¼Œä¸¦ä¸”ç´¯ç©ä¼°é©—é€²åº¦äº¦ä¸å¾—è¶…éç´¯ç©å¯¦éš›é€²åº¦ã€‚</p>
<p>éœ€è¦ä¾ç…§è©²æœŸåˆ¥çš„å·¥ç¨‹ä¼°é©—å…§å®¹å¦è£½æˆ<strong>å·¥ç¨‹ä¼°é©—ç¸½è¡¨ã€å·¥ç¨‹ä¼°é©—è©³ç´°è¡¨</strong>ï¼Œé€™äº›å ±è¡¨å…§å®¹ä¹Ÿéƒ½æ˜¯èˆ‡å¥‘ç´„é …ç›®ã€å–®åƒ¹æœ‰å¾ˆé«˜çš„é—œè¯æ€§ã€‚</p>
<figure>
<img src="cost.JPG" alt="Fig4.ä¼°é©—è¨ˆåƒ¹ä»‹é¢" />
<figcaption aria-hidden="true">Fig4.ä¼°é©—è¨ˆåƒ¹ä»‹é¢</figcaption>
</figure>
<h2 id="é–‹ç™¼ä¸­é‡éçš„å°å•é¡Œ">ğŸé–‹ç™¼ä¸­é‡éçš„å°å•é¡Œ</h2>
<ul>
<li>å¼•å…¥é …ç›®æ™‚å¼•åˆ°é‡è¦†é …ç›®</li>
<li>å¯¦éš›é€²åº¦çš„è¨ˆç®—åˆ†æ¯éœ€å°‡å» å•†åˆ©æ½¤ã€ç‡Ÿæ¥­ç¨…é€²è¡Œæ’é™¤</li>
<li>è®Šæ›´è¨­è¨ˆæœªå°‡è©¦é©—æ•¸é‡åŒæ­¥è®Šæ›´</li>
<li>è®Šæ›´è¨­è¨ˆå¾Œé€²åº¦ä¸å‡åé™</li>
<li>ä¼°é©—è¨ˆåƒ¹çš„ä»¥å‰ä¼°é©—åƒ¹å€¼å› ç‚ºè®Šæ›´è¨­è¨ˆè€Œæ›´å‹•</li>
</ul>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>ç›£é€ å ±è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ç›£é€ æ—¥å ±è¡¨è¨­è¨ˆè¦åŠƒ</title>
    <url>/posts/168906144/</url>
    <content><![CDATA[<h2 id="å‰è¨€">ğŸ™Œå‰è¨€</h2>
<blockquote>
<p>ç›£é€ å ±è¡¨ç‚ºå…¬å…±å·¥ç¨‹ä¸‰ç´šå“ç®¡åˆ¶åº¦ä¸‹çš„å¿…å‚™è¡¨å–®</p>
</blockquote>
<p>ä¾å…¬å…±å·¥ç¨‹æ–½å·¥å“è³ªç®¡ç†ä½œæ¥­è¦é»ç¬¬åä¸€ã€ç›£é€ å–®ä½åŠå…¶æ‰€æ´¾é§ç¾å ´äººå“¡å·¥ä½œé‡é»å¦‚ä¸‹:(åäº”)ä¾è¦å®šå¡«å ±<strong>ç›£é€ å ±è¡¨</strong></p>
<ul>
<li>æ ¼å¼ä¾†æºè«‹åƒè€ƒ<a
href="https://www.pcc.gov.tw/cp.aspx?n=82B82C5E132EEB1F">ç›£é€ å ±è¡¨(é™„è¡¨äº”)</a></li>
</ul>
<p>ç›£é€ å ±è¡¨æ‰€éœ€ç™»è¼‰å…§å®¹é™¤åŸºæœ¬è³‡æ–™å¤–ï¼Œå…¶é¤˜é‡é»ç°¡è¿°å¦‚ä¸‹:</p>
<ol type="1">
<li>å·¥ç¨‹é€²åº¦</li>
<li>æ•¸é‡è¨ˆç®—</li>
<li>æ–½å·¥æŠ½æŸ¥</li>
<li>å“è³ªè©¦é©—</li>
<li>æ–‡ä»¶ç®¡ç†</li>
</ol>
<p>æœ¬ç¯‡ç‚ºæˆ‘æ‰€é–‹ç™¼çš„ç›£é€ æ—¥å ±è¡¨VBAçš„ä¸€äº›å°ˆæ¡ˆè¨­è¨ˆæ¶æ§‹ç°¡è¿°ï¼Œ
æœ‰èˆˆè¶£è«‹ç¹¼çºŒè§€çœ‹...</p>
<span id="more"></span>
<figure>
<img src="é™„è¡¨äº”_å…¬å…±å·¥ç¨‹ç›£é€ å ±è¡¨_page-0001.jpg"
alt="Fig1. ç›£é€ å ±è¡¨ç•«é¢" />
<figcaption aria-hidden="true">Fig1. ç›£é€ å ±è¡¨ç•«é¢</figcaption>
</figure>
<hr />
<h2 id="å·¥ç¨‹é€²åº¦">ğŸš¸å·¥ç¨‹é€²åº¦</h2>
<h3 id="é å®šé€²åº¦">é å®šé€²åº¦</h3>
<blockquote>
<p>æ­¤è™•çš„ç´€éŒ„å…§å®¹ç‚ºæå ±æ–½å·¥è¨ˆç•«æ›¸æ™‚çš„æ–½å·¥é€²åº¦ç¶²åœ–å…§å®¹</p>
</blockquote>
<p>è¤‡é›œçš„æ¡ˆå­å¯èƒ½æœƒæ˜¯ç®­ç·šç¶²åœ–ç•«ã€ç°¡å–®çš„æ¡ˆå­é€šå¸¸ç”¨ç”˜ç‰¹åœ–ï¼Œä¸ç®¡å¦‚ä½•ï¼Œæœ€åº•ä¸‹çš„ç´¯ç©é€²åº¦é€šå¸¸æ¯åŠå€‹æœˆæœƒæœ‰ä¸€å€‹æ•¸å€¼ï¼Œé€™å°±æ˜¯å ±è¡¨ä¸Šæ‰€éœ€çš„é å®šé€²åº¦ï¼Œå¦‚æœæ¯”è¼ƒç°¡å–®çš„æ¡ˆå­å¯ä»¥ç”¨å…§æ’å€¼çš„æ–¹å¼å»è£œæ•¸å€¼ã€‚</p>
<div class="note info"><p>ç´¯ç©é€²åº¦ä»¥å…§æ’æ–¹å¼é€²è¡Œæ™‚ï¼Œåœ¨æŸäº›å¤§æ¡ˆå­ä¸­å¯èƒ½ç„¡æ³•è²¼è¿‘é æ’é€²åº¦ï¼Œå»ºè­°é€éæ§‹é€ ç‰©çš„æ‹†é …é æ’ï¼Œç”±æ§‹é€ ç‰©çš„å–®å…ƒåˆ†æå»æ›ç®—å¥‘ç´„åƒ¹é‡‘ï¼Œå†ä»¥è©²åƒ¹é‡‘é€²è¡Œé å®šé€²åº¦çš„æ›ç®—æœƒæ¯”è¼ƒæº–ç¢ºã€‚</p>
</div>
<h3 id="å¯¦éš›é€²åº¦">å¯¦éš›é€²åº¦</h3>
<blockquote>
<p>æŒ‰å¥‘ç´„è©³ç´°è¡¨é …ç›®å·²ç¶“æŠ½æŸ¥å®Œæˆéƒ¨åˆ†æ‰€æ›ç®—ä¹‹é‡‘é¡ä½”å¥‘ç´„åƒ¹é‡‘ä¹‹é‡‘é¡ç™¾åˆ†æ¯”ã€‚</p>
</blockquote>
<p>æœ‰äº›æ¥­ä¸»æœƒè¦æ±‚è¨ˆç®—å·¥ç¨‹é€²åº¦åˆ†æ¯æ™‚ï¼Œ<strong>ä¸è¦è¨ˆå…¥</strong>å» å•†ç®¡ç†è²»åŠç‡Ÿæ¥­ç¨…ï¼Œä½†å»åˆè¦æ±‚è¦é¡¯ç¤ºæ–¼ç›£é€ å ±è¡¨çš„è©³ç´°è¡¨ä¸Š...</p>
<h3 id="çªç™¼æƒ…å½¢">çªç™¼æƒ…å½¢</h3>
<p>åœ¨å·¥ç¨‹åŸ·è¡ŒæœŸé–“ï¼Œå¯èƒ½æœ‰è«¸å¤šåŸå› å°è‡´<strong>å±•å»¶å·¥æœŸ</strong>ã€<strong>åœå·¥</strong>ç­‰æƒ…æ³ï¼Œæ­¤æ™‚ä¹Ÿéœ€è¦é‡æ–°èª¿æ•´æ–½å·¥ç¶²åœ–ä¸¦å°‡æ­£ç¢ºä¹‹é å®šé€²åº¦ç´€éŒ„ä¸Šå»ã€‚</p>
<hr />
<h2 id="æ•¸é‡è¨ˆç®—">âœï¸æ•¸é‡è¨ˆç®—</h2>
<blockquote>
<p>å°æ‡‰æ–¼ ä¸€ã€å·¥ç¨‹é€²è¡Œæƒ…æ³(å«ç´„å®šä¹‹é‡è¦æ–½å·¥é …ç›®åŠæ•¸é‡)</p>
</blockquote>
<p>åœ¨ç›£é€ è¨ˆç•«æ›¸ä¸­æœƒæåŠé‡è¦æ–½å·¥é …ç›®åŠæ•¸é‡ï¼Œå¯ä»¥ç”¨é€™éƒ¨åˆ†çš„å…§å®¹ä¾†é€²è¡Œç´€éŒ„</p>
<p>ç´€éŒ„å…§å®¹å¯èƒ½æœƒæœ‰ä»¥ä¸‹æƒ…æ³</p>
<ol type="1">
<li>ç´€éŒ„ç´¯ç©æ•¸é‡ä¸ç‚º<strong>0</strong>çš„å¥‘ç´„é …ç›®(å³éƒ¨åˆ†å‘ˆç¾)</li>
<li>ç´€éŒ„å¥‘ç´„æ•¸é‡ä¸ç‚º<strong>0</strong>çš„å¥‘ç´„é …ç›®(å³å…¨éƒ¨å‘ˆç¾)</li>
<li>ç´€éŒ„ç•¶æ—¥æ–½ä½œå…§å®¹ï¼Œå†å¦æª¢é™„ç¬¬äºŒè¯è©³ç´°è¡¨(å³å…¨éƒ¨å‘ˆç¾åœ¨ç¬¬äºŒè¯)</li>
</ol>
<p>é€™éƒ¨åˆ†çš„å·®ç•°è®ŠåŒ–æ¯”è¼ƒå¤§ï¼Œæˆ‘çš„å°ˆæ¡ˆéƒ½æœƒæŠŠé€™äº›é‚è¼¯å»ºç«‹èµ·ä¾†ï¼Œåˆ°æ™‚å†ä¾†é¸è¦å“ªä¸€ç¨®å³å¯</p>
<hr />
<h2 id="æ–½å·¥æŠ½æŸ¥">âš’ï¸æ–½å·¥æŠ½æŸ¥</h2>
<blockquote>
<p>å°æ‡‰æ–¼
äºŒã€ç›£ç£ä¾ç…§è¨­è¨ˆåœ–èªªåŠæ ¸å®šæ–½å·¥åœ–èªªæ–½å·¥(å«ç´„å®šä¹‹æª¢é©—åœç•™é»åŠæ–½å·¥æŠ½æŸ¥ç­‰æƒ…å½¢)</p>
</blockquote>
<p>ä¾ç…§ç›£é€ è¨ˆç•«æ›¸æ‰€æåŠçš„æª¢é©—é »ç‡é€²è¡Œæª¢é©—åœç•™é»æŠ½æŸ¥æˆ–éš¨æ©ŸæŠ½æŸ¥ã€‚</p>
<p>ç´€éŒ„å…§å®¹ç‚ºæŠ½æŸ¥ç´€éŒ„è¡¨çš„ç·¨è™Ÿã€é …ç›®ã€åˆæ ¼èˆ‡å¦ã€‚</p>
<p>å¾ˆå¤šå§”å“¡éƒ½æœƒèªç‚ºç´€éŒ„è¡¨å°±æ˜¯è¦ç”¨<strong>æ‰‹å¯«</strong>æ‰æœ‰FUï¼Œå› æ­¤åœ¨é€²è¡Œæ–½å·¥æŠ½æŸ¥çš„æ­¸æª”æ™‚ï¼Œæœƒéœ€è¦å†å¦å¤–æƒæã€‚</p>
<h2 id="å“è³ªè©¦é©—">ğŸ“‹å“è³ªè©¦é©—</h2>
<blockquote>
<p>å°æ‡‰æ–¼
ä¸‰ã€æŸ¥æ ¸ææ–™è¦æ ¼åŠå“è³ª(å«ç´„å®šä¹‹æª¢é©—åœç•™é»ã€ææ–™è¨­å‚™ç®¡åˆ¶åŠæª¢(è©¦)é©—ç­‰æŠ½é©—æƒ…å½¢)</p>
</blockquote>
<p>ä¾ç…§å“è³ªè¨ˆç•«æ›¸æ‰€æåŠçš„ææ–™è¨­å‚™å“ç®¡é »ç‡é€²è¡Œå» é©—æˆ–æŠ½é©—ã€‚</p>
<p>ç´€éŒ„å…§å®¹ç‚ºææ–™è¨­å‚™ç®¡åˆ¶åç¨±ã€å¥‘ç´„æ•¸é‡ã€å·²ä½œæ•¸é‡ã€‚</p>
<p>é€™éƒ¨åˆ†è·Ÿæ–½å·¥æŠ½æŸ¥æœ‰é»é¡ä¼¼ï¼Œè©¦é©—å ±å‘Šé€šå¸¸ä¹Ÿæœƒæ˜¯ç´™æœ¬çš„å…§å®¹ï¼Œå› æ­¤åœ¨å“è³ªè©¦é©—çš„æ­¸æª”ï¼Œä¸€æ¨£ä¹Ÿæ˜¯è¦å¦å¤–æƒæèµ·ä¾†ã€‚</p>
<h2 id="æ–‡ä»¶ç®¡ç†">ğŸ“šæ–‡ä»¶ç®¡ç†</h2>
<blockquote>
<p>å°æ‡‰æ–¼
äº”ã€å…¶ä»–ç´„å®šç›£é€ äº‹é …(å«é‡è¦äº‹é …ç´€éŒ„ã€ä¸»è¾¦æ©Ÿé—œæŒ‡ç¤ºåŠé€šçŸ¥å» å•†è¾¦ç†äº‹é …)</p>
</blockquote>
<ul>
<li>æ©Ÿé—œå…¬æ–‡(è®Šæ›´ã€æ–°å¢ã€å±•å»¶ã€åœå·¥ã€ææ–™ã€ä¼°é©—ã€è¡Œæ”¿æ–‡ä»¶...ç­‰)</li>
<li>ç£å°æŸ¥æ ¸</li>
<li>æœƒè­°è¨˜éŒ„</li>
<li>äº¤è¾¦äº‹é …</li>
<li><strong>å…¶ä»–è¦ºå¾—æ‡‰è©²è¦ç´€éŒ„çš„å…§å®¹</strong></li>
</ul>
<p>æ¯å€‹å·¥ç¨‹æ¡ˆæ‡‰è©²éƒ½æœƒæœ‰ç„¡æ•¸å€‹æœƒè­°ã€ç„¡æ•¸å€‹ä¾†å¾€å…¬æ–‡ï¼Œç„¡è«–æ˜¯å°æ¥­ä¸»é‚„æ˜¯å°å» å•†éƒ½æ˜¯ï¼Œè€Œé€™äº›éƒ½æœƒéœ€è¦ç´€éŒ„åœ¨ç›£é€ å ±è¡¨ä¸­</p>
<p>é æœŸæ¯å€‹å°å·¥ç¨‹æ¡ˆä¸äº†è§£çš„äººï¼Œé€éç¿»æ‰¾ç›£é€ å ±è¡¨ï¼Œå°±èƒ½å¤ äº†è§£æ•´å€‹å·¥ç¨‹çš„å¤§è‡´å…§å®¹ï¼Œé€™å°±æ˜¯æ’°å¯«çš„ä¸»è¦ç›®çš„ã€‚</p>
<h2 id="ç›£é€ å ±è¡¨vbaç³»çµ±æ¶æ§‹åœ–">ğŸ’¥ç›£é€ å ±è¡¨VBAç³»çµ±æ¶æ§‹åœ–</h2>
<figure>
<img src="ç›£é€ å ±è¡¨VBA_page-0001.jpg"
alt="Fig2. ç›£é€ å ±è¡¨VBAç³»çµ±æ¶æ§‹åœ–" />
<figcaption aria-hidden="true">Fig2. ç›£é€ å ±è¡¨VBAç³»çµ±æ¶æ§‹åœ–</figcaption>
</figure>
]]></content>
      <categories>
        <category>å°ˆæ¡ˆé–‹ç™¼</category>
      </categories>
      <tags>
        <tag>Excel VBA</tag>
        <tag>ç›£é€ å ±è¡¨</tag>
      </tags>
  </entry>
</search>
